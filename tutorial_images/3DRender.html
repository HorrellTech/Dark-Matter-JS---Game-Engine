<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Dark Matter Game</title><meta name=description content="Use WASDD to move the camera around, hold left mouse button and drag to rotate the camera"><meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<script>
        document.addEventListener('DOMContentLoaded', function() {
            const canvas = document.getElementById('gameCanvas');
            if (canvas) {
                const updateCanvasSize = () => {
                    const width = window.innerWidth;
                    const height = window.innerHeight;
                    canvas.width = width;
                    canvas.height = height;
                    canvas.style.width = width + 'px';
                    canvas.style.height = height + 'px';
                    if (window.engine && typeof window.engine.handleResize === 'function') {
                        window.engine.handleResize(width, height);
                    }
                };
                updateCanvasSize();
                window.addEventListener('resize', updateCanvasSize);
                window.addEventListener('orientationchange', () => {
                    setTimeout(updateCanvasSize, 100);
                });
            }
            if (typeof Matter === 'undefined') {
                console.log('Loading Matter.js from CDN as fallback...');
                const script = document.createElement('script');
                script.src = 'https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.18.0/matter.min.js';
                script.onload = function() {
                    console.log('Matter.js loaded from CDN');
                    window.dispatchEvent(new Event('matter-loaded'));
                };
                document.head.appendChild(script);
            } else {
                window.dispatchEvent(new Event('matter-loaded'));
            }
        });

        document.addEventListener('DOMContentLoaded', function() {
            const startBtn = document.getElementById('start-game-btn');
            if (startBtn) {
                startBtn.addEventListener('click', function() {
                    startBtn.style.display = 'none';
                    const loadingScreen = document.getElementById('loading-screen');
                    if (loadingScreen) loadingScreen.style.display = 'none';
                    if (window.melodicode && window.melodicode.audioEngine && window.melodicode.audioEngine.context) {
                        window.melodicode.audioEngine.context.resume();
                    }
                    if (typeof initializeGame === 'function') {
                        initializeGame();
                    }
                });
            }

            // Load Game Button Logic
            const loadBtn = document.getElementById('load-game-btn');
            if (loadBtn) {
                loadBtn.addEventListener('click', function() {
                    showLoadGameDialog();
                });
            }
        });

        document.addEventListener('DOMContentLoaded', function() {
            function showDescModal() {
                document.getElementById('desc-modal').style.display = 'flex';
            }
            function hideDescModal() {
                document.getElementById('desc-modal').style.display = 'none';
            }
            const descBtn = document.getElementById('desc-btn');
            if (descBtn) {
                descBtn.addEventListener('click', showDescModal);
                descBtn.addEventListener('touchstart', function(e){e.preventDefault();showDescModal();});
            }
            const descCloseBtn = document.getElementById('desc-close-btn');
            if (descCloseBtn) {
                descCloseBtn.addEventListener('click', hideDescModal);
                descCloseBtn.addEventListener('touchstart', function(e){e.preventDefault();hideDescModal();});
            }
            // Touch support for start/load buttons
            const startBtn = document.getElementById('start-game-btn');
            if (startBtn) {
                startBtn.addEventListener('touchstart', function(e){
                    e.preventDefault();
                    startBtn.click();
                });
            }
            const loadBtn = document.getElementById('load-game-btn');
            if (loadBtn) {
                loadBtn.addEventListener('touchstart', function(e){
                    e.preventDefault();
                    loadBtn.click();
                });
            }
        });

        // Load Game Dialog
        function showLoadGameDialog() {
            const modal = document.createElement('div');
            modal.id = 'load-game-modal';
            modal.style.position = 'fixed';
            modal.style.top = '0'; modal.style.left = '0';
            modal.style.width = '100vw'; modal.style.height = '100vh';
            modal.style.background = 'rgba(0,0,0,0.85)';
            modal.style.display = 'flex'; modal.style.alignItems = 'center'; modal.style.justifyContent = 'center';
            modal.style.zIndex = '2000';

            // List local saves
            let saves = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('dmjs_save_')) {
                    saves.push(key.replace('dmjs_save_', ''));
                }
            }

            // Build options string
            let optionsHtml = '';
            if (saves.length) {
                optionsHtml = saves.map(s => `<option value="${s}">${s}</option>`).join('');
            } else {
                optionsHtml = '<option>No saves found</option>';
            }

            modal.innerHTML = `
                <div style="background:#222;padding:32px;border-radius:16px;min-width:320px;max-width:90vw;">
                    <h2 style="color:#fff;">Load Game</h2>
                    <div>
                        <label style="color:#fff;">Local Saves:</label>
                        <select id="local-save-list" style="width:100%;margin-bottom:12px;">
                            ${optionsHtml}
                        </select>
                        <button id="load-local-btn" style="margin-right:8px;">Load Selected</button>
                        <button id="delete-local-btn" style="margin-right:8px;">Delete Selected</button>
                    </div>
                    <hr style="margin:16px 0;">
                    <div>
                        <label style="color:#fff;">Import Save File:</label>
                        <input type="file" id="import-save-file" accept=".json,.dmjs-save.json" style="margin-bottom:8px;">
                        <button id="import-file-btn">Import & Load</button>
                    </div>
                    <hr style="margin:16px 0;">
                    <button id="back-btn" style="margin-top:8px;">Back</button>
                </div>
            `;
            document.body.appendChild(modal);

            // Load local
            modal.querySelector('#load-local-btn').onclick = async () => {
                const sel = modal.querySelector('#local-save-list').value;
                if (window.engine && sel) {
                    await window.engine.loadGame(sel);
                    modal.remove();
                    document.getElementById('loading-screen').style.display = 'none';
                }
            };
            // Delete local
            modal.querySelector('#delete-local-btn').onclick = () => {
                const sel = modal.querySelector('#local-save-list').value;
                if (sel && confirm('Delete save "' + sel + '"?')) {
                    localStorage.removeItem('dmjs_save_' + sel);
                    modal.remove();
                    showLoadGameDialog();
                }
            };
            // Import file
            modal.querySelector('#import-file-btn').onclick = async () => {
                const fileInput = modal.querySelector('#import-save-file');
                if (fileInput.files.length) {
                    const file = fileInput.files[0];
                    if (window.engine) {
                        await window.engine.loadGame(file);
                        modal.remove();
                        document.getElementById('loading-screen').style.display = 'none';
                    }
                }
            };
            // Back button
            modal.querySelector('#back-btn').onclick = () => {
                modal.remove();
            };
        }
    </script>
<style id="game-styles">html,body{margin:0;padding:0;width:100%;height:100%;overflow:hidden;background:#000;font-family:Arial,sans-serif;overscroll-behavior:none}#game-container{position:fixed;top:0;left:0;width:100vw;height:100vh;display:flex;justify-content:center;align-items:center;background:#000;margin:0;padding:0}#gameCanvas{display:block;background:#000;width:100%;height:100%;max-width:100vw;max-height:100vh;object-fit:contain;margin:0;image-rendering:auto}#loading-screen{position:fixed;top:0;left:0;width:100vw;height:100vh;background:#000;color:#fff;display:flex;align-items:center;justify-content:center;font-family:Arial,sans-serif;z-index:1000}#gameCanvas{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;outline:none}@media (max-width:768px){body{position:fixed;overflow:hidden;-webkit-overflow-scrolling:touch}#gameCanvas{width:100vw!important;height:100vh!important}}@media screen and (orientation:portrait){#game-container{flex-direction:column}}@media screen and (orientation:landscape){#game-container{flex-direction:row}}body:focus{outline:none}::-webkit-scrollbar{display:none}html{-ms-overflow-style:none;scrollbar-width:none}#loading-screen{position:fixed;top:0;left:0;width:100vw;height:100vh;background:#000000;color:#fff;display:flex;align-items:center;justify-content:center;z-index:1000;font-family:Arial,sans-serif}.loading-content{display:flex;flex-direction:column;align-items:center}.loading-spinner{width:48px;height:48px;border:6px solid transparent;border-top:6px solid #4f8ef7;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:16px}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.loading-text{font-size:1.2em;margin-bottom:12px;letter-spacing:1px}.loading-progress-bar{width:200px;height:8px;background:#222;border-radius:4px;overflow:hidden;margin-top:8px}.loading-progress{width:0%;height:100%;background:linear-gradient(90deg,#09f 0%,#0ff 100%);transition:width 0.3s}.loading-logo{display:block;margin:0 auto 32px auto;max-width:60vw;max-height:60vh;width:auto;height:auto;object-fit:contain}.loading-row{display:flex;align-items:center;justify-content:center;margin-bottom:16px;gap:24px}.loading-text{font-size:2em;margin:0;letter-spacing:1px;color:#fff}.loading-spinner{width:48px;height:48px;border:6px solid transparent;border-top:6px solid #4f8ef7;border-radius:50%;animation:spin 1s linear infinite;margin:0}#load-game-modal{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.85);display:flex;align-items:center;justify-content:center;z-index:2000;font-family:'Segoe UI',Arial,sans-serif}#load-game-modal>div{background:#222;padding:32px 40px;border-radius:18px;min-width:340px;max-width:95vw;box-shadow:0 8px 32px #000a;color:#fff}#load-game-modal h2{margin-top:0;margin-bottom:18px;font-size:2em;font-weight:700;letter-spacing:1px;color:#4f8ef7}#load-game-modal label{font-weight:500;margin-bottom:6px;display:block;color:#eee}#load-game-modal select,#load-game-modal input[type="file"]{width:100%;padding:8px 10px;border-radius:8px;border:none;background:#333;color:#fff;margin-bottom:10px;font-size:1em}#load-game-modal button{padding:10px 24px;border-radius:8px;border:none;background:#4f8ef7;color:#fff;font-weight:600;font-size:1em;margin:6px 4px 0 0;cursor:pointer;box-shadow:0 2px 8px #4F8EF744;transition:background 0.2s,box-shadow 0.2s}#load-game-modal button#back-btn{background:#444}#load-game-modal button:hover{background:#4f8ef7}#load-game-modal hr{border:none;border-top:1px solid #444;margin:18px 0}* Style the file input for the load game modal */ #load-game-modal input[type="file"]{background:#2d3e5c;color:#fff;border:none;border-radius:8px;padding:8px 10px;font-size:1em;margin-bottom:10px;box-shadow:0 2px 8px #4F8EF744;transition:background 0.2s,box-shadow 0.2s}#load-game-modal input[type="file"]:hover,#load-game-modal input[type="file"]:focus{background:#22304a;outline:none}#loading-screen{position:fixed;top:0;left:0;width:100vw;height:100vh;background:#111;color:#fff;display:flex;align-items:center;justify-content:center;z-index:1000;font-family:Arial,sans-serif}.loading-content{display:flex;flex-direction:column;align-items:center}.loading-logo{display:block;margin:0 auto 32px auto;max-width:60vw;max-height:60vh;width:auto;height:auto;object-fit:contain}.game-title{font-size:2em;font-weight:700;color:#4F8EF7;margin-bottom:16px;text-align:center;letter-spacing:1px}#start-game-btn,#load-game-btn{margin-top:8px;padding:16px 48px;font-size:1.4em;font-weight:bold;color:#fff;background:#4F8EF7;border:none;border-radius:32px;box-shadow:0 2px 16px 0 #4F8EF744;cursor:pointer;transition:background 0.2s,box-shadow 0.2s;outline:none;letter-spacing:1px;touch-action:manipulation}#load-game-btn{margin-top:12px;padding:12px 32px;font-size:1.1em;border-radius:24px;box-shadow:0 2px 8px 0 #4F8EF744}#desc-btn{margin-top:8px;padding:0 16px;font-size:1.4em;font-weight:bold;color:#4F8EF7;background:#222;border:2px solid #4F8EF7;border-radius:50%;cursor:pointer;transition:background 0.2s,box-shadow 0.2s;outline:none;height:48px;width:48px;display:flex;align-items:center;justify-content:center;touch-action:manipulation}#desc-btn:active,#desc-btn:focus{background:#333;border-color:#3574c3}#desc-modal{display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:3000;align-items:center;justify-content:center;background:rgba(0,0,0,0.85)}#desc-modal>div{background:#222;padding:32px 24px;border-radius:16px;max-width:90vw;max-height:80vh;overflow:auto;box-shadow:0 8px 32px #000a;color:#fff;position:relative}#desc-close-btn{position:absolute;top:12px;right:16px;background:none;border:none;color:#4F8EF7;font-size:1.6em;cursor:pointer;touch-action:manipulation}#desc-modal h2{color:#4F8EF7;margin-top:0;margin-bottom:12px;font-size:1.3em}#desc-modal div{font-size:1.1em;line-height:1.5;color:#eee}@media (max-width:600px){#desc-modal>div{padding:18px 8px;min-width:90vw}#desc-modal h2{font-size:1.1em}.game-title{font-size:1.2em}#start-game-btn,#load-game-btn{font-size:1em;padding:10px 24px}#desc-btn{font-size:1em;height:36px;width:36px}}@media (max-width:600px){#load-game-modal>div{padding:18px 8px;min-width:90vw}#load-game-modal h2{font-size:1.3em}}</style>
<script id="game-script">class Vector2{constructor(e=0,t=0){this.x=e,this.y=t}add(e){return new Vector2(this.x+e.x,this.y+e.y)}subtract(e){return new Vector2(this.x-e.x,this.y-e.y)}multiply(e){return new Vector2(this.x*e,this.y*e)}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const e=this.magnitude();return 0===e?new Vector2:new Vector2(this.x/e,this.y/e)}distanceTo(e){return Math.sqrt((this.x-e.x)**2+(this.y-e.y)**2)}static zero(){return new Vector2(0,0)}static one(){return new Vector2(1,1)}static up(){return new Vector2(0,1)}static down(){return new Vector2(0,-1)}static left(){return new Vector2(-1,0)}static right(){return new Vector2(1,0)}static fromAngle(e){return new Vector2(Math.cos(e),Math.sin(e))}static random(){return new Vector2(2*Math.random()-1,2*Math.random()-1).normalize()}add(e){return new Vector2(this.x+e.x,this.y+e.y)}subtract(e){return new Vector2(this.x-e.x,this.y-e.y)}sub(e){return new Vector2(this.x-e.x,this.y-e.y)}multiply(e){return new Vector2(this.x*e,this.y*e)}divide(e){if(0===e)throw Error("Division by zero");return new Vector2(this.x/e,this.y/e)}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}magnitudeSquared(){return this.x*this.x+this.y*this.y}normalize(){const e=this.magnitude();return 0===e?Vector2.zero():this.divide(e)}angle(){return Math.atan2(this.y,this.x)}rotate(e){const t=Math.cos(e),i=Math.sin(e);return new Vector2(this.x*t-this.y*i,this.x*i+this.y*t)}distance(e){return this.subtract(e).magnitude()}distanceSquared(e){return this.subtract(e).magnitudeSquared()}lerp(e,t){return new Vector2(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}clamp(e,t){return new Vector2(Math.min(Math.max(this.x,e.x),t.x),Math.min(Math.max(this.y,e.y),t.y))}reflect(e){const t=this.dot(e);return this.subtract(e.multiply(2*t))}project(e){const t=e.normalize();return t.multiply(this.dot(t))}perpendicular(){return new Vector2(-this.y,this.x)}equals(e,t=1e-6){return Math.abs(this.x-e.x)<t&&Math.abs(this.y-e.y)<t}toString(){return`Vector2(${this.x}, ${this.y})`}toArray(){return[this.x,this.y]}clone(){return new Vector2(this.x,this.y)}toJSON(){return{x:this.x,y:this.y}}static up(){return new Vector2(0,1)}static down(){return new Vector2(0,-1)}static left(){return new Vector2(-1,0)}static right(){return new Vector2(1,0)}static zero(){return new Vector2(0,0)}static one(){return new Vector2(1,1)}static fromAngle(e){return new Vector2(Math.cos(e),Math.sin(e))}static forward(){return Vector2.up()}static back(){return Vector2.down()}static fromJSON(e){return e?new Vector2(e.x??0,e.y??0):Vector2.zero()}}window.Vector2=Vector2;class Vector3{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}clone(){return new Vector3(this.x,this.y,this.z)}add(e){return new Vector3(this.x+e.x,this.y+e.y,this.z+e.z)}subtract(e){return new Vector3(this.x-e.x,this.y-e.y,this.z-e.z)}multiply(e){return new Vector3(this.x*e,this.y*e,this.z*e)}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}cross(e){return new Vector3(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){const e=this.magnitude();return 0===e?this.clone():new Vector3(this.x/e,this.y/e,this.z/e)}toVector2(){return new Vector2(this.x,this.y)}static fromVector2(e,t=0){return new Vector3(e.x,e.y,t)}distance(e){const t=this.x-e.x,i=this.y-e.y,s=this.z-e.z;return Math.sqrt(t*t+i*i+s*s)}rotateX(e){const t=Math.cos(e),i=Math.sin(e),s=this.y*t-this.z*i,o=this.y*i+this.z*t;return new Vector3(this.x,s,o)}rotateY(e){const t=Math.cos(e),i=Math.sin(e),s=this.x*t+this.z*i,o=-this.x*i+this.z*t;return new Vector3(s,this.y,o)}rotateZ(e){const t=Math.cos(e),i=Math.sin(e),s=this.x*t-this.y*i,o=this.x*i+this.y*t;return new Vector3(s,o,this.z)}toString(){return`(${this.x}, ${this.y}, ${this.z})`}static forward(){return new Vector3(1,0,0)}static right(){return new Vector3(0,1,0)}static up(){return new Vector3(0,0,1)}static forwardFromEulerDeg(e=0,t=0,i=0){const s=e*(Math.PI/180),o=t*(Math.PI/180),n=i*(Math.PI/180);let r=Vector3.forward();return r=r.rotateZ(s),r=r.rotateY(o),r=r.rotateX(n),r.normalize()}static rotateByEulerDeg(e,t=0,i=0,s=0){const o=t*(Math.PI/180),n=i*(Math.PI/180),r=s*(Math.PI/180);return e.rotateZ(o).rotateY(n).rotateX(r)}}window.Vector3=Vector3;class CollisionSystem{constructor(){this.lastFrameCollisions=new Set,this.currentFrameCollisions=new Set}checkCollision(e,t){return 0!==e.rotation&&void 0!==e.rotation||0!==t.rotation&&void 0!==t.rotation?this.checkOBBCollision(e,t):this.checkAABBCollision(e,t)}checkAABBCollision(e,t){const i=e.x-e.width/2,s=e.x+e.width/2,o=e.y-e.height/2,n=e.y+e.height/2,r=t.x-t.width/2,a=t.x+t.width/2,l=t.y-t.height/2,h=t.y+t.height/2;return!(r>s||i>a||l>n||o>h)}checkOBBCollision(e,t){const i=this.boxToPolygon(e),s=this.boxToPolygon(t);return this.checkSATCollision(i,s)}boxToPolygon(e){const t=e.width/2,i=e.height/2,s=[new Vector2(-t,-i),new Vector2(t,-i),new Vector2(t,i),new Vector2(-t,i)],o=(e.rotation||0)*Math.PI/180;return s.map(t=>t.rotate(o).add(new Vector2(e.x,e.y)))}checkSATCollision(e,t){const i=this.getAxes(e).concat(this.getAxes(t));for(const s of i){const i=this.projectPolygon(e,s),o=this.projectPolygon(t,s);if(i.max<o.min||o.max<i.min)return!1}return!0}getAxes(e){const t=[],i=e.length;for(let s=0;i>s;s++){const o=e[s],n=e[(s+1)%i].subtract(o),r=new Vector2(-n.y,n.x).normalize();t.push(r)}return t}projectPolygon(e,t){let i=e[0].dot(t),s=i;for(let o=1;o<e.length;o++){const n=e[o].dot(t);i=Math.min(i,n),s=Math.max(s,n)}return{min:i,max:s}}raycast(e,t){return t.rotation&&0!==t.rotation?this.raycastOBB(e,t):this.raycastAABB(e,t)}raycastAABB(e,t){const i=t.x-t.width/2,s=t.x+t.width/2,o=t.y-t.height/2,n=t.y+t.height/2,r=e.origin,a=e.direction.normalize(),l=1/(0===a.x?1e-5:a.x),h=1/(0===a.y?1e-5:a.y),c=(i-r.x)*l,d=(s-r.x)*l,p=(o-r.y)*h,u=(n-r.y)*h,g=Math.max(Math.min(c,d),Math.min(p,u)),m=Math.min(Math.max(c,d),Math.max(p,u));if(0>m)return null;if(g>m)return null;const f=0>g?m:g,y=r.add(a.multiply(f));let w;const b=.001;return w=Math.abs(y.x-i)<b?new Vector2(-1,0):Math.abs(y.x-s)<b?new Vector2(1,0):Math.abs(y.y-o)<b?new Vector2(0,-1):new Vector2(0,1),{distance:f,position:y,normal:w}}raycastOBB(e,t){const i=-t.rotation*Math.PI/180,s=new Vector2(t.x,t.y),o={origin:e.origin.subtract(s).rotate(i),direction:e.direction.rotate(i)},n={x:0,y:0,width:t.width,height:t.height,rotation:0},r=this.raycastAABB(o,n);if(!r)return null;const a=r.position.rotate(-i).add(s),l=r.normal.rotate(-i);return{distance:r.distance,position:a,normal:l}}update(e){this.lastFrameCollisions=new Set(this.currentFrameCollisions),this.currentFrameCollisions.clear();const t=e.length;for(let i=0;t>i;i++){const s=e[i];if(s.active&&s.collisionEnabled)for(let o=i+1;t>o;o++){const t=e[o];if(!t.active||!t.collisionEnabled)continue;if(0===(s.collisionLayer&t.collisionMask)&&0===(t.collisionLayer&s.collisionMask))continue;const i=s.getBoundingBox(),n=t.getBoundingBox();if(this.checkCollision(i,n)){const e=`${s.id}_${t.id}`;this.currentFrameCollisions.add(e),this.lastFrameCollisions.has(e)?this.triggerCollisionStay(s,t):this.triggerCollisionEnter(s,t)}}}for(const t of this.lastFrameCollisions)if(!this.currentFrameCollisions.has(t)){const[i,s]=t.split("_"),o=e.find(e=>e.id===i),n=e.find(e=>e.id===s);o&&n&&this.triggerCollisionExit(o,n)}}triggerCollisionEnter(e,t){e.onCollisionEnter&&e.onCollisionEnter(t),t.onCollisionEnter&&t.onCollisionEnter(e),this.triggerModuleCollisionEvents(e,t,"onCollisionEnter"),this.triggerModuleCollisionEvents(t,e,"onCollisionEnter")}triggerCollisionStay(e,t){e.onCollisionStay&&e.onCollisionStay(t),t.onCollisionStay&&t.onCollisionStay(e),this.triggerModuleCollisionEvents(e,t,"onCollisionStay"),this.triggerModuleCollisionEvents(t,e,"onCollisionStay")}triggerCollisionExit(e,t){e.onCollisionExit&&e.onCollisionExit(t),t.onCollisionExit&&t.onCollisionExit(e),this.triggerModuleCollisionEvents(e,t,"onCollisionExit"),this.triggerModuleCollisionEvents(t,e,"onCollisionExit")}triggerModuleCollisionEvents(e,t,i){e.modules&&e.modules.forEach(e=>{if(e.enabled&&"function"==typeof e[i])try{e[i](t)}catch(t){console.error(`Error in ${i} event for module ${e.type||e.constructor.name}:`,t)}})}}window.collisionSystem=new CollisionSystem;class Raycast{static cast(e,t,i=1/0,s=(window.engine.gameObjects?window.engine.gameObjects:[]),o=65535,n=null){const r={origin:e,direction:t.normalize()};let a=null,l=i,h=null;for(const e of s){if(!e.active||!e.collisionEnabled)continue;if(n&&e===n)continue;if(0===(e.collisionLayer&o))continue;let t=null;const s=e.getModule("RigidBody");if(s&&s.body&&window.physicsManager){if(n){const e=n.getModule("RigidBody");if(e&&e.body===s.body)continue}t=this.raycastMatterBody(r,s.body,i)}if(!t&&e.usePolygonCollision&&e.polygon&&(t=this.raycastPolygon(r,e.polygon,i)),!t&&e.useCollisions){const s=e.getBoundingBox();t=this.raycastRectangle(r,s,i)}t&&t.distance<l&&(a=t,l=t.distance,h=e)}return a?(a.object=h,a):null}static castAll(e,t,i=1/0,s=[],o=65535,n=null){const r={origin:e,direction:t.normalize()},a=[];for(const e of s){if(!e.active||!e.useCollisions&&!e.usePolygonCollision||e!==this.gameObject)continue;if(n&&e===n)continue;if(0===(e.collisionLayer&o))continue;let t=null;const s=e.getModule("RigidBody");if(s&&s.body&&window.physicsManager){if(n){const e=n.getModule("RigidBody");if(e&&e.body===s.body)continue}t=this.raycastMatterBody(r,s.body,i)}if(!t&&e.usePolygonCollision&&e.polygon&&(t=this.raycastPolygon(r,e.polygon,i)),!t&&e.useCollisions){const s=e.getBoundingBox();t=this.raycastRectangle(r,s,i)}t&&t.distance<=i&&(t.object=e,a.push(t))}return a.sort((e,t)=>e.distance-t.distance),a}static raycastMatterBody(e,t,i){const s={x:e.origin.x+e.direction.x*i,y:e.origin.y+e.direction.y*i},o=t.vertices;let n=null,r=i;for(let i=0;i<o.length;i++){const a=o[i],l=o[(i+1)%o.length],h=this.lineLineIntersection(e.origin,s,a,l);if(h){const i=Math.sqrt(Math.pow(h.x-e.origin.x,2)+Math.pow(h.y-e.origin.y,2));if(r>i&&i>.001){r=i;const e={x:l.x-a.x,y:l.y-a.y},s={x:-e.y,y:e.x},o=Math.sqrt(s.x*s.x+s.y*s.y);s.x/=o,s.y/=o;const c={x:h.x-t.position.x,y:h.y-t.position.y};0>s.x*c.x+s.y*c.y&&(s.x=-s.x,s.y=-s.y),n={position:new Vector2(h.x,h.y),normal:new Vector2(s.x,s.y),distance:i}}}}return n}static raycastPolygon(e,t,i){if(!t||!t.points)return null;const s={x:e.origin.x+e.direction.x*i,y:e.origin.y+e.direction.y*i};let o=null,n=i;for(let i=0;i<t.points.length;i++){const r=t.points[i],a=t.points[(i+1)%t.points.length],l=this.lineLineIntersection(e.origin,s,r,a);if(l){const i=Math.sqrt(Math.pow(l.x-e.origin.x,2)+Math.pow(l.y-e.origin.y,2));if(n>i&&i>.001){n=i;const e={x:a.x-r.x,y:a.y-r.y},s={x:-e.y,y:e.x},h=Math.sqrt(s.x*s.x+s.y*s.y);s.x/=h,s.y/=h;const c={x:l.x-t.position.x,y:l.y-t.position.y};0>s.x*c.x+s.y*c.y&&(s.x=-s.x,s.y=-s.y),o={position:new Vector2(l.x,l.y),normal:new Vector2(s.x,s.y),distance:i}}}}return o}static raycastRectangle(e,t,i){const s=t.width/2,o=t.height/2,n=t.x+s,r=t.y+o;let a=[{x:-s,y:-o},{x:s,y:-o},{x:s,y:o},{x:-s,y:o}];if(t.rotation&&0!==t.rotation){const e=Math.cos(t.rotation*Math.PI/180),i=Math.sin(t.rotation*Math.PI/180);a=a.map(t=>({x:n+(t.x*e-t.y*i),y:r+(t.x*i+t.y*e)}))}else a=a.map(e=>({x:n+e.x,y:r+e.y}));const l={x:e.origin.x+e.direction.x*i,y:e.origin.y+e.direction.y*i};let h=null,c=i;for(let t=0;t<a.length;t++){const i=a[t],s=a[(t+1)%a.length],o=this.lineLineIntersection(e.origin,l,i,s);if(o){const t=Math.sqrt(Math.pow(o.x-e.origin.x,2)+Math.pow(o.y-e.origin.y,2));if(c>t&&t>.001){c=t;const e={x:s.x-i.x,y:s.y-i.y},a={x:-e.y,y:e.x},l=Math.sqrt(a.x*a.x+a.y*a.y);a.x/=l,a.y/=l;const d={x:o.x-n,y:o.y-r};0>a.x*d.x+a.y*d.y&&(a.x=-a.x,a.y=-a.y),h={position:new Vector2(o.x,o.y),normal:new Vector2(a.x,a.y),distance:t}}}}return h}static lineLineIntersection(e,t,i,s){const o=e.x,n=e.y,r=t.x,a=t.y,l=i.x,h=i.y,c=s.x,d=s.y,p=(o-r)*(h-d)-(n-a)*(l-c);if(1e-10>Math.abs(p))return null;const u=((o-l)*(h-d)-(n-h)*(l-c))/p,g=-((o-r)*(n-h)-(n-a)*(o-l))/p;return 0>u||u>1||0>g||g>1?null:{x:o+u*(r-o),y:n+u*(a-n)}}static drawRay(e,t,i,s=100,o="#ff0000",n=!0,r=[],a=null){if(e.beginPath(),e.moveTo(t.x,t.y),n&&r.length>0){const n=Raycast.cast(t,i,s,r,65535,a);if(n)return e.lineTo(n.position.x,n.position.y),e.strokeStyle=o,e.lineWidth=1,e.stroke(),e.beginPath(),e.arc(n.position.x,n.position.y,3,0,2*Math.PI),e.fillStyle="#ffcc00",e.fill(),e.beginPath(),e.moveTo(n.position.x,n.position.y),e.lineTo(n.position.x+10*n.normal.x,n.position.y+10*n.normal.y),e.strokeStyle="#00ccff",e.lineWidth=1,void e.stroke()}const l=t.add(i.normalize().multiply(s));e.lineTo(l.x,l.y),e.strokeStyle=o,e.lineWidth=1,e.stroke()}}window.Raycast=Raycast;class MatterMath{constructor(){this.timescale=1}pi(){return Math.PI}pi2(){return 2*Math.PI}time(){return(new Date).getTime()}dt(e=.1){return 1e3/60*this.timescale*e}setTimescale(e){this.timescale=e}getTimescale(){return this.timescale}ts(){return this.timescale}listCreate(){return[]}listAdd(e,t){e.push(t)}listSet(e,t,i){e[t]=i}listGet(e,t){return e[t]}array2dCreate(e,t,i){for(var s=[],o=0;e>o;o+=1)for(var n=0;t>n;n+=1)s.push([o,n]),s[o][n]=i;return s}array2dSet(e,t,i,s){e[t][i]=s}array2dGet(e,t,i){return e[t][i]}array3dCreate(e,t,i,s){for(var o=[],n=0;e>n;n+=1)for(var r=0;t>r;r+=1)for(var a=0;i>a;a+=1)o.push([n,r,a]),o[n][r][a]=s;return o}array3dSet(e,t,i,s,o){e[t][i][s]=o}array3dGet(e,t,i,s){return e[t][i][s]}arrayClear(e){return[]}dcos(e){return Math.cos(this.degtorad(e))}degtorad2=function(){return 2*this.pi()/-360};degtorad(e){return e*this.pi()/180}radtodeg(e){return 180*e/this.pi()}snap(e,t){return floor(e/t)*t}pointDistance(e,t,i,s){var o=e-i,n=t-s;return Math.sqrt(o*o+n*n)}pointDirection(e,t,i,s){return-180*Math.atan2(s-t,i-e)/Math.PI}angleDifference(e,t){let i=Math.abs((e%360+360)%360-(t%360+360)%360);return i>180&&(i=360-i),i}lengthDirX(e,t){return e*Math.cos(t*this.degtorad2())}lengthDirY(e,t){return e*Math.sin(t*this.degtorad2())}lerp(e,t,i){return e+i*(t-e)}random(e){return Math.random()*e+1}randomRange(e,t){return Math.random()*(t-e)+e}irandom(e){return Math.floor(Math.random()*e+1)}irandomRange(e,t){return Math.floor(Math.random()*(t-e)+e)}randomBool(){return Math.random()>=.5}choose(...e){if(0===e.length)throw Error("No items provided to choose from.");return e[Math.floor(Math.random()*e.length)]}stringReplaceAll(e,t,i){return e.replace(RegExp(escapeRegExp(t),"g"),i)}toString(e){return e.toString()}toInt(e){return parseInt(e)}sine(e,t){var i=this.time();return Math.sin(i/e)*t}sinePositive(e,t){var i=Math.sin(this.time()/e)*t;return keepPositive(i)}sineNegative(e,t){var i=Math.sin(this.time()/e)*t;return keepNegative(i)}interpolate(e,t,i){return e+(t-e)*i}smoothstep(e){return e*e*(3-2*e)}sineInterpolation(e){return.5-.5*Math.cos(Math.PI*e)}clamp(e,t,i){return e>i&&(e=i),t>e&&(e=t),e}keepPositive(e){return 0>e&&(e*=-1),e}keepNegative(e){return e>0&&(e*=-1),e}rotateSmooth(e,t,i){let s=t-e;return s=(s+360)%360-180,(e+((s>0?1:-1)*Math.min(Math.abs(s),i)+360))%360}seededRandom(e){let t=1e4*Math.sin(e);return function(){return t=1e4*Math.sin(t),t-Math.floor(t)}}seededRandomGeneral(e){let t=1e4*Math.sin(e);return function(){return t=1e4*Math.sin(t),t-Math.floor(t)}}executeString(string){try{eval(string)}catch(e){console.error("Error executing string:",e)}}rgb(e,t,i){return"rgb("+(e=Math.floor(e))+","+(t=Math.floor(t))+","+(i=Math.floor(i))+")"}hsl(e,t,i){return r=Math.floor(e),g=100*Math.floor(t),b=100*Math.floor(i),"hsl("+r+","+g+"%,"+b+"%)"}}window.MatterMath=new MatterMath,window.matterMath=new MatterMath;class Polygon{constructor(e,t,...i){this.vertices=i.map(e=>e.sub(t)),this.position=t,this.rotation=0,this.math=new MatterMath,this.parent=e,this.originalVertices=this.vertices}projectOntoAxis(e){let t=1/0,i=-1/0;return this.vertices.forEach(s=>{s.add(this.position);const o=s.x*e.x+s.y*e.y;t=Math.min(t,o),i=Math.max(i,o)}),{min:t,max:i}}collidesWith(e){if(this===e)return!1;const t=this.getAxes().concat(e.getAxes());for(let i of t){const t=this.projectOntoAxis(i),s=e.projectOntoAxis(i);if(t.max<s.min||s.max<t.min)return!1}return!0}collisionPoint(e,t){const i=this;let s=!1;for(let o=0,n=i.length-1;o<i.length;n=o++){const r=i[o][0],a=i[o][1],l=i[n][0],h=i[n][1];a>t!=h>t&&(l-r)*(t-a)/(h-a)+r>e&&(s=!s)}return s}snapPositionBack(e){const t=this.calculateMTV(e);t&&(this.parent.x-=t.x,this.parent.y-=t.y)}easePositionBack(e,t=10){const i=this.calculateMTV(e),s=i.x/t,o=i.y/t;for(let e=0;t>e;e++)this.parent.x-=s,this.parent.y-=o}calculateMTV(e){let t=1/0,i={x:0,y:0};const s=this.getAxes().concat(e.getAxes());for(const o of s){const s=this.projectOntoAxis(o),n=e.projectOntoAxis(o),r=Math.min(s.max,n.max)-Math.max(s.min,n.min);if(0>r)return null;t>r&&(t=r,i={x:o.x*r,y:o.y*r})}return i}collisionLine(e,t,i,s){const o=this;if(this.collisionPoint(e,t)||this.collisionLine(i,s))return!0;for(let n=0;n<o.length;n++){const r=o[n][0],a=o[n][1],l=o[(n+1)%o.length][0],h=o[(n+1)%o.length][1];if(this.collisionLineLine(e,t,i,s,r,a,l,h))return!0}return!1}collisionLineLine(e,t,i,s,o,n,r,a){const l=i-e,h=s-t,c=r-o,d=a-n,p=l*d-c*h,u=1/p;if(1e-6>Math.abs(p))return!1;const g=((o-e)*d-(n-t)*c)*u,m=((o-e)*h-(n-t)*l)*u;return!(0>g||g>1||0>m||m>1)}getAxes(){const e=[];for(let t=0;t<this.vertices.length;t++){const i=this.vertices[t],s=this.vertices[t+1===this.vertices.length?0:t+1],o=new Vector2(s.x-i.x,s.y-i.y),n=new Vector2(-o.y,o.x),r=Math.sqrt(n.x*n.x+n.y*n.y),a=new Vector2(n.x/r,n.y/r);e.push(a)}return e}update(e,t){this.position=e;const i=t%360;this.rotation=this.math.degtorad(i);const s=Math.cos(this.rotation),o=Math.sin(this.rotation);this.vertices=this.originalVertices.map(e=>{const t=s*e.x-o*e.y,i=o*e.x+s*e.y;return new Vector2(t+this.position.x,i+this.position.y)})}static rectangle(e,t,i,s){return new Polygon(s,e,new Vector2(e.x-t,e.y-i),new Vector2(e.x+t,e.y-i),new Vector2(e.x+t,e.y+i),new Vector2(e.x-t,e.y+i))}static round(e,t,i,s){const o=[];for(let s=0;t>s;s++){const n=s/t*2*Math.PI,r=e.x+i*Math.cos(n),a=e.y+i*Math.sin(n);o.push(new Vector2(r,a))}return new Polygon(s,e,...o)}draw(e,t){e.save(),e.strokeStyle=t||"white",e.beginPath();for(let t=0;t<this.vertices.length;t++){const i=this.vertices[t],s=this.vertices[(t+1)%this.vertices.length];0===t&&e.moveTo(i.x,i.y),e.lineTo(s.x,s.y)}e.closePath(),e.stroke(),e.restore()}toJSON(){return{x:this.position.x,y:this.position.y,position:{x:this.position.x,y:this.position.y},rotation:this.rotation,vertices:this.vertices.map(e=>({x:e.x,y:e.y}))}}}window.Polygon=Polygon,function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Matter",[],t):"object"==typeof exports?exports.Matter=t():e.Matter=t()}(this,function(){return function(e){var t={};function i(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(s,o,function(t){return e[t]}.bind(null,o));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return{}.hasOwnProperty.call(e,t)},i.p="",i(i.s=20)}([function(e){var t={};e.exports=t,function(){t._baseDelta=1e3/60,t._nextId=0,t._seed=0,t._nowStartTime=+new Date,t._warnedOnce={},t._decomp=null,t.extend=function(e,i){var s,o;"boolean"==typeof i?(s=2,o=i):(s=1,o=!0);for(var n=s;arguments.length>n;n++){var r=arguments[n];if(r)for(var a in r)o&&r[a]&&r[a].constructor===Object?e[a]&&e[a].constructor!==Object?e[a]=r[a]:(e[a]=e[a]||{},t.extend(e[a],o,r[a])):e[a]=r[a]}return e},t.clone=function(e,i){return t.extend({},i,e)},t.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var i in e)t.push(i);return t},t.values=function(e){var t=[];if(Object.keys){for(var i=Object.keys(e),s=0;s<i.length;s++)t.push(e[i[s]]);return t}for(var o in e)t.push(e[o]);return t},t.get=function(e,t,i,s){t=t.split(".").slice(i,s);for(var o=0;o<t.length;o+=1)e=e[t[o]];return e},t.set=function(e,i,s,o,n){var r=i.split(".").slice(o,n);return t.get(e,i,0,-1)[r[r.length-1]]=s,s},t.shuffle=function(e){for(var i=e.length-1;i>0;i--){var s=Math.floor(t.random()*(i+1)),o=e[i];e[i]=e[s],e[s]=o}return e},t.choose=function(e){return e[Math.floor(t.random()*e.length)]},t.isElement=function(e){return"undefined"!=typeof HTMLElement?e instanceof HTMLElement:!!(e&&e.nodeType&&e.nodeName)},t.isArray=function(e){return"[object Array]"==={}.toString.call(e)},t.isFunction=function(e){return"function"==typeof e},t.isPlainObject=function(e){return"object"==typeof e&&e.constructor===Object},t.isString=function(e){return"[object String]"===toString.call(e)},t.clamp=function(e,t,i){return t>e?t:e>i?i:e},t.sign=function(e){return 0>e?-1:1},t.now=function(){if("undefined"!=typeof window&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-t._nowStartTime},t.random=function(t,i){return i=void 0!==i?i:1,(t=void 0!==t?t:0)+e()*(i-t)};var e=function(){return t._seed=(9301*t._seed+49297)%233280,t._seed/233280};t.colorToNumber=function(e){return 3==(e=e.replace("#","")).length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),parseInt(e,16)},t.logLevel=1,t.log=function(){console&&t.logLevel>0&&3>=t.logLevel&&console.log.apply(console,["matter-js:"].concat([].slice.call(arguments)))},t.info=function(){console&&t.logLevel>0&&2>=t.logLevel&&console.info.apply(console,["matter-js:"].concat([].slice.call(arguments)))},t.warn=function(){console&&t.logLevel>0&&3>=t.logLevel&&console.warn.apply(console,["matter-js:"].concat([].slice.call(arguments)))},t.warnOnce=function(){var e=[].slice.call(arguments).join(" ");t._warnedOnce[e]||(t.warn(e),t._warnedOnce[e]=!0)},t.deprecated=function(e,i,s){e[i]=t.chain(function(){t.warnOnce("\ud83d\udd05 deprecated \ud83d\udd05",s)},e[i])},t.nextId=function(){return t._nextId++},t.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var i=0;i<e.length;i++)if(e[i]===t)return i;return-1},t.map=function(e,t){if(e.map)return e.map(t);for(var i=[],s=0;s<e.length;s+=1)i.push(t(e[s]));return i},t.topologicalSort=function(e){var i=[],s=[],o=[];for(var n in e)s[n]||o[n]||t._topologicalSort(n,s,o,e,i);return i},t._topologicalSort=function(e,i,s,o,n){var r=o[e]||[];s[e]=!0;for(var a=0;a<r.length;a+=1){var l=r[a];s[l]||i[l]||t._topologicalSort(l,i,s,o,n)}s[e]=!1,i[e]=!0,n.push(e)},t.chain=function(){for(var e=[],t=0;arguments.length>t;t+=1){var i=arguments[t];i._chained?e.push.apply(e,i._chained):e.push(i)}var s=function(){for(var t,i=Array(arguments.length),s=0,o=arguments.length;o>s;s++)i[s]=arguments[s];for(s=0;s<e.length;s+=1){var n=e[s].apply(t,i);void 0!==n&&(t=n)}return t};return s._chained=e,s},t.chainPathBefore=function(e,i,s){return t.set(e,i,t.chain(s,t.get(e,i)))},t.chainPathAfter=function(e,i,s){return t.set(e,i,t.chain(t.get(e,i),s))},t.setDecomp=function(e){t._decomp=e},t.getDecomp=function(){var e=t._decomp;try{e||"undefined"==typeof window||(e=window.decomp),e||"undefined"==typeof global||(e=global.decomp)}catch(t){e=null}return e}}()},function(e){var t={};e.exports=t,t.create=function(e){var i={min:{x:0,y:0},max:{x:0,y:0}};return e&&t.update(i,e),i},t.update=function(e,t,i){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var s=0;s<t.length;s++){var o=t[s];o.x>e.max.x&&(e.max.x=o.x),o.x<e.min.x&&(e.min.x=o.x),o.y>e.max.y&&(e.max.y=o.y),o.y<e.min.y&&(e.min.y=o.y)}i&&(i.x>0?e.max.x+=i.x:e.min.x+=i.x,i.y>0?e.max.y+=i.y:e.min.y+=i.y)},t.contains=function(e,t){return!(t.x<e.min.x||t.x>e.max.x||t.y<e.min.y||t.y>e.max.y)},t.overlaps=function(e,t){return!(e.min.x>t.max.x||e.max.x<t.min.x||e.max.y<t.min.y||e.min.y>t.max.y)},t.translate=function(e,t){e.min.x+=t.x,e.max.x+=t.x,e.min.y+=t.y,e.max.y+=t.y},t.shift=function(e,t){var i=e.max.x-e.min.x,s=e.max.y-e.min.y;e.min.x=t.x,e.max.x=t.x+i,e.min.y=t.y,e.max.y=t.y+s}},function(e){var t={};e.exports=t,t.create=function(e,t){return{x:e||0,y:t||0}},t.clone=function(e){return{x:e.x,y:e.y}},t.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},t.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},t.rotate=function(e,t,i){var s=Math.cos(t),o=Math.sin(t);i||(i={});var n=e.x*s-e.y*o;return i.y=e.x*o+e.y*s,i.x=n,i},t.rotateAbout=function(e,t,i,s){var o=Math.cos(t),n=Math.sin(t);s||(s={});var r=i.x+((e.x-i.x)*o-(e.y-i.y)*n);return s.y=i.y+((e.x-i.x)*n+(e.y-i.y)*o),s.x=r,s},t.normalise=function(e){var i=t.magnitude(e);return 0===i?{x:0,y:0}:{x:e.x/i,y:e.y/i}},t.dot=function(e,t){return e.x*t.x+e.y*t.y},t.cross=function(e,t){return e.x*t.y-e.y*t.x},t.cross3=function(e,t,i){return(t.x-e.x)*(i.y-e.y)-(t.y-e.y)*(i.x-e.x)},t.add=function(e,t,i){return i||(i={}),i.x=e.x+t.x,i.y=e.y+t.y,i},t.sub=function(e,t,i){return i||(i={}),i.x=e.x-t.x,i.y=e.y-t.y,i},t.mult=function(e,t){return{x:e.x*t,y:e.y*t}},t.div=function(e,t){return{x:e.x/t,y:e.y/t}},t.perp=function(e,t){return{x:(t=!0===t?-1:1)*-e.y,y:t*e.x}},t.neg=function(e){return{x:-e.x,y:-e.y}},t.angle=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},t._temp=[t.create(),t.create(),t.create(),t.create(),t.create(),t.create()]},function(e,t,i){var s={};e.exports=s;var o=i(2),n=i(0);s.create=function(e,t){for(var i=[],s=0;s<e.length;s++){var o=e[s],n={x:o.x,y:o.y,index:s,body:t,isInternal:!1};i.push(n)}return i},s.fromPath=function(e,t){var i=[];return e.replace(/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/gi,function(e,t,s){i.push({x:parseFloat(t),y:parseFloat(s)})}),s.create(i,t)},s.centre=function(e){for(var t,i,n,r=s.area(e,!0),a={x:0,y:0},l=0;l<e.length;l++)n=(l+1)%e.length,t=o.cross(e[l],e[n]),i=o.mult(o.add(e[l],e[n]),t),a=o.add(a,i);return o.div(a,6*r)},s.mean=function(e){for(var t={x:0,y:0},i=0;i<e.length;i++)t.x+=e[i].x,t.y+=e[i].y;return o.div(t,e.length)},s.area=function(e,t){for(var i=0,s=e.length-1,o=0;o<e.length;o++)i+=(e[s].x-e[o].x)*(e[s].y+e[o].y),s=o;return t?i/2:Math.abs(i)/2},s.inertia=function(e,t){for(var i,s,n=0,r=0,a=e,l=0;l<a.length;l++)s=(l+1)%a.length,n+=(i=Math.abs(o.cross(a[s],a[l])))*(o.dot(a[s],a[s])+o.dot(a[s],a[l])+o.dot(a[l],a[l])),r+=i;return t/6*(n/r)},s.translate=function(e,t,i){i=void 0!==i?i:1;var s,o=e.length,n=t.x*i,r=t.y*i;for(s=0;o>s;s++)e[s].x+=n,e[s].y+=r;return e},s.rotate=function(e,t,i){if(0!==t){var s,o,n,r,a=Math.cos(t),l=Math.sin(t),h=i.x,c=i.y,d=e.length;for(r=0;d>r;r++)o=(s=e[r]).x-h,n=s.y-c,s.x=h+(o*a-n*l),s.y=c+(o*l+n*a);return e}},s.contains=function(e,t){for(var i,s=t.x,o=t.y,n=e.length,r=e[n-1],a=0;n>a;a++){if(i=e[a],(s-r.x)*(i.y-r.y)+(o-r.y)*(r.x-i.x)>0)return!1;r=i}return!0},s.scale=function(e,t,i,n){if(1===t&&1===i)return e;var r,a;n=n||s.centre(e);for(var l=0;l<e.length;l++)r=e[l],a=o.sub(r,n),e[l].x=n.x+a.x*t,e[l].y=n.y+a.y*i;return e},s.chamfer=function(e,t,i,s,r){t="number"==typeof t?[t]:t||[8],i=void 0!==i?i:-1,s=s||2,r=r||14;for(var a=[],l=0;l<e.length;l++){var h=e[0>l-1?e.length-1:l-1],c=e[l],d=e[(l+1)%e.length],p=t[l<t.length?l:t.length-1];if(0!==p){var u=o.normalise({x:c.y-h.y,y:h.x-c.x}),g=o.normalise({x:d.y-c.y,y:c.x-d.x}),m=Math.sqrt(2*Math.pow(p,2)),f=o.mult(n.clone(u),p),y=o.normalise(o.mult(o.add(u,g),.5)),w=o.sub(c,o.mult(y,m)),b=i;-1===i&&(b=1.75*Math.pow(p,.32)),(b=n.clamp(b,s,r))%2==1&&(b+=1);for(var x=Math.acos(o.dot(u,g))/b,v=0;b>v;v++)a.push(o.add(o.rotate(f,x*v),w))}else a.push(c)}return a},s.clockwiseSort=function(e){var t=s.mean(e);return e.sort(function(e,i){return o.angle(t,e)-o.angle(t,i)}),e},s.isConvex=function(e){var t,i,s,o,n=0,r=e.length;if(3>r)return null;for(t=0;r>t;t++)if(s=(t+2)%r,o=(e[i=(t+1)%r].x-e[t].x)*(e[s].y-e[i].y),0>(o-=(e[i].y-e[t].y)*(e[s].x-e[i].x))?n|=1:o>0&&(n|=2),3===n)return!1;return 0!==n||null},s.hull=function(e){var t,i,s=[],n=[];for((e=e.slice(0)).sort(function(e,t){var i=e.x-t.x;return 0!==i?i:e.y-t.y}),i=0;i<e.length;i+=1){for(t=e[i];n.length>=2&&0>=o.cross3(n[n.length-2],n[n.length-1],t);)n.pop();n.push(t)}for(i=e.length-1;i>=0;i-=1){for(t=e[i];s.length>=2&&0>=o.cross3(s[s.length-2],s[s.length-1],t);)s.pop();s.push(t)}return s.pop(),n.pop(),s.concat(n)}},function(e,t,i){var s={};e.exports=s;var o=i(3),n=i(2),r=i(7),a=i(0),l=i(1),h=i(11);!function(){s._timeCorrection=!0,s._inertiaScale=4,s._nextCollidingGroupId=1,s._nextNonCollidingGroupId=-1,s._nextCategory=1,s._baseDelta=1e3/60,s.create=function(t){var i={id:a.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:o.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,deltaTime:1e3/60,_original:null},s=a.extend(i,t);return e(s,t),s},s.nextGroup=function(e){return e?s._nextNonCollidingGroupId--:s._nextCollidingGroupId++},s.nextCategory=function(){return s._nextCategory=s._nextCategory<<1,s._nextCategory};var e=function(e,t){t=t||{},s.set(e,{bounds:e.bounds||l.create(e.vertices),positionPrev:e.positionPrev||n.clone(e.position),anglePrev:e.anglePrev||e.angle,vertices:e.vertices,parts:e.parts||[e],isStatic:e.isStatic,isSleeping:e.isSleeping,parent:e.parent||e}),o.rotate(e.vertices,e.angle,e.position),h.rotate(e.axes,e.angle),l.update(e.bounds,e.vertices,e.velocity),s.set(e,{axes:t.axes||e.axes,area:t.area||e.area,mass:t.mass||e.mass,inertia:t.inertia||e.inertia});var i=e.isStatic?"#14151f":a.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),r=e.isStatic?"#555":"#ccc",c=e.isStatic&&null===e.render.fillStyle?1:0;e.render.fillStyle=e.render.fillStyle||i,e.render.strokeStyle=e.render.strokeStyle||r,e.render.lineWidth=e.render.lineWidth||c,e.render.sprite.xOffset+=-(e.bounds.min.x-e.position.x)/(e.bounds.max.x-e.bounds.min.x),e.render.sprite.yOffset+=-(e.bounds.min.y-e.position.y)/(e.bounds.max.y-e.bounds.min.y)};s.set=function(e,t,i){var o;for(o in"string"==typeof t&&(o=t,(t={})[o]=i),t)if({}.hasOwnProperty.call(t,o))switch(i=t[o],o){case"isStatic":s.setStatic(e,i);break;case"isSleeping":r.set(e,i);break;case"mass":s.setMass(e,i);break;case"density":s.setDensity(e,i);break;case"inertia":s.setInertia(e,i);break;case"vertices":s.setVertices(e,i);break;case"position":s.setPosition(e,i);break;case"angle":s.setAngle(e,i);break;case"velocity":s.setVelocity(e,i);break;case"angularVelocity":s.setAngularVelocity(e,i);break;case"speed":s.setSpeed(e,i);break;case"angularSpeed":s.setAngularSpeed(e,i);break;case"parts":s.setParts(e,i);break;case"centre":s.setCentre(e,i);break;default:e[o]=i}},s.setStatic=function(e,t){for(var i=0;i<e.parts.length;i++){var s=e.parts[i];t?(s.isStatic||(s._original={restitution:s.restitution,friction:s.friction,mass:s.mass,inertia:s.inertia,density:s.density,inverseMass:s.inverseMass,inverseInertia:s.inverseInertia}),s.restitution=0,s.friction=1,s.mass=s.inertia=s.density=1/0,s.inverseMass=s.inverseInertia=0,s.positionPrev.x=s.position.x,s.positionPrev.y=s.position.y,s.anglePrev=s.angle,s.angularVelocity=0,s.speed=0,s.angularSpeed=0,s.motion=0):s._original&&(s.restitution=s._original.restitution,s.friction=s._original.friction,s.mass=s._original.mass,s.inertia=s._original.inertia,s.density=s._original.density,s.inverseMass=s._original.inverseMass,s.inverseInertia=s._original.inverseInertia,s._original=null),s.isStatic=t}},s.setMass=function(e,t){var i=e.inertia/(e.mass/6);e.inertia=i*(t/6),e.inverseInertia=1/e.inertia,e.mass=t,e.inverseMass=1/e.mass,e.density=e.mass/e.area},s.setDensity=function(e,t){s.setMass(e,t*e.area),e.density=t},s.setInertia=function(e,t){e.inertia=t,e.inverseInertia=1/e.inertia},s.setVertices=function(e,t){t[0].body===e?e.vertices=t:e.vertices=o.create(t,e),e.axes=h.fromVertices(e.vertices),e.area=o.area(e.vertices),s.setMass(e,e.density*e.area);var i=o.centre(e.vertices);o.translate(e.vertices,i,-1),s.setInertia(e,s._inertiaScale*o.inertia(e.vertices,e.mass)),o.translate(e.vertices,e.position),l.update(e.bounds,e.vertices,e.velocity)},s.setParts=function(e,t,i){var n;for(t=t.slice(0),e.parts.length=0,e.parts.push(e),e.parent=e,n=0;n<t.length;n++){var r=t[n];r!==e&&(r.parent=e,e.parts.push(r))}if(1!==e.parts.length){if(i=void 0===i||i){var a=[];for(n=0;n<t.length;n++)a=a.concat(t[n].vertices);o.clockwiseSort(a);var l=o.hull(a),h=o.centre(l);s.setVertices(e,l),o.translate(e.vertices,h)}var c=s._totalProperties(e);e.area=c.area,e.parent=e,e.position.x=c.centre.x,e.position.y=c.centre.y,e.positionPrev.x=c.centre.x,e.positionPrev.y=c.centre.y,s.setMass(e,c.mass),s.setInertia(e,c.inertia),s.setPosition(e,c.centre)}},s.setCentre=function(e,t,i){i?(e.positionPrev.x+=t.x,e.positionPrev.y+=t.y,e.position.x+=t.x,e.position.y+=t.y):(e.positionPrev.x=t.x-(e.position.x-e.positionPrev.x),e.positionPrev.y=t.y-(e.position.y-e.positionPrev.y),e.position.x=t.x,e.position.y=t.y)},s.setPosition=function(e,t,i){var s=n.sub(t,e.position);i?(e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.velocity.x=s.x,e.velocity.y=s.y,e.speed=n.magnitude(s)):(e.positionPrev.x+=s.x,e.positionPrev.y+=s.y);for(var r=0;r<e.parts.length;r++){var a=e.parts[r];a.position.x+=s.x,a.position.y+=s.y,o.translate(a.vertices,s),l.update(a.bounds,a.vertices,e.velocity)}},s.setAngle=function(e,t,i){var s=t-e.angle;i?(e.anglePrev=e.angle,e.angularVelocity=s,e.angularSpeed=Math.abs(s)):e.anglePrev+=s;for(var r=0;r<e.parts.length;r++){var a=e.parts[r];a.angle+=s,o.rotate(a.vertices,s,e.position),h.rotate(a.axes,s),l.update(a.bounds,a.vertices,e.velocity),r>0&&n.rotateAbout(a.position,s,e.position,a.position)}},s.setVelocity=function(e,t){var i=e.deltaTime/s._baseDelta;e.positionPrev.x=e.position.x-t.x*i,e.positionPrev.y=e.position.y-t.y*i,e.velocity.x=(e.position.x-e.positionPrev.x)/i,e.velocity.y=(e.position.y-e.positionPrev.y)/i,e.speed=n.magnitude(e.velocity)},s.getVelocity=function(e){var t=s._baseDelta/e.deltaTime;return{x:(e.position.x-e.positionPrev.x)*t,y:(e.position.y-e.positionPrev.y)*t}},s.getSpeed=function(e){return n.magnitude(s.getVelocity(e))},s.setSpeed=function(e,t){s.setVelocity(e,n.mult(n.normalise(s.getVelocity(e)),t))},s.setAngularVelocity=function(e,t){var i=e.deltaTime/s._baseDelta;e.anglePrev=e.angle-t*i,e.angularVelocity=(e.angle-e.anglePrev)/i,e.angularSpeed=Math.abs(e.angularVelocity)},s.getAngularVelocity=function(e){return(e.angle-e.anglePrev)*s._baseDelta/e.deltaTime},s.getAngularSpeed=function(e){return Math.abs(s.getAngularVelocity(e))},s.setAngularSpeed=function(e,t){s.setAngularVelocity(e,a.sign(s.getAngularVelocity(e))*t)},s.translate=function(e,t,i){s.setPosition(e,n.add(e.position,t),i)},s.rotate=function(e,t,i,o){if(i){var n=Math.cos(t),r=Math.sin(t),a=e.position.x-i.x,l=e.position.y-i.y;s.setPosition(e,{x:i.x+(a*n-l*r),y:i.y+(a*r+l*n)},o),s.setAngle(e,e.angle+t,o)}else s.setAngle(e,e.angle+t,o)},s.scale=function(e,t,i,n){var r=0,a=0;n=n||e.position;for(var c=0;c<e.parts.length;c++){var d=e.parts[c];o.scale(d.vertices,t,i,n),d.axes=h.fromVertices(d.vertices),d.area=o.area(d.vertices),s.setMass(d,e.density*d.area),o.translate(d.vertices,{x:-d.position.x,y:-d.position.y}),s.setInertia(d,s._inertiaScale*o.inertia(d.vertices,d.mass)),o.translate(d.vertices,{x:d.position.x,y:d.position.y}),c>0&&(r+=d.area,a+=d.inertia),d.position.x=n.x+(d.position.x-n.x)*t,d.position.y=n.y+(d.position.y-n.y)*i,l.update(d.bounds,d.vertices,e.velocity)}e.parts.length>1&&(e.area=r,e.isStatic||(s.setMass(e,e.density*r),s.setInertia(e,a))),e.circleRadius&&(t===i?e.circleRadius*=t:e.circleRadius=null)},s.update=function(e,t){var i=(t=(void 0!==t?t:1e3/60)*e.timeScale)*t,r=s._timeCorrection?t/(e.deltaTime||t):1,c=1-e.frictionAir*(t/a._baseDelta),d=(e.position.x-e.positionPrev.x)*r,p=(e.position.y-e.positionPrev.y)*r;e.velocity.x=d*c+e.force.x/e.mass*i,e.velocity.y=p*c+e.force.y/e.mass*i,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.position.x+=e.velocity.x,e.position.y+=e.velocity.y,e.deltaTime=t,e.angularVelocity=(e.angle-e.anglePrev)*c*r+e.torque/e.inertia*i,e.anglePrev=e.angle,e.angle+=e.angularVelocity;for(var u=0;u<e.parts.length;u++){var g=e.parts[u];o.translate(g.vertices,e.velocity),u>0&&(g.position.x+=e.velocity.x,g.position.y+=e.velocity.y),0!==e.angularVelocity&&(o.rotate(g.vertices,e.angularVelocity,e.position),h.rotate(g.axes,e.angularVelocity),u>0&&n.rotateAbout(g.position,e.angularVelocity,e.position,g.position)),l.update(g.bounds,g.vertices,e.velocity)}},s.updateVelocities=function(e){var t=s._baseDelta/e.deltaTime,i=e.velocity;i.x=(e.position.x-e.positionPrev.x)*t,i.y=(e.position.y-e.positionPrev.y)*t,e.speed=Math.sqrt(i.x*i.x+i.y*i.y),e.angularVelocity=(e.angle-e.anglePrev)*t,e.angularSpeed=Math.abs(e.angularVelocity)},s.applyForce=function(e,t,i){var s=t.x-e.position.x,o=t.y-e.position.y;e.force.x+=i.x,e.force.y+=i.y,e.torque+=s*i.y-o*i.x},s._totalProperties=function(e){for(var t={mass:0,area:0,inertia:0,centre:{x:0,y:0}},i=1===e.parts.length?0:1;i<e.parts.length;i++){var s=e.parts[i],o=s.mass!==1/0?s.mass:1;t.mass+=o,t.area+=s.area,t.inertia+=s.inertia,t.centre=n.add(t.centre,n.mult(s.position,o))}return t.centre=n.div(t.centre,t.mass),t}}()},function(e,t,i){var s={};e.exports=s;var o=i(0);s.on=function(e,t,i){for(var s,o=t.split(" "),n=0;n<o.length;n++)s=o[n],e.events=e.events||{},e.events[s]=e.events[s]||[],e.events[s].push(i);return i},s.off=function(e,t,i){if(t){"function"==typeof t&&(i=t,t=o.keys(e.events).join(" "));for(var s=t.split(" "),n=0;n<s.length;n++){var r=e.events[s[n]],a=[];if(i&&r)for(var l=0;l<r.length;l++)r[l]!==i&&a.push(r[l]);e.events[s[n]]=a}}else e.events={}},s.trigger=function(e,t,i){var s,n,r,a,l=e.events;if(l&&o.keys(l).length>0){i||(i={}),s=t.split(" ");for(var h=0;h<s.length;h++)if(r=l[n=s[h]]){(a=o.clone(i,!1)).name=n,a.source=e;for(var c=0;c<r.length;c++)r[c].call(e,a)}}}},function(e,t,i){var s={};e.exports=s;var o=i(5),n=i(0),r=i(1),a=i(4);s.create=function(e){return n.extend({id:n.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},e)},s.setModified=function(e,t,i,o){if(e.isModified=t,t&&e.cache&&(e.cache.allBodies=null,e.cache.allConstraints=null,e.cache.allComposites=null),i&&e.parent&&s.setModified(e.parent,t,i,o),o)for(var n=0;n<e.composites.length;n++){var r=e.composites[n];s.setModified(r,t,i,o)}},s.add=function(e,t){var i=[].concat(t);o.trigger(e,"beforeAdd",{object:t});for(var r=0;r<i.length;r++){var a=i[r];switch(a.type){case"body":if(a.parent!==a){n.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}s.addBody(e,a);break;case"constraint":s.addConstraint(e,a);break;case"composite":s.addComposite(e,a);break;case"mouseConstraint":s.addConstraint(e,a.constraint)}}return o.trigger(e,"afterAdd",{object:t}),e},s.remove=function(e,t,i){var n=[].concat(t);o.trigger(e,"beforeRemove",{object:t});for(var r=0;r<n.length;r++){var a=n[r];switch(a.type){case"body":s.removeBody(e,a,i);break;case"constraint":s.removeConstraint(e,a,i);break;case"composite":s.removeComposite(e,a,i);break;case"mouseConstraint":s.removeConstraint(e,a.constraint)}}return o.trigger(e,"afterRemove",{object:t}),e},s.addComposite=function(e,t){return e.composites.push(t),t.parent=e,s.setModified(e,!0,!0,!1),e},s.removeComposite=function(e,t,i){var o=n.indexOf(e.composites,t);if(-1!==o){var r=s.allBodies(t);s.removeCompositeAt(e,o);for(var a=0;a<r.length;a++)r[a].sleepCounter=0}if(i)for(a=0;a<e.composites.length;a++)s.removeComposite(e.composites[a],t,!0);return e},s.removeCompositeAt=function(e,t){return e.composites.splice(t,1),s.setModified(e,!0,!0,!1),e},s.addBody=function(e,t){return e.bodies.push(t),s.setModified(e,!0,!0,!1),e},s.removeBody=function(e,t,i){var o=n.indexOf(e.bodies,t);if(-1!==o&&(s.removeBodyAt(e,o),t.sleepCounter=0),i)for(var r=0;r<e.composites.length;r++)s.removeBody(e.composites[r],t,!0);return e},s.removeBodyAt=function(e,t){return e.bodies.splice(t,1),s.setModified(e,!0,!0,!1),e},s.addConstraint=function(e,t){return e.constraints.push(t),s.setModified(e,!0,!0,!1),e},s.removeConstraint=function(e,t,i){var o=n.indexOf(e.constraints,t);if(-1!==o&&s.removeConstraintAt(e,o),i)for(var r=0;r<e.composites.length;r++)s.removeConstraint(e.composites[r],t,!0);return e},s.removeConstraintAt=function(e,t){return e.constraints.splice(t,1),s.setModified(e,!0,!0,!1),e},s.clear=function(e,t,i){if(i)for(var o=0;o<e.composites.length;o++)s.clear(e.composites[o],t,!0);return t?e.bodies=e.bodies.filter(function(e){return e.isStatic}):e.bodies.length=0,e.constraints.length=0,e.composites.length=0,s.setModified(e,!0,!0,!1),e},s.allBodies=function(e){if(e.cache&&e.cache.allBodies)return e.cache.allBodies;for(var t=[].concat(e.bodies),i=0;i<e.composites.length;i++)t=t.concat(s.allBodies(e.composites[i]));return e.cache&&(e.cache.allBodies=t),t},s.allConstraints=function(e){if(e.cache&&e.cache.allConstraints)return e.cache.allConstraints;for(var t=[].concat(e.constraints),i=0;i<e.composites.length;i++)t=t.concat(s.allConstraints(e.composites[i]));return e.cache&&(e.cache.allConstraints=t),t},s.allComposites=function(e){if(e.cache&&e.cache.allComposites)return e.cache.allComposites;for(var t=[].concat(e.composites),i=0;i<e.composites.length;i++)t=t.concat(s.allComposites(e.composites[i]));return e.cache&&(e.cache.allComposites=t),t},s.get=function(e,t,i){var o,n;switch(i){case"body":o=s.allBodies(e);break;case"constraint":o=s.allConstraints(e);break;case"composite":o=s.allComposites(e).concat(e)}return o?0===(n=o.filter(function(e){return e.id.toString()===t.toString()})).length?null:n[0]:null},s.move=function(e,t,i){return s.remove(e,t),s.add(i,t),e},s.rebase=function(e){for(var t=s.allBodies(e).concat(s.allConstraints(e)).concat(s.allComposites(e)),i=0;i<t.length;i++)t[i].id=n.nextId();return e},s.translate=function(e,t,i){for(var o=i?s.allBodies(e):e.bodies,n=0;n<o.length;n++)a.translate(o[n],t);return e},s.rotate=function(e,t,i,o){for(var n=Math.cos(t),r=Math.sin(t),l=o?s.allBodies(e):e.bodies,h=0;h<l.length;h++){var c=l[h],d=c.position.x-i.x,p=c.position.y-i.y;a.setPosition(c,{x:i.x+(d*n-p*r),y:i.y+(d*r+p*n)}),a.rotate(c,t)}return e},s.scale=function(e,t,i,o,n){for(var r=n?s.allBodies(e):e.bodies,l=0;l<r.length;l++){var h=r[l],c=h.position.x-o.x,d=h.position.y-o.y;a.setPosition(h,{x:o.x+c*t,y:o.y+d*i}),a.scale(h,t,i)}return e},s.bounds=function(e){for(var t=s.allBodies(e),i=[],o=0;o<t.length;o+=1){var n=t[o];i.push(n.bounds.min,n.bounds.max)}return r.create(i)}},function(e,t,i){var s={};e.exports=s;var o=i(4),n=i(5),r=i(0);s._motionWakeThreshold=.18,s._motionSleepThreshold=.08,s._minBias=.9,s.update=function(e,t){for(var i=t/r._baseDelta,n=s._motionSleepThreshold,a=0;a<e.length;a++){var l=e[a],h=o.getSpeed(l),c=o.getAngularSpeed(l),d=h*h+c*c;if(0===l.force.x&&0===l.force.y){var p=Math.min(l.motion,d),u=Math.max(l.motion,d);l.motion=s._minBias*p+(1-s._minBias)*u,l.sleepThreshold>0&&l.motion<n?(l.sleepCounter+=1,l.sleepCounter>=l.sleepThreshold/i&&s.set(l,!0)):l.sleepCounter>0&&(l.sleepCounter-=1)}else s.set(l,!1)}},s.afterCollisions=function(e){for(var t=s._motionSleepThreshold,i=0;i<e.length;i++){var o=e[i];if(o.isActive){var n=o.collision,r=n.bodyA.parent,a=n.bodyB.parent;if(!(r.isSleeping&&a.isSleeping||r.isStatic||a.isStatic)&&(r.isSleeping||a.isSleeping)){var l=r.isSleeping&&!r.isStatic?r:a,h=l===r?a:r;!l.isStatic&&h.motion>t&&s.set(l,!1)}}}},s.set=function(e,t){var i=e.isSleeping;t?(e.isSleeping=!0,e.sleepCounter=e.sleepThreshold,e.positionImpulse.x=0,e.positionImpulse.y=0,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.anglePrev=e.angle,e.speed=0,e.angularSpeed=0,e.motion=0,i||n.trigger(e,"sleepStart")):(e.isSleeping=!1,e.sleepCounter=0,i&&n.trigger(e,"sleepEnd"))}},function(e,t,i){var s={};e.exports=s;var o,n,r,a=i(3),l=i(9);o=[],n={overlap:0,axis:null},r={overlap:0,axis:null},s.create=function(e,t){return{pair:null,collided:!1,bodyA:e,bodyB:t,parentA:e.parent,parentB:t.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[null,null],supportCount:0}},s.collides=function(e,t,i){if(s._overlapAxes(n,e.vertices,t.vertices,e.axes),0>=n.overlap)return null;if(s._overlapAxes(r,t.vertices,e.vertices,t.axes),0>=r.overlap)return null;var o,h,c=i&&i.table[l.id(e,t)];c?o=c.collision:((o=s.create(e,t)).collided=!0,o.bodyA=e.id<t.id?e:t,o.bodyB=e.id<t.id?t:e,o.parentA=o.bodyA.parent,o.parentB=o.bodyB.parent),e=o.bodyA,t=o.bodyB,h=r.overlap>n.overlap?n:r;var d=o.normal,p=o.tangent,u=o.penetration,g=o.supports,m=h.overlap,f=h.axis,y=f.x,w=f.y;y*(t.position.x-e.position.x)+w*(t.position.y-e.position.y)>=0&&(y=-y,w=-w),d.x=y,d.y=w,p.x=-w,p.y=y,u.x=y*m,u.y=w*m,o.depth=m;var b=s._findSupports(e,t,d,1),x=0;if(a.contains(e.vertices,b[0])&&(g[x++]=b[0]),a.contains(e.vertices,b[1])&&(g[x++]=b[1]),2>x){var v=s._findSupports(t,e,d,-1);a.contains(t.vertices,v[0])&&(g[x++]=v[0]),2>x&&a.contains(t.vertices,v[1])&&(g[x++]=v[1])}return 0===x&&(g[x++]=b[0]),o.supportCount=x,o},s._overlapAxes=function(e,t,i,s){var o,n,r,a,l,h,c=t.length,d=i.length,p=t[0].x,u=t[0].y,g=i[0].x,m=i[0].y,f=s.length,y=Number.MAX_VALUE,w=0;for(l=0;f>l;l++){var b=s[l],x=b.x,v=b.y,M=p*x+u*v,C=g*x+m*v,_=M,P=C;for(h=1;c>h;h+=1)(a=t[h].x*x+t[h].y*v)>_?_=a:M>a&&(M=a);for(h=1;d>h;h+=1)(a=i[h].x*x+i[h].y*v)>P?P=a:C>a&&(C=a);if((o=(n=_-C)<(r=P-M)?n:r)<y&&(y=o,w=l,0>=o))break}e.axis=s[w],e.overlap=y},s._findSupports=function(e,t,i,s){var n,r,a,l=t.vertices,h=l.length,c=e.position.x,d=e.position.y,p=i.x*s,u=i.y*s,g=l[0],m=g,f=p*(c-m.x)+u*(d-m.y);for(a=1;h>a;a+=1)(r=p*(c-(m=l[a]).x)+u*(d-m.y))<f&&(f=r,g=m);return f=p*(c-(n=l[(h+g.index-1)%h]).x)+u*(d-n.y),p*(c-(m=l[(g.index+1)%h]).x)+u*(d-m.y)<f?(o[0]=g,o[1]=m,o):(o[0]=g,o[1]=n,o)}},function(e,t,i){var s={};e.exports=s;var o=i(16);s.create=function(e,t){var i=e.bodyA,n=e.bodyB,r={id:s.id(i,n),bodyA:i,bodyB:n,collision:e,contacts:[o.create(),o.create()],contactCount:0,separation:0,isActive:!0,isSensor:i.isSensor||n.isSensor,timeCreated:t,timeUpdated:t,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return s.update(r,e,t),r},s.update=function(e,t,i){var s=t.supports,o=t.supportCount,n=e.contacts,r=t.parentA,a=t.parentB;e.isActive=!0,e.timeUpdated=i,e.collision=t,e.separation=t.depth,e.inverseMass=r.inverseMass+a.inverseMass,e.friction=r.friction<a.friction?r.friction:a.friction,e.frictionStatic=r.frictionStatic>a.frictionStatic?r.frictionStatic:a.frictionStatic,e.restitution=r.restitution>a.restitution?r.restitution:a.restitution,e.slop=r.slop>a.slop?r.slop:a.slop,e.contactCount=o,t.pair=e;var l=s[0],h=n[0],c=s[1],d=n[1];d.vertex!==l&&h.vertex!==c||(n[1]=h,n[0]=h=d,d=n[1]),h.vertex=l,d.vertex=c},s.setActive=function(e,t,i){t?(e.isActive=!0,e.timeUpdated=i):(e.isActive=!1,e.contactCount=0)},s.id=function(e,t){return e.id<t.id?e.id.toString(36)+":"+t.id.toString(36):t.id.toString(36)+":"+e.id.toString(36)}},function(e,t,i){var s={};e.exports=s;var o=i(3),n=i(2),r=i(7),a=i(1),l=i(11),h=i(0);s._warming=.4,s._torqueDampen=1,s._minLength=1e-6,s.create=function(e){var t=e;t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var i=t.bodyA?n.add(t.bodyA.position,t.pointA):t.pointA,s=t.bodyB?n.add(t.bodyB.position,t.pointB):t.pointB,o=n.magnitude(n.sub(i,s));t.length=void 0!==t.length?t.length:o,t.id=t.id||h.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||(t.length>0?1:.7),t.damping=t.damping||0,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={};var r={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return 0===t.length&&t.stiffness>.1?(r.type="pin",r.anchors=!1):.9>t.stiffness&&(r.type="spring"),t.render=h.extend(r,t.render),t},s.preSolveAll=function(e){for(var t=0;t<e.length;t+=1){var i=e[t],s=i.constraintImpulse;i.isStatic||0===s.x&&0===s.y&&0===s.angle||(i.position.x+=s.x,i.position.y+=s.y,i.angle+=s.angle)}},s.solveAll=function(e,t){for(var i=h.clamp(t/h._baseDelta,0,1),o=0;o<e.length;o+=1){var n=e[o],r=!n.bodyA||n.bodyA&&n.bodyA.isStatic,a=!n.bodyB||n.bodyB&&n.bodyB.isStatic;(r||a)&&s.solve(e[o],i)}for(o=0;o<e.length;o+=1)r=!(n=e[o]).bodyA||n.bodyA&&n.bodyA.isStatic,a=!n.bodyB||n.bodyB&&n.bodyB.isStatic,r||a||s.solve(e[o],i)},s.solve=function(e,t){var i=e.bodyA,o=e.bodyB,r=e.pointA,a=e.pointB;if(i||o){i&&!i.isStatic&&(n.rotate(r,i.angle-e.angleA,r),e.angleA=i.angle),o&&!o.isStatic&&(n.rotate(a,o.angle-e.angleB,a),e.angleB=o.angle);var l=r,h=a;if(i&&(l=n.add(i.position,r)),o&&(h=n.add(o.position,a)),l&&h){var c=n.sub(l,h),d=n.magnitude(c);d<s._minLength&&(d=s._minLength);var p,u,g,m,f,y=(d-e.length)/d,w=1>e.stiffness&&0!==e.length?e.stiffness*t*t:e.stiffness*t,b=e.damping*t,x=n.mult(c,y*w),v=(i?i.inverseMass:0)+(o?o.inverseMass:0),M=v+((i?i.inverseInertia:0)+(o?o.inverseInertia:0));if(b>0){var C=n.create();g=n.div(c,d),f=n.sub(o&&n.sub(o.position,o.positionPrev)||C,i&&n.sub(i.position,i.positionPrev)||C),m=n.dot(g,f)}i&&!i.isStatic&&(u=i.inverseMass/v,i.constraintImpulse.x-=x.x*u,i.constraintImpulse.y-=x.y*u,i.position.x-=x.x*u,i.position.y-=x.y*u,b>0&&(i.positionPrev.x-=b*g.x*m*u,i.positionPrev.y-=b*g.y*m*u),p=n.cross(r,x)/M*s._torqueDampen*i.inverseInertia*(1-e.angularStiffness),i.constraintImpulse.angle-=p,i.angle-=p),o&&!o.isStatic&&(u=o.inverseMass/v,o.constraintImpulse.x+=x.x*u,o.constraintImpulse.y+=x.y*u,o.position.x+=x.x*u,o.position.y+=x.y*u,b>0&&(o.positionPrev.x+=b*g.x*m*u,o.positionPrev.y+=b*g.y*m*u),p=n.cross(a,x)/M*s._torqueDampen*o.inverseInertia*(1-e.angularStiffness),o.constraintImpulse.angle+=p,o.angle+=p)}}},s.postSolveAll=function(e){for(var t=0;t<e.length;t++){var i=e[t],h=i.constraintImpulse;if(!(i.isStatic||0===h.x&&0===h.y&&0===h.angle)){r.set(i,!1);for(var c=0;c<i.parts.length;c++){var d=i.parts[c];o.translate(d.vertices,h),c>0&&(d.position.x+=h.x,d.position.y+=h.y),0!==h.angle&&(o.rotate(d.vertices,h.angle,i.position),l.rotate(d.axes,h.angle),c>0&&n.rotateAbout(d.position,h.angle,i.position,d.position)),a.update(d.bounds,d.vertices,i.velocity)}h.angle*=s._warming,h.x*=s._warming,h.y*=s._warming}}},s.pointAWorld=function(e){return{x:(e.bodyA?e.bodyA.position.x:0)+(e.pointA?e.pointA.x:0),y:(e.bodyA?e.bodyA.position.y:0)+(e.pointA?e.pointA.y:0)}},s.pointBWorld=function(e){return{x:(e.bodyB?e.bodyB.position.x:0)+(e.pointB?e.pointB.x:0),y:(e.bodyB?e.bodyB.position.y:0)+(e.pointB?e.pointB.y:0)}},s.currentLength=function(e){var t=(e.bodyA?e.bodyA.position.x:0)+(e.pointA?e.pointA.x:0),i=(e.bodyA?e.bodyA.position.y:0)+(e.pointA?e.pointA.y:0),s=t-((e.bodyB?e.bodyB.position.x:0)+(e.pointB?e.pointB.x:0)),o=i-((e.bodyB?e.bodyB.position.y:0)+(e.pointB?e.pointB.y:0));return Math.sqrt(s*s+o*o)}},function(e,t,i){var s={};e.exports=s;var o=i(2),n=i(0);s.fromVertices=function(e){for(var t={},i=0;i<e.length;i++){var s=(i+1)%e.length,r=o.normalise({x:e[s].y-e[i].y,y:e[i].x-e[s].x}),a=0===r.y?1/0:r.x/r.y;t[a=a.toFixed(3).toString()]=r}return n.values(t)},s.rotate=function(e,t){if(0!==t)for(var i=Math.cos(t),s=Math.sin(t),o=0;o<e.length;o++){var n,r=e[o];n=r.x*i-r.y*s,r.y=r.x*s+r.y*i,r.x=n}}},function(e,t,i){var s={};e.exports=s;var o=i(3),n=i(0),r=i(4),a=i(1),l=i(2);s.rectangle=function(e,t,i,s,a){a=a||{};var l={label:"Rectangle Body",position:{x:e,y:t},vertices:o.fromPath("L 0 0 L "+i+" 0 L "+i+" "+s+" L 0 "+s)};if(a.chamfer){var h=a.chamfer;l.vertices=o.chamfer(l.vertices,h.radius,h.quality,h.qualityMin,h.qualityMax),delete a.chamfer}return r.create(n.extend({},l,a))},s.trapezoid=function(e,t,i,s,a,l){l=l||{},a>=1&&n.warn("Bodies.trapezoid: slope parameter must be < 1.");var h,c=i*(a*=.5),d=c+(1-2*a)*i,p=d+c;h=.5>a?"L 0 0 L "+c+" "+-s+" L "+d+" "+-s+" L "+p+" 0":"L 0 0 L "+d+" "+-s+" L "+p+" 0";var u={label:"Trapezoid Body",position:{x:e,y:t},vertices:o.fromPath(h)};if(l.chamfer){var g=l.chamfer;u.vertices=o.chamfer(u.vertices,g.radius,g.quality,g.qualityMin,g.qualityMax),delete l.chamfer}return r.create(n.extend({},u,l))},s.circle=function(e,t,i,o,r){o=o||{};var a={label:"Circle Body",circleRadius:i},l=Math.ceil(Math.max(10,Math.min(r=r||25,i)));return l%2==1&&(l+=1),s.polygon(e,t,l,i,n.extend({},a,o))},s.polygon=function(e,t,i,a,l){if(l=l||{},3>i)return s.circle(e,t,a,l);for(var h=2*Math.PI/i,c="",d=.5*h,p=0;i>p;p+=1){var u=d+p*h,g=Math.cos(u)*a,m=Math.sin(u)*a;c+="L "+g.toFixed(3)+" "+m.toFixed(3)+" "}var f={label:"Polygon Body",position:{x:e,y:t},vertices:o.fromPath(c)};if(l.chamfer){var y=l.chamfer;f.vertices=o.chamfer(f.vertices,y.radius,y.quality,y.qualityMin,y.qualityMax),delete l.chamfer}return r.create(n.extend({},f,l))},s.fromVertices=function(e,t,i,s,h,c,d,p){var u,g,m,f,y,w,b,x,v,M,C=n.getDecomp();for(u=!(!C||!C.quickDecomp),s=s||{},m=[],h=void 0!==h&&h,c=void 0!==c?c:.01,d=void 0!==d?d:10,p=void 0!==p?p:.01,n.isArray(i[0])||(i=[i]),v=0;v<i.length;v+=1)if(y=i[v],!(f=o.isConvex(y))&&!u&&n.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),f||!u)y=f?o.clockwiseSort(y):o.hull(y),m.push({position:{x:e,y:t},vertices:y});else{var _=y.map(function(e){return[e.x,e.y]});C.makeCCW(_),!1!==c&&C.removeCollinearPoints(_,c),!1!==p&&C.removeDuplicatePoints&&C.removeDuplicatePoints(_,p);var P=C.quickDecomp(_);for(w=0;w<P.length;w++){var S=P[w].map(function(e){return{x:e[0],y:e[1]}});d>0&&o.area(S)<d||m.push({position:o.centre(S),vertices:S})}}for(w=0;w<m.length;w++)m[w]=r.create(n.extend(m[w],s));if(h)for(w=0;w<m.length;w++){var T=m[w];for(b=w+1;b<m.length;b++){var k=m[b];if(a.overlaps(T.bounds,k.bounds)){var O=T.vertices,A=k.vertices;for(x=0;x<T.vertices.length;x++)for(M=0;M<k.vertices.length;M++){var D=l.magnitudeSquared(l.sub(O[(x+1)%O.length],A[M])),R=l.magnitudeSquared(l.sub(O[x],A[(M+1)%A.length]));5>D&&5>R&&(O[x].isInternal=!0,A[M].isInternal=!0)}}}}return m.length>1?(g=r.create(n.extend({parts:m.slice(0)},s)),r.setPosition(g,{x:e,y:t}),g):m[0]}},function(e,t,i){var s={};e.exports=s;var o=i(0),n=i(8);s.create=function(e){return o.extend({bodies:[],collisions:[],pairs:null},e)},s.setBodies=function(e,t){e.bodies=t.slice(0)},s.clear=function(e){e.bodies=[],e.collisions=[]},s.collisions=function(e){var t,i,o=e.pairs,r=e.bodies,a=r.length,l=s.canCollide,h=n.collides,c=e.collisions,d=0;for(r.sort(s._compareBoundsX),t=0;a>t;t++){var p=r[t],u=p.bounds,g=p.bounds.max.x,m=p.bounds.max.y,f=p.bounds.min.y,y=p.isStatic||p.isSleeping,w=p.parts.length,b=1===w;for(i=t+1;a>i;i++){var x=r[i];if((k=x.bounds).min.x>g)break;if(m>=k.min.y&&f<=k.max.y&&(!y||!x.isStatic&&!x.isSleeping)&&l(p.collisionFilter,x.collisionFilter)){var v=x.parts.length;if(b&&1===v)(S=h(p,x,o))&&(c[d++]=S);else for(var M=v>1?1:0,C=w>1?1:0;w>C;C++)for(var _=p.parts[C],P=(u=_.bounds,M);v>P;P++){var S,T=x.parts[P],k=T.bounds;u.min.x>k.max.x||u.max.x<k.min.x||u.max.y<k.min.y||u.min.y>k.max.y||(S=h(_,T,o))&&(c[d++]=S)}}}}return c.length!==d&&(c.length=d),c},s.canCollide=function(e,t){return e.group===t.group&&0!==e.group?e.group>0:0!=(e.mask&t.category)&&0!=(t.mask&e.category)},s._compareBoundsX=function(e,t){return e.bounds.min.x-t.bounds.min.x}},function(e,t,i){var s={};e.exports=s;var o=i(0);s.create=function(e){var t={};return e||o.log("Mouse.create: element was undefined, defaulting to document.body","warn"),t.element=e||document.body,t.absolute={x:0,y:0},t.position={x:0,y:0},t.mousedownPosition={x:0,y:0},t.mouseupPosition={x:0,y:0},t.offset={x:0,y:0},t.scale={x:1,y:1},t.wheelDelta=0,t.button=-1,t.pixelRatio=parseInt(t.element.getAttribute("data-pixel-ratio"),10)||1,t.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},t.mousemove=function(e){var i=s._getRelativeMousePosition(e,t.element,t.pixelRatio);e.changedTouches&&(t.button=0,e.preventDefault()),t.absolute.x=i.x,t.absolute.y=i.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.sourceEvents.mousemove=e},t.mousedown=function(e){var i=s._getRelativeMousePosition(e,t.element,t.pixelRatio);e.changedTouches?(t.button=0,e.preventDefault()):t.button=e.button,t.absolute.x=i.x,t.absolute.y=i.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.mousedownPosition.x=t.position.x,t.mousedownPosition.y=t.position.y,t.sourceEvents.mousedown=e},t.mouseup=function(e){var i=s._getRelativeMousePosition(e,t.element,t.pixelRatio);e.changedTouches&&e.preventDefault(),t.button=-1,t.absolute.x=i.x,t.absolute.y=i.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.mouseupPosition.x=t.position.x,t.mouseupPosition.y=t.position.y,t.sourceEvents.mouseup=e},t.mousewheel=function(e){t.wheelDelta=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail)),e.preventDefault(),t.sourceEvents.mousewheel=e},s.setElement(t,t.element),t},s.setElement=function(e,t){e.element=t,t.addEventListener("mousemove",e.mousemove,{passive:!0}),t.addEventListener("mousedown",e.mousedown,{passive:!0}),t.addEventListener("mouseup",e.mouseup,{passive:!0}),t.addEventListener("wheel",e.mousewheel,{passive:!1}),t.addEventListener("touchmove",e.mousemove,{passive:!1}),t.addEventListener("touchstart",e.mousedown,{passive:!1}),t.addEventListener("touchend",e.mouseup,{passive:!1})},s.clearSourceEvents=function(e){e.sourceEvents.mousemove=null,e.sourceEvents.mousedown=null,e.sourceEvents.mouseup=null,e.sourceEvents.mousewheel=null,e.wheelDelta=0},s.setOffset=function(e,t){e.offset.x=t.x,e.offset.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},s.setScale=function(e,t){e.scale.x=t.x,e.scale.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},s._getRelativeMousePosition=function(e,t,i){var s,o,n=t.getBoundingClientRect(),r=document.documentElement||document.body.parentNode||document.body,a=void 0!==window.pageXOffset?window.pageXOffset:r.scrollLeft,l=void 0!==window.pageYOffset?window.pageYOffset:r.scrollTop,h=e.changedTouches;return h?(s=h[0].pageX-n.left-a,o=h[0].pageY-n.top-l):(s=e.pageX-n.left-a,o=e.pageY-n.top-l),{x:s/(t.clientWidth/(t.width||t.clientWidth)*i),y:o/(t.clientHeight/(t.height||t.clientHeight)*i)}}},function(e,t,i){var s={};e.exports=s;var o=i(0);s._registry={},s.register=function(e){if(s.isPlugin(e)||o.warn("Plugin.register:",s.toString(e),"does not implement all required fields."),e.name in s._registry){var t=s._registry[e.name],i=s.versionParse(e.version).number,n=s.versionParse(t.version).number;i>n?(o.warn("Plugin.register:",s.toString(t),"was upgraded to",s.toString(e)),s._registry[e.name]=e):n>i?o.warn("Plugin.register:",s.toString(t),"can not be downgraded to",s.toString(e)):e!==t&&o.warn("Plugin.register:",s.toString(e),"is already registered to different plugin object")}else s._registry[e.name]=e;return e},s.resolve=function(e){return s._registry[s.dependencyParse(e).name]},s.toString=function(e){return"string"==typeof e?e:(e.name||"anonymous")+"@"+(e.version||e.range||"0.0.0")},s.isPlugin=function(e){return e&&e.name&&e.version&&e.install},s.isUsed=function(e,t){return e.used.indexOf(t)>-1},s.isFor=function(e,t){var i=e.for&&s.dependencyParse(e.for);return!e.for||t.name===i.name&&s.versionSatisfies(t.version,i.range)},s.use=function(e,t){if(e.uses=(e.uses||[]).concat(t||[]),0!==e.uses.length){for(var i=s.dependencies(e),n=o.topologicalSort(i),r=[],a=0;a<n.length;a+=1)if(n[a]!==e.name){var l=s.resolve(n[a]);l?s.isUsed(e,l.name)||(s.isFor(l,e)||(o.warn("Plugin.use:",s.toString(l),"is for",l.for,"but installed on",s.toString(e)+"."),l._warned=!0),l.install?l.install(e):(o.warn("Plugin.use:",s.toString(l),"does not specify an install function."),l._warned=!0),l._warned?(r.push("\ud83d\udd36 "+s.toString(l)),delete l._warned):r.push("\u2705 "+s.toString(l)),e.used.push(l.name)):r.push("\u274c "+n[a])}r.length>0&&o.info(r.join("  "))}else o.warn("Plugin.use:",s.toString(e),"does not specify any dependencies to install.")},s.dependencies=function(e,t){var i=s.dependencyParse(e),n=i.name;if(!(n in(t=t||{}))){e=s.resolve(e)||e,t[n]=o.map(e.uses||[],function(t){s.isPlugin(t)&&s.register(t);var n=s.dependencyParse(t),r=s.resolve(t);return r&&!s.versionSatisfies(r.version,n.range)?(o.warn("Plugin.dependencies:",s.toString(r),"does not satisfy",s.toString(n),"used by",s.toString(i)+"."),r._warned=!0,e._warned=!0):r||(o.warn("Plugin.dependencies:",s.toString(t),"used by",s.toString(i),"could not be resolved."),e._warned=!0),n.name});for(var r=0;r<t[n].length;r+=1)s.dependencies(t[n][r],t);return t}},s.dependencyParse=function(e){return o.isString(e)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/.test(e)||o.warn("Plugin.dependencyParse:",e,"is not a valid dependency string."),{name:e.split("@")[0],range:e.split("@")[1]||"*"}):{name:e.name,range:e.range||e.version}},s.versionParse=function(e){var t=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;t.test(e)||o.warn("Plugin.versionParse:",e,"is not a valid version or range.");var i=t.exec(e),s=+i[4],n=+i[5],r=+i[6];return{isRange:!(!i[1]&&!i[2]),version:i[3],range:e,operator:i[1]||i[2]||"",major:s,minor:n,patch:r,parts:[s,n,r],prerelease:i[7],number:1e8*s+1e4*n+r}},s.versionSatisfies=function(e,t){t=t||"*";var i=s.versionParse(t),o=s.versionParse(e);if(i.isRange){if("*"===i.operator||"*"===e)return!0;if(">"===i.operator)return o.number>i.number;if(">="===i.operator)return o.number>=i.number;if("~"===i.operator)return o.major===i.major&&o.minor===i.minor&&o.patch>=i.patch;if("^"===i.operator)return i.major>0?o.major===i.major&&o.number>=i.number:i.minor>0?o.minor===i.minor&&o.patch>=i.patch:o.patch===i.patch}return e===t||"*"===e}},function(e){var t={};e.exports=t,t.create=function(e){return{vertex:e,normalImpulse:0,tangentImpulse:0}}},function(e,t,i){var s={};e.exports=s;var o=i(7),n=i(18),r=i(13),a=i(19),l=i(5),h=i(6),c=i(10),d=i(0),p=i(4);s._deltaMax=1e3/60,s.create=function(e){e=e||{};var t=d.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0,lastUpdatesPerFrame:0}},e);return t.world=e.world||h.create({label:"World"}),t.pairs=e.pairs||a.create(),t.detector=e.detector||r.create(),t.detector.pairs=t.pairs,t.grid={buckets:[]},t.world.gravity=t.gravity,t.broadphase=t.grid,t.metrics={},t},s.update=function(e,t){var i,p=d.now(),u=e.world,g=e.detector,m=e.pairs,f=e.timing,y=f.timestamp;t>s._deltaMax&&d.warnOnce("Matter.Engine.update: delta argument is recommended to be less than or equal to",s._deltaMax.toFixed(3),"ms."),t=void 0!==t?t:d._baseDelta,t*=f.timeScale,f.timestamp+=t,f.lastDelta=t;var w={timestamp:f.timestamp,delta:t};l.trigger(e,"beforeUpdate",w);var b=h.allBodies(u),x=h.allConstraints(u);for(u.isModified&&(r.setBodies(g,b),h.setModified(u,!1,!1,!0)),e.enableSleeping&&o.update(b,t),s._bodiesApplyGravity(b,e.gravity),t>0&&s._bodiesUpdate(b,t),l.trigger(e,"beforeSolve",w),c.preSolveAll(b),i=0;i<e.constraintIterations;i++)c.solveAll(x,t);c.postSolveAll(b);var v=r.collisions(g);a.update(m,v,y),e.enableSleeping&&o.afterCollisions(m.list),m.collisionStart.length>0&&l.trigger(e,"collisionStart",{pairs:m.collisionStart,timestamp:f.timestamp,delta:t});var M=d.clamp(20/e.positionIterations,0,1);for(n.preSolvePosition(m.list),i=0;i<e.positionIterations;i++)n.solvePosition(m.list,t,M);for(n.postSolvePosition(b),c.preSolveAll(b),i=0;i<e.constraintIterations;i++)c.solveAll(x,t);for(c.postSolveAll(b),n.preSolveVelocity(m.list),i=0;i<e.velocityIterations;i++)n.solveVelocity(m.list,t);return s._bodiesUpdateVelocities(b),m.collisionActive.length>0&&l.trigger(e,"collisionActive",{pairs:m.collisionActive,timestamp:f.timestamp,delta:t}),m.collisionEnd.length>0&&l.trigger(e,"collisionEnd",{pairs:m.collisionEnd,timestamp:f.timestamp,delta:t}),s._bodiesClearForces(b),l.trigger(e,"afterUpdate",w),e.timing.lastElapsed=d.now()-p,e},s.merge=function(e,t){if(d.extend(e,t),t.world){e.world=t.world,s.clear(e);for(var i=h.allBodies(e.world),n=0;n<i.length;n++){var r=i[n];o.set(r,!1),r.id=d.nextId()}}},s.clear=function(e){a.clear(e.pairs),r.clear(e.detector)},s._bodiesClearForces=function(e){for(var t=e.length,i=0;t>i;i++){var s=e[i];s.force.x=0,s.force.y=0,s.torque=0}},s._bodiesApplyGravity=function(e,t){var i=void 0!==t.scale?t.scale:.001,s=e.length;if((0!==t.x||0!==t.y)&&0!==i)for(var o=0;s>o;o++){var n=e[o];n.isStatic||n.isSleeping||(n.force.y+=n.mass*t.y*i,n.force.x+=n.mass*t.x*i)}},s._bodiesUpdate=function(e,t){for(var i=e.length,s=0;i>s;s++){var o=e[s];o.isStatic||o.isSleeping||p.update(o,t)}},s._bodiesUpdateVelocities=function(e){for(var t=e.length,i=0;t>i;i++)p.updateVelocities(e[i])}},function(e,t,i){var s={};e.exports=s;var o=i(3),n=i(0),r=i(1);s._restingThresh=2,s._restingThreshTangent=Math.sqrt(6),s._positionDampen=.9,s._positionWarming=.8,s._frictionNormalMultiplier=5,s._frictionMaxStatic=Number.MAX_VALUE,s.preSolvePosition=function(e){var t,i,s,o=e.length;for(t=0;o>t;t++)(i=e[t]).isActive&&(s=i.contactCount,i.collision.parentA.totalContacts+=s,i.collision.parentB.totalContacts+=s)},s.solvePosition=function(e,t,i){var o,r,a,l,h,c,d,p,u=s._positionDampen*(i||1),g=n.clamp(t/n._baseDelta,0,1),m=e.length;for(o=0;m>o;o++)(r=e[o]).isActive&&!r.isSensor&&(l=(a=r.collision).parentA,h=a.parentB,c=a.normal,r.separation=a.depth+c.x*(h.positionImpulse.x-l.positionImpulse.x)+c.y*(h.positionImpulse.y-l.positionImpulse.y));for(o=0;m>o;o++)(r=e[o]).isActive&&!r.isSensor&&(l=(a=r.collision).parentA,h=a.parentB,c=a.normal,p=r.separation-r.slop*g,(l.isStatic||h.isStatic)&&(p*=2),l.isStatic||l.isSleeping||(d=u/l.totalContacts,l.positionImpulse.x+=c.x*p*d,l.positionImpulse.y+=c.y*p*d),h.isStatic||h.isSleeping||(d=u/h.totalContacts,h.positionImpulse.x-=c.x*p*d,h.positionImpulse.y-=c.y*p*d))},s.postSolvePosition=function(e){for(var t=s._positionWarming,i=e.length,n=o.translate,a=r.update,l=0;i>l;l++){var h=e[l],c=h.positionImpulse,d=c.x,p=c.y,u=h.velocity;if(h.totalContacts=0,0!==d||0!==p){for(var g=0;g<h.parts.length;g++){var m=h.parts[g];n(m.vertices,c),a(m.bounds,m.vertices,u),m.position.x+=d,m.position.y+=p}h.positionPrev.x+=d,h.positionPrev.y+=p,0>d*u.x+p*u.y?(c.x=0,c.y=0):(c.x*=t,c.y*=t)}}},s.preSolveVelocity=function(e){var t,i,s=e.length;for(t=0;s>t;t++){var o=e[t];if(o.isActive&&!o.isSensor){var n=o.contacts,r=o.contactCount,a=o.collision,l=a.parentA,h=a.parentB,c=a.normal,d=a.tangent;for(i=0;r>i;i++){var p=n[i],u=p.vertex,g=p.normalImpulse,m=p.tangentImpulse;if(0!==g||0!==m){var f=c.x*g+d.x*m,y=c.y*g+d.y*m;l.isStatic||l.isSleeping||(l.positionPrev.x+=f*l.inverseMass,l.positionPrev.y+=y*l.inverseMass,l.anglePrev+=l.inverseInertia*((u.x-l.position.x)*y-(u.y-l.position.y)*f)),h.isStatic||h.isSleeping||(h.positionPrev.x-=f*h.inverseMass,h.positionPrev.y-=y*h.inverseMass,h.anglePrev-=h.inverseInertia*((u.x-h.position.x)*y-(u.y-h.position.y)*f))}}}}},s.solveVelocity=function(e,t){var i,o,r,a,l=t/n._baseDelta,h=l*l*l,c=-s._restingThresh*l,d=s._restingThreshTangent,p=s._frictionNormalMultiplier*l,u=s._frictionMaxStatic,g=e.length;for(r=0;g>r;r++){var m=e[r];if(m.isActive&&!m.isSensor){var f=m.collision,y=f.parentA,w=f.parentB,b=f.normal.x,x=f.normal.y,v=f.tangent.x,M=f.tangent.y,C=m.inverseMass,_=m.friction*m.frictionStatic*p,P=m.contacts,S=m.contactCount,T=1/S,k=y.position.x-y.positionPrev.x,O=y.position.y-y.positionPrev.y,A=y.angle-y.anglePrev,D=w.position.x-w.positionPrev.x,R=w.position.y-w.positionPrev.y,B=w.angle-w.anglePrev;for(a=0;S>a;a++){var j=P[a],I=j.vertex,E=I.x-y.position.x,z=I.y-y.position.y,F=I.x-w.position.x,V=I.y-w.position.y,L=k-z*A-(D-V*B),W=O+E*A-(R+F*B),G=b*L+x*W,H=v*L+M*W,N=m.separation+G,q=Math.min(N,1),U=(q=0>N?0:q)*_;-U>H||H>U?(o=H>0?H:-H,(i=m.friction*(H>0?1:-1)*h)<-o?i=-o:i>o&&(i=o)):(i=H,o=u);var $=E*x-z*b,X=F*x-V*b,Y=T/(C+y.inverseInertia*$*$+w.inverseInertia*X*X),J=(1+m.restitution)*G*Y;if(i*=Y,c>G)j.normalImpulse=0;else{var K=j.normalImpulse;j.normalImpulse+=J,j.normalImpulse>0&&(j.normalImpulse=0),J=j.normalImpulse-K}if(-d>H||H>d)j.tangentImpulse=0;else{var Z=j.tangentImpulse;j.tangentImpulse+=i,j.tangentImpulse<-o&&(j.tangentImpulse=-o),j.tangentImpulse>o&&(j.tangentImpulse=o),i=j.tangentImpulse-Z}var Q=b*J+v*i,ee=x*J+M*i;y.isStatic||y.isSleeping||(y.positionPrev.x+=Q*y.inverseMass,y.positionPrev.y+=ee*y.inverseMass,y.anglePrev+=(E*ee-z*Q)*y.inverseInertia),w.isStatic||w.isSleeping||(w.positionPrev.x-=Q*w.inverseMass,w.positionPrev.y-=ee*w.inverseMass,w.anglePrev-=(F*ee-V*Q)*w.inverseInertia)}}}}},function(e,t,i){var s={};e.exports=s;var o=i(9),n=i(0);s.create=function(e){return n.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},e)},s.update=function(e,t,i){var s,n,r,a=o.update,l=o.create,h=o.setActive,c=e.table,d=e.list,p=d.length,u=p,g=e.collisionStart,m=e.collisionEnd,f=e.collisionActive,y=t.length,w=0,b=0,x=0;for(r=0;y>r;r++)(n=(s=t[r]).pair)?(n.isActive&&(f[x++]=n),a(n,s,i)):(c[(n=l(s,i)).id]=n,g[w++]=n,d[u++]=n);for(u=0,p=d.length,r=0;p>r;r++)(n=d[r]).timeUpdated<i?(h(n,!1,i),n.collision.bodyA.sleepCounter>0&&n.collision.bodyB.sleepCounter>0?d[u++]=n:(m[b++]=n,delete c[n.id])):d[u++]=n;d.length!==u&&(d.length=u),g.length!==w&&(g.length=w),m.length!==b&&(m.length=b),f.length!==x&&(f.length=x)},s.clear=function(e){return e.table={},e.list.length=0,e.collisionStart.length=0,e.collisionActive.length=0,e.collisionEnd.length=0,e}},function(e,t,i){var s=e.exports=i(21);s.Axes=i(11),s.Bodies=i(12),s.Body=i(4),s.Bounds=i(1),s.Collision=i(8),s.Common=i(0),s.Composite=i(6),s.Composites=i(22),s.Constraint=i(10),s.Contact=i(16),s.Detector=i(13),s.Engine=i(17),s.Events=i(5),s.Grid=i(23),s.Mouse=i(14),s.MouseConstraint=i(24),s.Pair=i(9),s.Pairs=i(19),s.Plugin=i(15),s.Query=i(25),s.Render=i(26),s.Resolver=i(18),s.Runner=i(27),s.SAT=i(28),s.Sleeping=i(7),s.Svg=i(29),s.Vector=i(2),s.Vertices=i(3),s.World=i(30),s.Engine.run=s.Runner.run,s.Common.deprecated(s.Engine,"run","Engine.run \u27a4 use Matter.Runner.run(engine) instead")},function(e,t,i){var s={};e.exports=s;var o=i(15),n=i(0);s.name="matter-js",s.version="0.20.0",s.uses=[],s.used=[],s.use=function(){o.use(s,[].slice.call(arguments))},s.before=function(e,t){return e=e.replace(/^Matter./,""),n.chainPathBefore(s,e,t)},s.after=function(e,t){return e=e.replace(/^Matter./,""),n.chainPathAfter(s,e,t)}},function(e,t,i){var s={};e.exports=s;var o=i(6),n=i(10),r=i(0),a=i(4),l=i(12),h=r.deprecated;s.stack=function(e,t,i,s,n,r,l){for(var h,c=o.create({label:"Stack"}),d=e,p=t,u=0,g=0;s>g;g++){for(var m=0,f=0;i>f;f++){var y=l(d,p,f,g,h,u);if(y){var w=y.bounds.max.y-y.bounds.min.y,b=y.bounds.max.x-y.bounds.min.x;w>m&&(m=w),a.translate(y,{x:.5*b,y:.5*w}),d=y.bounds.max.x+n,o.addBody(c,y),h=y,u+=1}else d+=n}p+=m+r,d=e}return c},s.chain=function(e,t,i,s,a,l){for(var h=e.bodies,c=1;c<h.length;c++){var d=h[c-1],p=h[c],u=d.bounds.max.y-d.bounds.min.y,g=d.bounds.max.x-d.bounds.min.x,m=p.bounds.max.y-p.bounds.min.y,f={bodyA:d,pointA:{x:g*t,y:u*i},bodyB:p,pointB:{x:(p.bounds.max.x-p.bounds.min.x)*s,y:m*a}},y=r.extend(f,l);o.addConstraint(e,n.create(y))}return e.label+=" Chain",e},s.mesh=function(e,t,i,s,a){var l,h,c,d,p,u=e.bodies;for(l=0;i>l;l++){for(h=1;t>h;h++)c=u[h-1+l*t],d=u[h+l*t],o.addConstraint(e,n.create(r.extend({bodyA:c,bodyB:d},a)));if(l>0)for(h=0;t>h;h++)c=u[h+(l-1)*t],d=u[h+l*t],o.addConstraint(e,n.create(r.extend({bodyA:c,bodyB:d},a))),s&&h>0&&(p=u[h-1+(l-1)*t],o.addConstraint(e,n.create(r.extend({bodyA:p,bodyB:d},a)))),s&&t-1>h&&(p=u[h+1+(l-1)*t],o.addConstraint(e,n.create(r.extend({bodyA:p,bodyB:d},a))))}return e.label+=" Mesh",e},s.pyramid=function(e,t,i,o,n,r,l){return s.stack(e,t,i,o,n,r,function(t,s,r,h,c,d){var p=Math.min(o,Math.ceil(i/2)),u=c?c.bounds.max.x-c.bounds.min.x:0;if(!(h>p||r<(h=p-h)||r>i-1-h))return 1===d&&a.translate(c,{x:(r+(i%2==1?1:-1))*u,y:0}),l(e+(c?r*u:0)+r*n,s,r,h,c,d)})},s.newtonsCradle=function(e,t,i,s,r){for(var a=o.create({label:"Newtons Cradle"}),h=0;i>h;h++){var c=l.circle(e+1.9*h*s,t+r,s,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),d=n.create({pointA:{x:e+1.9*h*s,y:t},bodyB:c});o.addBody(a,c),o.addConstraint(a,d)}return a},h(s,"newtonsCradle","Composites.newtonsCradle \u27a4 moved to newtonsCradle example"),s.car=function(e,t,i,s,r){var h=a.nextGroup(!0),c=.5*-i+20,d=.5*i-20,p=o.create({label:"Car"}),u=l.rectangle(e,t,i,s,{collisionFilter:{group:h},chamfer:{radius:.5*s},density:2e-4}),g=l.circle(e+c,t+0,r,{collisionFilter:{group:h},friction:.8}),m=l.circle(e+d,t+0,r,{collisionFilter:{group:h},friction:.8}),f=n.create({bodyB:u,pointB:{x:c,y:0},bodyA:g,stiffness:1,length:0}),y=n.create({bodyB:u,pointB:{x:d,y:0},bodyA:m,stiffness:1,length:0});return o.addBody(p,u),o.addBody(p,g),o.addBody(p,m),o.addConstraint(p,f),o.addConstraint(p,y),p},h(s,"car","Composites.car \u27a4 moved to car example"),s.softBody=function(e,t,i,o,n,a,h,c,d,p){d=r.extend({inertia:1/0},d),p=r.extend({stiffness:.2,render:{type:"line",anchors:!1}},p);var u=s.stack(e,t,i,o,n,a,function(e,t){return l.circle(e,t,c,d)});return s.mesh(u,i,o,h,p),u.label="Soft Body",u},h(s,"softBody","Composites.softBody \u27a4 moved to softBody and cloth examples")},function(e,t,i){var s={};e.exports=s;var o=i(9),n=i(0),r=n.deprecated;s.create=function(e){return n.extend({buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48},e)},s.update=function(e,t,i,o){var n,r,a,l,h,c=i.world,d=e.buckets,p=!1;for(n=0;n<t.length;n++){var u=t[n];if((!u.isSleeping||o)&&(!c.bounds||!(u.bounds.max.x<c.bounds.min.x||u.bounds.min.x>c.bounds.max.x||u.bounds.max.y<c.bounds.min.y||u.bounds.min.y>c.bounds.max.y))){var g=s._getRegion(e,u);if(!u.region||g.id!==u.region.id||o){u.region&&!o||(u.region=g);var m=s._regionUnion(g,u.region);for(r=m.startCol;r<=m.endCol;r++)for(a=m.startRow;a<=m.endRow;a++){l=d[h=s._getBucketId(r,a)];var f=!(r<g.startCol||r>g.endCol||a<g.startRow||a>g.endRow),y=!(r<u.region.startCol||r>u.region.endCol||a<u.region.startRow||a>u.region.endRow);!f&&y&&y&&l&&s._bucketRemoveBody(e,l,u),(u.region===g||f&&!y||o)&&(l||(l=s._createBucket(d,h)),s._bucketAddBody(e,l,u))}u.region=g,p=!0}}}p&&(e.pairsList=s._createActivePairsList(e))},r(s,"update","Grid.update \u27a4 replaced by Matter.Detector"),s.clear=function(e){e.buckets={},e.pairs={},e.pairsList=[]},r(s,"clear","Grid.clear \u27a4 replaced by Matter.Detector"),s._regionUnion=function(e,t){var i=Math.min(e.startCol,t.startCol),o=Math.max(e.endCol,t.endCol),n=Math.min(e.startRow,t.startRow),r=Math.max(e.endRow,t.endRow);return s._createRegion(i,o,n,r)},s._getRegion=function(e,t){var i=t.bounds,o=Math.floor(i.min.x/e.bucketWidth),n=Math.floor(i.max.x/e.bucketWidth),r=Math.floor(i.min.y/e.bucketHeight),a=Math.floor(i.max.y/e.bucketHeight);return s._createRegion(o,n,r,a)},s._createRegion=function(e,t,i,s){return{id:e+","+t+","+i+","+s,startCol:e,endCol:t,startRow:i,endRow:s}},s._getBucketId=function(e,t){return"C"+e+"R"+t},s._createBucket=function(e,t){return e[t]=[]},s._bucketAddBody=function(e,t,i){var s,n=e.pairs,r=o.id,a=t.length;for(s=0;a>s;s++){var l=t[s];if(!(i.id===l.id||i.isStatic&&l.isStatic)){var h=r(i,l),c=n[h];c?c[2]+=1:n[h]=[i,l,1]}}t.push(i)},s._bucketRemoveBody=function(e,t,i){var s,r=e.pairs,a=o.id;t.splice(n.indexOf(t,i),1);var l=t.length;for(s=0;l>s;s++){var h=r[a(i,t[s])];h&&(h[2]-=1)}},s._createActivePairsList=function(e){var t,i,s=e.pairs,o=n.keys(s),r=o.length,a=[];for(i=0;r>i;i++)(t=s[o[i]])[2]>0?a.push(t):delete s[o[i]];return a}},function(e,t,i){var s={};e.exports=s;var o=i(3),n=i(7),r=i(14),a=i(5),l=i(13),h=i(10),c=i(6),d=i(0),p=i(1);s.create=function(e,t){var i=(e?e.mouse:null)||(t?t.mouse:null);i||(e&&e.render&&e.render.canvas?i=r.create(e.render.canvas):t&&t.element?i=r.create(t.element):(i=r.create(),d.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var o={type:"mouseConstraint",mouse:i,element:null,body:null,constraint:h.create({label:"Mouse Constraint",pointA:i.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),collisionFilter:{category:1,mask:4294967295,group:0}},n=d.extend(o,t);return a.on(e,"beforeUpdate",function(){var t=c.allBodies(e.world);s.update(n,t),s._triggerEvents(n)}),n},s.update=function(e,t){var i=e.mouse,s=e.constraint,r=e.body;if(0===i.button){if(s.bodyB)n.set(s.bodyB,!1),s.pointA=i.position;else for(var h=0;h<t.length;h++)if(r=t[h],p.contains(r.bounds,i.position)&&l.canCollide(r.collisionFilter,e.collisionFilter))for(var c=r.parts.length>1?1:0;c<r.parts.length;c++){var d=r.parts[c];if(o.contains(d.vertices,i.position)){s.pointA=i.position,s.bodyB=e.body=r,s.pointB={x:i.position.x-r.position.x,y:i.position.y-r.position.y},s.angleB=r.angle,n.set(r,!1),a.trigger(e,"startdrag",{mouse:i,body:r});break}}}else s.bodyB=e.body=null,s.pointB=null,r&&a.trigger(e,"enddrag",{mouse:i,body:r})},s._triggerEvents=function(e){var t=e.mouse,i=t.sourceEvents;i.mousemove&&a.trigger(e,"mousemove",{mouse:t}),i.mousedown&&a.trigger(e,"mousedown",{mouse:t}),i.mouseup&&a.trigger(e,"mouseup",{mouse:t}),r.clearSourceEvents(t)}},function(e,t,i){var s={};e.exports=s;var o=i(2),n=i(8),r=i(1),a=i(12),l=i(3);s.collides=function(e,t){for(var i=[],s=t.length,o=e.bounds,a=n.collides,l=r.overlaps,h=0;s>h;h++){var c=t[h],d=c.parts.length,p=1===d?0:1;if(l(c.bounds,o))for(var u=p;d>u;u++){var g=c.parts[u];if(l(g.bounds,o)){var m=a(g,e);if(m){i.push(m);break}}}}return i},s.ray=function(e,t,i,n){n=n||1e-100;for(var r=o.angle(t,i),l=o.magnitude(o.sub(t,i)),h=.5*(i.x+t.x),c=.5*(i.y+t.y),d=a.rectangle(h,c,l,n,{angle:r}),p=s.collides(d,e),u=0;u<p.length;u+=1){var g=p[u];g.body=g.bodyB=g.bodyA}return p},s.region=function(e,t,i){for(var s=[],o=0;o<e.length;o++){var n=e[o],a=r.overlaps(n.bounds,t);(a&&!i||!a&&i)&&s.push(n)}return s},s.point=function(e,t){for(var i=[],s=0;s<e.length;s++){var o=e[s];if(r.contains(o.bounds,t))for(var n=1===o.parts.length?0:1;n<o.parts.length;n++){var a=o.parts[n];if(r.contains(a.bounds,t)&&l.contains(a.vertices,t)){i.push(o);break}}}return i}},function(e,t,i){var s={};e.exports=s;var o=i(4),n=i(0),r=i(6),a=i(1),l=i(5),h=i(2),c=i(14);!function(){var e,t;"undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(n.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),s._goodFps=30,s._goodDelta=1e3/60,s.create=function(e){var t={engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],engineUpdatesHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",wireframeStrokeStyle:"#bbb",hasBounds:!!e.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},i=n.extend(t,e);return i.canvas&&(i.canvas.width=i.options.width||i.canvas.width,i.canvas.height=i.options.height||i.canvas.height),i.mouse=e.mouse,i.engine=e.engine,i.canvas=i.canvas||p(i.options.width,i.options.height),i.context=i.canvas.getContext("2d"),i.textures={},i.bounds=i.bounds||{min:{x:0,y:0},max:{x:i.canvas.width,y:i.canvas.height}},i.controller=s,i.options.showBroadphase=!1,1!==i.options.pixelRatio&&s.setPixelRatio(i,i.options.pixelRatio),n.isElement(i.element)&&i.element.appendChild(i.canvas),i},s.run=function(t){!function o(n){t.frameRequestId=e(o),i(t,n),s.world(t,n),t.context.setTransform(t.options.pixelRatio,0,0,t.options.pixelRatio,0,0),(t.options.showStats||t.options.showDebug)&&s.stats(t,t.context,n),(t.options.showPerformance||t.options.showDebug)&&s.performance(t,t.context,n),t.context.setTransform(1,0,0,1,0,0)}()},s.stop=function(e){t(e.frameRequestId)},s.setPixelRatio=function(e,t){var i=e.options,s=e.canvas;"auto"===t&&(t=u(s)),i.pixelRatio=t,s.setAttribute("data-pixel-ratio",t),s.width=i.width*t,s.height=i.height*t,s.style.width=i.width+"px",s.style.height=i.height+"px"},s.setSize=function(e,t,i){e.options.width=t,e.options.height=i,e.bounds.max.x=e.bounds.min.x+t,e.bounds.max.y=e.bounds.min.y+i,1!==e.options.pixelRatio?s.setPixelRatio(e,e.options.pixelRatio):(e.canvas.width=t,e.canvas.height=i)},s.lookAt=function(e,t,i,s){s=void 0===s||s,t=n.isArray(t)?t:[t],i=i||{x:0,y:0};for(var o={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},r=0;r<t.length;r+=1){var a=t[r],l=a.bounds?a.bounds.min:a.min||a.position||a,h=a.bounds?a.bounds.max:a.max||a.position||a;l&&h&&(l.x<o.min.x&&(o.min.x=l.x),h.x>o.max.x&&(o.max.x=h.x),l.y<o.min.y&&(o.min.y=l.y),h.y>o.max.y&&(o.max.y=h.y))}var d=o.max.x-o.min.x+2*i.x,p=o.max.y-o.min.y+2*i.y,u=e.canvas.height,g=e.canvas.width/u,m=d/p,f=1,y=1;m>g?y=m/g:f=g/m,e.options.hasBounds=!0,e.bounds.min.x=o.min.x,e.bounds.max.x=o.min.x+d*f,e.bounds.min.y=o.min.y,e.bounds.max.y=o.min.y+p*y,s&&(e.bounds.min.x+=.5*d-d*f*.5,e.bounds.max.x+=.5*d-d*f*.5,e.bounds.min.y+=.5*p-p*y*.5,e.bounds.max.y+=.5*p-p*y*.5),e.bounds.min.x-=i.x,e.bounds.max.x-=i.x,e.bounds.min.y-=i.y,e.bounds.max.y-=i.y,e.mouse&&(c.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),c.setOffset(e.mouse,e.bounds.min))},s.startViewTransform=function(e){var t=e.bounds.max.x-e.bounds.min.x,i=e.bounds.max.y-e.bounds.min.y,s=t/e.options.width,o=i/e.options.height;e.context.setTransform(e.options.pixelRatio/s,0,0,e.options.pixelRatio/o,0,0),e.context.translate(-e.bounds.min.x,-e.bounds.min.y)},s.endViewTransform=function(e){e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0)},s.world=function(e){var t,i=n.now(),o=e.engine,d=o.world,p=e.canvas,u=e.context,g=e.options,f=e.timing,y=r.allBodies(d),w=r.allConstraints(d),b=g.wireframes?g.wireframeBackground:g.background,x=[],v=[],M={timestamp:o.timing.timestamp};if(l.trigger(e,"beforeRender",M),e.currentBackground!==b&&m(e,b),u.globalCompositeOperation="source-in",u.fillStyle="transparent",u.fillRect(0,0,p.width,p.height),u.globalCompositeOperation="source-over",g.hasBounds){for(t=0;t<y.length;t++){var C=y[t];a.overlaps(C.bounds,e.bounds)&&x.push(C)}for(t=0;t<w.length;t++){var _=w[t],P=_.bodyA,S=_.bodyB,T=_.pointA,k=_.pointB;P&&(T=h.add(P.position,_.pointA)),S&&(k=h.add(S.position,_.pointB)),T&&k&&(a.contains(e.bounds,T)||a.contains(e.bounds,k))&&v.push(_)}s.startViewTransform(e),e.mouse&&(c.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.options.width,y:(e.bounds.max.y-e.bounds.min.y)/e.options.height}),c.setOffset(e.mouse,e.bounds.min))}else v=w,x=y,1!==e.options.pixelRatio&&e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0);!g.wireframes||o.enableSleeping&&g.showSleeping?s.bodies(e,x,u):(g.showConvexHulls&&s.bodyConvexHulls(e,x,u),s.bodyWireframes(e,x,u)),g.showBounds&&s.bodyBounds(e,x,u),(g.showAxes||g.showAngleIndicator)&&s.bodyAxes(e,x,u),g.showPositions&&s.bodyPositions(e,x,u),g.showVelocity&&s.bodyVelocity(e,x,u),g.showIds&&s.bodyIds(e,x,u),g.showSeparations&&s.separations(e,o.pairs.list,u),g.showCollisions&&s.collisions(e,o.pairs.list,u),g.showVertexNumbers&&s.vertexNumbers(e,x,u),g.showMousePosition&&s.mousePosition(e,e.mouse,u),s.constraints(v,u),g.hasBounds&&s.endViewTransform(e),l.trigger(e,"afterRender",M),f.lastElapsed=n.now()-i},s.stats=function(e,t){for(var i=e.engine,s=i.world,o=r.allBodies(s),n=0,a=0,l=0;l<o.length;l+=1)n+=o[l].parts.length;var h={Part:n,Body:o.length,Cons:r.allConstraints(s).length,Comp:r.allComposites(s).length,Pair:i.pairs.list.length};for(var c in t.fillStyle="#0e0f19",t.fillRect(a,0,302.5,44),t.font="12px Arial",t.textBaseline="top",t.textAlign="right",h){var d=h[c];t.fillStyle="#aaa",t.fillText(c,a+55,8),t.fillStyle="#eee",t.fillText(d,a+55,26),a+=55}},s.performance=function(e,t){var i=e.engine,o=e.timing,r=o.deltaHistory,a=o.elapsedHistory,l=o.timestampElapsedHistory,h=o.engineDeltaHistory,c=o.engineUpdatesHistory,p=o.engineElapsedHistory,u=i.timing.lastUpdatesPerFrame,g=i.timing.lastDelta,m=d(r),f=d(a),y=d(h),w=d(c),b=d(p),x=d(l)/m||0,v=Math.round(m/g),M=1e3/m||0,C=69;t.fillStyle="#0e0f19",t.fillRect(0,50,442,34),s.status(t,10,C,60,4,r.length,Math.round(M)+" fps",M/s._goodFps,function(e){return r[e]/m-1}),s.status(t,82,C,60,4,h.length,g.toFixed(2)+" dt",s._goodDelta/g,function(e){return h[e]/y-1}),s.status(t,154,C,60,4,c.length,u+" upf",Math.pow(n.clamp(w/v||1,0,1),4),function(e){return c[e]/w-1}),s.status(t,226,C,60,4,p.length,b.toFixed(2)+" ut",1-u*b/s._goodFps,function(e){return p[e]/b-1}),s.status(t,298,C,60,4,a.length,f.toFixed(2)+" rt",1-f/s._goodFps,function(e){return a[e]/f-1}),s.status(t,370,C,60,4,l.length,x.toFixed(2)+" x",x*x*x,function(e){return(l[e]/r[e]/x||0)-1})},s.status=function(e,t,i,s,o,r,a,l,h){e.strokeStyle="#888",e.fillStyle="#444",e.lineWidth=1,e.fillRect(t,i+7,s,1),e.beginPath(),e.moveTo(t,i+7-o*n.clamp(.4*h(0),-2,2));for(var c=0;s>c;c+=1)e.lineTo(t+c,i+7-(r>c?o*n.clamp(.4*h(c),-2,2):0));e.stroke(),e.fillStyle="hsl("+n.clamp(25+95*l,0,120)+",100%,60%)",e.fillRect(t,i-7,4,4),e.font="12px Arial",e.textBaseline="middle",e.textAlign="right",e.fillStyle="#eee",e.fillText(a,t+s,i-5)},s.constraints=function(e,t){for(var i=t,s=0;s<e.length;s++){var o=e[s];if(o.render.visible&&o.pointA&&o.pointB){var r,a,l=o.bodyA,c=o.bodyB;if(r=l?h.add(l.position,o.pointA):o.pointA,"pin"===o.render.type)i.beginPath(),i.arc(r.x,r.y,3,0,2*Math.PI),i.closePath();else{if(a=c?h.add(c.position,o.pointB):o.pointB,i.beginPath(),i.moveTo(r.x,r.y),"spring"===o.render.type)for(var d,p=h.sub(a,r),u=h.perp(h.normalise(p)),g=Math.ceil(n.clamp(o.length/5,12,20)),m=1;g>m;m+=1)d=m%2==0?1:-1,i.lineTo(r.x+p.x*(m/g)+u.x*d*4,r.y+p.y*(m/g)+u.y*d*4);i.lineTo(a.x,a.y)}o.render.lineWidth&&(i.lineWidth=o.render.lineWidth,i.strokeStyle=o.render.strokeStyle,i.stroke()),o.render.anchors&&(i.fillStyle=o.render.strokeStyle,i.beginPath(),i.arc(r.x,r.y,3,0,2*Math.PI),i.arc(a.x,a.y,3,0,2*Math.PI),i.closePath(),i.fill())}}},s.bodies=function(e,t,i){var s,o,n,r,a=i,l=(e.engine,e.options),h=l.showInternalEdges||!l.wireframes;for(n=0;n<t.length;n++)if((s=t[n]).render.visible)for(r=s.parts.length>1?1:0;r<s.parts.length;r++)if((o=s.parts[r]).render.visible){if(l.showSleeping&&s.isSleeping?a.globalAlpha=.5*o.render.opacity:1!==o.render.opacity&&(a.globalAlpha=o.render.opacity),o.render.sprite&&o.render.sprite.texture&&!l.wireframes){var c=o.render.sprite,d=g(e,c.texture);a.translate(o.position.x,o.position.y),a.rotate(o.angle),a.drawImage(d,d.width*-c.xOffset*c.xScale,d.height*-c.yOffset*c.yScale,d.width*c.xScale,d.height*c.yScale),a.rotate(-o.angle),a.translate(-o.position.x,-o.position.y)}else{if(o.circleRadius)a.beginPath(),a.arc(o.position.x,o.position.y,o.circleRadius,0,2*Math.PI);else{a.beginPath(),a.moveTo(o.vertices[0].x,o.vertices[0].y);for(var p=1;p<o.vertices.length;p++)!o.vertices[p-1].isInternal||h?a.lineTo(o.vertices[p].x,o.vertices[p].y):a.moveTo(o.vertices[p].x,o.vertices[p].y),o.vertices[p].isInternal&&!h&&a.moveTo(o.vertices[(p+1)%o.vertices.length].x,o.vertices[(p+1)%o.vertices.length].y);a.lineTo(o.vertices[0].x,o.vertices[0].y),a.closePath()}l.wireframes?(a.lineWidth=1,a.strokeStyle=e.options.wireframeStrokeStyle,a.stroke()):(a.fillStyle=o.render.fillStyle,o.render.lineWidth&&(a.lineWidth=o.render.lineWidth,a.strokeStyle=o.render.strokeStyle,a.stroke()),a.fill())}a.globalAlpha=1}},s.bodyWireframes=function(e,t,i){var s,o,n,r,a,l=i,h=e.options.showInternalEdges;for(l.beginPath(),n=0;n<t.length;n++)if((s=t[n]).render.visible)for(a=s.parts.length>1?1:0;a<s.parts.length;a++){for(o=s.parts[a],l.moveTo(o.vertices[0].x,o.vertices[0].y),r=1;r<o.vertices.length;r++)!o.vertices[r-1].isInternal||h?l.lineTo(o.vertices[r].x,o.vertices[r].y):l.moveTo(o.vertices[r].x,o.vertices[r].y),o.vertices[r].isInternal&&!h&&l.moveTo(o.vertices[(r+1)%o.vertices.length].x,o.vertices[(r+1)%o.vertices.length].y);l.lineTo(o.vertices[0].x,o.vertices[0].y)}l.lineWidth=1,l.strokeStyle=e.options.wireframeStrokeStyle,l.stroke()},s.bodyConvexHulls=function(e,t,i){var s,o,n,r=i;for(r.beginPath(),o=0;o<t.length;o++)if((s=t[o]).render.visible&&1!==s.parts.length){for(r.moveTo(s.vertices[0].x,s.vertices[0].y),n=1;n<s.vertices.length;n++)r.lineTo(s.vertices[n].x,s.vertices[n].y);r.lineTo(s.vertices[0].x,s.vertices[0].y)}r.lineWidth=1,r.strokeStyle="rgba(255,255,255,0.2)",r.stroke()},s.vertexNumbers=function(e,t,i){var s,o,n,r=i;for(s=0;s<t.length;s++){var a=t[s].parts;for(n=a.length>1?1:0;n<a.length;n++){var l=a[n];for(o=0;o<l.vertices.length;o++)r.fillStyle="rgba(255,255,255,0.2)",r.fillText(s+"_"+o,l.position.x+.8*(l.vertices[o].x-l.position.x),l.position.y+.8*(l.vertices[o].y-l.position.y))}}},s.mousePosition=function(e,t,i){var s=i;s.fillStyle="rgba(255,255,255,0.8)",s.fillText(t.position.x+"  "+t.position.y,t.position.x+5,t.position.y-5)},s.bodyBounds=function(e,t,i){var s=i,o=(e.engine,e.options);s.beginPath();for(var n=0;n<t.length;n++)if(t[n].render.visible)for(var r=t[n].parts,a=r.length>1?1:0;a<r.length;a++){var l=r[a];s.rect(l.bounds.min.x,l.bounds.min.y,l.bounds.max.x-l.bounds.min.x,l.bounds.max.y-l.bounds.min.y)}o.wireframes?s.strokeStyle="rgba(255,255,255,0.08)":s.strokeStyle="rgba(0,0,0,0.1)",s.lineWidth=1,s.stroke()},s.bodyAxes=function(e,t,i){var s,o,n,r,a=i,l=(e.engine,e.options);for(a.beginPath(),o=0;o<t.length;o++){var h=t[o],c=h.parts;if(h.render.visible)if(l.showAxes)for(n=c.length>1?1:0;n<c.length;n++)for(s=c[n],r=0;r<s.axes.length;r++){var d=s.axes[r];a.moveTo(s.position.x,s.position.y),a.lineTo(s.position.x+20*d.x,s.position.y+20*d.y)}else for(n=c.length>1?1:0;n<c.length;n++)for(s=c[n],r=0;r<s.axes.length;r++)a.moveTo(s.position.x,s.position.y),a.lineTo((s.vertices[0].x+s.vertices[s.vertices.length-1].x)/2,(s.vertices[0].y+s.vertices[s.vertices.length-1].y)/2)}l.wireframes?(a.strokeStyle="indianred",a.lineWidth=1):(a.strokeStyle="rgba(255, 255, 255, 0.4)",a.globalCompositeOperation="overlay",a.lineWidth=2),a.stroke(),a.globalCompositeOperation="source-over"},s.bodyPositions=function(e,t,i){var s,o,n,r,a=i,l=(e.engine,e.options);for(a.beginPath(),n=0;n<t.length;n++)if((s=t[n]).render.visible)for(r=0;r<s.parts.length;r++)o=s.parts[r],a.arc(o.position.x,o.position.y,3,0,2*Math.PI,!1),a.closePath();for(l.wireframes?a.fillStyle="indianred":a.fillStyle="rgba(0,0,0,0.5)",a.fill(),a.beginPath(),n=0;n<t.length;n++)(s=t[n]).render.visible&&(a.arc(s.positionPrev.x,s.positionPrev.y,2,0,2*Math.PI,!1),a.closePath());a.fillStyle="rgba(255,165,0,0.8)",a.fill()},s.bodyVelocity=function(e,t,i){var s=i;s.beginPath();for(var n=0;n<t.length;n++){var r=t[n];if(r.render.visible){var a=o.getVelocity(r);s.moveTo(r.position.x,r.position.y),s.lineTo(r.position.x+a.x,r.position.y+a.y)}}s.lineWidth=3,s.strokeStyle="cornflowerblue",s.stroke()},s.bodyIds=function(e,t,i){var s,o,n=i;for(s=0;s<t.length;s++)if(t[s].render.visible){var r=t[s].parts;for(o=r.length>1?1:0;o<r.length;o++){var a=r[o];n.font="12px Arial",n.fillStyle="rgba(255,255,255,0.5)",n.fillText(a.id,a.position.x+10,a.position.y-10)}}},s.collisions=function(e,t,i){var s,o,n,r,a=i,l=e.options;for(a.beginPath(),n=0;n<t.length;n++)if((s=t[n]).isActive)for(o=s.collision,r=0;r<s.contactCount;r++){var h=s.contacts[r].vertex;a.rect(h.x-1.5,h.y-1.5,3.5,3.5)}for(l.wireframes?a.fillStyle="rgba(255,255,255,0.7)":a.fillStyle="orange",a.fill(),a.beginPath(),n=0;n<t.length;n++)if((s=t[n]).isActive&&(o=s.collision,s.contactCount>0)){var c=s.contacts[0].vertex.x,d=s.contacts[0].vertex.y;2===s.contactCount&&(c=(s.contacts[0].vertex.x+s.contacts[1].vertex.x)/2,d=(s.contacts[0].vertex.y+s.contacts[1].vertex.y)/2),o.bodyB===o.supports[0].body||!0===o.bodyA.isStatic?a.moveTo(c-8*o.normal.x,d-8*o.normal.y):a.moveTo(c+8*o.normal.x,d+8*o.normal.y),a.lineTo(c,d)}l.wireframes?a.strokeStyle="rgba(255,165,0,0.7)":a.strokeStyle="orange",a.lineWidth=1,a.stroke()},s.separations=function(e,t,i){var s,o,n,r,a,l=i,h=e.options;for(l.beginPath(),a=0;a<t.length;a++)if((s=t[a]).isActive){n=(o=s.collision).bodyA;var c=1;(r=o.bodyB).isStatic||n.isStatic||(c=.5),r.isStatic&&(c=0),l.moveTo(r.position.x,r.position.y),l.lineTo(r.position.x-o.penetration.x*c,r.position.y-o.penetration.y*c),c=1,r.isStatic||n.isStatic||(c=.5),n.isStatic&&(c=0),l.moveTo(n.position.x,n.position.y),l.lineTo(n.position.x+o.penetration.x*c,n.position.y+o.penetration.y*c)}h.wireframes?l.strokeStyle="rgba(255,165,0,0.5)":l.strokeStyle="orange",l.stroke()},s.inspector=function(e,t){e.engine;var i,s=e.selected,o=e.render,n=o.options;if(n.hasBounds){var r=o.bounds.max.x-o.bounds.min.x,a=o.bounds.max.y-o.bounds.min.y,l=r/o.options.width,h=a/o.options.height;t.scale(1/l,1/h),t.translate(-o.bounds.min.x,-o.bounds.min.y)}for(var c=0;c<s.length;c++){var d=s[c].data;switch(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.9)",t.setLineDash([1,2]),d.type){case"body":i=d.bounds,t.beginPath(),t.rect(Math.floor(i.min.x-3),Math.floor(i.min.y-3),Math.floor(i.max.x-i.min.x+6),Math.floor(i.max.y-i.min.y+6)),t.closePath(),t.stroke();break;case"constraint":var p=d.pointA;d.bodyA&&(p=d.pointB),t.beginPath(),t.arc(p.x,p.y,10,0,2*Math.PI),t.closePath(),t.stroke()}t.setLineDash([]),t.translate(-.5,-.5)}null!==e.selectStart&&(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.6)",t.fillStyle="rgba(255,165,0,0.1)",i=e.selectBounds,t.beginPath(),t.rect(Math.floor(i.min.x),Math.floor(i.min.y),Math.floor(i.max.x-i.min.x),Math.floor(i.max.y-i.min.y)),t.closePath(),t.stroke(),t.fill(),t.translate(-.5,-.5)),n.hasBounds&&t.setTransform(1,0,0,1,0,0)};var i=function(e,t){var i=e.engine,o=e.timing,n=o.historySize,r=i.timing.timestamp;o.delta=t-o.lastTime||s._goodDelta,o.lastTime=t,o.timestampElapsed=r-o.lastTimestamp||0,o.lastTimestamp=r,o.deltaHistory.unshift(o.delta),o.deltaHistory.length=Math.min(o.deltaHistory.length,n),o.engineDeltaHistory.unshift(i.timing.lastDelta),o.engineDeltaHistory.length=Math.min(o.engineDeltaHistory.length,n),o.timestampElapsedHistory.unshift(o.timestampElapsed),o.timestampElapsedHistory.length=Math.min(o.timestampElapsedHistory.length,n),o.engineUpdatesHistory.unshift(i.timing.lastUpdatesPerFrame),o.engineUpdatesHistory.length=Math.min(o.engineUpdatesHistory.length,n),o.engineElapsedHistory.unshift(i.timing.lastElapsed),o.engineElapsedHistory.length=Math.min(o.engineElapsedHistory.length,n),o.elapsedHistory.unshift(o.lastElapsed),o.elapsedHistory.length=Math.min(o.elapsedHistory.length,n)},d=function(e){for(var t=0,i=0;i<e.length;i+=1)t+=e[i];return t/e.length||0},p=function(e,t){var i=document.createElement("canvas");return i.width=e,i.height=t,i.oncontextmenu=function(){return!1},i.onselectstart=function(){return!1},i},u=function(e){var t=e.getContext("2d");return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)},g=function(e,t){var i=e.textures[t];return i||((i=e.textures[t]=new Image).src=t,i)},m=function(e,t){var i=t;/(jpg|gif|png)$/.test(t)&&(i="url("+t+")"),e.canvas.style.background=i,e.canvas.style.backgroundSize="contain",e.currentBackground=t}}()},function(e,t,i){var s={};e.exports=s;var o=i(5),n=i(17),r=i(0);!function(){s._maxFrameDelta=1e3/15,s._frameDeltaFallback=1e3/60,s._timeBufferMargin=1.5,s._elapsedNextEstimate=1,s._smoothingLowerBound=.1,s._smoothingUpperBound=.9,s.create=function(e){var t=r.extend({delta:1e3/60,frameDelta:null,frameDeltaSmoothing:!0,frameDeltaSnapping:!0,frameDeltaHistory:[],frameDeltaHistorySize:100,frameRequestId:null,timeBuffer:0,timeLastTick:null,maxUpdates:null,maxFrameTime:1e3/30,lastUpdatesDeferred:0,enabled:!0},e);return t.fps=0,t},s.run=function(e,t){return e.timeBuffer=s._frameDeltaFallback,function i(o){e.frameRequestId=s._onNextFrame(e,i),o&&e.enabled&&s.tick(e,t,o)}(),e},s.tick=function(t,i,a){var l=r.now(),h=t.delta,c=0,d=a-t.timeLastTick;if((!d||!t.timeLastTick||d>Math.max(s._maxFrameDelta,t.maxFrameTime))&&(d=t.frameDelta||s._frameDeltaFallback),t.frameDeltaSmoothing){t.frameDeltaHistory.push(d),t.frameDeltaHistory=t.frameDeltaHistory.slice(-t.frameDeltaHistorySize);var p=t.frameDeltaHistory.slice(0).sort(),u=t.frameDeltaHistory.slice(p.length*s._smoothingLowerBound,p.length*s._smoothingUpperBound);d=e(u)||d}t.frameDeltaSnapping&&(d=1e3/Math.round(1e3/d)),t.frameDelta=d,t.timeLastTick=a,t.timeBuffer+=t.frameDelta,t.timeBuffer=r.clamp(t.timeBuffer,0,t.frameDelta+h*s._timeBufferMargin),t.lastUpdatesDeferred=0;var g=t.maxUpdates||Math.ceil(t.maxFrameTime/h),m={timestamp:i.timing.timestamp};o.trigger(t,"beforeTick",m),o.trigger(t,"tick",m);for(var f=r.now();h>0&&t.timeBuffer>=h*s._timeBufferMargin;){o.trigger(t,"beforeUpdate",m),n.update(i,h),o.trigger(t,"afterUpdate",m),t.timeBuffer-=h,c+=1;var y=r.now()-l,w=r.now()-f,b=y+s._elapsedNextEstimate*w/c;if(c>=g||b>t.maxFrameTime){t.lastUpdatesDeferred=Math.round(Math.max(0,t.timeBuffer/h-s._timeBufferMargin));break}}i.timing.lastUpdatesPerFrame=c,o.trigger(t,"afterTick",m),t.frameDeltaHistory.length>=100&&(t.lastUpdatesDeferred&&Math.round(t.frameDelta/h)>g?r.warnOnce("Matter.Runner: runner reached runner.maxUpdates, see docs."):t.lastUpdatesDeferred&&r.warnOnce("Matter.Runner: runner reached runner.maxFrameTime, see docs."),void 0!==t.isFixed&&r.warnOnce("Matter.Runner: runner.isFixed is now redundant, see docs."),(t.deltaMin||t.deltaMax)&&r.warnOnce("Matter.Runner: runner.deltaMin and runner.deltaMax were removed, see docs."),0!==t.fps&&r.warnOnce("Matter.Runner: runner.fps was replaced by runner.delta, see docs."))},s.stop=function(e){s._cancelNextFrame(e)},s._onNextFrame=function(e,t){if("undefined"==typeof window||!window.requestAnimationFrame)throw Error("Matter.Runner: missing required global window.requestAnimationFrame.");return e.frameRequestId=window.requestAnimationFrame(t),e.frameRequestId},s._cancelNextFrame=function(e){if("undefined"==typeof window||!window.cancelAnimationFrame)throw Error("Matter.Runner: missing required global window.cancelAnimationFrame.");window.cancelAnimationFrame(e.frameRequestId)};var e=function(e){for(var t=0,i=e.length,s=0;i>s;s+=1)t+=e[s];return t/i||0}}()},function(e,t,i){var s={};e.exports=s;var o=i(8),n=i(0).deprecated;s.collides=function(e,t){return o.collides(e,t)},n(s,"collides","SAT.collides \u27a4 replaced by Collision.collides")},function(e,t,i){var s={};e.exports=s,i(1);var o=i(0);s.pathToVertices=function(e,t){"undefined"==typeof window||"SVGPathSeg"in window||o.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var i,n,r,a,l,h,c,d,p,u,g,m=[],f=0,y=0,w=0;t=t||15;var b=function(e,t,i){var s=i%2==1&&i>1;if(!p||e!=p.x||t!=p.y){p&&s?(u=p.x,g=p.y):(u=0,g=0);var o={x:u+e,y:g+t};!s&&p||(p=o),m.push(o),y=u+e,w=g+t}},x=function(e){var t=e.pathSegTypeAsLetter.toUpperCase();if("Z"!==t){switch(t){case"M":case"L":case"T":case"C":case"S":case"Q":y=e.x,w=e.y;break;case"H":y=e.x;break;case"V":w=e.y}b(y,w,e.pathSegType)}};for(s._svgPathToAbsolute(e),r=e.getTotalLength(),h=[],i=0;i<e.pathSegList.numberOfItems;i+=1)h.push(e.pathSegList.getItem(i));for(c=h.concat();r>f;){if((l=h[e.getPathSegAtLength(f)])!=d){for(;c.length&&c[0]!=l;)x(c.shift());d=l}switch(l.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":a=e.getPointAtLength(f),b(a.x,a.y,0)}f+=t}for(i=0,n=c.length;n>i;++i)x(c[i]);return m},s._svgPathToAbsolute=function(e){for(var t,i,s,o,n,r,a=e.pathSegList,l=0,h=0,c=a.numberOfItems,d=0;c>d;++d){var p=a.getItem(d),u=p.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(u))"x"in p&&(l=p.x),"y"in p&&(h=p.y);else switch("x1"in p&&(s=l+p.x1),"x2"in p&&(n=l+p.x2),"y1"in p&&(o=h+p.y1),"y2"in p&&(r=h+p.y2),"x"in p&&(l+=p.x),"y"in p&&(h+=p.y),u){case"m":a.replaceItem(e.createSVGPathSegMovetoAbs(l,h),d);break;case"l":a.replaceItem(e.createSVGPathSegLinetoAbs(l,h),d);break;case"h":a.replaceItem(e.createSVGPathSegLinetoHorizontalAbs(l),d);break;case"v":a.replaceItem(e.createSVGPathSegLinetoVerticalAbs(h),d);break;case"c":a.replaceItem(e.createSVGPathSegCurvetoCubicAbs(l,h,s,o,n,r),d);break;case"s":a.replaceItem(e.createSVGPathSegCurvetoCubicSmoothAbs(l,h,n,r),d);break;case"q":a.replaceItem(e.createSVGPathSegCurvetoQuadraticAbs(l,h,s,o),d);break;case"t":a.replaceItem(e.createSVGPathSegCurvetoQuadraticSmoothAbs(l,h),d);break;case"a":a.replaceItem(e.createSVGPathSegArcAbs(l,h,p.r1,p.r2,p.angle,p.largeArcFlag,p.sweepFlag),d);break;case"z":case"Z":l=t,h=i}"M"!=u&&"m"!=u||(t=l,i=h)}}},function(e,t,i){var s={};e.exports=s;var o=i(6);i(0),s.create=o.create,s.add=o.add,s.remove=o.remove,s.clear=o.clear,s.addComposite=o.addComposite,s.addBody=o.addBody,s.addConstraint=o.addConstraint}])});class PhysicsManager{constructor(){this.engine=Matter.Engine.create({enableSleeping:!0}),this.world=this.engine.world,this.world.gravity.y=0,this.gravity={x:0,y:1},this.bodies=new Map,this.gameObjectBodies=new Map,this.debugDraw=!1,this.wireframes=!0,this.fixedTimeStep=1e3/60,this.timeAccumulator=0,Matter.Events.on(this.engine,"collisionStart",e=>{e.pairs.forEach(e=>{[e.bodyA,e.bodyB].forEach(e=>{e.ignoreGravity&&e.isSleeping&&Matter.Sleeping.set(e,!1)})})}),console.log("Physics manager initialized")}setGravity(e,t){this.world.gravity.x=e,this.world.gravity.y=t}update(e){this.timeAccumulator+=1e3*e;let t=0;for(;this.timeAccumulator>=this.fixedTimeStep&&5>t;){Matter.Engine.update(this.engine,this.fixedTimeStep);const e=this.gravity;this.bodies.forEach((t,i)=>{if(!i.isStatic&&!i.ignoreGravity){const t={x:i.mass*e.x*.001,y:i.mass*e.y*.001};Matter.Body.applyForce(i,i.position,t)}}),this.timeAccumulator-=this.fixedTimeStep,t++}5===t&&(this.timeAccumulator=0),this.syncPhysicsBodies()}syncPhysicsBodies(){this.bodies&&0!==this.bodies.size&&this.bodies.forEach((e,t)=>{e&&t&&(t.plugin&&t.plugin.isCollider||(t.isStatic?e.rigidbody&&e.rigidbody.bodyNeedsUpdate&&(Matter.Body.setPosition(t,e.position),Matter.Body.setAngle(t,e.angle*(Math.PI/180)),e.rigidbody.bodyNeedsUpdate=!1):(e.position.x=t.position.x,e.position.y=t.position.y,e.angle=t.angle*(180/Math.PI))))})}registerBody(e,t){if(e&&t){this.bodies||(this.bodies=new Map),this.gameObjectBodies||(this.gameObjectBodies=new Map);try{this.bodies.set(e,t),this.gameObjectBodies.set(t,e),e.isStatic&&Matter.Body.setStatic(e,!0),this.engine&&this.engine.world&&!this.engine.world.bodies.includes(e)&&Matter.Composite.add(this.engine.world,e),e.isStatic&&Matter.Body.setStatic(e,!0)}catch(e){console.error("Error in PhysicsManager.registerBody:",e)}}else console.warn("PhysicsManager.registerBody: Missing body or gameObject")}removeBody(e){e&&(Matter.Composite.remove(this.world,e),this.bodies.delete(e))}drawDebug(e){if(!this.debugDraw)return;e.save();const t=window.engine?.viewport;let i=0,s=0;t&&(t.width,t.height,i=0,s=0);const o=Matter.Composite.allBodies(this.world);e.beginPath();for(let t=0;t<o.length;t++){const n=o[t],r=n.vertices,a=this.bodies.get(n),l=a&&a.isTerrainRigidbody,h=l?i:0,c=l?s:0;e.moveTo(r[0].x+h,r[0].y+c);for(let t=1;t<r.length;t++)e.lineTo(r[t].x+h,r[t].y+c);e.lineTo(r[0].x+h,r[0].y+c)}e.lineWidth=1,e.strokeStyle="#22ff22",e.stroke();const n=Matter.Composite.allConstraints(this.world);e.beginPath();for(let t=0;t<n.length;t++){const o=n[t];if(!o.render.visible)continue;const r=o.bodyA,a=o.bodyB,l=o.pointA,h=o.pointB;let c,d,p,u;if(r){const e=this.bodies.get(r),t=e&&e.isTerrainRigidbody,o=t?i:0,n=t?s:0;c=r.position.x+l.x+o,d=r.position.y+l.y+n}else c=l.x,d=l.y;if(a){const e=this.bodies.get(a),t=e&&e.isTerrainRigidbody,o=t?i:0,n=t?s:0;p=a.position.x+h.x+o,u=a.position.y+h.y+n}else p=h.x,u=h.y;e.moveTo(c,d),e.lineTo(p,u)}e.lineWidth=1,e.strokeStyle="#ff8822",e.stroke(),e.restore()}reset(){const e=new Map;this.bodies.forEach(t=>{e.set(t.id,{gameObject:t,originalPosition:t.getOriginalPosition?t.getOriginalPosition():t.position.clone(),originalRotation:t.originalRotation||0})}),Matter.Composite.clear(this.world),this.bodies.clear(),e.forEach(e=>{e.gameObject.position=e.originalPosition,e.gameObject.angle=e.originalRotation})}}class AudioEngine{constructor(){this.audioContext=null,this.masterGain=null,this.compressor=null,this.limiter=null,this.reverb=null,this.eq={low:null,mid:null,high:null},this.isPlaying=!1,this.currentTime=0,this.bpm=120,this.samples=new Map,this.activeBlocks=new Map,this.scheduleTime=0,this.lookAhead=25,this.scheduleAheadTime=.1,this.nextNoteTime=0,this.timerID=null,this.activeSources=new Set,this.initializeAudio(),this.loadBuiltInSamples()}async initializeAudio(){try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.setupMasterChain(),console.log("Audio engine initialized successfully")}catch(e){console.error("Failed to initialize audio context:",e)}}setupMasterChain(){this.masterGain=this.audioContext.createGain(),this.masterGain.gain.value=.5,this.eq.low=this.audioContext.createBiquadFilter(),this.eq.low.type="lowshelf",this.eq.low.frequency.value=320,this.eq.low.gain.value=0,this.eq.mid=this.audioContext.createBiquadFilter(),this.eq.mid.type="peaking",this.eq.mid.frequency.value=1e3,this.eq.mid.Q.value=1,this.eq.mid.gain.value=0,this.eq.high=this.audioContext.createBiquadFilter(),this.eq.high.type="highshelf",this.eq.high.frequency.value=3200,this.eq.high.gain.value=0,this.compressor=this.audioContext.createDynamicsCompressor(),this.compressor.threshold.value=-20,this.compressor.knee.value=40,this.compressor.ratio.value=12,this.compressor.attack.value=.003,this.compressor.release.value=.25,this.limiter=this.audioContext.createDynamicsCompressor(),this.limiter.threshold.value=-3,this.limiter.knee.value=0,this.limiter.ratio.value=20,this.limiter.attack.value=.001,this.limiter.release.value=.01,this.createReverb(),this.eq.low.connect(this.eq.mid),this.eq.mid.connect(this.eq.high),this.eq.high.connect(this.compressor),this.compressor.connect(this.limiter),this.limiter.connect(this.reverb),this.reverb.connect(this.masterGain),this.masterGain.connect(this.audioContext.destination)}async createReverb(){const e=this.audioContext.sampleRate,t=2*e,i=this.audioContext.createBuffer(2,t,e);for(let e=0;2>e;e++){const s=i.getChannelData(e);for(let e=0;t>e;e++){const i=Math.pow(1-e/t,2);s[e]=(2*Math.random()-1)*i}}this.reverb=this.audioContext.createConvolver(),this.reverb.buffer=i,this.reverbGain=this.audioContext.createGain(),this.reverbGain.gain.value=.2,this.dryGain=this.audioContext.createGain(),this.dryGain.gain.value=.8,this.reverb.disconnect(),this.reverb=this.audioContext.createGain()}async loadBuiltInSamples(){const e={kick:await this.generateKick(),snare:await this.generateSnare(),hihat:await this.generateHiHat(),hihat_open:await this.generateOpenHiHat(),crash:await this.generateCrash(),ride:await this.generateRide(),tom_high:await this.generateTom(200),tom_mid:await this.generateTom(150),tom_low:await this.generateTom(100),clap:await this.generateClap(),bass_low:await this.generateBass(55),bass_mid:await this.generateBass(110),bass_high:await this.generateBass(220),sub_bass:await this.generateSubBass(41),bass_pluck:await this.generateBassPluck(82),lead_1:await this.generateLead(440),lead_2:await this.generateLead2(440),lead_bright:await this.generateBrightLead(880),lead_soft:await this.generateSoftLead(440),pad_1:await this.generatePad(220),pad_warm:await this.generateWarmPad(220),pad_strings:await this.generateStringPad(330),pad_choir:await this.generateChoirPad(440),shaker:await this.generateShaker(),tambourine:await this.generateTambourine(),cowbell:await this.generateCowbell(),woodblock:await this.generateWoodblock(),triangle:await this.generateWoodblock(),whoosh:await this.generateWhoosh(),zap:await this.generateZap(),drop:await this.generateDrop(),rise:await this.generateRise()};for(const[t,i]of Object.entries(e))this.samples.set(t,i)}getBuiltInSampleNames(){return["kick","snare","hihat","hihat_open","crash","ride","tom_high","tom_mid","tom_low","clap","triangle","bass_low","bass_mid","bass_high","sub_bass","bass_pluck","lead_1","lead_2","lead_bright","lead_soft","pad_1","pad_warm","pad_strings","pad_choir","shaker","tambourine","cowbell","woodblock","whoosh","zap","drop","rise"]}async generateOpenHiHat(){const e=this.audioContext.sampleRate,t=.3*e,i=this.audioContext.createBuffer(1,t,e),s=i.getChannelData(0);for(let i=0;t>i;i++){const t=Math.exp(-i/e*8),o=2*Math.random()-1,n=i>0?o-.7*s[i-1]:o;s[i]=n*t*.5}return i}async generateCrash(){const e=this.audioContext.sampleRate,t=2*e,i=this.audioContext.createBuffer(1,t,e),s=i.getChannelData(0);for(let i=0;t>i;i++){const t=i/e,o=Math.exp(2*-t),n=2*Math.random()-1,r=.3*Math.sin(6e3*Math.PI*t*Math.random());s[i]=(n+r)*o*.6}return i}async generateRide(){const e=this.audioContext.sampleRate,t=1.5*e,i=this.audioContext.createBuffer(1,t,e),s=i.getChannelData(0);for(let i=0;t>i;i++){const t=i/e,o=Math.exp(1.5*-t),n=.4*Math.sin(4e3*Math.PI*t),r=.3*(2*Math.random()-1);s[i]=(n+r)*o*.5}return i}async generateTom(e){const t=this.audioContext.sampleRate,i=.8*t,s=this.audioContext.createBuffer(1,i,t),o=s.getChannelData(0);for(let s=0;i>s;s++){const i=s/t,n=Math.exp(8*-i),r=Math.sin(2*Math.PI*e*Math.exp(3*-i)*i),a=.1*(2*Math.random()-1);o[s]=(r+a)*n*.7}return s}async generateClap(){const e=this.audioContext.sampleRate,t=.2*e,i=this.audioContext.createBuffer(1,t,e),s=i.getChannelData(0);for(let i=0;t>i;i++){const t=i/e,o=(.01>t?1:0)+(t>=.02&&.03>t?.8:0)+(t>=.04&&.05>t?.6:0),n=2*Math.random()-1;s[i]=n*o*.6}return i}async generateSubBass(e){const t=this.audioContext.sampleRate,i=1.5*t,s=this.audioContext.createBuffer(1,i,t),o=s.getChannelData(0);for(let s=0;i>s;s++){const i=s/t,n=Math.exp(1.5*-i),r=Math.sin(2*Math.PI*e*i),a=.5*Math.sin(2*Math.PI*e*.5*i);o[s]=(r+a)*n*.8}return s}async generateBassPluck(e){const t=this.audioContext.sampleRate,i=.6*t,s=this.audioContext.createBuffer(1,i,t),o=s.getChannelData(0);for(let s=0;i>s;s++){const i=s/t,n=Math.exp(8*-i),r=e*i%1*2-1,a=1-2*i;o[s]=r*n*a*.6}return s}async generateLead2(e){const t=this.audioContext.sampleRate,i=.8*t,s=this.audioContext.createBuffer(1,i,t),o=s.getChannelData(0);for(let s=0;i>s;s++){const i=s/t,n=Math.exp(2*-i),r=Math.sign(Math.sin(2*Math.PI*e*i)),a=Math.sign(Math.sin(2*Math.PI*e*i*(1+.3*Math.sin(10*i))));o[s]=(.6*r+.4*a)*n*.4}return s}async generateBrightLead(e){const t=this.audioContext.sampleRate,i=.6*t,s=this.audioContext.createBuffer(1,i,t),o=s.getChannelData(0);for(let s=0;i>s;s++){const i=s/t,n=Math.exp(4*-i),r=e*i%1*2-1,a=.3*Math.sin(2*Math.PI*e*3*i);o[s]=(r+a)*n*.5}return s}async generateSoftLead(e){const t=this.audioContext.sampleRate,i=1*t,s=this.audioContext.createBuffer(1,i,t),o=s.getChannelData(0);for(let s=0;i>s;s++){const i=s/t,n=Math.exp(1.5*-i),r=Math.sin(2*Math.PI*e*i),a=.1*Math.sin(10*Math.PI*i);o[s]=r*(1+a)*n*.4}return s}async generateWarmPad(e){const t=this.audioContext.sampleRate,i=3*t,s=this.audioContext.createBuffer(1,i,t),o=s.getChannelData(0);for(let s=0;i>s;s++){const i=s/t,n=1-Math.exp(3*-i),r=Math.sin(2*Math.PI*e*i),a=.3*Math.sin(2*Math.PI*e*1.25*i),l=.2*Math.sin(2*Math.PI*e*1.5*i);o[s]=(r+a+l)*n*.25}return s}async generateStringPad(e){const t=this.audioContext.sampleRate,i=2.5*t,s=this.audioContext.createBuffer(1,i,t),o=s.getChannelData(0);for(let s=0;i>s;s++){const i=s/t,n=1-Math.exp(4*-i),r=e*i%1*2-1,a=Math.exp(.5*-i);o[s]=r*n*a*.3}return s}async generateChoirPad(e){const t=this.audioContext.sampleRate,i=3*t,s=this.audioContext.createBuffer(1,i,t),o=s.getChannelData(0);for(let s=0;i>s;s++){const i=s/t,n=1-Math.exp(2*-i),r=Math.sin(2*Math.PI*e*i),a=.8*Math.sin(2*Math.PI*e*1.02*i),l=.8*Math.sin(2*Math.PI*e*.98*i),h=.2*Math.sin(2*Math.PI*e*2.5*i);o[s]=(r+a+l+h)*n*.2}return s}async generateShaker(){const e=this.audioContext.sampleRate,t=.15*e,i=this.audioContext.createBuffer(1,t,e),s=i.getChannelData(0);for(let i=0;t>i;i++){const t=Math.exp(-i/e*20),o=2*Math.random()-1,n=i>0?o-.5*s[i-1]:o;s[i]=n*t*.3}return i}async generateTambourine(){const e=this.audioContext.sampleRate,t=.4*e,i=this.audioContext.createBuffer(1,t,e),s=i.getChannelData(0);for(let i=0;t>i;i++){const t=i/e,o=Math.exp(10*-t),n=.5*Math.sin(4e3*Math.PI*t*(1+Math.sin(50*t))),r=.3*(2*Math.random()-1);s[i]=(n+r)*o*.4}return i}async generateCowbell(){const e=this.audioContext.sampleRate,t=.3*e,i=this.audioContext.createBuffer(1,t,e),s=i.getChannelData(0);for(let i=0;t>i;i++){const t=i/e,o=Math.exp(15*-t),n=Math.sin(1600*Math.PI*t),r=.7*Math.sin(1800*Math.PI*t);s[i]=(n+r)*o*.5}return i}async generateWoodblock(){const e=this.audioContext.sampleRate,t=.1*e,i=this.audioContext.createBuffer(1,t,e),s=i.getChannelData(0);for(let i=0;t>i;i++){const t=i/e,o=Math.exp(50*-t),n=Math.sin(3e3*Math.PI*t),r=.3*Math.sin(600*Math.PI*t);s[i]=(n+r)*o*.6}return i}async generateWhoosh(){const e=this.audioContext.sampleRate,t=1*e,i=this.audioContext.createBuffer(1,t,e),s=i.getChannelData(0);for(let i=0;t>i;i++){const t=i/e,o=Math.sin(Math.PI*t/1),n=2*Math.random()-1,r=1-t;s[i]=n*o*r*.4}return i}async generateZap(){const e=this.audioContext.sampleRate,t=.2*e,i=this.audioContext.createBuffer(1,t,e),s=i.getChannelData(0);for(let i=0;t>i;i++){const t=i/e,o=Math.exp(10*-t),n=Math.sin(4e3*Math.PI*Math.exp(5*-t)*t),r=.2*(2*Math.random()-1);s[i]=(n+r)*o*.5}return i}async generateDrop(){const e=this.audioContext.sampleRate,t=.8*e,i=this.audioContext.createBuffer(1,t,e),s=i.getChannelData(0);for(let i=0;t>i;i++){const t=i/e,o=1-t/.8,n=Math.sin(1600*Math.PI*Math.exp(3*-t)*t);s[i]=n*o*.6}return i}async generateRise(){const e=this.audioContext.sampleRate,t=1.5*e,i=this.audioContext.createBuffer(1,t,e),s=i.getChannelData(0);for(let i=0;t>i;i++){const t=i/e,o=t/1.5,n=Math.sin(200*Math.PI*Math.exp(2*t)*t),r=.1*(2*Math.random()-1);s[i]=(n+r)*o*.4}return i}async generateKick(){const e=this.audioContext.sampleRate,t=Math.floor(.4*e),i=this.audioContext.createBuffer(1,t,e),s=i.getChannelData(0);for(let i=0;t>i;i++){const t=i/e,o=110*Math.pow(.2,t/.18),n=Math.exp(12*-t),r=Math.sin(2*Math.PI*o*t)*n,a=Math.exp(30*-t),l=Math.sin(360*Math.PI*t)*a*.18,h=Math.exp(400*-t),c=Math.sin(4e3*Math.PI*t)*h*.08;s[i]=.98*(r+l+c)}return i}async generateSnare(){const e=this.audioContext.sampleRate,t=.3*e,i=this.audioContext.createBuffer(1,t,e),s=i.getChannelData(0);for(let i=0;t>i;i++){const t=i/e,o=Math.exp(15*-t),n=.3*Math.sin(400*Math.PI*t),r=.7*(2*Math.random()-1);s[i]=(n+r)*o*.6}return i}async generateHiHat(){const e=this.audioContext.sampleRate,t=.1*e,i=this.audioContext.createBuffer(1,t,e),s=i.getChannelData(0);for(let i=0;t>i;i++){const t=Math.exp(-i/e*40),o=2*Math.random()-1,n=i>0?o-.9*s[i-1]:o;s[i]=n*t*.4}return i}async generateBass(e){const t=this.audioContext.sampleRate,i=1*t,s=this.audioContext.createBuffer(1,i,t),o=s.getChannelData(0);for(let s=0;i>s;s++){const i=s/t,n=Math.exp(2*-i),r=Math.sin(2*Math.PI*e*i),a=.3*Math.sin(2*Math.PI*e*2*i),l=.2*Math.sin(2*Math.PI*e*.5*i);o[s]=(r+a+l)*n*.7}return s}async generateLead(e){const t=this.audioContext.sampleRate,i=.8*t,s=this.audioContext.createBuffer(1,i,t),o=s.getChannelData(0);for(let s=0;i>s;s++){const i=s/t,n=Math.exp(3*-i),r=e*i%1*2-1,a=Math.sign(Math.sin(2*Math.PI*e*i));o[s]=(.6*r+.4*a)*n*.5}return s}async generatePad(e){const t=this.audioContext.sampleRate,i=2*t,s=this.audioContext.createBuffer(1,i,t),o=s.getChannelData(0);for(let s=0;i>s;s++){const i=s/t,n=1-Math.exp(5*-i),r=Math.sin(2*Math.PI*e*i),a=.4*Math.sin(2*Math.PI*e*1.5*i),l=.3*Math.sin(2*Math.PI*e*2*i);o[s]=(r+a+l)*n*.3}return s}playSample(e,t=1,i=1,s=0,o=1,n=0,r=null){if(!this.samples.has(e))return void console.warn(`Sample '${e}' not found`);const a=this.samples.get(e),l=this.audioContext.createBufferSource(),h=this.audioContext.createGain(),c=this.audioContext.createStereoPanner();l.buffer=a,l.playbackRate.value=t*i,c.pan.value=Math.max(-1,Math.min(1,n)),l.connect(h),h.connect(c),c.connect(r||this.eq.low),l.gainNode=h;const d=this.audioContext.currentTime+s,p=a.duration/(t*i),u=Math.min(.002,.02*p);h.gain.setValueAtTime(0,d),h.gain.linearRampToValueAtTime(o,d+u);const g=d+p-u;return g>d+u&&(h.gain.setValueAtTime(o,g),h.gain.linearRampToValueAtTime(0,d+p)),l.start(d),this.activeSources.add(l),l.addEventListener("ended",()=>{this.activeSources.delete(l)}),l}generateTone(e,t=1,i="sine",s=0,o=1,n=0,r=null){e&&!isNaN(e)&&e>0||(console.warn(`Invalid frequency: ${e}, using 440 Hz`),e=440),t&&!isNaN(t)&&t>0||(console.warn(`Invalid duration: ${t}, using 1 second`),t=1),(!o||isNaN(o)||0>o)&&(o=.5);const a=this.audioContext.createOscillator(),l=this.audioContext.createGain(),h=this.audioContext.createStereoPanner();a.type=i,a.frequency.value=e,h.pan.value=Math.max(-1,Math.min(1,n)),a.connect(l),l.connect(h),h.connect(r||this.eq.low);const c=this.audioContext.currentTime+s,d=c+t,p=Math.min(.003,.05*t);return l.gain.setValueAtTime(0,c),l.gain.linearRampToValueAtTime(o,c+p),l.gain.setValueAtTime(o,d-p),l.gain.linearRampToValueAtTime(0,d),this.activeSources.add(a),a.addEventListener("ended",()=>{this.activeSources.delete(a)}),a.start(c),a.stop(d),a}noteToFrequency(e){const t=e.toUpperCase().match(/^([A-G][#B]?)(\d+)$/);if(!t)return console.warn(`Invalid note format: ${e}, defaulting to A4`),440;const i=t[1],s=parseInt(t[2]);if(isNaN(s)||0>s||s>10)return console.warn(`Invalid octave: ${s}, defaulting to A4`),440;const o={C:0,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11}[i];if(void 0===o)return console.warn(`Invalid note name: ${i}, defaulting to A4`),440;const n=440*Math.pow(2,(12*(s+1)+o-69)/12);return isNaN(n)||0>=n||n>2e4?(console.warn(`Invalid frequency calculated: ${n}, defaulting to A4`),440):n}setMasterVolume(e){this.masterGain&&(this.masterGain.gain.value=e/100)}setEQ(e,t){this.eq[e]&&(this.eq[e].gain.value=t)}setCompressor(e){this.compressor&&(this.compressor.threshold.value=e)}setLimiter(e){this.limiter&&(this.limiter.threshold.value=e)}setReverb(e){this.reverbGain&&(this.reverbGain.gain.value=e/100,this.dryGain.gain.value=(100-e)/100)}async loadAudioFile(e){try{const t=await e.arrayBuffer(),i=await this.audioContext.decodeAudioData(t),s=e.name.replace(/\.[^/.]+$/,"");return this.samples.set(s,i),s}catch(e){throw console.error("Error loading audio file:",e),e}}scheduler(){for(;this.nextNoteTime<this.audioContext.currentTime+this.scheduleAheadTime;)this.nextNoteTime+=60/this.bpm/4;this.timerID=setTimeout(()=>this.scheduler(),this.lookAhead)}play(){"suspended"===this.audioContext.state&&this.audioContext.resume(),this.isPlaying=!0,this.nextNoteTime=this.audioContext.currentTime,this.scheduler()}pause(){this.isPlaying=!1,this.timerID&&(clearTimeout(this.timerID),this.timerID=null)}stop(){this.pause(),this.currentTime=0,this.nextNoteTime=0,this.activeSources.forEach(e=>{try{e.stop()}catch(e){}}),this.activeSources.clear(),this.activeBlocks.clear(),"undefined"!=typeof speechSynthesis&&speechSynthesis.cancel()}async exportWAV(e=10){if(!window.codeInterpreter)throw Error("Code interpreter not available");const t=window.editor.getValue();if(!t.trim())throw Error("No code to export");window.codeInterpreter.parse(t);let i=10;try{i=window.codeInterpreter.estimateDuration("main"),console.log("Estimated duration:",i),(!i||isNaN(i)||1>i)&&(i=10)}catch(e){i=10}i+=5;const s=new OfflineAudioContext(2,i*this.audioContext.sampleRate,this.audioContext.sampleRate);try{await this.renderCodeToOfflineContext(t,s,i);const e=await s.startRendering();return this.audioBufferToWAV(e)}catch(e){throw console.error("Error exporting WAV:",e),e}}async renderCodeToOfflineContext(e,t,i){const s=t.createGain();s.gain.value=this.masterGain.gain.value,s.connect(t.destination);const o={low:t.createBiquadFilter(),mid:t.createBiquadFilter(),high:t.createBiquadFilter()};o.low.type="lowshelf",o.low.frequency.value=320,o.low.gain.value=this.eq.low.gain.value,o.mid.type="peaking",o.mid.frequency.value=1e3,o.mid.Q.value=1,o.mid.gain.value=this.eq.mid.gain.value,o.high.type="highshelf",o.high.frequency.value=3200,o.high.gain.value=this.eq.high.gain.value,o.low.connect(o.mid),o.mid.connect(o.high),o.high.connect(s);try{window.codeInterpreter.parse(e)}catch(e){throw console.error("Failed to parse code for export:",e),Error("Invalid MelodiCode syntax: "+e.message)}const n=this.createOfflineAudioEngine(t,o.low);await this.executeCodeOffline(n,i)}createOfflineAudioEngine(e,t){let i=0;const s={audioContext:e,masterGain:{gain:{value:this.masterGain.gain.value}},eq:{low:t},samples:this.samples,noteToFrequency:this.noteToFrequency.bind(this),bpm:this.bpm,isPlaying:!0,currentTime:0,nextNoteTime:0,scheduleAheadTime:.1,activeSources:new Set,activeBlocks:new Map,reverb:this.reverb?{buffer:this.reverb.buffer}:null,audioContext:e,offlineCurrentTime:0,playSample:(t,o=1,n=1,r=0,a=1,l=0,h=null)=>{const c=i+r;return console.log(`Playing sample '${t}' at offline time ${c} (currentTime: ${i}, when: ${r})`),this.playOfflineSample(t,e,h||s.eq.low,c,o,n,a)},generateTone:(t,o=1,n="sine",r=0,a=1,l=0,h=null)=>{const c=Math.max(0,i+r);return console.log(`Generating tone ${t}Hz at offline time ${c} (currentTime: ${i}, when: ${r})`),this.generateOfflineTone(t,o,e,h||s.eq.low,c,n,a)},scheduler:()=>{i+=60/s.bpm/16,console.log("Offline scheduler advanced time to: "+i)},setMasterVolume:()=>{},setEQ:()=>{},setCompressor:()=>{},setLimiter:()=>{},setReverb:()=>{},play:()=>{},pause:()=>{},stop:()=>{}};return s.executeBlock=async(t,i=0)=>{if(!window.codeInterpreter.blocks.has(t))return console.warn(`Block '${t}' not found`),0;const o=window.codeInterpreter.blocks.get(t);let n=0,r=s.eq.low;if(window.codeInterpreter.effects.has(t)){const i=window.codeInterpreter.effects.get(t);let o=s.eq.low;for(let t=i.length-1;t>=0;t--){const n=i[t];let r=null,a=null,l=null;if("reverb"===n.type){r=e.createConvolver(),s.reverb&&s.reverb.buffer&&(r.buffer=s.reverb.buffer),a=e.createGain(),l=e.createGain();const t=parseFloat(n.params[0])||.3;a.gain.value=t,l.gain.value=1-t,r.connect(a),a.connect(o),l.connect(o);const i=e.createGain();i.connect(r),i.connect(l),o=i}else if("delay"===n.type){r=e.createDelay(1);const t=parseFloat(n.params[0])||.3,i=parseFloat(n.params[1])||.3,s=parseFloat(n.params[2])||.3;r.delayTime.value=t;const h=e.createGain();h.gain.value=i,r.connect(h),h.connect(r),a=e.createGain(),l=e.createGain(),a.gain.value=s,l.gain.value=1-s,r.connect(a),a.connect(o),l.connect(o);const c=e.createGain();c.connect(r),c.connect(l),o=c}else if("filter"===n.type){r=e.createBiquadFilter();const t=n.params[0]||"lowpass",i=parseFloat(n.params[1])||1e3,s=parseFloat(n.params[2])||1;r.type=t,r.frequency.value=i,r.Q.value=s,r.connect(o),o=r}else if("distortion"===n.type){r=e.createWaveShaper();const t=parseFloat(n.params[0])||10,i=44100,s=new Float32Array(i),a=Math.PI/180;for(let e=0;i>e;e++){const o=2*e/i-1;s[e]=(3+t)*o*20*a/(Math.PI+t*Math.abs(o))}r.curve=s,r.oversample="4x",r.connect(o),o=r}else if("chorus"===n.type){const t=parseFloat(n.params[0])||1,i=parseFloat(n.params[1])||.002,s=parseFloat(n.params[2])||.3,r=e.createDelay(.1),h=e.createDelay(.1),c=e.createOscillator(),d=e.createOscillator(),p=e.createGain(),u=e.createGain();c.frequency.value=t,d.frequency.value=1.1*t,p.gain.value=i,u.gain.value=i,c.connect(p),d.connect(u),p.connect(r.delayTime),u.connect(h.delayTime),r.delayTime.value=.01,h.delayTime.value=.015,a=e.createGain(),l=e.createGain(),a.gain.value=s,l.gain.value=1-s;const g=e.createGain();r.connect(g),h.connect(g),g.connect(a),a.connect(o),l.connect(o);const m=e.createGain();m.connect(r),m.connect(h),m.connect(l),c.start(),d.start(),o=m}}r=o}let a=0;for(;a<o.length;){const e=o[a],t=e.split(/\s+/),l=t[0];if("if"===l){const e=await window.codeInterpreter.executeIf(t,i+n,o,a);n+=e.duration,a=e.nextIndex}else if("for"===l){const e=await window.codeInterpreter.executeFor(t,i+n,o,a);n+=e.duration,a=e.nextIndex}else"pattern"===l?(n+=await window.codeInterpreter.executePattern(t,i+n,r),a++):"sequence"===l?(n+=await window.codeInterpreter.executeSequence(t,i+n,r),a++):(n+=await this.executeOfflineCommand(e,i+n,r,s),a++)}return s.offlineCurrentTime+=n,n},s}async executeOfflineCommand(e,t,i,s){const o=e.split(/\s+/),n=o[0];switch(n){case"sample":const e=o[1],r=parseFloat(o[2])||1,a=parseFloat(o[3])||1,l=parseFloat(o[4])||.8;if(window.codeInterpreter.customSamples.has(e)){const o=window.codeInterpreter.customSamples.get(e);return await Promise.all(o.map(e=>this.executeOfflineCommand(e,t,i,s))),0}return this.playOfflineSample(e,s.audioContext,i,t,r,a,l);case"tone":const h=o[1];let c=parseFloat(o[2])||1;const d=o[3]||"sine",p=parseFloat(o[4])||.8,u=c*(60/s.bpm);let g;return g=isNaN(h)?this.noteToFrequency(h):parseFloat(h),this.generateOfflineTone(g,u,s.audioContext,i,t,d,p),u;case"slide":return this.executeOfflineSlide(o,t,i,s);case"sidechain":return this.executeOfflineSidechain(o,t,i,s);case"pattern":return this.executeOfflinePattern(o,t,i,s);case"sequence":return this.executeOfflineSequence(o,t,i,s);case"play":return this.executeOfflinePlay(o,t,i,s);case"playasync":return this.executeOfflinePlayAsync(o,t,i,s);case"loop":return this.executeOfflineLoop(o,t,i,s);case"loopasync":return this.executeOfflineLoopAsync(o,t,i,s);case"wait":return(parseFloat(o[1])||0)*(60/s.bpm);case"bpm":return s.bpm=parseFloat(o[1])||120,0;case"set":return window.codeInterpreter.variables.set(o[1],parseFloat(o[2])||0),0;case"tts":console.warn("TTS not supported in offline rendering, adding estimated silence");let m="",f=1;if(o[1]&&o[1].startsWith('"')){const e=[];for(let t=1;t<o.length;t++)if(e.push(o[t]),o[t].endsWith('"')){f=t+1;break}m=e.join(" ").replace(/"/g,"")}else m=o[1]||"Hello",f=2;const y=parseFloat(o[f]||"1")*(s.bpm/120)*150;return m.split(" ").length/y*60;default:return console.warn("Unknown offline command: "+n),0}}executeOfflineSlide(e,t,i,s){const o=e[1],n=e[2],r=(parseFloat(e[3])||1)*(60/s.bpm),a=e[4]||"sine",l=parseFloat(e[5])||.8,h=parseFloat(e[6])||0,c=isNaN(o)?this.noteToFrequency(o):parseFloat(o),d=isNaN(n)?this.noteToFrequency(n):parseFloat(n),p=s.audioContext,u=p.createOscillator(),g=p.createGain(),m=p.createStereoPanner();u.type=a,u.frequency.setValueAtTime(c,t),u.frequency.linearRampToValueAtTime(d,t+r),m.pan.setValueAtTime(Math.max(-1,Math.min(1,h)),t);const f=Math.min(.003,.03*r);return g.gain.setValueAtTime(0,t),g.gain.linearRampToValueAtTime(l,t+f),g.gain.setValueAtTime(l,t+r-f),g.gain.linearRampToValueAtTime(0,t+r),u.connect(g),g.connect(m),m.connect(i),u.start(t),u.stop(t+r),console.log(`Scheduled slide from ${c}Hz to ${d}Hz for ${r}s at time ${t}`),r}async executeOfflineSidechain(e,t,i,s){const o=e[1],n=e[2],r=parseFloat(e[3]);if(!window.codeInterpreter.blocks.has(o)||!window.codeInterpreter.blocks.has(n))return console.warn(`One or both blocks not found: ${o}, ${n}`),0;const a=s.audioContext.createGain();a.gain.value=1,a.connect(i);const l=window.codeInterpreter.estimateDuration(o),h=window.codeInterpreter.estimateDuration(n),c=Math.max(l,h,4);console.log(`Offline Sidechain: block1 (${o}) duration: ${l}s, block2 (${n}) duration: ${h}s, total: ${c}s`);const d=this.getOfflineTriggerTimes(n,h,c,s);console.log(`Offline Sidechain: Found ${d.length} triggers at times:`,d),d.forEach((e,i)=>{if(c>e){const s=t+e;console.log(`Scheduling offline duck ${i+1} at ${e}s (absolute: ${s}s)`),a.gain.cancelScheduledValues(s),a.gain.setValueAtTime(1,s),a.gain.linearRampToValueAtTime(1-r,s+.01),a.gain.linearRampToValueAtTime(1,s+.15)}});const p=[];if(l>0&&c>l){const e=Math.ceil(c/l);for(let i=0;e>i;i++){const e=t+i*l;t+c>e&&p.push(this.executeOfflineBlock(o,e,a,s))}}else p.push(this.executeOfflineBlock(o,t,a,s));if(h>0&&c>h){const e=Math.ceil(c/h);for(let o=0;e>o;o++){const e=t+o*h;t+c>e&&p.push(this.executeOfflineBlock(n,e,i,s))}}else p.push(this.executeOfflineBlock(n,t,i,s));return await Promise.all(p),c}getOfflineTriggerTimes(e,t,i,s){const o=window.codeInterpreter.blocks.get(e),n=[],r=t>0?Math.ceil(i/t):1;for(let e=0;r>e;e++){const r=e*t;if(r>=i)break;let a=0;const l=60/s.bpm;for(const e of o){const t=e.split(/\s+/),i=t[0];if("sample"===i)n.push(r+a);else if("tone"===i)n.push(r+a),a+=parseFloat(t[2]||"1")*l;else if("slide"===i)n.push(r+a),a+=parseFloat(t[3]||"1")*l;else if("wait"===i)a+=parseFloat(t[1])*l;else if("pattern"===i)for(let e=2;e<t.length;e+=2)if(e+1<t.length){const i=t[e+1].replace(/"/g,"").split("-"),s=l/4;for(let e=0;e<i.length;e++)"1"!==i[e].trim()&&"x"!==i[e].trim()&&"X"!==i[e].trim()||n.push(r+a+e*s);a+=i.length*s}}}return n}async executeCodeOffline(e,t){const i=window.audioEngine,s=window.codeInterpreter.audioEngine;window.audioEngine=e,window.codeInterpreter.audioEngine=e;try{if(console.log("Starting offline code execution..."),window.codeInterpreter&&"function"==typeof window.codeInterpreter.execute)await window.codeInterpreter.execute();else if(console.warn("Code interpreter execute method not available"),window.codeInterpreter&&window.codeInterpreter.blocks){const t=window.codeInterpreter.blocks.get("main");t&&(console.log("Executing main block as fallback"),await this.executeBlockFallback(t,e))}console.log("Offline code execution completed")}catch(e){console.error("Error executing code for export:",e)}finally{window.audioEngine=i,window.codeInterpreter.audioEngine=s}}async executeBlockFallback(e,t){console.log("Executing block fallback:",e),t.generateTone(440,1,"sine",0,.5),t.generateTone(880,1,"sine",1,.5),t.playSample("kick",1,1,2,.8)}async executeOfflineBlock(e,t,i,s){if(!window.codeInterpreter.blocks.has(e))return console.warn(`Block '${e}' not found for offline execution`),0;const o=window.codeInterpreter.blocks.get(e);let n=0,r=0;for(;r<o.length;){const e=o[r],a=e.split(/\s+/),l=a[0];if("if"===l){const e=await this.executeOfflineIf(a,t+n,o,r,i,s);n+=e.duration,r=e.nextIndex}else if("for"===l){const e=await this.executeOfflineFor(a,t+n,o,r,i,s);n+=e.duration,r=e.nextIndex}else n+=await this.executeOfflineCommand(e,t+n,i,s),r++}return n}async executeOfflinePattern(e,t,i,s){if(3>e.length||e.length%2!=1)return console.warn("Pattern command requires pairs of a sample name and a pattern string."),0;const o=[];for(let t=1;t<e.length;t+=2){const i=e[t],s=e[t+1].replace(/"/g,"");o.push({name:i,string:s})}if(0===o.length)return 0;let n=0;const r=[],a=60/s.bpm/4;for(const e of o){const o=e.string.split("-");o.length>n&&(n=o.length);for(let n=0;n<o.length;n++){const l=o[n].trim();if("1"===l||"x"===l||"X"===l){const o=t+n*a;r.push(this.executeOfflineCommand("sample "+e.name,o,i,s))}}}return await Promise.all(r),n*a}async executeOfflineSequence(e,t,i,s){e[1];const o=e.slice(2);let n=0;const r=60/s.bpm/4;for(let e=0;e<o.length;e++){const a=o[e];"-"!==a&&"0"!==a&&await this.executeOfflineCommand("sample "+a,t+n,i,s),n+=r}return n}async executeOfflinePlay(e,t,i,s){const o=[],n={};for(let t=1;t<e.length;t++)if(e[t].includes("=")){const[i,s]=e[t].split("=");n[i]=parseFloat(s)}else o.push(e[t]);if(0===o.length)return 0;const r=o.map(e=>({name:e,duration:window.codeInterpreter.estimateDuration(e)})),a=Math.max(...r.map(e=>e.duration),0);if(0===a){const e=o.map(e=>this.executeOfflineBlock(e,t,i,s));return await Promise.all(e),0}const l=[];return r.forEach(e=>{const{name:o,duration:n}=e;if(n>0){const e=Math.ceil(a/n);for(let r=0;e>r;r++){const e=t+r*n;t+a>e&&l.push(this.executeOfflineBlock(o,e,i,s))}}else l.push(this.executeOfflineBlock(o,t,i,s))}),await Promise.all(l),a}async executeOfflinePlayAsync(e,t,i,s){return this.executeOfflinePlay(e,t,i,s)}async executeOfflineLoop(e,t,i,s){const o=parseInt(e[1]),n=e.slice(2);for(const e of n)if(!window.codeInterpreter.blocks.has(e))return console.warn(`Block '${e}' not found`),0;const r=n.map(e=>({name:e,duration:window.codeInterpreter.estimateDuration(e)})),a=Math.max(...r.map(e=>e.duration),0);if(0===a){let e=0;for(let r=0;o>r;r++){const o=n.map(o=>this.executeOfflineBlock(o,t+e,i,s));await Promise.all(o)}return 0}const l=[];let h=0;for(let e=0;o>e;e++){const e=t+h;r.forEach(t=>{const{name:o,duration:n}=t;if(n>0){const t=Math.ceil(a/n);for(let r=0;t>r;r++){const t=e+r*n;e+a>t&&l.push(this.executeOfflineBlock(o,t,i,s))}}else l.push(this.executeOfflineBlock(o,e,i,s))}),h+=a}return await Promise.all(l),h}async executeOfflineLoopAsync(e,t,i,s){return this.executeOfflineLoop(e,t,i,s)}async executeOfflineIf(e,t,i,s,o,n){const r=e[1],a=e[2],l=window.codeInterpreter.parseValue(e[3]),h=window.codeInterpreter.parseValue(r);let c=!1;switch(a){case">":c=h>l;break;case"<":c=l>h;break;case"==":c=h==l;break;case"!=":c=h!=l;break;case">=":c=h>=l;break;case"<=":c=l>=h}let d=this.findMatchingEndOffline(i,s,"if","endif");return c?await this.executeOfflineCommandBlock(i,s+1,d,t,o,n):{duration:0,nextIndex:d+1}}async executeOfflineFor(e,t,i,s,o,n){const r=e[1],a=window.codeInterpreter.parseValue(e[2]),l=window.codeInterpreter.parseValue(e[3]);let h=0;const c=this.findMatchingEndOffline(i,s,"for","endfor");for(let e=a;l>=e;e++)window.codeInterpreter.variables.set(r,e),h+=(await this.executeOfflineCommandBlock(i,s+1,c,t+h,o,n)).duration;return{duration:h,nextIndex:c+1}}async executeOfflineCommandBlock(e,t,i,s,o,n){let r=0,a=t;for(;i>a;){const t=e[a],i=t.split(/\s+/),l=i[0];if("if"===l){const t=await this.executeOfflineIf(i,s+r,e,a,o,n);r+=t.duration,a=t.nextIndex}else if("for"===l){const t=await this.executeOfflineFor(i,s+r,e,a,o,n);r+=t.duration,a=t.nextIndex}else"endif"===l||"endfor"===l||(r+=await this.executeOfflineCommand(t,s+r,o,n)),a++}return{duration:r}}findMatchingEndOffline(e,t,i,s){let o=1;for(let n=t+1;n<e.length;n++){const t=e[n].split(/\s+/)[0];if(t===i&&o++,t===s&&o--,0===o)return n}return e.length-1}async playOfflineSample(e,t,i,s,o=1,n=1,r=1){if(!this.samples.has(e))return void console.warn(`Sample '${e}' not found for export`);const a=this.samples.get(e),l=t.createBufferSource(),h=t.createGain();return l.buffer=a,l.playbackRate.value=o*n,h.gain.value=r,l.connect(h),h.connect(i),l.start(s),console.log(`Scheduled sample '${e}' at time ${s} with pitch ${o} and timescale ${n}`),l}generateOfflineTone(e,t,i,s,o,n="sine",r=1){const a=i.createOscillator(),l=i.createGain();a.type=n,a.frequency.value=e,l.gain.value=0,a.connect(l),l.connect(s);const h=Math.max(0,o),c=h+t;return l.gain.setValueAtTime(0,h),l.gain.linearRampToValueAtTime(.5*r,Math.max(h+.01,h+.1*t)),l.gain.linearRampToValueAtTime(.4*r,Math.max(h+.1,c-.1*t)),l.gain.setValueAtTime(.3*r,Math.max(c-.1,c-.1*t)),l.gain.exponentialRampToValueAtTime(.001,c),a.start(h),a.stop(c),console.log(`Scheduled tone ${e}Hz for ${t}s at time ${h}`),a}audioBufferToWAV(e){const t=e.length,i=e.numberOfChannels,s=e.sampleRate,o=new ArrayBuffer(44+t*i*2),n=new DataView(o),r=(e,t)=>{for(let i=0;i<t.length;i++)n.setUint8(e+i,t.charCodeAt(i))};r(0,"RIFF"),n.setUint32(4,36+t*i*2,!0),r(8,"WAVE"),r(12,"fmt "),n.setUint32(16,16,!0),n.setUint16(20,1,!0),n.setUint16(22,i,!0),n.setUint32(24,s,!0),n.setUint32(28,s*i*2,!0),n.setUint16(32,2*i,!0),n.setUint16(34,16,!0),r(36,"data"),n.setUint32(40,t*i*2,!0);let a=44;for(let s=0;t>s;s++)for(let t=0;i>t;t++){const i=Math.max(-1,Math.min(1,e.getChannelData(t)[s]));n.setInt16(a,32767*i,!0),a+=2}return new Blob([o],{type:"audio/wav"})}getAnalyserData(){this.analyser||(this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=256,this.masterGain.connect(this.analyser));const e=this.analyser.frequencyBinCount,t=new Uint8Array(e);return this.analyser.getByteFrequencyData(t),t}getWaveformData(){if(!this.analyser)return null;const e=this.analyser.fftSize,t=new Uint8Array(e);return this.analyser.getByteTimeDomainData(t),t}}window.audioEngine=new AudioEngine;class CodeInterpreter{constructor(audioEngine){this.audioEngine=audioEngine,this.blocks=new Map,this.globalCommands=[],this.variables=new Map,this.isRunning=!1,this.currentPosition=0,this.loopStacks=new Map,this.effects=new Map,this.customSamples=new Map,this.activeUtterances=[],this.defaultVolume=.8,this.defaultPan=0,this.defaultPitch=1,this.defaultTimescale=1,this.bpm=120,this.beatDuration=60/this.bpm,this.forLoopStacks=new Map,this.conditionalBlocks=new Map}parse(e){try{this.blocks.clear(),this.globalCommands=[],this.variables.clear(),this.customSamples.clear(),this.effects.clear();const t=e.split("\n").map(e=>{const t=e.indexOf("//");return-1!==t?e.slice(0,t).trim():e.trim()}).filter(e=>e),i=[];for(const e of t)if(e.startsWith("[")||e.startsWith("<")||"[end]"===e||"<end>"===e)i.push(e);else{const t=e.split(";").map(e=>e.trim()).filter(e=>e);i.push(...t)}let s=null,o=[],n=!1,r="",a=[];for(let e=0;e<i.length;e++){const t=i[e].trim();if(t.startsWith("<")&&t.endsWith(">")&&"<end>"!==t){n=!0,r=t.slice(1,-1),o=[],s=null;continue}if("[end]"===t||"<end>"===t){n&&r?(this.customSamples.set(r,o.slice()),n=!1,r="",o=[]):s&&(this.blocks.set(s,o),s=null,o=[]);continue}if(n){o.push(t);continue}const l=t.match(/^\[([^\]]+)\](.*)$/);if(l&&"end"!==l[1].trim()){const e=l[1].trim(),t=l[2].trim();a=[];const i=/\(([^\)]+)\)/g;let r;for(;null!==(r=i.exec(t));){const e=r[1].trim().split(/\s+/),t=e[0],i=e.slice(1);a.push({type:t,params:i})}a.length>0&&this.effects.set(e,a),s=e,o=[],n=!1;continue}s?o.push(t):this.globalCommands.push(t)}return{success:!0,message:"Code parsed successfully"}}catch(e){return{success:!1,message:"Parse error: "+e.message}}}validate(){const e=[];this.blocks.has("main")||e.push("Warning: No [main] block found");for(const[t,i]of this.blocks)for(let s=0;s<i.length;s++){const o=i[s],n=this.validateCommand(o);n.valid||e.push(`Block '${t}', line ${s+1}: ${n.error}`)}for(let t=0;t<this.globalCommands.length;t++){const i=this.globalCommands[t],s=this.validateCommand(i);s.valid||e.push(`Global command line ${t+1}: ${s.error}`)}return{valid:0===e.length,errors:e}}validateCommand(e){const t=e.split(/\s+/),i=t[0];switch(i){case"sample":if(2>t.length)return{valid:!1,error:"sample command requires at least sample name"};break;case"tone":if(2>t.length)return{valid:!1,error:"tone command requires at least frequency/note"};break;case"slide":if(4>t.length)return{valid:!1,error:"slide command requires key1, key2, and timescale"};break;case"sidechain":if(4>t.length)return{valid:!1,error:"sidechain command requires block1, block2, and amount"};if(isNaN(parseFloat(t[3]))||0>parseFloat(t[3])||parseFloat(t[3])>1)return{valid:!1,error:"sidechain amount must be between 0 and 1"};break;case"wait":if(2>t.length)return{valid:!1,error:"wait command requires duration"};if(isNaN(parseFloat(t[1])))return{valid:!1,error:"wait duration must be a number"};break;case"play":case"playasync":if(2>t.length)return{valid:!1,error:"play command requires at least one block name"};break;case"bpm":if(2>t.length)return{valid:!1,error:"bpm command requires BPM value"};if(isNaN(parseFloat(t[1]))||0>=parseFloat(t[1]))return{valid:!1,error:"BPM must be a positive number"};break;case"loop":case"loopasync":if(3>t.length)return{valid:!1,error:"loop command requires count and at least one block name"};if(isNaN(parseInt(t[1])))return{valid:!1,error:"loop count must be a number"};break;case"pattern":if(3>t.length)return{valid:!1,error:"pattern command requires name and pattern string"};break;case"sequence":if(3>t.length)return{valid:!1,error:"sequence command requires name and step pattern"};break;case"set":if(3>t.length)return{valid:!1,error:"set command requires variable name and value"};break;case"effect":if(3>t.length)return{valid:!1,error:"effect command requires effect type and parameters"};const e=t[1],s=["reverb","delay","filter","distortion","chorus"];if(!s.includes(e))return{valid:!1,error:`Unknown effect type: ${e}. Valid effects: ${s.join(", ")}`};break;case"if":if(4>t.length)return{valid:!1,error:"if statement requires variable, operator, and value"};break;case"for":if(4>t.length)return{valid:!1,error:"for loop requires variable, start, and end values"};break;case"endif":case"endfor":break;case"tts":if(2>t.length)return{valid:!1,error:"tts command requires text"};if("undefined"==typeof speechSynthesis)return{valid:!1,error:"Text-to-speech not supported in this browser"};break;default:return{valid:!1,error:"Unknown command: "+i}}return{valid:!0}}async execute(){if(!this.audioEngine)throw Error("Audio engine not available");this.isRunning=!0,this.currentPosition=0;try{for(const e of this.globalCommands){if(!this.isRunning)break;await this.executeCommand(e,0)}0===this.globalCommands.length&&this.blocks.has("main")&&await this.executeBlock("main",0)}catch(e){throw console.error("Execution error:",e),e}}async executeCommand(e,t,i=[]){const s=e.split(/\s+/),o=s[0];switch(o){case"sample":return this.executeSample(s,t,i);case"tone":return this.executeTone(s,t,i);case"slide":return this.executeSlide(s,t);case"sidechain":return this.executeSidechain(s,t);case"wait":return this.executeWait(s,t);case"play":return this.executePlay(s,t);case"playasync":return this.executePlayAsync(s,t);case"loopasync":return this.executeLoopAsync(s,t);case"loop":return this.executeLoop(s,t);case"set":return this.executeSet(s);case"effect":return this.executeEffect(s,t);case"bpm":return this.executeBPM(s);case"pattern":return this.executePattern(s,t);case"sequence":return this.executeSequence(s,t);case"tts":return this.executeTTS(s,t);default:return console.warn("Unknown command: "+o),0}}executeBPM(e){const t=parseFloat(e[1]);return this.bpm=t,this.beatDuration=60/this.bpm,console.log(`BPM set to ${this.bpm}, beat duration: ${this.beatDuration}s`),0}async executePattern(e,t,i=[]){if(3>e.length||e.length%2!=1)return console.warn("Pattern command requires pairs of a sample name and a pattern string."),0;const s=[];for(let t=1;t<e.length;t+=2){const i=e[t],o=e[t+1].replace(/"/g,"");s.push({name:i,string:o})}if(0===s.length)return 0;let o=0;const n=[],r=this.beatDuration/4;for(const e of s){const s=e.string.split("-");s.length>o&&(o=s.length);for(let o=0;o<s.length;o++){const a=s[o].trim();if("1"===a||"x"===a||"X"===a){const s=t+o*r;n.push(this.executeCommand("sample "+e.name,s,i))}}}return await Promise.all(n),o*r}async executeSequence(e,t,i=[]){e[1];const s=e.slice(2);let o=0;const n=this.beatDuration/4;for(let e=0;e<s.length;e++){const r=s[e];"-"!==r&&"0"!==r&&await this.executeCommand("sample "+r,t+o,i),o+=n}return o}async executeIf(e,t,i,s){const o=e[1],n=e[2],r=this.parseValue(e[3]),a=this.parseValue(o);let l=!1;switch(n){case">":l=a>r;break;case"<":l=r>a;break;case"==":l=a==r;break;case"!=":l=a!=r;break;case">=":l=a>=r;break;case"<=":l=r>=a}let h=this.findMatchingEnd(i,s,"if","endif");return l?await this.executeCommandBlock(i,s+1,h,t):{duration:0,nextIndex:h+1}}async executeFor(e,t,i,s){const o=e[1],n=this.parseValue(e[2]),r=this.parseValue(e[3]);let a=0;const l=this.findMatchingEnd(i,s,"for","endfor");for(let e=n;r>=e;e++)this.variables.set(o,e),a+=(await this.executeCommandBlock(i,s+1,l,t+a)).duration;return{duration:a,nextIndex:l+1}}async executeTTS(e,t){if(this.audioEngine&&this.audioEngine.audioContext&&"OfflineAudioContext"===this.audioEngine.audioContext.constructor.name){console.warn("TTS not supported in offline rendering mode");let t="",i=1;if(e[1]&&e[1].startsWith('"')){const s=[];for(let t=1;t<e.length;t++)if(s.push(e[t]),e[t].endsWith('"')){i=t+1;break}t=s.join(" ").replace(/"/g,"")}else t=e[1]||"Hello",i=2;const s=this.parseValue(e[i]||"1")*(this.bpm/120)*150;return t.split(" ").length/s*60}let i="",s=1;if(e[1]&&e[1].startsWith('"')){const t=[];for(let i=1;i<e.length;i++)if(t.push(e[i]),e[i].endsWith('"')){s=i+1;break}i=t.join(" ").replace(/"/g,"")}else i=e[1]||"Hello",s=2;const o=this.parseValue(e[s]||"1"),n=this.parseValue(e[s+1]||"1"),r=parseInt(e[s+2]||"0"),a=o*(this.bpm/120),l=this.audioEngine.audioContext.currentTime,h=l+t,c="tts_"+(Date.now()+Math.random());this.activeTTSCalls||(this.activeTTSCalls=new Set),this.pendingTTSTimeouts||(this.pendingTTSTimeouts=new Map),console.log(`Starting TTS: "${i}" with ID: ${c} scheduled for absolute time: ${h} (current: ${l}, offset: ${t})`);const d=new SpeechSynthesisUtterance(i);d.rate=Math.max(.1,Math.min(10,a)),d.pitch=Math.max(0,Math.min(2,n));const p=speechSynthesis.getVoices();p.length>0&&r<p.length&&(d.voice=p[r]);const u=()=>{const e=this.activeUtterances.indexOf(d);e>-1&&this.activeUtterances.splice(e,1),this.activeTTSCalls.delete(c),this.pendingTTSTimeouts.delete(c),console.log(`Cleaned up TTS: "${i}" (${c})`)};d.onend=()=>{console.log(`TTS completed: "${i}" (${c})`),u()},d.onerror=e=>{console.error(`SpeechSynthesis error for "${i}" (${c}): ${e.error}`),u()},this.activeTTSCalls.add(c),this.activeUtterances.push(d),(()=>{const e=()=>{const t=this.audioEngine.audioContext.currentTime;if(h-.05>t)this.isRunning&&this.activeTTSCalls.has(c)?setTimeout(e,10):u();else if(this.isRunning&&this.activeTTSCalls.has(c)){console.log(`Speaking: "${i}" (${c}) at context time: ${t} (target was: ${h})`);try{speechSynthesis.speak(d)}catch(e){console.error(`Failed to speak TTS "${i}":`,e),u()}}else console.log(`Skipping TTS "${i}" (${c}) - execution stopped or already processed`),u()};e()})();const g=150*d.rate;return i.split(" ").length/g*60}findMatchingEnd(e,t,i,s){let o=1;for(let n=t+1;n<e.length;n++){const t=e[n].split(/\s+/)[0];if(t===i&&o++,t===s&&o--,0===o)return n}return e.length-1}async executeCommandBlock(e,t,i,s){let o=0,n=t;for(;i>n;){const t=e[n],i=t.split(/\s+/),r=i[0];if("if"===r){const t=await this.executeIf(i,s+o,e,n);o+=t.duration,n=t.nextIndex}else if("for"===r){const t=await this.executeFor(i,s+o,e,n);o+=t.duration,n=t.nextIndex}else"endif"===r||"endfor"===r||(o+=await this.executeCommand(t,s+o)),n++}return{duration:o}}async executeSample(e,t,i=[]){const s=e[1],o=this.parseValue(e[2]||"1"),n=this.parseValue(e[3]||"1"),r=this.parseValue(e[4]||this.defaultVolume),a=this.parseValue(e[5]||this.defaultPan),l=this.parseParameters(e.slice(6));if(this.customSamples.has(s)){const e=this.customSamples.get(s);return await Promise.all(e.map(e=>this.executeCommand(e,t,i))),0}let h=this.audioEngine.eq.low;return i&&"function"==typeof i.connect?h=i:i&&i.length>0&&(h=i[0]),this.audioEngine.playSample(s,o,n,t,Math.max(.001,+r*(l.volume||1)),a+(l.pan||0),h),0}executeTone(e,t,i=[]){const s=e[1];let o=this.parseValue(e[2]||"1");const n=this.parseValue(e[4]||this.defaultVolume),r=this.parseValue(e[5]||this.defaultPan),a=e[3]||"sine",l=o*this.beatDuration,h=this.parseParameters(e.slice(6));let c;c=isNaN(s)?this.audioEngine.noteToFrequency(s):parseFloat(s);let d=this.audioEngine.eq.low;i&&"function"==typeof i.connect?d=i:i&&i.length>0&&(d=i[0]);const p=this.audioEngine.audioContext,u=p.createOscillator(),g=p.createGain(),m=p.createStereoPanner();u.type=a,u.frequency.value=c,m.pan.value=Math.max(-1,Math.min(1,r+(h.pan||0))),u.connect(g),g.connect(m),m.connect(d);const f=p.currentTime+t,y=f+l,w=Math.min(.005,.1*l),b=n*(h.volume||1);return g.gain.setValueAtTime(0,f),g.gain.linearRampToValueAtTime(b,f+w),g.gain.setValueAtTime(b,y-w),g.gain.linearRampToValueAtTime(0,y),u.start(f),u.stop(y),this.audioEngine.activeSources.add(u),u.addEventListener("ended",()=>{this.audioEngine.activeSources.delete(u)}),l}async executeSlide(e,t){const i=e[1],s=e[2],o=this.parseValue(e[3]||"1")*this.beatDuration,n=e[4]||"sine",r=this.parseValue(e[5]||this.defaultVolume),a=this.parseValue(e[6]||this.defaultPan),l=isNaN(i)?this.audioEngine.noteToFrequency(i):parseFloat(i),h=isNaN(s)?this.audioEngine.noteToFrequency(s):parseFloat(s),c=this.audioEngine.audioContext,d=c.createOscillator(),p=c.createGain(),u=c.createStereoPanner(),g=c.currentTime+t,m=g+o;d.type=n,d.frequency.setValueAtTime(l,g),d.frequency.linearRampToValueAtTime(h,m),u.pan.setValueAtTime(Math.max(-1,Math.min(1,a)),g);const f=Math.min(.003,.03*o);return p.gain.setValueAtTime(0,g),p.gain.linearRampToValueAtTime(r,g+f),p.gain.setValueAtTime(r,m-f),p.gain.linearRampToValueAtTime(0,m),d.connect(p),p.connect(u),u.connect(this.audioEngine.eq.low),d.start(g),d.stop(m),this.audioEngine.activeSources.add(d),d.addEventListener("ended",()=>{this.audioEngine.activeSources.delete(d)}),o}async executeSidechain(e,t){const i=e[1],s=e[2],o=parseFloat(e[3]);if(!this.blocks.has(i)||!this.blocks.has(s))return console.warn(`One or both blocks not found: ${i}, ${s}`),0;const n=this.audioEngine.audioContext,r=n.createGain();r.gain.value=1;const a=n.createDynamicsCompressor();a.threshold.value=-50,a.knee.value=40,a.ratio.value=20,a.attack.value=.003,a.release.value=.1,r.connect(a),a.connect(this.audioEngine.eq.low);const l=this.estimateDuration(i),h=this.estimateDuration(s),c=Math.max(l,h,4);console.log(`Sidechain: block1 (${i}) duration: ${l}s, block2 (${s}) duration: ${h}s, total: ${c}s`);const d=this.audioEngine.playSample.bind(this.audioEngine),p=this.executeTone.bind(this);let u=null;const g=((e,t,i)=>{const s=this.blocks.get(e),o=[],n=t>0?Math.ceil(i/t):1;for(let e=0;n>e;e++){const n=e*t;if(n>=i)break;let r=0;for(const e of s){const t=e.split(/\s+/),i=t[0];if("sample"===i)o.push(n+r);else if("tone"===i)o.push(n+r),r+=this.parseValue(t[2]||"1")*this.beatDuration;else if("slide"===i)o.push(n+r),r+=this.parseValue(t[3]||"1")*this.beatDuration;else if("wait"===i)r+=this.parseValue(t[1])*this.beatDuration;else if("pattern"===i)for(let e=2;e<t.length;e+=2)if(e+1<t.length){const i=t[e+1].replace(/"/g,"").split("-"),s=this.beatDuration/4;for(let e=0;e<i.length;e++)"1"!==i[e].trim()&&"x"!==i[e].trim()&&"X"!==i[e].trim()||o.push(n+r+e*s);r+=i.length*s}}}return o})(s,h,c);console.log(`Sidechain: Found ${g.length} triggers at times:`,g),g.forEach((e,i)=>{if(c>e){const s=n.currentTime+t+e;console.log(`Scheduling duck ${i+1} at ${e}s (absolute: ${s}s)`),r.gain.cancelScheduledValues(s),r.gain.setValueAtTime(1,s),r.gain.linearRampToValueAtTime(1-o,s+.01),r.gain.linearRampToValueAtTime(1,s+.15)}}),this.audioEngine.playSample=(e,t,s,o,n,a)=>d(e,t,s,o,n,a,u===i?r:this.audioEngine.eq.low),this.executeTone=(e,t)=>u===i?p.call(this,e,t,[r]):p.call(this,e,t,[this.audioEngine.eq.low]);try{const e=[];if(u=i,l>0&&c>l){const s=Math.ceil(c/l);for(let o=0;s>o;o++){const s=t+o*l;t+c>s&&e.push(this.executeBlock(i,s))}}else e.push(this.executeBlock(i,t));if(u=s,h>0&&c>h){const i=Math.ceil(c/h);for(let o=0;i>o;o++){const i=t+o*h;t+c>i&&e.push(this.executeBlock(s,i))}}else e.push(this.executeBlock(s,t));return await Promise.all(e),c}finally{this.audioEngine.playSample=d,this.executeTone=p,u=null}}executeWait(e,t){return this.parseValue(e[1])*this.beatDuration}async executePlay(e,t){const i=[],s={};for(let t=1;t<e.length;t++)if(e[t].includes("=")){const[i,o]=e[t].split("=");s[i]=this.parseValue(o)}else i.push(e[t]);if(0===i.length)return 0;const o=i.map(e=>({name:e,duration:this.estimateDuration(e)})),n=Math.max(...o.map(e=>e.duration),0);if(0===n){const e=i.map(e=>this.executeBlock(e,t,s));return await Promise.all(e),0}const r=[];return o.forEach(e=>{const{name:i,duration:o}=e;if(o>0){const e=Math.ceil(n/o);for(let a=0;e>a&&this.isRunning;a++){const e=t+a*o;t+n>e&&r.push(this.executeBlock(i,e,s))}}else r.push(this.executeBlock(i,t,s))}),await Promise.all(r),n}async executePlayAsync(e,t){const i=[],s={};for(let t=1;t<e.length;t++)if(e[t].includes("=")){const[i,o]=e[t].split("=");s[i]=this.parseValue(o)}else i.push(e[t]);return 0===i.length||Promise.all(i.map(e=>this.executeBlock(e,t,s))).catch(e=>{console.error("Async play error:",e)}),0}async executeLoopAsync(e,t){const i=parseInt(e[1]),s=e.slice(2);for(const e of s)if(!this.blocks.has(e))return console.warn(`Block '${e}' not found`),0;return this.executeAsyncLoop(i,s,t).catch(e=>{console.error("Async loop error:",e)}),0}async executeAsyncLoop(e,t,i){const s=t.map(e=>({name:e,duration:this.estimateDuration(e)})),o=Math.max(...s.map(e=>e.duration),0);if(0===o){for(let s=0;e>s&&this.isRunning;s++){const e=t.map(e=>this.executeBlock(e,i));await Promise.all(e)}return}const n=[];let r=0;for(let t=0;e>t&&this.isRunning;t++){const e=i+r;s.forEach(t=>{const{name:i,duration:s}=t;if(s>0){const t=Math.ceil(o/s);for(let r=0;t>r&&this.isRunning;r++){const t=e+r*s;e+o>t&&n.push(this.executeBlock(i,t))}}else n.push(this.executeBlock(i,e))}),r+=o}await Promise.all(n)}async executeLoop(e,t){const i=parseInt(e[1]),s=e.slice(2);for(const e of s)if(!this.blocks.has(e))return console.warn(`Block '${e}' not found`),0;const o=s.map(e=>({name:e,duration:this.estimateDuration(e)})),n=Math.max(...o.map(e=>e.duration),0);if(0===n){let e=0;for(let o=0;i>o&&this.isRunning;o++){const i=s.map(i=>this.executeBlock(i,t+e));await Promise.all(i)}return 0}const r=[];let a=0;for(let e=0;i>e&&this.isRunning;e++){const e=t+a;o.forEach(t=>{const{name:i,duration:s}=t;if(s>0){const t=Math.ceil(n/s);for(let o=0;t>o&&this.isRunning;o++){const t=e+o*s;e+n>t&&r.push(this.executeBlock(i,t))}}else r.push(this.executeBlock(i,e))}),a+=n}return await Promise.all(r),a}executeSet(e){const t=e[1],i=this.parseValue(e[2]);return this.variables.set(t,i),0}executeEffect(e,t){const i=e[1],s=e[2],o=this.parseParameters(e.slice(3));return this.effects.has(s)||this.effects.set(s,[]),this.effects.get(s).push({type:i,params:o}),0}async executeBlock(e,t,i={}){if(!this.blocks.has(e))return console.warn(`Block '${e}' not found`),0;const s=this.blocks.get(e);let o=0,n=this.audioEngine.eq.low;if(this.effects.has(e)&&this.audioEngine){const t=this.audioEngine.audioContext,i=this.effects.get(e);let s=this.audioEngine.eq.low;for(let e=i.length-1;e>=0;e--){const o=i[e];let n=null,r=null,a=null;if("reverb"===o.type){n=t.createConvolver(),this.audioEngine.reverb&&this.audioEngine.reverb.buffer&&(n.buffer=this.audioEngine.reverb.buffer),r=t.createGain(),a=t.createGain();const e=parseFloat(o.params[0])||.3;r.gain.value=e,a.gain.value=1-e,n.connect(r),r.connect(s),a.connect(s);const i=t.createGain();i.connect(n),i.connect(a),s=i}else if("delay"===o.type){n=t.createDelay(1);const e=parseFloat(o.params[0])||.3,i=parseFloat(o.params[1])||.3,l=parseFloat(o.params[2])||.3;n.delayTime.value=e;const h=t.createGain();h.gain.value=i,n.connect(h),h.connect(n),r=t.createGain(),a=t.createGain(),r.gain.value=l,a.gain.value=1-l,n.connect(r),r.connect(s),a.connect(s);const c=t.createGain();c.connect(n),c.connect(a),s=c}else if("filter"===o.type){n=t.createBiquadFilter();const e=o.params[0]||"lowpass",i=parseFloat(o.params[1])||1e3,r=parseFloat(o.params[2])||1;n.type=e,n.frequency.value=i,n.Q.value=r,n.connect(s),s=n}else if("distortion"===o.type){n=t.createWaveShaper();const e=parseFloat(o.params[0])||10,i=44100,r=new Float32Array(i),a=Math.PI/180;for(let t=0;i>t;t++){const s=2*t/i-1;r[t]=(3+e)*s*20*a/(Math.PI+e*Math.abs(s))}n.curve=r,n.oversample="4x",n.connect(s),s=n}else if("chorus"===o.type){const e=parseFloat(o.params[0])||1,i=parseFloat(o.params[1])||.002,n=parseFloat(o.params[2])||.3,l=t.createDelay(.1),h=t.createDelay(.1),c=t.createOscillator(),d=t.createOscillator(),p=t.createGain(),u=t.createGain();c.frequency.value=e,d.frequency.value=1.1*e,p.gain.value=i,u.gain.value=i,c.connect(p),d.connect(u),p.connect(l.delayTime),u.connect(h.delayTime),l.delayTime.value=.01,h.delayTime.value=.015,r=t.createGain(),a=t.createGain(),r.gain.value=n,a.gain.value=1-n;const g=t.createGain();l.connect(g),h.connect(g),g.connect(r),r.connect(s),a.connect(s);const m=t.createGain();m.connect(l),m.connect(h),m.connect(a),c.start(),d.start(),s=m}}n=s}const r=this.bpm,a=this.beatDuration;try{let e=0;for(;e<s.length;){const i=s[e],r=i.split(/\s+/),a=r[0];if("if"===a){const i=await this.executeIf(r,t+o,s,e);o+=i.duration,e=i.nextIndex}else if("for"===a){const i=await this.executeFor(r,t+o,s,e);o+=i.duration,e=i.nextIndex}else"pattern"===a?(o+=await this.executePattern(r,t+o,n),e++):"sequence"===a?(o+=await this.executeSequence(r,t+o,n),e++):(o+=await this.executeCommand(i,t+o,n),e++)}}finally{this.bpm=r,this.beatDuration=a}return o}findMatchingEndInArray(e,t,i,s){let o=1;for(let n=t+1;n<e.length;n++){const t=e[n].split(/\s+/)[0];if(t===i&&o++,t===s&&o--,0===o)return n}return e.length-1}parseValue(e){if("number"==typeof e)return e;if("string"!=typeof e)return 0;if(this.variables.has(e))return this.variables.get(e);const t=parseFloat(e);return isNaN(t)?0:t}parseParameters(e){const t={};for(const i of e)if(i.includes("=")){const[e,s]=i.split("=");t[e]=this.parseValue(s)}return t}stop(){if(this.isRunning=!1,this.currentPosition=0,this.activeUtterances.length=0,this.activeTTSCalls&&this.activeTTSCalls.clear(),this.scheduledTTS&&this.scheduledTTS.clear(),this.pendingTTSTimeouts){for(const[e,t]of this.pendingTTSTimeouts)clearTimeout(t);this.pendingTTSTimeouts.clear()}this.pendingTTS&&(clearTimeout(this.pendingTTS),this.pendingTTS=null),this.audioEngine&&this.audioEngine.stop(),"undefined"!=typeof speechSynthesis&&speechSynthesis.cancel(),console.log("Code execution stopped and TTS cleared")}getBlockInfo(e){if(!this.blocks.has(e))return null;const t=this.blocks.get(e),i={name:e,commands:t.length,samples:[],tones:[],duration:0};let s=0;for(const e of t){const t=e.split(/\s+/);switch(t[0]){case"sample":i.samples.push(t[1]);break;case"tone":i.tones.push(t[1]),s+=this.parseValue(t[2]||"1");break;case"wait":s+=this.parseValue(t[1])}}return i.duration=s,i}estimateDuration(e="main",t=new Set){if(!this.blocks.has(e))return 0;if(t.has(e))return 0;t.add(e);let i=0,s=this.bpm,o=60/s;const n=this.blocks.get(e);for(let e=0;e<n.length;e++){const r=n[e].split(/\s+/);switch(r[0]){case"wait":i+=parseFloat(r[1])||0;break;case"tone":case"slide":i+=parseFloat(r[2])||1;break;case"bpm":s=parseFloat(r[1])||s,o=60/s;break;case"play":{let e=0;for(let i=1;i<r.length;i++)if(!r[i].includes("=")){const s=this.estimateDuration(r[i],new Set(t));e=Math.max(e,s)}i+=e/o;break}case"loop":{const e=parseInt(r[1])||1;let s=0;for(let e=2;e<r.length;e++){const i=this.estimateDuration(r[e],new Set(t));s=Math.max(s,i)}i+=s/o*e;break}case"pattern":i+=.25*r.slice(2).join(" ").split("-").length;break;case"sequence":i+=.25*(r.length-2);break;case"if":const a=this.findMatchingEnd(n,e,"if","endif");for(let t=e+1;a>t;t++){const e=n[t].split(/\s+/)[0];"wait"===e?i+=parseFloat(n[t].split(/\s+/)[1])||0:"tone"!==e&&"slide"!==e||(i+=parseFloat(n[t].split(/\s+/)[2])||1)}e=a;break;case"for":const l=parseInt(r[2])||1,h=parseInt(r[3])||1,c=Math.max(1,h-l+1),d=this.findMatchingEnd(n,e,"for","endfor");let p=0;for(let t=e+1;d>t;t++){const e=n[t].split(/\s+/)[0];"wait"===e?p+=parseFloat(n[t].split(/\s+/)[1])||0:"tone"!==e&&"slide"!==e||(p+=parseFloat(n[t].split(/\s+/)[2])||1)}i+=p*c,e=d}}return i*o}getAllBlocks(){const e=[];for(const[t,i]of this.blocks)e.push(this.getBlockInfo(t));return e}beatsToSeconds(e){return e*this.beatDuration}formatCode(){let e="";if(this.globalCommands.length>0){e+="// Global Commands\n";for(const t of this.globalCommands)e+=t+"\n";e+="\n"}for(const[t,i]of this.blocks){e+=`[${t}]\n`;for(const t of i)e+="    "+t+"\n";e+="[end]\n\n"}return e.trim()}getDocumentation(){return"\nMelodiCode Syntax Reference:\n\nBLOCKS:\n[block_name]\n    commands...\n[end]\n\n<sample_block_name>\n    commands...\n<end>\n\nCOMMANDS:\nsample <name> [pitch] [timescale] [volume] [pan] [params...]\n    - Play an audio sample\n    - pitch: playback speed multiplier (default: 1)\n    - timescale: time stretch (default: 1)\n    - volume: 0-1 (default: 0.8)\n    - pan: -1 to 1 (default: 0)\n\ntone <frequency|note> [duration] [waveType] [volume] [pan]\n    - Generate a tone\n    - frequency: Hz or note (C4, A#3, etc.)\n    - duration: beats (default: 1)\n    - waveType: sine, square, sawtooth, triangle (default: sine)\n    - volume: 0-1 (default: 0.8)\n    - pan: -1 to 1 (default: 0)\n\nslide <key1> <key2> <timescale> [waveType] [volume] [pan]\n    - Play a tone at key1 and slide to key2 over timescale beats (BPM-based)\n    - Example: slide C4 G4 2 sawtooth 0.7 0\n\nwait <duration>\n    - Pause for specified seconds\n\nbpm <value>\n    - Set the tempo in beats per minute (default: 120)\n    - Example: bpm 140\n\nplay <block1> [block2...] [params...]\n    - Play one or more blocks simultaneously\n    - params: volume=0.8, pan=0, etc.\n\nloop <count> <block_name>\n    - Repeat a block specified number of times\n\nset <variable> <value>\n    - Set a variable value\n\neffect <type> <block> [params...]\n    - Apply effect to a block\n\nTIMING HELPERS:\n- Use beatsToSeconds() method in custom code\n- BPM affects overall timing calculations\n\nEXAMPLES:\n[main]\nbpm 130\nsample kick 1 1\nwait 0.5\ntone C4 0.5\nslide C4 G4 2\n[end]\n\nplay main volume=0.8 pan=0\n        "}}window.codeInterpreter=new CodeInterpreter(window.audioEngine);class MelodiCode{constructor(){this.audioEngine=null,this.codeInterpreter=null,this.isInitialized=!1,this.isPlaying=!1,this.init()}async init(){try{window.audioEngine?this.audioEngine=window.audioEngine:console.warn("MelodiCode: AudioEngine not found, some features may not work"),window.codeInterpreter?this.codeInterpreter=window.codeInterpreter:console.warn("MelodiCode: CodeInterpreter not found, some features may not work"),this.isInitialized=!0,console.log("MelodiCode initialized successfully")}catch(e){console.error("Failed to initialize MelodiCode:",e)}}async play(e,t={}){if(this.isInitialized||(console.warn("MelodiCode not initialized, attempting to initialize..."),await this.init()),!this.codeInterpreter||!this.audioEngine)return console.error("MelodiCode: Required components not available"),!1;try{this.codeInterpreter.parse(e);const i=this.codeInterpreter.validate();return i.valid?(t.bpm&&(this.codeInterpreter.bpm=t.bpm,this.codeInterpreter.beatDuration=60/t.bpm),await this.codeInterpreter.execute(),this.isPlaying=!0,console.log("MelodiCode playback started"),!0):(console.error("MelodiCode validation errors:",i.errors),!1)}catch(e){return console.error("Error playing MelodiCode:",e),!1}}stop(){this.codeInterpreter&&(this.codeInterpreter.stop(),this.isPlaying=!1,console.log("MelodiCode playback stopped"))}playBeat(e,t=120){const i=`\nbpm ${t}\n\n[main]\n    pattern ${e}\n[end]\nplay main\n`;return this.play(i)}playMelody(e,t=1,i=120){const s=`\nbpm ${i}\n\n[main]\n    ${e.map(e=>`tone ${e} ${t}`).join("\n    ")}\n[end]\nplay main\n`;return this.play(s)}playSample(e,t={}){const i=`\n[main]\n    sample ${e} ${t.pitch||1} ${t.timescale||1} ${t.volume||.8} ${t.pan||0}\n[end]\nplay main\n`;return this.play(i)}playTone(e,t=1,i="sine",s={}){const o=s.volume||.8,n=s.pan||0,r=`\nbpm ${s.bpm||120}\n\n[main]\n    tone ${e} ${t} ${i} ${o} ${n}\n[end]\n\nplay main\n`;return this.play(r)}getAvailableSamples(){return this.audioEngine&&"function"==typeof this.audioEngine.getBuiltInSampleNames?this.audioEngine.getBuiltInSampleNames():[]}setMasterVolume(e){this.audioEngine&&"function"==typeof this.audioEngine.setMasterVolume&&this.audioEngine.setMasterVolume(e)}getIsPlaying(){return this.isPlaying}async exportWAV(e=10){if(this.audioEngine&&"function"==typeof this.audioEngine.exportWAV)return await this.audioEngine.exportWAV(e);throw Error("Export functionality not available")}}window.MelodiCode=MelodiCode,window.melodicode=new MelodiCode;class Module{static allowMultiple=!0;static drawInEditor=!0;static namespace="Core";static description="Base module class for game objects";static iconClass="fas fa-cube";constructor(e="Module"){this.type=this.constructor.name,this.name=e,this.gameObject=null,this.enabled=!0,this.ignoreGameObjectTransform=!1,this.properties={},this._requirements=[],this.input=null,this.engine=null}async preload(){this.input||(this.input=window.input),this.engine||(this.engine=window.engine)}start(){this.gameObject||console.warn(`Module ${this.name} has no gameObject reference during start()`)}beginLoop(){}loop(e){this.gameObject||(console.warn(`Module ${this.name} has no gameObject reference during loop()`),this.enabled=!1)}endLoop(){}draw(e){}onDestroy(){}onAttach(e){}onEnable(){}onDisable(){}requires(...e){return this._requirements||(this._requirements=[]),this._requirements.push(...e),this}requireModule(e){this._requirements||(this._requirements=[]),this._requirements.push(e)}require(e){this.requireModule(e)}getRequirements(){return this._requirements||[]}getWorldPosition(){return this.gameObject?this.gameObject.getWorldPosition():new Vector2}getLocalPosition(){return this.gameObject?this.gameObject.position:new Vector2}setLocalPosition(e){this.gameObject&&(this.gameObject.position=e)}getBackgroundCanvas(){return window.engine?window.engine.backgroundCanvas:null}getMainCanvas(){return window.engine?window.engine.mainCanvas:null}getGUICanvas(){return window.engine?window.engine.guiCanvas:null}getModule(e){return this.gameObject?this.gameObject.getModule(e):null}get viewport(){return window.engine?window.engine.viewport:null}instanceNearest(e,t=1/0){this.gameObject.getNearestObject(e,t)}getAllGameObjects(){return window.engine?window.engine.getAllObjects():null}getGameObjectByName(e){return window.engine?window.engine.getGameObjectByName(e):null}findGameObject(e){return this.getGameObjectByName(e)}instanceCreate(e,t,i,s=!0){if(window.engine){let o=null;if(o=window.engine.objectsToCreate&&window.engine.objectsToCreate.has(i)?window.engine.objectsToCreate.get(i):this.getGameObjectByName(i),window.engine.objectsToCreate&&!window.engine.objectsToCreate.has(i)&&window.engine.objectsToCreate.set(i,o),o){const n=o.clone();return n.position.x=e,n.position.y=t,s&&(o.parent&&o.parent.removeChild(o),o.onDestroy()),n.start(),window.engine.addGameObject(n),console.log(`Module ${this.name} created instance of '${i}' at (${Math.round(e)}, ${Math.round(t)})`),n}console.warn(`Module ${this.name} failed to instanceCreate: GameObject '${i}' not found.`)}}async instanceCreateFromPrefab(e,t,i){if(!window.engine)return console.warn(`Module ${this.name} failed to prefabCreate: Engine not available.`),null;if(!i)return console.warn(`Module ${this.name} failed to prefabCreate: No prefab name provided.`),null;try{const s=await window.engine.instantiatePrefab(i,e,t);return s?(console.log(`Module ${this.name} created prefab instance '${i}' at (${Math.round(e)}, ${Math.round(t)})`),s):(console.warn(`Module ${this.name} failed to prefabCreate: Prefab '${i}' not found.`),console.log("Available prefabs:",window.engine.getAvailablePrefabs()),null)}catch(e){return console.error(`Module ${this.name} error creating prefab '${i}':`,e),null}}clone(e=null){const t=new this.constructor(this.name);this._image&&this._isImageLoaded&&(t._image=this._image,t._isImageLoaded=!0,t._imageWidth=this._imageWidth,t._imageHeight=this._imageHeight,this.imageAsset&&this.imageAsset.embedded?t.imageAsset={path:null,type:"image",embedded:!0,load:()=>Promise.resolve(this._image)}:this.imageAsset&&(t.imageAsset={...this.imageAsset}));const i=new Set([...Object.getOwnPropertyNames(this),...Object.keys(this)]);i.delete("gameObject"),i.delete("_gameObject"),i.delete("_previousGameObject"),i.delete("constructor");for(const e of i){const i=this[e];null==i||"function"==typeof i?t[e]=i:Array.isArray(i)?t[e]=i.map(e=>e&&"function"==typeof e.clone?e.clone():e):"function"==typeof i.clone?t[e]=i.clone():t[e]="object"==typeof i?JSON.parse(JSON.stringify(i)):i}return t._gameObject=null,t._previousGameObject=null,e&&t.attachTo(e),t}deepCloneArray(e){return e?e.map(e=>null==e||"object"!=typeof e?e:"function"==typeof e.clone?e.clone():Array.isArray(e)?this.deepCloneArray(e):e instanceof HTMLElement?e:this.deepCloneObject(e)):e}deepCloneObject(e){if(!e)return e;if("function"==typeof e.clone)return e.clone();if(e instanceof HTMLElement)return e;const t=Object.create(Object.getPrototypeOf(e));for(const i in e){if(!{}.hasOwnProperty.call(e,i))continue;const s=e[i];null==s||"object"!=typeof s?t[i]=s:"function"==typeof s.clone?t[i]=s.clone():Array.isArray(s)?t[i]=this.deepCloneArray(s):s instanceof HTMLElement?t[i]=s:t[i]=this.deepCloneObject(s)}return t}registerModuleClass(e){e&&e.prototype instanceof Module?this.availableModules.some(t=>t.name===e.name||t===e)||(this.availableModules.push(e),console.log("Registered module: "+e.name),this.moduleDropdown&&"none"!==this.moduleDropdown.style.display&&this.populateModuleDropdown()):console.error("Not a valid module class:",e)}getExposedProperties(){let e=this.exposedProperties||[];for(const t in this.properties)e.some(e=>e.name===t)||e.push({name:t,type:typeof this.properties[t],value:this.properties[t]});return e}exposeProperty(e,t,i,s={}){this.exposedProperties||(this.exposedProperties=[]),this.exposedProperties.push({name:e,type:t,value:i,options:s});const o="_"+e;void 0===this[o]&&(this[o]=void 0!==this[e]?this[e]:i),Object.getOwnPropertyDescriptor(this,e)||Object.defineProperty(this,e,{get:function(){return this[o]},set:function(t){const i=this[o];this[o]=t;const s=this.exposedProperties?.find(t=>t.name===e);s?.options?.onChange&&i!==t&&s.options.onChange.call(this,t)},enumerable:!0,configurable:!0}),this[e]!==this[o]&&(this[e]=this[o])}enable(){this.enabled=!0,this.onEnable()}disable(){this.enabled=!1,this.onDisable()}toggle(){this.enabled=!this.enabled,this.enabled?this.onEnable():this.onDisable()}setProperty(e,t){const i="_"+e;this.hasOwnProperty(i)?this[i]=t:this[e]=t;const s=this.exposedProperties?.find(t=>t.name===e);s?.options?.onChange&&s.options.onChange.call(this,t)}getProperty(e,t){const i="_"+e;return this.hasOwnProperty(i)?this[i]:void 0!==this[e]?this[e]:t}attachTo(e){this._previousGameObject=null,this._gameObject=e,this._previousGameObject=e,"function"==typeof this.onAttach&&this.onAttach(e)}set gameObject(e){this._gameObject=e,e&&this._previousGameObject&&this._previousGameObject!==e&&this._updateInternalReferences(this._previousGameObject,e),this._previousGameObject=e}get gameObject(){return this._gameObject}get viewport(){return window.engine?window.engine.viewport:null}toJSON(){const e={name:this.name,type:this.constructor.name,enabled:this.enabled,requirements:this._requirements};if(e.properties={...this.properties},e.exposedValues={},Array.isArray(this.exposedProperties))for(const t of this.exposedProperties){const i=t.name,s=this[i];void 0!==s&&(s&&"object"==typeof s&&"function"==typeof s.toJSON?e.exposedValues[i]=s.toJSON():e.exposedValues[i]=s instanceof Vector2?{x:s.x,y:s.y}:s)}if("function"==typeof this._serializeCustomData){const t=this._serializeCustomData();t&&"object"==typeof t&&(e.customData=t)}return e}fromJSON(e){if(!e)return this;if(this.name=e.name||this.name,this.enabled=void 0!==e.enabled?e.enabled:this.enabled,this._requirements=e.requirements||this._requirements||[],this.properties=e.properties||{},e.exposedValues)for(const t in e.exposedValues){const i=e.exposedValues[t];i&&"object"==typeof i&&"x"in i&&"y"in i&&"object"==typeof this[t]&&this[t]instanceof Vector2?(this[t].x=i.x,this[t].y=i.y):this[t]&&"object"==typeof this[t]&&"function"==typeof this[t].fromJSON&&i?this[t].fromJSON(i):"function"==typeof this.setProperty?this.setProperty(t,i):this[t]=i}return e.customData&&"function"==typeof this._deserializeCustomData&&this._deserializeCustomData(e.customData),this}_updateInternalReferences(e,t){if(!e||!t||e===t)return;const i=i=>{if(!i||"object"!=typeof i)return;if(i instanceof HTMLElement)return;const s=new WeakSet,o=i=>{if(!i||"object"!=typeof i||s.has(i))return;s.add(i);for(const n in i)try{const r=i[n];if(r===e){i[n]=t;continue}r&&"object"==typeof r&&!s.has(r)&&o(r)}catch(e){}const n=Object.getOwnPropertyNames(i);for(const r of n)try{if("constructor"===r||"prototype"===r||"__proto__"===r)continue;const n=Object.getOwnPropertyDescriptor(i,r);if(n&&n.get&&!n.configurable)continue;const a=i[r];if(a===e){i[r]=t;continue}a&&"object"==typeof a&&!s.has(a)&&o(a)}catch(e){}};o(i)};for(const s in this)if("gameObject"!==s&&"_gameObject"!==s&&"_previousGameObject"!==s){const o=this[s];o===e?this[s]=t:o&&"object"==typeof o&&i(o)}}_serializeCustomData(){return null}_deserializeCustomData(e){}}window.Module=Module;class ModuleRegistry{constructor(){this.modules=new Map,this.listeners=[]}register(e){return e&&e.prototype instanceof Module?!this.modules.has(e.name)&&(this.modules.set(e.name,e),console.log("Registered module: "+e.name),this.notifyListeners("register",e),!0):(console.error("Cannot register invalid module class:",e),!1)}unregister(e){const t="string"==typeof e?e:e.name,i=this.modules.get(t);return!!i&&(this.modules.delete(t),console.log("Unregistered module: "+t),this.notifyListeners("unregister",i),!0)}getModuleClass(e){return this.modules.get(e)||null}getAllModules(){return Array.from(this.modules.values())}addListener(e){"function"!=typeof e||this.listeners.includes(e)||this.listeners.push(e)}removeListener(e){const t=this.listeners.indexOf(e);-1!==t&&this.listeners.splice(t,1)}notifyListeners(e,t){this.listeners.forEach(i=>{try{i(e,t)}catch(e){console.error("Error in module registry listener:",e)}})}}window.moduleRegistry=new ModuleRegistry;class ModuleReloader{constructor(){this.moduleRegistry=window.moduleRegistry||null,this.scriptCache=new Map}reloadModuleClass(e,t){try{if("EditorWindow"===e||e.endsWith("EditorWindow"))return!1;if(this.scriptCache.set(e,t),/^\s*(import|export)\s/m.test(t))return console.error(`Module script for ${e} contains ES module syntax (import/export). Cannot reload dynamically.`),!1;const i=Function(`\n            try {\n                (function() {\n                    ${t}\n                })();\n                return ${e};\n            } catch (error) {\n                console.error("Error evaluating module script:", error);\n                return null;\n            }\n        `)();return i?(window[e]=i,this.moduleRegistry?this.moduleRegistry.register(i):console.warn("ModuleRegistry not available, could not register updated module"),console.log("Successfully reloaded module: "+e),!0):(console.error(`Failed to reload module ${e}: Script did not return a class`),!1)}catch(t){return console.error(`Error reloading module ${e}:`,t),!1}}updateModuleInstances(e,t){let i=0;const s=window[e];if(!s)return console.error(`Cannot update instances of ${e}: Class not found`),0;const o=t=>{t.forEach(t=>{t.modules.forEach((o,n)=>{if(o.constructor.name===e){const e={};Object.keys(o).forEach(t=>{"constructor"!==t&&"function"!=typeof o[t]&&(e[t]=o[t])});const r=new s;r.gameObject=t,r.enabled=o.enabled,r.id=o.id,Object.keys(e).forEach(t=>{"gameObject"!==t&&"constructor"!==t&&(r[t]=e[t])}),t.modules[n]=r,i++}}),t.children&&t.children.length>0&&o(t.children)})};return o(t),i}}window.moduleReloader=new ModuleReloader;class ModulesManager{constructor(){this.loadedModules=new Map,this.coreModules=["SpriteRenderer","RigidBody","Collider","BoundingBoxCollider","DrawCircle","DrawRectangle"]}initializeCoreModules(){if(console.log("Initializing core modules..."),window.moduleRegistry){for(const e of this.coreModules)window[e]?(console.log("Registering core module: "+e),window.moduleRegistry.register(window[e]),this.loadedModules.set(e,window[e])):console.error("Core module not found: "+e);console.log("Core modules initialized")}else console.error("ModuleRegistry not found, modules cannot be loaded")}getAvailableModules(){return Array.from(this.loadedModules.keys())}createModule(e){const t=this.loadedModules.get(e);if(t)try{return new t}catch(t){return console.error(`Error creating module ${e}:`,t),null}return null}}window.modulesManager=new ModulesManager;class GameObject{constructor(e="GameObject",t=null){this.name=e,this.position=new Vector2,this.size=new Vector2(50,50),this.useCollisions=!1,this.origin=new Vector2(.5,.5),this.scale=new Vector2(1,1),this.angle=0,this.depth=0,this.depthToY=!1,this.visible=!0,this.modules=[],this.children=[],this.parent=null,this.active=!0,this.colliderWidth=this.size.x,this.colliderHeight=this.size.y,this.tags=[],this.selected=!1,this.expanded=!1,this.editorColor=this.generateRandomColor(),this.id=crypto.randomUUID(),this.usePolygonCollision=!1,this.polygonPointCount=3,this.polygonAngleOffset=0,this.polygonPoints=[],this.polygon=null,this.engine=t,this.xd=0,this.yd=0,this.collisionEnabled=!0,this.collisionLayer=0,this.collisionMask=65535,this.originalPosition=this.position.clone(),this.originalRotation=this.angle,this.previousPosition=this.position.clone(),this.usePolygonCollision&&this.generatePolygonPoints()}getNearestObject(e,t=1/0){return(window.engine||this.engine||null).findNearestObjectByName(this.position.x,this.position.y,e,t)}generateRandomColor(){const e=Math.floor(360*Math.random()),t=.56,i=t*(1-Math.abs(e/60%2-1)),s=.6-t/2;let o,n,r;return e>=0&&60>e?(o=t,n=i,r=0):e>=60&&120>e?(o=i,n=t,r=0):e>=120&&180>e?(o=0,n=t,r=i):e>=180&&240>e?(o=0,n=i,r=t):e>=240&&300>e?(o=i,n=0,r=t):(o=t,n=0,r=i),o=Math.round(255*(o+s)),n=Math.round(255*(n+s)),r=Math.round(255*(r+s)),`#${o.toString(16).padStart(2,"0")}${n.toString(16).padStart(2,"0")}${r.toString(16).padStart(2,"0")}`}getOriginalPosition(){return this.originalPosition||this.position.clone()}async preload(){for(const e of this.modules)try{e.enabled&&e.preload&&await e.preload()}catch(t){console.error(`Error in module ${e.type||e.constructor.name} preload on ${this.name}:`,t)}for(const e of this.children)await e.preload()}start(){this.active&&(this.originalPosition=this.position.clone(),this.originalRotation=this.angle,this.modules.forEach(e=>{try{e.enabled&&e.start&&e.start()}catch(t){console.error(`Error in module ${e.type||e.constructor.name} start on ${this.name}:`,t)}}),this.children.forEach(e=>e.start()))}beginLoop(){this.active&&(this.colliderWidth=this.size.x,this.colliderHeight=this.size.y,this.previousPosition=this.position.clone(),this.modules.forEach(e=>{try{e.enabled&&e.beginLoop&&e.beginLoop()}catch(t){console.error(`Error in module ${e.type||e.constructor.name} beginLoop on ${this.name}:`,t)}}),this.children.forEach(e=>e.beginLoop()))}loop(e){this.active&&(this.depthToY&&(this.depth=Math.floor(this.position.y)),this.usePolygonCollision&&this.polygon&&this.polygon.update(this.position.clone(),this.angle+this.polygonAngleOffset),this.modules.forEach(t=>{try{t.enabled&&t.loop&&t.loop(e)}catch(e){console.error(`Error in module ${t.type||t.constructor.name} loop on ${this.name}:`,e)}}),this.children.forEach(t=>t.loop(e)))}endLoop(){this.active&&(this.modules.forEach(e=>{try{e.enabled&&e.endLoop&&e.endLoop()}catch(t){console.error(`Error in module ${e.type||e.constructor.name} endLoop on ${this.name}:`,t)}}),this.children.forEach(e=>e.endLoop()))}draw(e){if(!this.active||!this.visible)return;if(window.engine&&window.engine.usePixi&&window.engine.pixiRenderer&&e===window.engine.pixiRenderer){this.pixiDisplayObject||(this.createPixiDisplayObject(),window.engine.pixiRenderer.addDisplayObject(this.pixiDisplayObject)),this.updatePixiDisplayObject();for(const t of this.modules)if(t.enabled&&"function"==typeof t.draw)try{t.draw(e,this.pixiDisplayObject)}catch(e){console.error(`Error in module ${t.type||t.constructor.name} draw (Pixi) on ${this.name}:`,e)}return void this.children.forEach(t=>{t.active&&t.visible&&t.draw(e)})}e.save();const t=this.getWorldPosition(),i=this.getWorldRotation(),s=this.getWorldScale();e.translate(t.x,t.y),e.rotate(i*Math.PI/180),e.scale(s.x,s.y);let o=!1;for(const n of this.modules)if(n.enabled&&"function"==typeof n.draw)try{n.ignoreGameObjectTransform?(e.restore(),n.draw(e),e.save(),e.translate(t.x,t.y),e.rotate(i*Math.PI/180),e.scale(s.x,s.y)):n.draw(e),o=!0}catch(e){console.error(`Error in module ${n.type||n.constructor.name} draw on ${this.name}:`,e)}e.restore(),this.children.forEach(t=>{t.active&&t.visible&&t.draw(e)})}drawInEditor(e){if(!this.active)return;e.save();const t=this.getWorldPosition(),i=this.getWorldRotation(),s=this.getWorldScale();e.translate(t.x,t.y),e.rotate(i*Math.PI/180),e.scale(s.x,s.y);let o=!1;for(const t of this.modules)if(t.enabled&&"function"==typeof t.draw)try{if(!1===t.drawInEditor)continue;const i=document.createElement("canvas");i.width=100,i.height=100;const s=i.getContext("2d");s.clearRect(0,0,i.width,i.height),s.save(),s.translate(50,50);const n=s.getImageData(0,0,100,100).data;t.draw(s);const r=s.getImageData(0,0,100,100).data;let a=!1;for(let e=0;e<n.length;e+=4)if(n[e]!==r[e]||n[e+1]!==r[e+1]||n[e+2]!==r[e+2]||n[e+3]!==r[e+3]){a=!0;break}if(s.restore(),!a)continue;t.draw(e),o=!0}catch(e){console.error(`Error drawing module ${t.type||t.constructor.name} in editor:`,e)}if(!o){const t=20;e.beginPath(),e.rect(-t/2,-t/2,t,t),e.fillStyle=this.selected?"#ffffff":this.editorColor,e.fill(),e.beginPath(),e.arc(0,0,2,0,2*Math.PI),e.fillStyle="#ff0000",e.fill()}e.beginPath(),e.moveTo(0,0),e.lineTo(30,0),e.strokeStyle="#ffcc00",e.lineWidth=2/(this.editor?.camera?.zoom||1),e.stroke(),e.beginPath(),e.moveTo(30,0),e.lineTo(25,-3),e.lineTo(25,3),e.closePath(),e.fillStyle="#ffcc00",e.fill(),!this.usePolygonCollision&&this.useCollisions&&(e.beginPath(),e.rect(-this.size.x/2,-this.size.y/2,this.size.x,this.size.y),e.setLineDash([5,3]),e.strokeStyle="#00ff00",e.lineWidth=1/(this.editor?.camera?.zoom||1),e.stroke(),e.setLineDash([])),this.usePolygonCollision&&this.polygon&&(e.save(),e.setLineDash([5,3]),e.rotate((this.polygonAngleOffset||0)*Math.PI/180),this.polygon.draw(e,"#00ff00"),e.setLineDash([]),e.restore()),this.selected&&(e.strokeStyle="#00aaff",e.lineWidth=2/(this.editor?.camera?.zoom||1),e.strokeRect(-10,-10,20,20)),e.restore(),this.selected&&(e.fillStyle="#ffffff",e.font="12px Arial",e.textAlign="center",e.textBaseline="bottom",e.fillText(this.name,t.x,t.y-25)),this.children.forEach(t=>{t.active&&t.drawInEditor(e)})}getBoundingBox(){const e=this.getWorldPosition(),t=this.getWorldScale(),i=this.getWorldRotation(),s=this.width*t.x,o=this.height*t.y;return i%360==0?{x:e.x-s/2,y:e.y-o/2,width:s,height:o,rotation:0}:{x:e.x,y:e.y,width:s,height:o,rotation:i}}drawFallbackShape(e){e.beginPath(),e.arc(0,0,10,0,2*Math.PI),e.fillStyle=this.editorColor||"#ffffff",e.fill(),e.strokeStyle="#ffffff",e.lineWidth=1,e.stroke()}onDestroy(){this.modules.forEach(e=>{e.onDestroy&&e.onDestroy()}),this.children.forEach(e=>e.onDestroy()),window.engine.gameObjects=window.engine.gameObjects.filter(e=>e!==this)}destroy(){this.onDestroy()}collidesWithNearby(e,t,i){const s=i||window.gameObjects||[],o=this.getWorldPosition();for(const i of s)if(i!==this&&i.name===e&&i.active&&i.visible&&i.collisionEnabled){const e=i.getWorldPosition(),s=e.x-o.x,n=e.y-o.y;if(t*t>=s*s+n*n&&this.collidesWith(i))return i}return null}collidesWith(e){if(!this.collisionEnabled||!e.collisionEnabled)return!1;if(0===(this.collisionLayer&e.collisionMask)&&0===(e.collisionLayer&this.collisionMask))return!1;const t=this.getBoundingBox(),i=e.getBoundingBox();return t.x<i.x+i.width&&t.x+t.width>i.x&&t.y<i.y+i.height&&t.y+t.height>i.y}checkForCollisions(){const e=[];return window.engine.getAllObjects().forEach(t=>{t!==this&&this.collidesWith(t)&&t.collisionEnabled&&e.push(t)}),e}setCollision(e,t=65535){this.collisionLayer=e,this.collisionMask=t}setCollisionEnabled(e){this.collisionEnabled=e}collidesWithPolygon(e){return!(!this.usePolygonCollision||!e.usePolygonCollision)&&!(!this.polygon||!e.polygon)&&this.polygon.collidesWith(e.polygon)}polygonContainsPoint(e,t){return!(!this.usePolygonCollision||!this.polygon)&&this.polygon.collisionPoint(e,t)}checkPolygonCollisions(){return this.usePolygonCollision&&this.polygon?window.engine.getAllObjects().filter(e=>e!==this&&e.usePolygonCollision&&e.polygon&&this.collidesWithPolygon(e)):[]}generatePolygonPoints(){const e=Math.max(3,this.polygonPointCount),t=Math.max(this.size.x,this.size.y)/2;this.polygonPoints=[];for(let i=0;e>i;i++){const s=2*Math.PI*i/e,o=this.position.x+Math.cos(s)*t,n=this.position.y+Math.sin(s)*t;this.polygonPoints.push(new Vector2(o,n))}this.polygon=new Polygon(this,this.position.clone(),...this.polygonPoints.map(e=>e.clone()))}addModule(e){if(!e)return null;const t=e.constructor;if(!1===t.allowMultiple){const e=this.getModuleByType(t.name);if(e)return console.warn(`Only one ${t.name} allowed on a GameObject.`),e}e.id||(e.id=crypto.randomUUID?crypto.randomUUID():`m-${Date.now()}-${Math.random().toString(36).substring(2,9)}`);const i=e.getRequirements?e.getRequirements():[];for(const t of i)if(!this.getModuleByType(t)){console.log(`Adding required module: ${t} for ${e.constructor.name}`);let i=null;if(window.moduleRegistry&&(i=window.moduleRegistry.getModuleClass(t)),!i&&window[t]&&(i=window[t]),i){const e=new i;this.addModule(e)}else console.warn(`Required module ${t} not found`)}return e.gameObject=this,this.modules.push(e),"function"==typeof e.onAttach&&e.onAttach(this),e}addRequiredModules(e){const t=e.getRequirements?e.getRequirements():[];for(const i of t)if(!this.getModuleByType(i)){console.log(`Module ${e.constructor.name} requires ${i}, adding it automatically`);let t=null;if(window.moduleRegistry&&(t=window.moduleRegistry.getModuleClass(i)),!t&&window[i]&&(t=window[i]),t){const e=new t;this.addRequiredModules(e),e.gameObject=this,e.id=crypto.randomUUID?crypto.randomUUID():`m-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,this.modules.push(e),"function"==typeof e.onAttach&&e.onAttach(this)}else console.warn(`Required module ${i} not found, cannot add automatically`)}}getModule(e){return"string"==typeof e?this.modules.find(t=>t.constructor.name===e||t.type===e):"function"==typeof e?this.modules.find(t=>t instanceof e):null}reorderModules(e){if(!e||!e.length)return;const t=[];for(const i of e){const e=this.getModuleById(i);e&&t.push(e)}for(const e of this.modules)t.includes(e)||t.push(e);this.modules=t}getModuleByType(e){return this.modules.find(t=>t.constructor.name===e||t.type===e)}getModuleById(e){return this.modules.find(t=>t.id===e)||null}removeModule(e){const t=this.modules.indexOf(e);return-1!==t&&(e.gameObject=null,this.modules.splice(t,1),e.onDestroy&&e.onDestroy(),!0)}removeModuleByType(e){const t=this.getModule(e);return!!t&&this.removeModule(t)}addChild(e){return e.parent&&e.parent.removeChild(e),e.parent=this,this.children.push(e),e}removeChild(e){const t=this.children.indexOf(e);return-1!==t&&(this.children.splice(t,1),e.parent=null,!0)}setActive(e){this.active=e}toggleActive(){this.active=!this.active}addTag(e){this.tags.includes(e)||this.tags.push(e)}hasTag(e){return this.tags.includes(e)}removeTag(e){const t=this.tags.indexOf(e);-1!==t&&this.tags.splice(t,1)}findChild(e,t=!0){for(const t of this.children)if(t.name===e)return t;if(t)for(const t of this.children){const i=t.findChild(e,!0);if(i)return i}return null}setSelected(e){this.selected=e}rename(e){this.name=e}getWorldPositionOriginal(){let e=this.position.clone();if(this.parent){const t=this.parent.getWorldPosition();e=e.rotate(this.parent.angle*Math.PI/180),e=e.add(t)}return e}getWorldPosition(){let e=this.position.clone(),t=this.parent,i=0;for(;t;)i+=t.angle,t=t.parent;return e=e.rotate(i*Math.PI/180),this.parent&&(e=e.add(this.parent.getWorldPosition())),e.x=Math.round(100*e.x)/100,e.y=Math.round(100*e.y)/100,e}worldToLocalPosition(e){if(!this.parent)return e.subtract(this.position);const t=this.parent.getWorldPosition();let i=e.subtract(t);return i=i.rotate(-this.parent.angle*Math.PI/180),i.subtract(this.position)}getWorldRotation(){let e=this.angle,t=this.parent;for(;t;)e+=t.angle,t=t.parent;return e}getWorldScale(){let e=this.scale.clone(),t=this.parent;for(;t;)e.x*=t.scale.x,e.y*=t.scale.y,t=t.parent;return e}createPixiDisplayObject(){const e=new PIXI.Graphics;return e.beginFill(16777215),e.drawRect(-this.size.x/2,-this.size.y/2,this.size.x,this.size.y),e.endFill(),e.pivot.set(0,0),e.x=this.position.x,e.y=this.position.y,e.rotation=this.angle*Math.PI/180,e.scale.set(this.scale.x,this.scale.y),e.visible=this.visible,this.pixiDisplayObject=e,e}updatePixiDisplayObject(){this.pixiDisplayObject&&(this.pixiDisplayObject.x=this.position.x,this.pixiDisplayObject.y=this.position.y,this.pixiDisplayObject.rotation=this.angle*Math.PI/180,this.pixiDisplayObject.scale.set(this.scale.x,this.scale.y),this.pixiDisplayObject.visible=this.visible)}toJSON(){return{id:this.id,name:this.name,position:{x:this.position.x,y:this.position.y},scale:{x:this.scale.x,y:this.scale.y},useCollisions:this.useCollisions,polygonPointCount:this.polygonPointCount,polygonPoints:this.polygonPoints.map(e=>({x:e.x,y:e.y})),usePolygonCollision:this.usePolygonCollision,polygon:this.polygon?this.polygon.toJSON():null,size:this.size?{width:this.size.x,height:this.size.y}:{width:50,height:50},colliderWidth:this.colliderWidth||0,colliderHeight:this.colliderHeight||0,angle:this.angle,depth:this.depth,active:this.active,editorColor:this.editorColor,visible:this.visible,tags:[...this.tags],collisionEnabled:this.collisionEnabled,collisionLayer:this.collisionLayer,collisionMask:this.collisionMask,modules:this.modules.map(e=>({type:e.constructor.name,id:e.id,data:e.toJSON?e.toJSON():{}})),children:this.children.map(e=>e.toJSON())}}static fromJSON(e){const t=new GameObject(e.name);return t.id=crypto.randomUUID(),t.colliderWidth=e.colliderWidth||0,t.colliderHeight=e.colliderHeight||0,t.position=new Vector2(e.position.x,e.position.y),t.useCollisions=e.useCollisions||!1,t.size=e.size?new Vector2(e.size.width,e.size.height):new Vector2(50,50),e.scale&&(t.scale=new Vector2(e.scale.x,e.scale.y)),t.editorColor=e.editorColor||t.generateRandomColor(),void 0!==e.polygonPointCount&&(t.polygonPointCount=e.polygonPointCount),e.polygonPoints&&Array.isArray(e.polygonPoints)&&(t.polygonPoints=e.polygonPoints.map(e=>new Vector2(e.x,e.y)),t.polygon=new Polygon(t,t.position.clone(),...t.polygonPoints.map(e=>e.clone()))),void 0!==e.usePolygonCollision&&(t.usePolygonCollision=e.usePolygonCollision),t.angle=e.angle,t.depth=e.depth,t.active=e.active,void 0!==e.visible&&(t.visible=e.visible),t.tags=Array.isArray(e.tags)?[...e.tags]:[],void 0!==e.collisionEnabled&&(t.collisionEnabled=e.collisionEnabled),void 0!==e.collisionLayer&&(t.collisionLayer=e.collisionLayer),void 0!==e.collisionMask&&(t.collisionMask=e.collisionMask),e.modules&&Array.isArray(e.modules)&&e.modules.forEach(e=>{const i=e.type;let s=null;if(window.moduleRegistry&&(s=window.moduleRegistry.getModuleClass(i)),!s)if(window[i])s=window[i];else if(i){const e=i.charAt(0).toLowerCase()+i.slice(1);window[e]&&(s=window[e]);const t=i.charAt(0).toUpperCase()+i.slice(1);window[t]&&(s=window[t])}if(s)try{const o=new s;if(e.id&&(o.id=e.id),o.type=i,e.data&&"function"==typeof o.fromJSON)o.fromJSON(e.data);else if(e.exposedValues)for(const t in e.exposedValues)t in o&&(o[t]=e.exposedValues[t]);t.addModule(o)}catch(s){console.error(`Error restoring module ${i}:`,s),createPlaceholderModule(t,e,i)}else console.warn(`Module class ${i} not found when restoring game object.`),createPlaceholderModule(t,e,i)}),e.children.forEach(e=>{const i=GameObject.fromJSON(e);t.addChild(i)}),t}copyModuleProperties(e,t,i){if(!e||!t||!i)return void console.warn("copyModuleProperties: Missing required arguments");const s=this,o=new Set([...Object.getOwnPropertyNames(e),...Object.keys(e)]);for(const n of o)try{if("id"===n||"gameObject"===n||"constructor"===n||n.startsWith("__")||"function"==typeof e[n])continue;const o=e[n];null==o?t[n]=o:o===s||o===e.gameObject?t[n]=i:o instanceof Vector2?t[n]=o.clone():Array.isArray(o)?t[n]=deepCloneArray(o,s,i):"object"!=typeof o||null===o||o instanceof HTMLElement?t[n]=o:"function"==typeof o.clone?t[n]=o.clone():t[n]=deepCloneWithReplacements(o,s,i)}catch(t){console.warn(`Error cloning property ${n} in module ${e.constructor.name}:`,t)}if(Array.isArray(e.exposedProperties))for(const o of e.exposedProperties){const n="_"+o.name;if(n in e){const o=e[n];o===s?t[n]=i:"object"==typeof o&&null!==o?"function"==typeof o.clone?t[n]=o.clone():t[n]=deepCloneWithReplacements(o,s,i):t[n]=o}}}deepCloneObject(e,t){if(!e)return e;try{if(e instanceof HTMLElement)return e;if("function"==typeof e.clone)return e.clone();const i={};for(const s in e){if(!{}.hasOwnProperty.call(e,s))continue;const o=e[s];o===this||o===this.gameObject?i[s]=t:o instanceof Vector2?i[s]=o.clone():Array.isArray(o)?i[s]=this.deepCloneArray(o,t):"object"!=typeof o||null===o||o instanceof HTMLElement?i[s]=o:i[s]=this.deepCloneObject(o,t)}return i}catch(e){return console.warn("Failed to deep clone object:",e),{}}}deepCloneArray(e,t,i){return e?e.map(e=>e===t||e===t.gameObject?i:null==e||"object"!=typeof e?e:"function"==typeof e.clone?e.clone():Array.isArray(e)?this.deepCloneArray(e,t,i):e instanceof HTMLElement?e:this.deepCloneWithReplacements(e,t,i)):e}deepCloneWithReplacements(e,t,i){if(!e)return e;if(e===t)return i;if("object"!=typeof e||e instanceof HTMLElement)return e;if("function"==typeof e.clone)return e.clone();if(e instanceof Date)return new Date(e.getTime());if(Array.isArray(e))return this.deepCloneArray(e,t,i);const s=Object.create(Object.getPrototypeOf(e));for(const o in e){if(!{}.hasOwnProperty.call(e,o))continue;const n=e[o];n===t||n===t.gameObject?s[o]=i:null==n||"object"!=typeof n?s[o]=n:"function"==typeof n.clone?s[o]=n.clone():n instanceof HTMLElement?s[o]=n:s[o]=Array.isArray(n)?this.deepCloneArray(n,t,i):this.deepCloneWithReplacements(n,t,i)}return s}replaceMissedReferences(e,t){if(!e||"object"!=typeof e)return;const i=new Set;(function e(s){if(s&&"object"==typeof s&&!i.has(s)){i.add(s);for(const o in s){if(!{}.hasOwnProperty.call(s,o))continue;if("gameObject"===o)continue;const n=s[o];n===this?s[o]=t:n&&"object"==typeof n&&!i.has(n)&&e(n)}}}).call(this,e)}deepScanAndReplaceAllReferences(e,t,i){if(!e||"object"!=typeof e)return;const s=new WeakMap,o=e=>{if(e&&"object"==typeof e&&!s.has(e)){s.set(e,!0);for(const n in e){if(!{}.hasOwnProperty.call(e,n))continue;const r=e[n];r!==t&&r!==t.gameObject?"object"!=typeof r||null===r||s.has(r)||o(r):e[n]=i}}};o(e)}clone(e=!0){let t=this.name;e&&!t.trim().endsWith("(Copy)")&&(t+=" (Copy)");const i=GameObject.fromJSON(this.toJSON());return i.name=t,i.id=crypto.randomUUID?crypto.randomUUID():`go-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,i}}function deepScanAndReplaceAllReferences(e,t,i){if(!e||"object"!=typeof e)return;const s=new WeakMap,o=e=>{if(e&&"object"==typeof e&&!s.has(e)){s.set(e,!0);for(const n in e){if(!{}.hasOwnProperty.call(e,n))continue;const r=e[n];r!==t&&r!==t.gameObject||(console.log(`Replacing reference in ${e.constructor.name}.${n}`),e[n]=i),"object"!=typeof r||null===r||s.has(r)||o(r)}}};o(e)}function findModuleClass(e){if(!e)return null;if(window.moduleRegistry){const t=window.moduleRegistry.getModuleClass(e);if(t)return t}if(window[e])return window[e];const t=e.charAt(0).toLowerCase()+e.slice(1);if(window[t])return window[t];const i=e.charAt(0).toUpperCase()+e.slice(1);return window[i]?window[i]:null}function copyModuleProperties(e,t,i,s){if(!(e&&t&&i&&s))return void console.warn("copyModuleProperties: Missing required arguments");const o=new Set([...Object.getOwnPropertyNames(e),...Object.keys(e)]);for(const n of o)try{if("id"===n||"gameObject"===n||"constructor"===n||n.startsWith("__")||"function"==typeof e[n])continue;const o=e[n];null==o?t[n]=o:o===s||o===e.gameObject?t[n]=i:o instanceof Vector2?t[n]=o.clone():Array.isArray(o)?t[n]=deepCloneArray(o,s,i):"object"!=typeof o||null===o||o instanceof HTMLElement?t[n]=o:"function"==typeof o.clone?t[n]=o.clone():t[n]=deepCloneWithReplacements(o,s,i)}catch(t){console.warn(`Error cloning property ${n} in module ${e.constructor.name}:`,t)}if(Array.isArray(e.exposedProperties))for(const o of e.exposedProperties){const n="_"+o.name;if(n in e){const o=e[n];o===s?t[n]=i:"object"==typeof o&&null!==o?"function"==typeof o.clone?t[n]=o.clone():t[n]=deepCloneWithReplacements(o,s,i):t[n]=o}}t.gameObject=i}function deepCloneArray(e,t,i){return e?e.map(e=>e===t||e===t.gameObject?i:null==e||"object"!=typeof e?e:"function"==typeof e.clone?e.clone():Array.isArray(e)?deepCloneArray(e,t,i):e instanceof HTMLElement?e:deepCloneWithReplacements(e,t,i)):e}function deepCloneWithReplacements(e,t,i){if(!e)return e;if(e===t)return i;if("object"!=typeof e||e instanceof HTMLElement)return e;if("function"==typeof e.clone)return e.clone();if(e instanceof Date)return new Date(e.getTime());if(Array.isArray(e))return deepCloneArray(e,t,i);const s=Object.create(Object.getPrototypeOf(e));for(const o in e){if(!{}.hasOwnProperty.call(e,o))continue;const n=e[o];n===t||n===t.gameObject?s[o]=i:null==n||"object"!=typeof n?s[o]=n:"function"==typeof n.clone?s[o]=n.clone():n instanceof HTMLElement?s[o]=n:s[o]=Array.isArray(n)?deepCloneArray(n,t,i):deepCloneWithReplacements(n,t,i)}return s}function deepScanAndReplaceReferences(e,t,i){if(!e||"object"!=typeof e)return;const s=new Set;!function e(o){if(o&&"object"==typeof o&&!s.has(o)){s.add(o);for(const n in o){if(!o.hasOwnProperty(n))continue;if("gameObject"===n)continue;const r=o[n];r===t?o[n]=i:r&&"object"==typeof r&&!s.has(r)&&e(r)}}}(e)}function deepCloneWithReferenceReplacement(e,t,i){if(!e||"object"!=typeof e)return e;if(null===e)return null;if(e instanceof Date)return new Date(e.getTime());if(e===t)return i;if(e instanceof Vector2)return e.clone();if(Array.isArray(e))return e.map(e=>e===t?i:deepCloneWithReferenceReplacement(e,t,i));if("function"!=typeof e){if("function"==typeof e.clone)return e.clone();try{const s=Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e));for(const o in e)({}).hasOwnProperty.call(e,o)&&(e[o]===t?s[o]=i:"object"==typeof e[o]&&null!==e[o]?s[o]=deepCloneWithReferenceReplacement(e[o],t,i):s[o]=e[o]);return s}catch(s){console.warn("Error during deep clone, using simpler clone:",s);const o={};for(const s in e)e[s]===t?o[s]=i:"function"!=typeof e[s]&&(o[s]=e[s]);return o}}}function replaceReferences(e,t,i){if(e&&"object"==typeof e&&null!==t&&null!==i)for(const s in e)({}).hasOwnProperty.call(e,s)&&(e[s]===t?e[s]=i:"object"==typeof e[s]&&null!==e[s]&&replaceReferences(e[s],t,i))}function safeClone(e,t,i){if(null==e)return e;if(t&&e===t)return i;if("object"!=typeof e&&"function"!=typeof e)return e;if(e instanceof Vector2)return e.clone();if(e instanceof Date)return new Date(e.getTime());if(Array.isArray(e))return e.map(e=>t&&e===t?i:safeClone(e,t,i));if("function"!=typeof e){if("function"==typeof e.clone)return e.clone();try{const s=structuredClone(e);return t&&i&&replaceReferences(s,t,i),s}catch(s){const o=Array.isArray(e)?[]:{};for(const s in e)if({}.hasOwnProperty.call(e,s)){if("function"==typeof e[s])continue;t&&e[s]===t?o[s]=i:o[s]=safeClone(e[s],t,i)}return o}}}function createPlaceholderModule(e,t,i){try{if(void 0===Module)return console.error("Module base class not available for placeholder creation"),null;const s=new Module((i||"Unknown")+" (Missing)");return s.id=t.id||crypto.randomUUID(),s.type=i||"UnknownModule",s.missingModule=!0,s.originalData=t,s.gameObject=e,e.modules.push(s),console.warn(`Created placeholder for missing module: ${i}. Available modules: ${Array.from(window.moduleRegistry?.modules?.keys()||[]).join(", ")}`),s}catch(e){return console.error("Failed to create placeholder module:",e),null}}class InputManager{constructor(){this.keys={},this.keysDown={},this.keysUp={},this.keysPressed={},this.mousePosition=new Vector2(0,0),this.worldMousePosition=new Vector2(0,0),this.mouseButtons={left:!1,middle:!1,right:!1},this.mouseButtonsDown={left:!1,middle:!1,right:!1},this.mouseButtonsUp={left:!1,middle:!1,right:!1},this.mouseWheel=0,this.mouseMoveThisFrame=!1,this.touches={},this.touchesStarted={},this.touchesEnded={},this.engine=null,this.targetElement=document,this.enabled=!0,this._handleKeyDown=this._handleKeyDown.bind(this),this._handleKeyUp=this._handleKeyUp.bind(this),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseDown=this._handleMouseDown.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this._handleWheel=this._handleWheel.bind(this),this._handleTouchStart=this._handleTouchStart.bind(this),this._handleTouchMove=this._handleTouchMove.bind(this),this._handleTouchEnd=this._handleTouchEnd.bind(this),this.initialize()}initialize(){window.addEventListener("keydown",this._handleKeyDown),window.addEventListener("keyup",this._handleKeyUp),this.targetElement.addEventListener("mousemove",this._handleMouseMove),this.targetElement.addEventListener("mousedown",this._handleMouseDown),this.targetElement.addEventListener("mouseup",this._handleMouseUp),this.targetElement.addEventListener("wheel",this._handleWheel),this.targetElement.addEventListener("contextmenu",e=>{this.preventContextMenu&&e.preventDefault()}),this.targetElement.addEventListener("touchstart",this._handleTouchStart),this.targetElement.addEventListener("touchmove",this._handleTouchMove),this.targetElement.addEventListener("touchend",this._handleTouchEnd),this.targetElement.addEventListener("touchcancel",this._handleTouchEnd),console.log("InputManager initialized")}setEngine(e){this.engine=e}beginFrame(){this.keysDown={},this.keysUp={},this.mouseButtonsDown={left:!1,middle:!1,right:!1},this.mouseButtonsUp={left:!1,middle:!1,right:!1},this.mouseWheel=0,this.mouseMoveThisFrame=!1,this.touchesStarted={},this.touchesEnded={}}endFrame(){this.keysPressed=Object.assign({},this.keys),this.engine&&this.engine.ctx&&this.updateWorldMousePosition()}_updateMousePosition(e){const t=e.clientX,i=e.clientY;if(this.engine&&this.engine.canvas){const e=this.engine.canvas.getBoundingClientRect();let s=t-e.left,o=i-e.top;s*=this.engine.canvas.width/e.width,o*=this.engine.canvas.height/e.height,this.mousePosition.x=s,this.mousePosition.y=o}else this.mousePosition.x=t,this.mousePosition.y=i;this.updateWorldMousePosition()}updateWorldMousePosition(){if(this.engine&&this.engine.ctx)if(this.engine.screenToWorld){const e=this.engine.screenToWorld(this.mousePosition.x,this.mousePosition.y);this.worldMousePosition.x=e.x,this.worldMousePosition.y=e.y}else{const e=this.engine.viewport;if(e){const t=this.engine.canvas.width/2,i=this.engine.canvas.height/2;let s=this.mousePosition.x,o=this.mousePosition.y;if(0!==e.angle){const n=Math.cos(-e.angle*Math.PI/180),r=Math.sin(-e.angle*Math.PI/180),a=s-t,l=o-i;s=t+(a*n-l*r),o=i+(a*r+l*n)}s=(s-t)/e.zoom+t,o=(o-i)/e.zoom+i,s=s+e.x-(e.shake?.x||0),o=o+e.y-(e.shake?.y||0),this.worldMousePosition.x=s,this.worldMousePosition.y=o}else this.worldMousePosition.x=this.mousePosition.x,this.worldMousePosition.y=this.mousePosition.y}}keyDown(e){return!0===this.keys[e.toLowerCase()]}keyPressed(e){return!0===this.keysDown[e.toLowerCase()]}keyReleased(e){return!0===this.keysUp[e.toLowerCase()]}_handleKeyDown(e){if(!this.enabled)return;const t=e.key.toLowerCase();this.keys[t]||(this.keys[t]=!0,this.keysDown[t]=!0)}_handleKeyUp(e){if(!this.enabled)return;const t=e.key.toLowerCase();this.keys[t]=!1,this.keysUp[t]=!0}mouseDown(e){if("string"==typeof e)return!0===this.mouseButtons[e];switch(e){case 0:return this.mouseButtons.left;case 1:return this.mouseButtons.middle;case 2:return this.mouseButtons.right;default:return!1}}mousePressed(e){if("string"==typeof e)return!0===this.mouseButtonsDown[e];switch(e){case 0:return this.mouseButtonsDown.left;case 1:return this.mouseButtonsDown.middle;case 2:return this.mouseButtonsDown.right;default:return!1}}mouseReleased(e){if("string"==typeof e)return!0===this.mouseButtonsUp[e];switch(e){case 0:return this.mouseButtonsUp.left;case 1:return this.mouseButtonsUp.middle;case 2:return this.mouseButtonsUp.right;default:return!1}}getMousePosition(e=!1){return e?this.worldMousePosition.clone():this.mousePosition.clone()}didMouseMove(){return this.mouseMoveThisFrame}getMouseWheelDelta(){return this.mouseWheel}_handleMouseMove(e){this.enabled&&(this._updateMousePosition(e),this.mouseMoveThisFrame=!0)}_handleMouseDown(e){if(this.enabled)switch(this._updateMousePosition(e),console.log("Mouse Down:",e.button,"at screen:",e.clientX,e.clientY,"canvas:",this.mousePosition.x,this.mousePosition.y,"world:",this.worldMousePosition.x,this.worldMousePosition.y),e.button){case 0:this.mouseButtons.left=!0,this.mouseButtonsDown.left=!0;break;case 1:this.mouseButtons.middle=!0,this.mouseButtonsDown.middle=!0;break;case 2:this.mouseButtons.right=!0,this.mouseButtonsDown.right=!0}}_handleMouseUp(e){if(this.enabled)switch(e.button){case 0:this.mouseButtons.left=!1,this.mouseButtonsUp.left=!0;break;case 1:this.mouseButtons.middle=!1,this.mouseButtonsUp.middle=!0;break;case 2:this.mouseButtons.right=!1,this.mouseButtonsUp.right=!0}}_handleWheel(e){this.enabled&&(this.mouseWheel=Math.sign(e.deltaY))}_handleTouchStart(e){if(this.enabled){e.preventDefault();for(let t=0;t<e.changedTouches.length;t++){const i=e.changedTouches[t],s=i.identifier;let o=i.clientX,n=i.clientY;if(this.engine&&this.engine.canvas){const e=this.engine.canvas.getBoundingClientRect();o=i.clientX-e.left,n=i.clientY-e.top,o*=this.engine.canvas.width/e.width,n*=this.engine.canvas.height/e.height}else{const e=document.getElementById("gameCanvas"),t=document.getElementById("editorCanvas"),s=e||t;if(s){const e=s.getBoundingClientRect();o=i.clientX-e.left,n=i.clientY-e.top,o*=s.width/e.width,n*=s.height/e.height}}this.touches[s]={id:s,position:new Vector2(o,n),startPosition:new Vector2(o,n),startTime:Date.now(),moved:!1,totalDistance:0},this.touchesStarted[s]=this.touches[s],1===Object.keys(this.touches).length&&(this.mousePosition.x=i.clientX,this.mousePosition.y=i.clientY,this.mouseMoveThisFrame=!0,this.mouseButtons.left=!0,this.mouseButtonsDown.left=!0)}}}_handleTouchMove(e){if(this.enabled){e.preventDefault();for(let t=0;t<e.changedTouches.length;t++){const i=e.changedTouches[t],s=i.identifier;if(this.touches[s]){let e=i.clientX,t=i.clientY;if(this.engine&&this.engine.canvas){const s=this.engine.canvas.getBoundingClientRect();e=i.clientX-s.left,t=i.clientY-s.top,e*=this.engine.canvas.width/s.width,t*=this.engine.canvas.height/s.height}else{const s=document.getElementById("gameCanvas"),o=document.getElementById("editorCanvas"),n=s||o;if(n){const s=n.getBoundingClientRect();e=i.clientX-s.left,t=i.clientY-s.top,e*=n.width/s.width,t*=n.height/s.height}}const o=e-this.touches[s].position.x,n=t-this.touches[s].position.y,r=Math.sqrt(o*o+n*n);this.touches[s].position.x=e,this.touches[s].position.y=t,this.touches[s].moved=!0,this.touches[s].totalDistance+=r,1===Object.keys(this.touches).length&&(this.mousePosition.x=i.clientX,this.mousePosition.y=i.clientY,this.mouseMoveThisFrame=!0)}}}}_handleTouchEnd(e){if(this.enabled){e.preventDefault();for(let t=0;t<e.changedTouches.length;t++){const i=e.changedTouches[t],s=i.identifier;if(this.touches[s]){let e=i.clientX,t=i.clientY;if(this.engine&&this.engine.canvas){const s=this.engine.canvas.getBoundingClientRect();e=i.clientX-s.left,t=i.clientY-s.top,e*=this.engine.canvas.width/s.width,t*=this.engine.canvas.height/s.height}else{const s=document.getElementById("gameCanvas"),o=document.getElementById("editorCanvas"),n=s||o;if(n){const s=n.getBoundingClientRect();e=i.clientX-s.left,t=i.clientY-s.top,e*=n.width/s.width,t*=n.height/s.height}}this.touches[s].position.x=e,this.touches[s].position.y=t,this.touchesEnded[s]=Object.assign({},this.touches[s]),delete this.touches[s],0===Object.keys(this.touches).length&&(this.mouseButtons.left=!1,this.mouseButtonsUp.left=!0)}}}}getTouches(){return this.touches}getTouchCount(){return Object.keys(this.touches).length}isTapped(){for(const e in this.touchesEnded){const t=this.touchesEnded[e];if(300>(t.startTime?Date.now()-t.startTime:0)&&20>t.position.distanceTo(t.startPosition))return!0}return!1}isLongPressed(){for(const e in this.touchesEnded){const t=this.touchesEnded[e];if((t.startTime?Date.now()-t.startTime:0)>500&&30>t.position.distanceTo(t.startPosition))return!0}return!1}getPinchData(){const e=Object.keys(this.touches);if(2!==e.length)return null;const t=this.touches[e[0]],i=this.touches[e[1]],s=t.position.distanceTo(i.position),o=t.startPosition.distanceTo(i.startPosition),n=(t.position.x+i.position.x)/2,r=(t.position.y+i.position.y)/2;return{scale:s/o,center:new Vector2(n,r),distance:s,startDistance:o}}isPinching(){return 2===Object.keys(this.touches).length}getSwipeDirection(){for(const e in this.touchesEnded){const t=this.touchesEnded[e];if(300>(t.startTime?Date.now()-t.startTime:0)&&t.totalDistance>50){const e=t.position.x-t.startPosition.x,i=t.position.y-t.startPosition.y;return Math.abs(e)>Math.abs(i)?e>0?"right":"left":i>0?"down":"up"}}return null}destroy(){window.removeEventListener("keydown",this._handleKeyDown),window.removeEventListener("keyup",this._handleKeyUp),this.targetElement.removeEventListener("mousemove",this._handleMouseMove),this.targetElement.removeEventListener("mousedown",this._handleMouseDown),this.targetElement.removeEventListener("mouseup",this._handleMouseUp),this.targetElement.removeEventListener("wheel",this._handleWheel),this.targetElement.removeEventListener("touchstart",this._handleTouchStart),this.targetElement.removeEventListener("touchmove",this._handleTouchMove),this.targetElement.removeEventListener("touchend",this._handleTouchEnd),this.targetElement.removeEventListener("touchcancel",this._handleTouchEnd)}enable(){this.enabled=!0}disable(){this.enabled=!1,this.keys={},this.keysDown={},this.keysUp={},this.keysPressed={},this.mouseButtons={left:!1,middle:!1,right:!1},this.mouseButtonsDown={left:!1,middle:!1,right:!1},this.mouseButtonsUp={left:!1,middle:!1,right:!1},this.touches={},this.touchesStarted={},this.touchesEnded={}}preventContextMenu(){this.preventContextMenu=!0}allowContextMenu(){this.preventContextMenu=!1}enableDebugMode(){this.debugMode=!0;const e=this._handleMouseDown,t=this._handleMouseUp,i=this._handleMouseMove;this._handleMouseDown=t=>{this.debugMode&&console.log("Mouse down:",t.button,"at",t.clientX,t.clientY),e.call(this,t)},this._handleMouseUp=e=>{this.debugMode&&console.log("Mouse up:",e.button,"at",e.clientX,e.clientY),t.call(this,e)},this._handleMouseMove=e=>{this.debugMode&&this.frameCount%60==0&&console.log("Mouse move:",e.clientX,e.clientY),i.call(this,e)},this.frameCount=0}testEventListeners(){console.log("Testing event listeners..."),console.log("Target element:",this.targetElement),console.log("Canvas element:",this.engine?.canvas);const e=t=>{console.log("TEST: Click detected on",t.target.tagName,"at",t.clientX,t.clientY),document.removeEventListener("click",e)};document.addEventListener("click",e),console.log("Click anywhere to test event detection...")}useCanvasTarget(){this.engine&&this.engine.canvas?(this.targetElement.removeEventListener("mousemove",this._handleMouseMove),this.targetElement.removeEventListener("mousedown",this._handleMouseDown),this.targetElement.removeEventListener("mouseup",this._handleMouseUp),this.targetElement.removeEventListener("wheel",this._handleWheel),this.targetElement=this.engine.canvas,this.targetElement.tabIndex=0,this.targetElement.addEventListener("mousemove",this._handleMouseMove),this.targetElement.addEventListener("mousedown",this._handleMouseDown),this.targetElement.addEventListener("mouseup",this._handleMouseUp),this.targetElement.addEventListener("wheel",this._handleWheel),console.log("Switched to canvas-based event listeners")):console.warn("Cannot switch to canvas target: engine or canvas not available")}getDebugState(){return{mousePosition:this.mousePosition,worldMousePosition:this.worldMousePosition,mouseButtons:this.mouseButtons,mouseButtonsDown:this.mouseButtonsDown,mouseButtonsUp:this.mouseButtonsUp,enabled:this.enabled,targetElement:this.targetElement.tagName||"document",touchCount:this.getTouchCount()}}static get key(){return{a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z",0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",backspace:"backspace",tab:"tab",enter:"enter",shift:"shift",control:"control",ctrl:"control",alt:"alt",pause:"pause",capslock:"capslock",escape:"escape",esc:"escape",space:" ",pageup:"pageup",pagedown:"pagedown",end:"end",home:"home",left:"arrowleft",up:"arrowup",right:"arrowright",down:"arrowdown",arrowleft:"arrowleft",arrowup:"arrowup",arrowright:"arrowright",arrowdown:"arrowdown",insert:"insert",delete:"delete",f1:"f1",f2:"f2",f3:"f3",f4:"f4",f5:"f5",f6:"f6",f7:"f7",f8:"f8",f9:"f9",f10:"f10",f11:"f11",f12:"f12",numlock:"numlock",numpad0:"0",numpad1:"1",numpad2:"2",numpad3:"3",numpad4:"4",numpad5:"5",numpad6:"6",numpad7:"7",numpad8:"8",numpad9:"9",multiply:"*",add:"+",subtract:"-",decimal:".",divide:"/",semicolon:";",equal:"=",comma:",",dash:"-",period:".",slash:"/",graveaccent:"`",openbracket:"[",backslash:"\\",closebracket:"]",quote:"'",meta:"meta",cmd:"meta",win:"meta"}}static get mouse(){return{left:"left",middle:"middle",right:"right",button1:0,button2:2,button3:1,button4:3,button5:4}}static get gamepad(){return{a:0,b:1,x:2,y:3,leftbumper:4,rightbumper:5,lefttrigger:6,righttrigger:7,select:8,start:9,leftstick:10,rightstick:11,dpadup:12,dpaddown:13,dpadleft:14,dpadright:15,home:16}}}window.input=new InputManager,window.key=InputManager.key,window.mouse=InputManager.mouse,window.gamepad=InputManager.gamepad;class DecalChunk{constructor(e,t,i=256){this.x=e,this.y=t,this.size=i,this.decals=[],this.dirty=!1}addDecal(e,t,i,s={}){const o=e-this.x,n=t-this.y,r={rotation:0,scale:1,alpha:1,width:64,height:64,lifetime:0,...s};if(r.alpha=Math.max(0,Math.min(1,r.alpha)),"function"==typeof i){const e={x:o,y:n,drawFunction:i,options:r,lifetime:r.lifetime,startTime:Date.now()};this.decals.push(e),this.dirty=!0}else{const e={x:o,y:n,image:i,options:r,lifetime:r.lifetime,startTime:Date.now()};this.decals.push(e),this.dirty=!0}}async generateImageFromDrawFunction(e,t){const i=document.createElement("canvas");i.width=t.width||64,i.height=t.height||64,e(i.getContext("2d"));const s=new Image;return s.src=i.toDataURL(),new Promise(e=>{s.onload=()=>e(s)})}clear(){this.decals=[],this.dirty=!0}update(e){this.decals=this.decals.filter(t=>{if(t.lifetime>0){if((Date.now()-t.startTime)/1e3>=t.lifetime)return!1;t.options.alpha=Math.max(0,Math.min(1,t.options.alpha-e/t.lifetime))}return!0}),0===this.decals.length&&(this.dirty=!1)}draw(e,t,i=!1){(this.dirty||0!==this.decals.length||i)&&(this.decals.forEach(t=>{e.save(),e.translate(t.x,t.y),t.options.rotation&&e.rotate(t.options.rotation),t.options.scale&&e.scale(t.options.scale,t.options.scale),e.globalAlpha=t.options.alpha,t.image&&t.image.complete?e.drawImage(t.image,0,0):t.drawFunction&&t.drawFunction(e),e.restore()}),i&&(e.save(),e.strokeStyle="rgba(255, 0, 0, 0.5)",e.lineWidth=2,e.strokeRect(0,0,this.size,this.size),e.restore()),this.dirty=!1)}isVisible(e){const t=this.x,i=this.x+this.size,s=this.y,o=this.y+this.size,n=e.x/e.zoom,r=(e.x+e.width)/e.zoom,a=e.y/e.zoom,l=(e.y+e.height)/e.zoom;return!(n>i||t>r||a>o||s>l)}}class Scene{constructor(e="New Scene"){this.name=e,this.path=null,this.gameObjects=[],this.settings={viewportWidth:1280,viewportHeight:720,viewportX:0,viewportY:0,backgroundColor:"#1e1e1e",gridEnabled:!0,gridSize:32,snapToGrid:!1},this.dirty=!1}markDirty(){this.dirty=!0}toJSON(){return{name:this.name,settings:{viewportWidth:this.settings.viewportWidth,viewportHeight:this.settings.viewportHeight,viewportX:this.settings.viewportX||0,viewportY:this.settings.viewportY||0,backgroundColor:this.settings.backgroundColor,gridEnabled:this.settings.gridEnabled,gridSize:this.settings.gridSize,snapToGrid:this.settings.snapToGrid,gravity:{x:0,y:1},physicsEnabled:!0,physicsDebugDraw:!1},gameObjects:this.gameObjects.filter(e=>!e.parent).map(e=>e.toJSON())}}static fromJSON(e){const t=new Scene(e.name);if(t.settings=e.settings||{},t.activeCamera=e.activeCamera,void 0!==GameObject||window.GameObject){const i=void 0!==GameObject?GameObject:window.GameObject;t.gameObjects=e.gameObjects.map(e=>i.fromJSON(e))}else t.gameObjectsJSON=e.gameObjects,t.gameObjects=[],console.warn("GameObject class not available. Game objects will be loaded when GameObject class is available.");return t}completeLoading(){if(this.gameObjectsJSON&&(void 0!==GameObject||window.GameObject)){const e=void 0!==GameObject?GameObject:window.GameObject;return this.gameObjects=this.gameObjectsJSON.map(t=>e.fromJSON(t)),delete this.gameObjectsJSON,!0}return!1}attachToEngine(e){e.scene=this,e.gameObjects=this.gameObjects}findGameObjectByName(e){return this.findGameObjectByNameRecursive(this.gameObjects,e)}findGameObjectByNameRecursive(e,t){for(const i of e){if(i.name===t)return i;if(i.children&&i.children.length>0){const e=this.findGameObjectByNameRecursive(i.children,t);if(e)return e}}return null}findGameObject(e){return this.findGameObjectByName(e)}}class Engine{constructor(e,t={}){if(this.canvas=e,this.useWebGL=t.useWebGL||!1,this.guiCanvas=document.createElement("canvas"),this.guiCanvas.width=800,this.guiCanvas.height=600,this.guiCanvas.style.position="absolute",this.guiCanvas.style.left="0px",this.guiCanvas.style.top="0px",this.guiCanvas.style.pointerEvents="none",this.backgroundCanvas=document.createElement("canvas"),this.backgroundCanvas.width=800,this.backgroundCanvas.height=600,this.backgroundCanvas.style.position="absolute",this.backgroundCanvas.style.left="0px",this.backgroundCanvas.style.top="0px",this.backgroundCanvas.style.pointerEvents="none",this.scene=null,this.gameObjects=[],this.lastTime=0,this.running=!1,this.preloaded=!1,this.decalCanvas=document.createElement("canvas"),this.decalCanvas.width=800,this.decalCanvas.height=600,this.decalCanvas.style.position="absolute",this.decalCanvas.style.left="0px",this.decalCanvas.style.top="0px",this.decalCanvas.style.pointerEvents="none",this.decalCtx=this.decalCanvas.getContext("2d"),this.decalChunks=new Map,this.debugDecals=!1,this.chunkSize=512,this.preloadChunkRadius=1,this.usePixi=!1,this.pixiRenderer=null,this.useWebGL&&window.WebGLCanvas)try{this.ctx=new WebGLCanvas(this.canvas,{enableFullscreen:!1,pixelWidth:this.canvas.width,pixelHeight:this.canvas.height,pixelScale:1,batchSize:8e3}),this.ctx?(console.log("WebGLCanvas initialized successfully"),console.log("WebGLCanvas methods:",Object.getOwnPropertyNames(this.ctx))):this.ctx&&"function"==typeof this.ctx.init?console.log("WebGLCanvas initialized after init() call"):(console.warn("WebGLCanvas created but may not be ready"),this.useWebGL=!1,this.ctx=this.canvas.getContext("2d"),console.log("Falling back to Canvas 2D context"))}catch(e){console.error("Failed to initialize WebGLCanvas:",e),this.useWebGL=!1,this.ctx=this.canvas.getContext("2d"),console.log("Falling back to Canvas 2D context due to error")}else this.ctx=this.canvas.getContext("2d"),console.log("Using standard Canvas 2D context");this.viewport={width:800,height:600,x:0,y:0,zoom:1,angle:0,minZoom:.1,maxZoom:10,dirty:!0,shake:{x:0,y:0,intensity:0,duration:0}},this.viewportOriginalPosition={width:800,height:600,x:0,y:0,zoom:1,angle:0},this.renderConfig={scaleMode:"fit",fullscreen:!1,maintainAspectRatio:!0,pixelPerfect:!1,smoothing:!1,pixelRatio:window.devicePixelRatio||1},this.editor=null,this.canvasResized=!0,this.viewportCallbacks=[],window.input&&(window.input.setEngine(this),window.input.useCanvasTarget()),window.viewport||(window.viewport=this.viewport),window.engine=this,window.MelodiCode&&(this.melodicode=new window.MelodiCode),this.setupResizeObserver(),window.addEventListener("resize",()=>{this.resizeCanvas()}),window.addEventListener("panel-resized",()=>{this.resizeCanvas()}),this.initializeViewport(),window.prefabManager||(window.prefabManager={prefabs:new Map,loadPrefabs:function(e){if(e){for(const[t,i]of Object.entries(e))this.prefabs.set(t,i),console.log("Loaded prefab:",t);console.log("Total prefabs loaded:",this.prefabs.size)}},findPrefabByName:function(e){if(!e)return null;if(this.prefabs.has(e))return this.prefabs.get(e);const t=e.toLowerCase();for(const[e,i]of this.prefabs)if(e.toLowerCase()===t)return i;return null},hasPrefab:function(e){return null!==this.findPrefabByName(e)},getAllPrefabNames:function(){return Array.from(this.prefabs.keys())},instantiatePrefabByName:function(e,t=null,i=null){const s=this.findPrefabByName(e);return s?this.instantiatePrefab(s,t,i):(console.error("Prefab not found:",e),null)},instantiatePrefab:function(e,t=null,i=null){try{const s=GameObject.fromJSON(e);return t&&(s.position.x=t.x,s.position.y=t.y),i?i.addChild(s):window.engine&&window.engine.gameObjects&&window.engine.gameObjects.push(s),s}catch(e){return console.error("Error instantiating prefab:",e),null}}}),this.prefabManager=window.prefabManager,this.dynamicObjects=new Set,this.originalGameObjects=[],this.objectsToCreate=new Map,this.maxFPS=120,this._minFrameInterval=1e3/this.maxFPS,this._lastFrameTime=0,this.fps=0,this.enableVSync=!0,this.frameCount=0,this.lastFpsUpdate=0,this.prefabs={},e.tabIndex=0,e.focus()}initializePixiRenderer(){this.usePixi&&window.PixiRenderer&&(this.pixiRenderer=new PixiRenderer(this.canvas,this.viewport.width,this.viewport.height,{backgroundColor:this.scene.settings.backgroundColor||0,antialias:!0}),this.pixiRenderer.Init().then(e=>{e?console.log("PixiRenderer initialized"):(console.error("Failed to initialize PixiRenderer"),this.pixiRenderer=null,this.usePixi=!1)}))}initializeViewport(){this.viewport.dirty=!0,this.updateViewport()}async loadExistingPrefabs(){if(this.editor&&this.editor.fileBrowser)try{const e=(await this.editor.fileBrowser.getAllFiles()).filter(e=>e.name.endsWith(".prefab"));for(const t of e)try{const e=t.content||await this.editor.fileBrowser.readFile(t.path);if(!e)continue;const i=JSON.parse(e),s=i.metadata?.name||t.name.replace(".prefab","");this.prefabs.set(s,i),console.log("Loaded prefab: "+s)}catch(e){console.error(`Error loading prefab ${t.name}:`,e)}if(console.log(`Loaded ${this.prefabs.size} prefabs into memory`),window.prefabManager&&"function"==typeof window.prefabManager.loadPrefabs){const e={};for(const[t,i]of this.prefabs)e[t]=i;window.prefabManager.loadPrefabs(e)}}catch(e){console.error("Error loading existing prefabs:",e)}}updateViewport(){if(this.viewport.shake||(this.viewport.shake={x:0,y:0,intensity:0,duration:0}),this.viewport.zoom=Math.max(this.viewport.minZoom,Math.min(this.viewport.maxZoom,this.viewport.zoom)),this.viewport.angle=(this.viewport.angle%360+360)%360,this.viewport.shake.duration>0)if(this.viewport.shake.duration-=16,this.viewport.shake.duration>0){const e=this.viewport.shake.intensity*(this.viewport.shake.duration/1e3);this.viewport.shake.x=(Math.random()-.5)*e,this.viewport.shake.y=(Math.random()-.5)*e}else this.viewport.shake.x=0,this.viewport.shake.y=0,this.viewport.shake.intensity=0;this.preloadChunks(),this.viewport.dirty=!1,this.viewportCallbacks.forEach(e=>{try{e(this.viewport)}catch(e){console.error("Error in viewport callback:",e)}})}setupResizeObserver(){this.canvas&&this.canvas.parentElement&&window.ResizeObserver?(this.resizeObserver=new ResizeObserver(()=>{this.resizeCanvas()}),this.resizeObserver.observe(this.canvas.parentElement)):setInterval(()=>this.resizeCanvas(),1e3)}getBackgroundCanvas(){return this.backgroundCanvas.getContext("2d")}getGuiCanvas(){return this.guiCanvas.getContext("2d")}getMainCanvas(){return this.canvas.getContext("2d")}updateRenderConfig(e){Object.assign(this.renderConfig,e),this.resizeCanvas()}getGameObjectByName(e){const t=i=>{for(const s of i){if(s.name===e)return s;if(s.children&&s.children.length>0){const e=t(s.children);if(e)return e}}return null};return t(this.gameObjects)}addGameObject(e,t=null,i=!1){return t?t.addChild(e):this.gameObjects.push(e),i&&(this.dynamicObjects.add(e),e._isDynamic=!0),e}getAllObjects(e=this.gameObjects,t=new Set){let i=[];return e.forEach(e=>{t.has(e)||(t.add(e),i.push(e),e.children&&e.children.length&&(i=i.concat(this.getAllObjects(e.children,t))))}),i}findNearestObjectByName(e,t,i,s=1/0){let o=null,n=s;return this.gameObjects.forEach(s=>{if(s.name===i){const i=s.position.x-e,r=s.position.y-t,a=Math.sqrt(i*i+r*r);n>a&&(n=a,o=s)}}),o}async preload(){console.log("Preloading game objects...");const e=[];this.traverseGameObjects(this.gameObjects,t=>{t.preload&&e.push(t.preload()),t.modules&&t.modules.forEach(i=>{i.preload&&e.push(i.preload(t))}),t.engine=this}),await Promise.all(e),this.preloaded=!0,console.log("All resources preloaded.")}traverseGameObjects(e,t){e.forEach(e=>{t(e),e.children&&e.children.length>0&&this.traverseGameObjects(e.children,t)})}setViewportPosition(e,t){this.viewport.x=e,this.viewport.y=t,this.viewport.dirty=!0}moveViewport(e,t){this.viewport.x+=e,this.viewport.y+=t,this.viewport.dirty=!0}setViewportZoom(e){this.viewport.zoom=Math.max(this.viewport.minZoom,Math.min(this.viewport.maxZoom,e)),this.viewport.dirty=!0}zoomViewport(e){this.setViewportZoom(this.viewport.zoom*e)}setViewportAngle(e){this.viewport.angle=e,this.viewport.dirty=!0}rotateViewport(e){this.viewport.angle+=e,this.viewport.dirty=!0}shakeViewport(e,t){this.viewport.shake.intensity=e,this.viewport.shake.duration=t}worldToScreen(e,t){const i=this.canvas.width/2,s=this.canvas.height/2;let o=e-this.viewport.x+this.viewport.shake.x,n=t-this.viewport.y+this.viewport.shake.y;if(o=(o-i)*this.viewport.zoom+i,n=(n-s)*this.viewport.zoom+s,0!==this.viewport.angle){const e=this.viewport.angle*Math.PI/180,t=Math.cos(e),r=Math.sin(e),a=o-i,l=n-s;o=i+(a*t-l*r),n=s+(a*r+l*t)}return{x:o,y:n}}screenToWorld(e,t){const i=this.canvas.width/2,s=this.canvas.height/2;let o=e,n=t;if(0!==this.viewport.angle){const e=-this.viewport.angle*Math.PI/180,t=Math.cos(e),r=Math.sin(e),a=o-i,l=n-s;o=i+(a*t-l*r),n=s+(a*r+l*t)}return o=(o-i)/this.viewport.zoom+i,n=(n-s)/this.viewport.zoom+s,o=o+this.viewport.x-this.viewport.shake.x,n=n+this.viewport.y-this.viewport.shake.y,{x:o,y:n}}onViewportChange(e){this.viewportCallbacks.push(e)}removeViewportCallback(e){const t=this.viewportCallbacks.indexOf(e);t>-1&&this.viewportCallbacks.splice(t,1)}async start(){this.usePixi&&!this.pixiRenderer&&this.initializePixiRenderer(),this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.scene?(window.input&&window.input.setEngine(this),console.log("Starting game..."),this.viewportOriginalPosition={width:this.viewport.width,height:this.viewport.height,x:this.viewport.x,y:this.viewport.y,zoom:this.viewport.zoom,angle:this.viewport.angle},this.refreshModules(),this.preloaded||await this.preload(),this.traverseGameObjects(this.gameObjects,e=>{e.active&&e.start&&e.start()}),this.initTouchControls(),this.running=!0,this.lastTime=performance.now(),this.animationFrameId=requestAnimationFrame(this.gameLoop.bind(this))):console.error("No scene loaded")}pause(){this.running&&(this.wasRunning=!0,this.running=!1,cancelAnimationFrame(this.animationFrameId),console.log("Game paused"))}resume(){this.wasRunning&&!this.running&&(this.running=!0,this.wasRunning=!1,this.lastFrameTime=performance.now(),this.animationFrameId=requestAnimationFrame(this.gameLoop.bind(this)),console.log("Game resumed"))}stop(){if(console.log("Stopping game..."),this.running=!1,this.wasRunning=!1,this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.melodicode&&"function"==typeof this.melodicode.stop&&this.melodicode.stop(),this.clearDecals(),this.viewport={width:this.viewportOriginalPosition.width,height:this.viewportOriginalPosition.height,x:this.viewportOriginalPosition.x,y:this.viewportOriginalPosition.y,zoom:this.viewportOriginalPosition.zoom,angle:this.viewportOriginalPosition.angle,minZoom:this.viewport.minZoom,maxZoom:this.viewport.maxZoom,dirty:this.viewport.dirty,shake:{x:0,y:0,intensity:0,duration:0}},this.traverseGameObjects(this.gameObjects,e=>{e.modules&&e.modules.forEach(e=>{if(e.onDestroy)try{e.onDestroy()}catch(t){console.error(`Error in onDestroy for module ${e.type||e.constructor.name}:`,t)}})}),this.cleanupDynamicObjects(),window.physicsManager&&window.physicsManager.reset(),window.editor&&window.editor.activeScene){if(window.editor.activeScene.gameObjects=[...this.originalGameObjects],window.editor.scene.gameObjects=[...this.originalGameObjects],window.editor.hierarchy&&window.editor.hierarchy.selectedObject){const e=window.editor.hierarchy.selectedObject,t=this.findOriginalObject(e,this.originalGameObjects);if(t){e.setSelected(!1),t.setSelected(!0),window.editor.hierarchy.selectedObject=t,window.editor.inspector&&window.editor.inspector.inspectObject(t),window.editor.hierarchy.refreshHierarchy();const i=document.querySelector(`.hierarchy-item[data-id="${t.id}"]`);i&&(document.querySelectorAll(".hierarchy-item").forEach(e=>{e.classList.remove("selected")}),i.classList.add("selected"))}else e.setSelected(!1),window.editor.hierarchy.selectedObject=null,document.querySelectorAll(".hierarchy-item").forEach(e=>{e.classList.remove("selected")}),window.editor.inspector&&window.editor.inspector.showNoObjectMessage()}window.editor.hierarchy&&window.editor.hierarchy.refreshHierarchy(),window.editor.refreshCanvas()}}findOriginalObject(e,t){const i=t=>{for(const s of t){if(s.name===e.name&&s._originalPosition&&e._originalPosition&&.01>Math.abs(s._originalPosition.x-e._originalPosition.x)&&.01>Math.abs(s._originalPosition.y-e._originalPosition.y))return s;if(!s._originalPosition&&s.id===e.id)return s;if(s.children&&s.children.length>0){const e=i(s.children);if(e)return e}}return null};return i(t)}removeDynamicObject(e){if(!e)return!1;this.dynamicObjects.delete(e);const t=this.gameObjects.indexOf(e);if(t>-1&&this.gameObjects.splice(t,1),e.parent&&e.parent.removeChild(e),window.editor&&window.editor.activeScene){const t=window.editor.activeScene.gameObjects.indexOf(e);t>-1&&window.editor.activeScene.gameObjects.splice(t,1);const i=window.editor.scene.gameObjects.indexOf(e);i>-1&&window.editor.scene.gameObjects.splice(i,1)}return window.editor&&window.editor.hierarchy&&window.editor.hierarchy.selectedObject===e&&(e.setSelected(!1),window.editor.hierarchy.selectedObject=null,document.querySelectorAll(".hierarchy-item").forEach(e=>{e.classList.remove("selected")}),window.editor.inspector&&window.editor.inspector.showNoObjectMessage()),e.modules&&e.modules.forEach(e=>{if(e.onDestroy)try{e.onDestroy()}catch(t){console.error(`Error in onDestroy for module ${e.type||e.constructor.name}:`,t)}}),console.log("Removed dynamic object: "+(e.name||"Unnamed")),!0}cleanupDynamicObjects(){if(console.log(`Cleaning up ${this.dynamicObjects.size} dynamic objects...`),Array.from(this.dynamicObjects).forEach(e=>{this.removeDynamicObject(e)}),this.gameObjects=[...this.originalGameObjects],this.dynamicObjects.clear(),window.editor){if(window.editor.activeScene&&(window.editor.activeScene.gameObjects=[...this.originalGameObjects],window.editor.scene.gameObjects=[...this.originalGameObjects]),window.editor.hierarchy&&window.editor.hierarchy.selectedObject){const e=window.editor.hierarchy.selectedObject;e._isDynamic&&(e.setSelected(!1),window.editor.hierarchy.selectedObject=null,document.querySelectorAll(".hierarchy-item").forEach(e=>{e.classList.remove("selected")}),window.editor.inspector&&window.editor.inspector.showNoObjectMessage())}window.editor.hierarchy&&window.editor.hierarchy.refreshHierarchy(),window.editor.refreshCanvas()}console.log("Dynamic object cleanup complete")}refreshModules(){if(!window.moduleReloader||!window.moduleRegistry)return console.warn("Cannot refresh modules: ModuleReloader or ModuleRegistry not available"),!1;console.log("Refreshing all module instances before game start...");let e=0;return Array.from(window.moduleRegistry.modules.keys()).forEach(t=>{const i=window.moduleReloader.updateModuleInstances(t,this.gameObjects);i>0&&(e+=i,console.log(`Updated ${i} instances of ${t}`))}),console.log("Total module instances refreshed: "+e),e>0}updateFPSLimit(e){this.maxFPS=e,this._minFrameInterval=this.maxFPS>0?1e3/this.maxFPS:0}setVSync(e){this.enableVSync=e,console.log("VSync "+(e?"enabled":"disabled"))}gameLoop(e){if(!this.running)return;if(!this.enableVSync&&this.maxFPS>0&&e-this._lastFrameTime<this._minFrameInterval)return void(this.animationFrameId=requestAnimationFrame(this.gameLoop.bind(this)));this._lastFrameTime=e;const t=Math.min((e-this.lastTime)/1e3,.1);this.lastTime=e,this.frameCount++,1e3>e-this.lastFpsUpdate||(this.fps=this.frameCount,this.frameCount=0,this.lastFpsUpdate=e),window.input&&window.input.beginFrame(),this.viewport.dirty&&this.updateViewport(),this.decalChunks.forEach(e=>e.update(t)),this.update(t),this.draw(),window.input&&window.input.endFrame(),this.animationFrameId=requestAnimationFrame(this.gameLoop.bind(this))}update(e){this.traverseGameObjects(this.gameObjects,t=>{t.active&&t.beginLoop&&t.beginLoop(e)}),this.traverseGameObjects(this.gameObjects,t=>{t.active&&t.loop&&t.loop(e)}),this.traverseGameObjects(this.gameObjects,t=>{t.active&&t.endLoop&&t.endLoop(e)})}draw(){if(!this.canvas||!this.ctx||!this.running)return;if(this.usePixi&&this.pixiRenderer){const e=this.getAllObjects(this.gameObjects);return e.forEach(e=>{if(!e.pixiDisplayObject){const t=e.createPixiDisplayObject();this.pixiRenderer.addDisplayObject(t)}e.updatePixiDisplayObject()}),e.filter(e=>e.active&&!1!==e.visible).sort((e,t)=>t.depth-e.depth).forEach(e=>{try{e.draw(this.pixiRenderer)}catch(t){console.error(`Error drawing object ${e.name}:`,t)}}),void this.pixiRenderer.render()}this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);const e=this.scene&&this.scene.settings&&this.scene.settings.backgroundColor?this.scene.settings.backgroundColor:"#000000";this.ctx.fillStyle=e,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.backgroundCanvas&&this.backgroundCanvas.getContext("2d").clearRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height),this.guiCanvas&&this.guiCanvas.getContext("2d").clearRect(0,0,this.guiCanvas.width,this.guiCanvas.height),this.decalCanvas&&this.decalCanvas.getContext("2d").clearRect(0,0,this.decalCanvas.width,this.decalCanvas.height),this.scene&&this.scene.settings&&this.scene.settings.backgroundColor&&(this.ctx.fillStyle=this.scene.settings.backgroundColor,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)),this.ctx.save(),this.applyViewportTransform(),this.backgroundCanvas&&(this.ctx.save(),this.ctx.globalAlpha=1,this.ctx.drawImage(this.backgroundCanvas,0,0),this.ctx.restore()),this.decalCanvas&&(this.ctx.save(),this.ctx.globalAlpha=1,this.decalChunks.forEach(e=>{e.isVisible(this.viewport)&&(this.ctx.save(),this.ctx.translate(e.x,e.y),e.draw(this.ctx,this.viewport,this.debugDecals),this.ctx.restore())}),this.ctx.restore());const t=this.getAllObjects(this.gameObjects);0===t.length?(this.ctx.fillStyle="#ffffff",this.ctx.font="20px Arial",this.ctx.textAlign="center",this.ctx.fillText("No objects in scene... What is a game without objects?",this.canvas.width/2,this.canvas.height/2)):t.filter(e=>e.active&&!1!==e.visible).sort((e,t)=>t.depth-e.depth).forEach(e=>{try{e.draw(this.ctx)}catch(t){console.error(`Error drawing object ${e.name}:`,t)}}),window.physicsManager&&window.physicsManager.debugDraw&&window.physicsManager.drawDebug(this.ctx),this.draw3DCameras(),this.ctx.restore(),this.guiCanvas&&(this.ctx.save(),this.ctx.globalAlpha=1,this.ctx.drawImage(this.guiCanvas,0,0),this.ctx.restore()),this.ctx.flush&&this.ctx.flush()}draw3DCameras(){if(!this.gameObjects)return;const e=[],t=i=>{i.forEach(i=>{if(!1!==i.active){const s=i.getModule("Camera3DRasterizer")||i.getModule("Camera3D");s&&s.isActive&&s.getRenderedTexture&&e.push(s),i.children&&i.children.length>0&&t(i.children)}})};t(this.gameObjects),e.forEach(e=>{try{if(!e._isActive)return;const t=e.viewportWidth||800,i=e.viewportHeight||600,s=this.canvas.width/t,o=this.canvas.height/i,n=Math.min(s,o),r=t*n,a=i*n,l=(this.canvas.width-r)/2,h=(this.canvas.height-a)/2;if(this.useWebGL&&this.ctx.gl){this.ctx.shaders.camera3D||this.create3DCameraShader();const t=e.getRenderedTexture(!1);if(t){e._webglTexture||(e._webglTexture=this.ctx.gl.createTexture());const i=this.ctx.gl;i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,e._webglTexture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t);const s=e._renderTextureSmoothing?i.LINEAR:i.NEAREST;i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,s),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,s),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE);const o=new Float32Array([l,h,l+r,h,l,h+a,l+r,h+a]),n=new Float32Array([0,1,1,1,0,0,1,0]),c=new Uint16Array([0,1,2,1,3,2]),d=this.ctx.shaders.camera3D;if(!d)return void console.error("Camera3D shader not found");i.useProgram(d);const p=i.getUniformLocation(d,"u_resolution");p&&i.uniform2f(p,this.canvas.width,this.canvas.height);const u=i.getUniformLocation(d,"u_texture");u&&i.uniform1i(u,0),this.ctx.drawWithShader("camera3D",o,c,{},{a_position:{data:o,size:2},a_texCoord:{data:n,size:2}}),i.bindTexture(i.TEXTURE_2D,null)}}else{const t=e.getRenderedTexture(!1);t&&(e._renderTextureSmoothing?this.ctx.imageSmoothingEnabled=!0:this.ctx.imageSmoothingEnabled=!1,this.ctx.drawImage(t,l,h,r,a))}}catch(e){console.error("Error drawing 3D camera:",e)}})}create3DCameraShader(){this.ctx.addShader("camera3D","\n        precision mediump float;\n        attribute vec2 a_position;\n        attribute vec2 a_texCoord;\n        uniform vec2 u_resolution;\n        varying vec2 v_texCoord;\n        \n        void main() {\n            // Convert from pixel coordinates to clip space (-1 to 1)\n            vec2 clipSpace = (a_position / u_resolution) * 2.0 - 1.0;\n            clipSpace.y = -clipSpace.y;\n            \n            gl_Position = vec4(clipSpace, 0.0, 1.0);\n            v_texCoord = a_texCoord;\n        }\n    ","\n        precision mediump float;\n        uniform sampler2D u_texture;\n        varying vec2 v_texCoord;\n        \n        void main() {\n            gl_FragColor = texture2D(u_texture, v_texCoord);\n        }\n    ")}applyViewportTransform(){const e=this.canvas.width/2,t=this.canvas.height/2;if(this.ctx.translate(e,t),this.viewport.angle&&0!==this.viewport.angle){const e=this.viewport.angle*Math.PI/180;this.ctx.rotate(e)}this.viewport.zoom&&1!==this.viewport.zoom&&this.ctx.scale(this.viewport.zoom,this.viewport.zoom),this.ctx.translate(-e-this.viewport.x+this.viewport.shake.x,-t-this.viewport.y+this.viewport.shake.y)}loadScene(e){this.running?this.stop():window.physicsManager&&window.physicsManager.reset(),console.log("Loading scene: "+e.name),console.log(`Scene has ${e.gameObjects.length} game objects`),this.scene=e,this.clearDecals(),e.settings&&(this.viewport.width=Math.max(1,e.settings.viewportWidth||800),this.viewport.height=Math.max(1,e.settings.viewportHeight||600),this.viewport.x=e.settings.viewportX||0,this.viewport.y=e.settings.viewportY||0,this.viewport.zoom=Math.max(.1,e.settings.viewportZoom||1),this.viewport.angle=e.settings.viewportAngle||0),e.settings&&(this.chunkSize=e.settings.chunkSize||this.chunkSize,this.preloadChunkRadius=e.settings.preloadChunkRadius||this.preloadChunkRadius),this.viewport.dirty=!0,window.editor?(this.storeOriginalPositions(e.gameObjects),this.gameObjects=this.cloneGameObjects(e.gameObjects,!1)):this.gameObjects=e.gameObjects,this.originalGameObjects=[...e.gameObjects],this.dynamicObjects.clear(),this.preloaded=!1,this.canvasResized=!0,this.resizeCanvas()}loadSceneByIndex(e,t){if(!e||!Array.isArray(e)||0>t||t>=e.length)return console.error("Invalid scene index or scenes array"),!1;const i=e[t];return this.loadScene(i),!0}async instantiatePrefab(e,t=0,i=0){console.log("Attempting to instantiate prefab: "+e);let s=null;if(this.prefabManager&&"function"==typeof this.prefabManager.instantiatePrefabByName){const o=new Vector2(t,i);s=this.prefabManager.instantiatePrefabByName(e,o),s&&(this.gameObjects.includes(s)||this.gameObjects.push(s),console.log("Successfully instantiated prefab via engine prefab manager: "+e))}if(!s&&window.editor&&window.editor.hierarchy&&window.editor.hierarchy.prefabManager){const o=new Vector2(t,i);s=window.editor.hierarchy.prefabManager.instantiatePrefabByName(e,o),s&&(this.gameObjects.includes(s)||this.gameObjects.push(s),console.log("Successfully instantiated prefab via editor: "+e))}if(!s&&window.prefabManager&&(console.log("Using global prefab manager for instantiation"),"function"==typeof window.prefabManager.instantiatePrefabByName)){const o=new Vector2(t,i);s=window.prefabManager.instantiatePrefabByName(e,o),s&&(this.gameObjects.includes(s)||this.gameObjects.push(s),console.log("Successfully instantiated prefab via global manager: "+e))}if(!s&&window.editor&&window.editor.fileBrowser){const o=[e+".prefab",`Prefabs/${e}.prefab`,`/Prefabs/${e}.prefab`];for(const e of o)try{const o=await window.editor.fileBrowser.readFile(e);if(o){const n=JSON.parse(o);if(s=this.createGameObjectFromPrefab(n,t,i),s){this.gameObjects.includes(s)||this.gameObjects.push(s),console.log("Successfully instantiated prefab from file: "+e);break}}}catch(t){console.warn(`Failed to load prefab from ${e}:`,t)}}return s?(this.dynamicObjects.add(s),s._isDynamic=!0,console.log("Tracked dynamic object: "+(s.name||"Unnamed"))):(console.error("Prefab not found: "+e),console.log("Available prefabs in global manager:",window.prefabManager?window.prefabManager.getAllPrefabNames():"None"),console.log("Available prefabs in engine:",this.getAvailablePrefabs())),s}createGameObjectFromPrefab(e,t=0,i=0){if(!e)return null;try{const s=GameObject.fromJSON(e);return s.id=s.position=new Vector2(t,i),s}catch(e){return console.error("Error creating GameObject from prefab:",e),null}}hasPrefab(e){if(!e)return!1;if(window.editor&&window.editor.hierarchy&&window.editor.hierarchy.prefabManager)return window.editor.hierarchy.prefabManager.hasPrefab(e);if(window.prefabManager&&"function"==typeof window.prefabManager.hasPrefab)return window.prefabManager.hasPrefab(e);if(window.editor&&window.editor.fileBrowser){const t=[e+".prefab",`Prefabs/${e}.prefab`,`/Prefabs/${e}.prefab`];for(const e of t)if(window.editor.fileBrowser.exists&&window.editor.fileBrowser.exists(e))return!0}return!1}findGameObjectByName(e){const t=i=>{for(const s of i){if(s.name===e)return s;if(s.children&&s.children.length>0){const e=t(s.children);if(e)return e}}return null};return t(this.gameObjects)}addDecal(e,t,i,s={}){const o=Math.floor(e/this.chunkSize)*this.chunkSize,n=Math.floor(t/this.chunkSize)*this.chunkSize,r=`${o}_${n}`,a=e-o,l=t-n;a>=0&&a<this.chunkSize&&l>=0&&l<this.chunkSize||console.warn(`Decal at (${e}, ${t}) is outside chunk bounds (${o}, ${n}) - adjusting.`),this.decalChunks.has(r)||this.decalChunks.set(r,new DecalChunk(o,n,this.chunkSize)),this.debugDecals&&console.log(`Adding decal to chunk: ${r} at local (${a}, ${l})`),this.decalChunks.get(r).addDecal(e,t,i,s)}clearDecals(e=null,t=null){if(null!==e&&null!==t){const i=`${Math.floor(e/this.chunkSize)*this.chunkSize}_${Math.floor(t/this.chunkSize)*this.chunkSize}`;this.decalChunks.has(i)&&this.decalChunks.get(i).clear()}else this.decalChunks.forEach(e=>e.clear())}getChunk(e,t){const i=Math.floor(e/this.chunkSize)*this.chunkSize,s=Math.floor(t/this.chunkSize)*this.chunkSize,o=`${i}_${s}`;return this.decalChunks.has(o)||this.decalChunks.set(o,new DecalChunk(i,s,this.chunkSize)),this.decalChunks.get(o)}preloadChunks(){const e=this.viewport.width/2/this.viewport.zoom,t=this.viewport.height/2/this.viewport.zoom,i=this.viewport.x-e,s=this.viewport.x+e,o=this.viewport.y-t,n=this.viewport.y+t,r=this.preloadChunkRadius*this.chunkSize,a=Math.floor((i-r)/this.chunkSize)*this.chunkSize,l=Math.floor((s+r)/this.chunkSize)*this.chunkSize,h=Math.floor((o-r)/this.chunkSize)*this.chunkSize,c=Math.floor((n+r)/this.chunkSize)*this.chunkSize;this.debugDecals&&console.log(`Preloading chunks: view bounds (${i}, ${o}) to (${s}, ${n}), buffer: ${r}`);for(let e=a;l>=e;e+=this.chunkSize)for(let t=h;c>=t;t+=this.chunkSize){const i=`${e}_${t}`;this.decalChunks.has(i)||(this.decalChunks.set(i,new DecalChunk(e,t,this.chunkSize)),this.debugDecals&&console.log("Preloaded chunk: "+i))}const d=2*r,p=a-d,u=l+d,g=h-d,m=c+d;for(const[e,t]of this.decalChunks){const[t,i]=e.split("_").map(Number);(p>t||t>u||g>i||i>m)&&(this.debugDecals&&console.log("Unloading distant chunk: "+e),this.decalChunks.delete(e))}}storeOriginalPositions(e){const t=e=>{e._originalPosition={x:e.position.x,y:e.position.y},e.children&&e.children.length>0&&e.children.forEach(t)};e.forEach(t)}cloneGameObjects(e,t=!0){return e.map(e=>{const i=e.clone(t);return e._originalPosition&&(i._originalPosition={x:e._originalPosition.x,y:e._originalPosition.y}),e.children&&e.children.length>0&&(i.children=[],this.cloneGameObjects(e.children,t).forEach(e=>{i.addChild(e)})),i})}saveGame(e="savegame",t=!0){const i={scene:this.scene?this.scene.name:null,gameObjects:this.gameObjects.map(e=>e.toJSON?e.toJSON():e),viewport:this.viewport,timestamp:Date.now()},s=JSON.stringify(i);if(t)localStorage.setItem("dmjs_save_"+e,s),alert(`Game saved locally as "${e}"`);else{const t=new Blob([s],{type:"application/json"}),i=URL.createObjectURL(t),o=document.createElement("a");o.href=i,o.download=e+".dmjs-save.json",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}}async loadGame(e){let t=null;if("string"==typeof e?t=localStorage.getItem("dmjs_save_"+e):e instanceof File&&(t=await e.text()),!t)return alert("Save file not found."),!1;try{const e=JSON.parse(t);if(e.scene&&window.editor&&window.editor.scenes){const t=window.editor.scenes.find(t=>t.name===e.scene);t&&this.loadScene(t)}return e.gameObjects&&(this.gameObjects=e.gameObjects.map(e=>window.GameObject&&window.GameObject.fromJSON?window.GameObject.fromJSON(e):e)),e.viewport&&Object.assign(this.viewport,e.viewport),alert("Game loaded!"),!0}catch(e){return alert("Failed to load game: "+e.message),!1}}loadPrefabs(e){e&&(console.log("Loading prefabs into engine:",Object.keys(e)),!this.prefabManager&&window.prefabManager&&(this.prefabManager=window.prefabManager),this.prefabManager&&"function"==typeof this.prefabManager.loadPrefabs?(this.prefabManager.loadPrefabs(e),console.log(`Engine loaded ${Object.keys(e).length} prefabs`)):console.warn("No prefab manager available in engine"))}getAvailablePrefabs(){return this.prefabManager&&"function"==typeof this.prefabManager.getAllPrefabNames?this.prefabManager.getAllPrefabNames():window.prefabManager&&"function"==typeof window.prefabManager.getAllPrefabNames?window.prefabManager.getAllPrefabNames():[]}initTouchControls(){this.canvas&&(this.canvas.addEventListener("touchstart",e=>{if(window.input){const t=e.touches[0],i=this.canvas.getBoundingClientRect(),s=t.clientX-i.left,o=t.clientY-i.top;window.input.handleMouseDown({clientX:t.clientX,clientY:t.clientY,button:0,offsetX:s,offsetY:o})}},{passive:!1}),this.canvas.addEventListener("touchmove",e=>{if(window.input){const t=e.touches[0],i=this.canvas.getBoundingClientRect(),s=t.clientX-i.left,o=t.clientY-i.top;window.input.handleMouseMove({clientX:t.clientX,clientY:t.clientY,offsetX:s,offsetY:o})}},{passive:!1}),this.canvas.addEventListener("touchend",()=>{window.input&&window.input.handleMouseUp({button:0})},{passive:!1}))}resizeCanvas(){if(!this.canvas)return;const e=this.canvas.parentElement;if(!e)return;e.offsetHeight;const t=e.clientWidth,i=e.clientHeight;if(0>=t||0>=i)return;const s=this.viewport.width||800,o=this.viewport.height||600,n=s/o,r=this.renderConfig.pixelRatio;let a,l;if(this.renderConfig.fullscreen)this.renderConfig.maintainAspectRatio?t/i>n?(l=i,a=i*n):(a=t,l=t/n):(a=t,l=i);else{const e=Math.min(t/s,i/o);a=s*e,l=o*e}a=Math.max(1,Math.floor(a)),l=Math.max(1,Math.floor(l));const h=Math.floor((t-a)/2),c=Math.floor((i-l)/2);if(this.canvas.style.width=a+"px",this.canvas.style.height=l+"px",this.canvas.style.position="absolute",this.canvas.style.left=h+"px",this.canvas.style.top=c+"px",this.canvas.style.minWidth="0",this.canvas.style.minHeight="0",this.canvas.style.maxWidth="none",this.canvas.style.maxHeight="none",this.canvas.width=s*r,this.canvas.height=o*r,this.ctx.setTransform(1,0,0,1,0,0),1!==r&&this.ctx.scale(r,r),this.guiCanvas){this.guiCanvas.width=this.canvas.width,this.guiCanvas.height=this.canvas.height;const e=this.guiCanvas.getContext("2d");1!==r&&e.scale(r,r)}if(this.backgroundCanvas){this.backgroundCanvas.width=this.canvas.width,this.backgroundCanvas.height=this.canvas.height;const e=this.backgroundCanvas.getContext("2d");1!==r&&e.scale(r,r)}if(this.decalCanvas){this.decalCanvas.width=this.canvas.width,this.decalCanvas.height=this.canvas.height;const e=this.decalCanvas.getContext("2d");1!==r&&e.scale(r,r)}if(this.canvas.style.transform="none",this.ctx.imageSmoothingEnabled=this.renderConfig.smoothing,"nearest-neighbor"===this.renderConfig.scaleMode?this.canvas.style.imageRendering="pixelated":this.canvas.style.imageRendering=this.renderConfig.smoothing?"auto":"crisp-edges",this.useWebGL&&this.ctx.resize)return this.ctx.resize(s*r,o*r),void(1!==r&&this.ctx.scale(r,r));this.canvasResized=!0,this.viewport.dirty=!0}cleanup(){this.resizeObserver&&this.resizeObserver.disconnect(),this._resizeHandler=this.resizeCanvas.bind(this),window.addEventListener("resize",this._resizeHandler),window.addEventListener("panel-resized",this._resizeHandler),this.viewportCallbacks=[]}}window.Engine=Engine;class AssetManager{constructor(e=null){this.fileBrowser=e,this.cache=new Map,this.loadingPromises=new Map,this.assetRegistry=new Map,this.modal=null,this.typeHandlers={image:this.handleImageAsset.bind(this),audio:this.handleAudioAsset.bind(this),json:this.handleJsonAsset.bind(this),text:this.handleTextAsset.bind(this)},this.setupFileBrowserIntegration(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>this.initModal()):this.initModal()}setupFileBrowserIntegration(){if(!this.fileBrowser)return void console.log("FileBrowser not available yet for AssetManager integration");console.log("Setting up AssetManager integration with FileBrowser");const e=this.fileBrowser.createFile.bind(this.fileBrowser),t=this.fileBrowser.writeFile?this.fileBrowser.writeFile.bind(this.fileBrowser):null,i=this.fileBrowser.deleteItem.bind(this.fileBrowser);this.fileBrowser.createFile=async(t,i,s=!1)=>{const o=await e(t,i,s);return o&&setTimeout(()=>this.registerAssetFromPath(t),100),o},t&&(this.fileBrowser.writeFile=async(e,i,s=!1)=>{const o=await t(e,i,s);return o&&setTimeout(()=>this.registerAssetFromPath(e),100),o}),this.fileBrowser.deleteItem=async e=>{const t=await i(e);return t&&this.removeAssetByPath(e),t}}async scanAndRegisterAssets(){if(this.fileBrowser)try{console.log("Scanning FileBrowser for assets...");const e=await this.fileBrowser.getAllFiles();for(const t of e)if("file"===t.type){const e=this.detectAssetType(t.path);"image"!==e&&"audio"!==e&&"json"!==e||await this.registerAssetFromPath(t.path)}console.log(`Registered ${this.assetRegistry.size} assets from FileBrowser`)}catch(e){console.error("Error scanning FileBrowser for assets:",e)}else console.warn("No FileBrowser available for asset scanning")}async registerAssetFromPath(e){if("text"!==this.detectAssetType(e)||e.endsWith(".json")){const t=this.normalizePath(e),i=this.generateAssetId(t);try{this.fileBrowser&&(await this.loadAsset(t),console.log(`Auto-registered asset: ${i} from ${e}`))}catch(t){console.warn(`Failed to auto-register asset from ${e}:`,t)}}}removeAssetByPath(e){const t=this.generateAssetId(e);this.removeAsset(t);const i=this.normalizePath(e);this.cache.delete(i),this.cache.delete(e)}async getAssetByPath(e){if(!e)return null;const t=this.normalizePath(e),i=this.generateAssetId(t);let s=this.getAsset(i);if(s)return s;if(window.editor&&window.editor.fileBrowser&&"function"==typeof this.fileBrowser?.readFile)try{return console.log("AssetManager: Loading from FileBrowser first:",t),s=await this.loadAsset(t),s}catch(e){console.warn("AssetManager: FileBrowser loading failed:",e)}if(!this.fileBrowser)return console.warn("No FileBrowser available for asset loading"),null;try{return s=await this.loadAsset(t),s}catch(t){return console.warn("Could not load asset from FileBrowser path: "+e,t),null}}async loadAsset(e){const t=this.normalizePath(e),i=this.generateAssetId(t);if(this.cache.has(i))return this.cache.get(i);if(this.cache.has(t))return this.cache.get(t);if(this.loadingPromises.has(t))return this.loadingPromises.get(t);if(!this.fileBrowser||"function"!=typeof this.fileBrowser.readFile)throw console.warn("No FileBrowser available, cannot load asset: "+t),Error("Asset loading requires FileBrowser: "+t);const s=this.loadFromFileBrowser(t);this.loadingPromises.set(t,s);try{const o=await s;this.cache.set(i,o),this.cache.set(t,o),this.cache.set(e,o);const n=this.detectAssetType(t);return this.assetRegistry.set(i,{id:i,type:n,metadata:{path:t,originalPath:e,addedAt:Date.now(),loadedFromPath:!0}}),o}catch(e){throw console.error(`Failed to load asset ${t}:`,e),e}finally{this.loadingPromises.delete(t)}}getAvailableAssetPaths(e=null){const t=[];for(const[i,s]of this.assetRegistry)e&&s.type!==e||t.push({id:i,path:s.metadata.path||s.metadata.originalPath,type:s.type,displayName:this.getDisplayName(s.metadata.path||i)});return t.sort((e,t)=>e.displayName.localeCompare(t.displayName))}getDisplayName(e){return e?e.split("/").pop().split("\\").pop():"Unknown"}getCachedAsset(e){if(!e)return null;if(this.cache.has(e))return this.cache.get(e);const t=this.generateAssetId(e);if(this.cache.has(t))return this.cache.get(t);const i=this.normalizePath(e);if(this.cache.has(i))return this.cache.get(i);for(const[t,i]of this.cache)if(t.endsWith(e)||e.endsWith(t))return i;return null}serializeCache(){const e={};for(const[t,i]of this.cache)try{if(i instanceof HTMLImageElement){const s=document.createElement("canvas");s.width=i.naturalWidth||i.width,s.height=i.naturalHeight||i.height,s.getContext("2d").drawImage(i,0,0),e[t]={type:"image",content:s.toDataURL("image/png"),width:s.width,height:s.height}}else i instanceof HTMLAudioElement?i.src&&i.src.startsWith("data:")&&(e[t]={type:"audio",content:i.src}):"string"!=typeof i&&"object"!=typeof i||(e[t]={type:"data",content:i})}catch(e){console.warn(`Failed to serialize asset ${t}:`,e)}const t={};for(const[e,i]of this.assetRegistry)t[e]={type:i.type,metadata:i.metadata};return{cache:e,registry:t,version:"1.0"}}async deserializeCache(e){if(e&&e.cache){this.cache.clear(),this.assetRegistry.clear();try{for(const[t,i]of Object.entries(e.cache))try{if("image"===i.type){const e=await this.loadImage(i.content);this.cache.set(t,e)}else if("audio"===i.type){const e=await this.loadAudio(i.content);this.cache.set(t,e)}else"data"===i.type&&this.cache.set(t,i.content)}catch(e){console.warn(`Failed to deserialize asset ${t}:`,e)}if(e.registry)for(const[t,i]of Object.entries(e.registry))this.assetRegistry.set(t,i);console.log(`Deserialized ${this.cache.size} assets and ${this.assetRegistry.size} registry entries`)}catch(e){console.error("Error deserializing asset cache:",e)}}else console.warn("No cache data to deserialize")}async exportAssetsForGame(){const e={},t=new Set;console.log("Exporting assets from AssetManager..."),console.log("Asset registry size:",this.assetRegistry.size),console.log("Cache size:",this.cache.size);for(const[i,s]of this.assetRegistry){const o=this.cache.get(i);if(!o)continue;const n=s.metadata.path||s.metadata.originalPath,r=this.normalizePath(n);if(!t.has(r)){t.add(r);try{if("image"===s.type&&o instanceof HTMLImageElement){const t=document.createElement("canvas");t.width=o.naturalWidth||o.width,t.height=o.naturalHeight||o.height,t.getContext("2d").drawImage(o,0,0),e[r]={content:t.toDataURL("image/png"),type:"image/png"},console.log("Exported image asset:",r)}else"audio"===s.type&&o instanceof HTMLAudioElement?o.src&&o.src.startsWith("data:")&&(e[r]={content:o.src,type:"audio/mpeg"},console.log("Exported audio asset:",r)):"string"==typeof o?(e[r]={content:o,type:"text/plain"},console.log("Exported text asset:",r)):"object"==typeof o&&null!==o&&(e[r]={content:JSON.stringify(o),type:"application/json"},console.log("Exported JSON asset:",r))}catch(e){console.warn(`Failed to export asset ${n}:`,e)}}}return console.log("Total assets exported:",Object.keys(e).length),e}async addAsset(e,t,i,s={}){console.log(`Adding asset: ${e} (type: ${i})`),this.assetRegistry.set(e,{id:e,type:i,metadata:{...s,addedAt:Date.now(),originalPath:s.path||e}});const o=this.typeHandlers[i]||this.handleGenericAsset.bind(this),n=await o(t,s);return this.cache.set(e,n),console.log("Asset added successfully: "+e),e}getAsset(e){return this.cache.has(e)?this.cache.get(e):(console.warn("Asset not found: "+e),null)}getImage(e){const t=this.getAsset(e);return t&&t instanceof HTMLImageElement?t:(console.warn("Image asset not found or invalid type: "+e),null)}getAudio(e){const t=this.getAsset(e);return t&&t instanceof HTMLAudioElement?t:(console.warn("Audio asset not found or invalid type: "+e),null)}getJson(e){const t=this.getAsset(e);return t&&"object"==typeof t&&null!==t?t:(console.warn("JSON asset not found or invalid type: "+e),null)}getText(e){const t=this.getAsset(e);return"string"==typeof t?t:(console.warn("Text asset not found or invalid type: "+e),null)}hasAsset(e){return this.cache.has(e)}removeAsset(e){const t=this.cache.delete(e);return this.assetRegistry.delete(e),t&&console.log("Asset removed: "+e),t}getAssetIds(){return Array.from(this.cache.keys())}getAssetsByType(e){const t=[];for(const[i,s]of this.assetRegistry)s.type===e&&t.push({id:i,asset:this.cache.get(i),metadata:s});return t}async handleImageAsset(e,t={}){if(e instanceof HTMLImageElement)return e;if(e instanceof File||e instanceof Blob){const t=await this.blobToDataURL(e);return this.loadImage(t)}if("string"==typeof e&&(e.startsWith("data:image/")||e.startsWith("blob:")||e.startsWith("http")))return this.loadImage(e);throw Error("Invalid image content type")}async handleAudioAsset(e,t={}){if(e instanceof HTMLAudioElement)return e;if(e instanceof File||e instanceof Blob){const t=await this.blobToDataURL(e);return this.loadAudio(t)}if("string"==typeof e&&(e.startsWith("data:audio/")||e.startsWith("blob:")||e.startsWith("http")))return this.loadAudio(e);throw Error("Invalid audio content type")}async handleJsonAsset(e,t={}){if("object"==typeof e&&null!==e)return e;if("string"==typeof e)return JSON.parse(e);if(e instanceof File||e instanceof Blob){const t=await e.text();return JSON.parse(t)}throw Error("Invalid JSON content type")}async handleTextAsset(e,t={}){if("string"==typeof e)return e;if(e instanceof File||e instanceof Blob)return e.text();throw Error("Invalid text content type")}async handleGenericAsset(e,t={}){return e}addEmbeddedAssets(e){console.log("Adding embedded assets to AssetManager:",Object.keys(e));for(const[t,i]of Object.entries(e)){const e=this.generateAssetId(t),s=i.type?this.getAssetTypeFromMime(i.type):this.detectAssetType(t);this.addAsset(e,i.content,s,{path:t,originalType:i.type,embedded:!0}).then(()=>{console.log("Successfully added embedded asset:",t)}).catch(e=>{console.error(`Failed to add embedded asset ${t}:`,e)})}}generateAssetId(e){const t=e.split("/").pop().split("\\").pop().split(".")[0].replace(/[^a-zA-Z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"").replace(/_([a-z])/g,(e,t)=>t.toUpperCase());return/^\d/.test(t)?"asset_"+t:t||"asset_"+Date.now()}detectAssetType(e){return{png:"image",jpg:"image",jpeg:"image",gif:"image",webp:"image",svg:"image",bmp:"image",ico:"image",mp3:"audio",wav:"audio",ogg:"audio",aac:"audio",flac:"audio",m4a:"audio",wma:"audio",json:"json",txt:"text",md:"text",csv:"text",xml:"text"}[e.split(".").pop().toLowerCase()]||"text"}getAssetTypeFromMime(e){return e.startsWith("image/")?"image":e.startsWith("audio/")?"audio":e.includes("json")?"json":"text"}normalizePath(e){if(!e)return"";let t=e.replace(/\\/g,"/");t.startsWith("./")&&(t=t.substring(2)),t.startsWith("/")||(t="/"+t),t=t.replace(/\/+/g,"/");try{t=decodeURIComponent(t)}catch(e){}return t}loadImage(e){return new Promise((t,i)=>{const s=new Image;s.onload=()=>t(s),s.onerror=()=>i(Error("Failed to load image: "+e)),s.src=e})}loadAudio(e){return new Promise((t,i)=>{const s=new Audio;s.oncanplaythrough=()=>t(s),s.onerror=()=>i(Error("Failed to load audio: "+e)),s.src=e})}async blobToDataURL(e){return new Promise((t,i)=>{const s=new FileReader;s.onload=()=>t(s.result),s.onerror=i,s.readAsDataURL(e)})}async loadFromFileBrowser(e){try{const t=e.startsWith("/")?e:"/"+e;console.log("Loading asset from FileBrowser: "+t);const i=await this.fileBrowser.readFile(t);if(!i)throw Error("Asset not found in file browser: "+t);const s=this.detectAssetType(e);if(console.log("Processing asset as type: "+s),"string"!=typeof i)return i instanceof Blob||i instanceof File?(this.typeHandlers[s]||this.handleGenericAsset.bind(this))(i):i;if("image"===s&&i.startsWith("data:image/"))return this.loadImage(i);if("audio"===s&&i.startsWith("data:audio/"))return this.loadAudio(i);if("json"!==s)return i;try{return JSON.parse(i)}catch(t){return console.warn(`Failed to parse JSON from ${e}, treating as text`),i}}catch(t){throw Error(`Failed to load asset from file browser: ${e} - ${t.message}`)}}async loadFromUrl(e){try{const t=this.basePath?`${this.basePath}${e}`:e,i=await fetch(t);if(!i.ok)throw Error(`HTTP ${i.status}: ${i.statusText}`);const s=this.detectAssetType(e);if("image"===s){const e=await i.blob(),t=await this.blobToDataURL(e);return this.loadImage(t)}if("audio"===s){const e=await i.blob(),t=await this.blobToDataURL(e);return this.loadAudio(t)}return"json"===s?i.json():i.text()}catch(t){throw Error(`Failed to load asset from URL: ${e} - ${t.message}`)}}clearAll(){this.cache.clear(),this.assetRegistry.clear(),this.loadingPromises.clear(),console.log("All assets cleared")}getStats(){const e={totalAssets:this.cache.size,byType:{}};for(const[t,i]of this.assetRegistry){const t=i.type;e.byType[t]=(e.byType[t]||0)+1}return e}initModal(){this.modal=document.createElement("div"),this.modal.className="asset-modal",this.modal.innerHTML='\n            <div class="asset-modal-content">\n                <div class="asset-modal-header">\n                    <h2 class="asset-modal-title">Export Assets</h2>\n                    <button class="asset-modal-close"><i class="fas fa-times"></i></button>\n                </div>\n                <div class="asset-modal-body">\n                    <div class="asset-tree"></div>\n                    <div class="asset-actions">\n                        <button class="asset-button select-all">Select All</button>\n                        <button class="asset-button export">Export Selected</button>\n                    </div>\n                </div>\n            </div>\n        ';const e=document.createElement("style");e.textContent="\n            .asset-pack-info {\n                margin-bottom: 20px;\n                padding: 16px;\n                background: #3d3d3d;\n                border-radius: 6px;\n                border: 1px solid #555;\n            }\n            \n            .asset-input-group {\n                margin-bottom: 16px;\n            }\n            \n            .asset-input-group label {\n                display: block;\n                margin-bottom: 6px;\n                color: #ccc;\n                font-size: 14px;\n                font-weight: 500;\n            }\n            \n            .asset-input-group input,\n            .asset-input-group textarea {\n                width: 100%;\n                padding: 8px 12px;\n                background: #2a2a2a;\n                border: 1px solid #555;\n                border-radius: 4px;\n                color: #fff;\n                font-size: 14px;\n                font-family: inherit;\n            }\n            \n            .asset-input-group input:focus,\n            .asset-input-group textarea:focus {\n                outline: none;\n                border-color: #0078d4;\n                box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.2);\n            }\n            \n            .icon-selector {\n                display: flex;\n                align-items: center;\n                gap: 16px;\n            }\n            \n            .icon-preview {\n                width: 80px;\n                height: 80px;\n                background: #2a2a2a;\n                border: 2px dashed #555;\n                border-radius: 8px;\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                justify-content: center;\n                text-align: center;\n                color: #888;\n                font-size: 12px;\n                flex-shrink: 0;\n            }\n            \n            .icon-preview img {\n                border-radius: 4px;\n            }\n            \n            .icon-preview span {\n                margin-top: 4px;\n                font-size: 10px;\n            }\n            \n            .icon-controls {\n                display: flex;\n                flex-direction: column;\n                gap: 8px;\n            }\n            \n            .asset-tree-section h3 {\n                color: #fff;\n                margin-bottom: 12px;\n                font-size: 16px;\n            }\n        ",document.head.appendChild(e),document.body.appendChild(this.modal),this.setupEventListeners()}setupEventListeners(){this.modal.querySelector(".asset-modal-close").addEventListener("click",()=>{this.hideModal()}),this.modal.addEventListener("click",e=>{e.target.classList.contains("select-all")&&this.modal.querySelectorAll('.asset-item input[type="checkbox"]').forEach(e=>e.checked=!0),e.target.classList.contains("select-none")&&this.modal.querySelectorAll('.asset-item input[type="checkbox"]').forEach(e=>e.checked=!1),e.target.classList.contains("export")&&this.exportSelected()})}async showExportModal(){const e=await this.fileBrowser.getAllFiles(),t=this.modal.querySelector(".asset-tree");t.innerHTML="";const i=this.buildFileTree(e);this.renderFileTree(i,t);const s=this.modal.querySelector(".asset-modal-body");s.innerHTML='\n        <div class="asset-pack-info">\n            <div class="asset-input-group">\n                <label for="asset-pack-name">Asset Pack Name:</label>\n                <input type="text" id="asset-pack-name" placeholder="Enter asset pack name" value="My Asset Pack">\n            </div>\n            <div class="asset-input-group">\n                <label for="asset-pack-description">Description:</label>\n                <textarea id="asset-pack-description" placeholder="Enter a description for this asset pack" rows="3"></textarea>\n            </div>\n            <div class="asset-input-group">\n                <label for="asset-pack-version">Version:</label>\n                <input type="text" id="asset-pack-version" placeholder="1.0.0" value="1.0.0">\n            </div>\n            <div class="asset-input-group">\n                <label for="asset-pack-author">Author:</label>\n                <input type="text" id="asset-pack-author" placeholder="Your name">\n            </div>\n            <div class="asset-input-group">\n                <label for="asset-pack-icon">Icon (optional):</label>\n                <div class="icon-selector">\n                    <div class="icon-preview" id="icon-preview">\n                        <i class="fas fa-image" style="font-size: 48px; color: #666;"></i>\n                        <span>No icon selected</span>\n                    </div>\n                    <div class="icon-controls">\n                        <button type="button" class="asset-button select-icon">Select Icon</button>\n                        <button type="button" class="asset-button remove-icon" style="display: none;">Remove Icon</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="asset-tree-section">\n            <h3>Select Assets to Export</h3>\n            <div class="asset-tree"></div>\n        </div>\n        <div class="asset-actions">\n            <button class="asset-button select-all">Select All</button>\n            <button class="asset-button select-none">Select None</button>\n            <button class="asset-button export">Export Selected</button>\n        </div>\n    ';const o=s.querySelector(".asset-tree");this.renderFileTree(i,o),this.setupIconSelector(),this.modal.style.display="flex"}hideModal(){this.modal.style.display="none"}buildFileTree(e){const t={};return e.forEach(e=>{const i=e.path.split("/").filter(Boolean);let s=t;i.forEach((t,o)=>{o===i.length-1?(s.files||(s.files=[]),s.files.push(e)):(s.dirs=s.dirs||{},s.dirs[t]=s.dirs[t]||{},s=s.dirs[t])})}),t}renderFileTree(e,t,i=""){e.dirs&&Object.entries(e.dirs).forEach(([e,s])=>{const o=document.createElement("div");o.className="asset-directory",o.innerHTML=`\n                    <div class="asset-dir-header">\n                        <input type="checkbox" data-path="${i}/${e}">\n                        <i class="fas fa-folder"></i>\n                        <span>${e}</span>\n                    </div>\n                    <div class="asset-dir-content"></div>\n                `,t.appendChild(o);const n=o.querySelector('input[type="checkbox"]'),r=o.querySelector(".asset-dir-content");n.addEventListener("change",()=>{r.querySelectorAll('input[type="checkbox"]').forEach(e=>e.checked=n.checked)}),this.renderFileTree(s,r,`${i}/${e}`)}),e.files&&e.files.forEach(e=>{const i=document.createElement("div");i.className="asset-item",i.innerHTML=`\n                    <input type="checkbox" data-path="${e.path}">\n                    <i class="fas fa-file"></i>\n                    <span>${e.name}</span>\n                `,t.appendChild(i)})}setupIconSelector(){const e=this.modal.querySelector(".select-icon"),t=this.modal.querySelector(".remove-icon"),i=this.modal.querySelector("#icon-preview");this.selectedIcon=null,e.addEventListener("click",async()=>{try{const e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=async e=>{const s=e.target.files[0];s&&await this.handleIconSelection(s,i,t)},e.click()}catch(e){console.error("Error selecting icon:",e),this.fileBrowser?.showNotification?.("Error selecting icon: "+e.message,"error")}}),t.addEventListener("click",()=>{this.selectedIcon=null,i.innerHTML='\n                <i class="fas fa-image" style="font-size: 48px; color: #666;"></i>\n                <span>No icon selected</span>\n            ',t.style.display="none"})}async handleIconSelection(e,t,i){try{if(!e.type.startsWith("image/"))throw Error("Please select a valid image file");if(e.size>5242880)throw Error("Image file size must be less than 5MB");const s=new Image,o=document.createElement("canvas"),n=o.getContext("2d"),r=await this.fileToDataURL(e);await new Promise((e,t)=>{s.onload=e,s.onerror=()=>t(Error("Failed to load image")),s.src=r}),o.width=512,o.height=512;const{width:a,height:l,x:h,y:c}=this.calculateImageFit(s.width,s.height,512,512);n.clearRect(0,0,128,128),n.drawImage(s,h,c,a,l);const d=o.toDataURL("image/png");this.selectedIcon={data:d,originalName:e.name,size:Math.round(.75*d.length)},t.innerHTML=`\n                <img src="${d}" style="width: 64px; height: 64px; border-radius: 4px; border: 1px solid #555;">\n                <span style="font-size: 12px; color: #aaa;">${e.name} (512x512)</span>\n            `,i.style.display="inline-block",this.fileBrowser?.showNotification?.("Icon resized and ready for export","success")}catch(e){console.error("Error processing icon:",e),this.fileBrowser?.showNotification?.("Error processing icon: "+e.message,"error")}}calculateImageFit(e,t,i,s){const o=Math.min(i/e,s/t),n=e*o,r=t*o;return{width:n,height:r,x:(i-n)/2,y:(s-r)/2}}fileToDataURL(e){return new Promise((t,i)=>{const s=new FileReader;s.onload=e=>t(e.target.result),s.onerror=i,s.readAsDataURL(e)})}async exportSelected(){const e=this.modal.querySelectorAll('.asset-item input[type="checkbox"]:checked'),t=this.modal.querySelectorAll('.asset-dir-header input[type="checkbox"]:checked'),i=[],s=this.modal.querySelector("#asset-pack-name").value.trim()||"Untitled Asset Pack",o=this.modal.querySelector("#asset-pack-description").value.trim()||"",n=this.modal.querySelector("#asset-pack-version").value.trim()||"1.0.0",r=this.modal.querySelector("#asset-pack-author").value.trim()||"",a=new Set;for(const e of t){const t=e.dataset.path;a.add(t)}for(const t of e){const e=t.dataset.path,s=await this.fileBrowser.getFile(e);s&&i.push({path:s.path,content:s.content,type:s.type,name:s.name,parentPath:s.parentPath,created:s.created,modified:s.modified})}if(0===i.length)return void alert("No files selected for export");const l=new Set;a.forEach(e=>{e&&"/"!==e&&l.add(e)}),i.forEach(e=>{let t=e.parentPath;for(;t&&"/"!==t;){if(a.has(t)){l.add(t);let e=t.substring(0,t.lastIndexOf("/"))||"/";for(;e&&"/"!==e&&a.has(e);)l.add(e),e=e.substring(0,e.lastIndexOf("/"))||"/"}t=t.substring(0,t.lastIndexOf("/"))||"/"}});const h=Array.from(l).sort(),c={name:s,description:o,version:n,author:r,timestamp:Date.now(),icon:this.selectedIcon?{data:this.selectedIcon.data,originalName:this.selectedIcon.originalName,size:this.selectedIcon.size}:null,directories:h,totalFiles:i.length,totalDirectories:h.length,files:i,metadata:{exportedBy:"Dark Matter JS Game Engine",exportVersion:"1.0",engineVersion:window.engineVersion||"1.0.0",selectionMode:"explicit-directories-only"}},d=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),p=URL.createObjectURL(d),u=document.createElement("a");u.href=p;const g=s.replace(/[^a-z0-9]/gi,"_").toLowerCase();u.download=g+".dmjs",document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(p),this.fileBrowser.showNotification(`Asset pack "${s}" exported successfully!`,"success"),this.hideModal()}async importAssets(e){try{const t=await this.readFileContent(e),i=JSON.parse(t);if(!i.version||!i.files)throw Error("Invalid asset package format");const s=`Import Asset Pack: "${i.name}"\n        \nDescription: ${i.description||"No description"}\nVersion: ${i.version}\nAuthor: ${i.author||"Unknown"}\nFiles: ${i.totalFiles||i.files.length}\nDirectories: ${i.totalDirectories||0}\n\nContinue with import?`;if(!confirm(s))return;const o=i.name||e.name.replace(".dmjs",""),n="/"+o.replace(/[^a-z0-9\s]/gi,"_");if(await this.fileBrowser.createDirectory(n),i.directories)for(const e of i.directories){const t=`${n}${e}`;await this.fileBrowser.createDirectory(t)}let r=0,a=0;for(const e of i.files)try{const t=`${n}${e.path}`,i=t.substring(0,t.lastIndexOf("/"));i!==n&&"/"!==i&&await this.fileBrowser.createDirectory(i),await this.fileBrowser.writeFile(t,e.content,!0),r++}catch(t){console.error(`Error importing file ${e.path}:`,t),a++}this.fileBrowser.refreshFiles();const l=a>0?`Asset pack imported with ${r} files succeeded, ${a} files failed`:`Asset pack "${o}" imported successfully with ${r} files`;this.fileBrowser.showNotification(l,a>0?"warning":"success"),await this.fileBrowser.navigateTo(n)}catch(e){console.error("Error importing assets:",e),this.fileBrowser.showNotification("Error importing assets: "+e.message,"error")}}readFileContent(e){return new Promise((t,i)=>{const s=new FileReader;s.onload=e=>t(e.target.result),s.onerror=e=>i(e.target.error),s.readAsText(e)})}}window.assetManager=new AssetManager(window.fileBrowser||null);class AssetReference{constructor(e=null,t="any"){this.path=e,this.type=t,this._cachedData=null,this._isLoading=!1,this._loadPromise=null}isValid(){return!!this.path}getFilename(){return this.path?this.path.split("/").pop().split("\\").pop():null}getExtension(){return this.path?this.path.split(".").pop().toLowerCase():null}async load(){return this._cachedData?this._cachedData:this._isLoading&&this._loadPromise?this._loadPromise:this.path?(this._isLoading=!0,this._loadPromise=new Promise(async(e,t)=>{try{if(!window.fileBrowser){const i=this.getExtension();let s=null;if(s=this.path.startsWith("data:image/")||this.path.startsWith("data:audio/")?this.path:window.__ASSET_MAP&&window.__ASSET_MAP[this.path]?window.__ASSET_MAP[this.path]:"assets/"+this.getFilename(),["png","jpg","jpeg","gif","webp","svg"].includes(i)||s.startsWith("data:image/")){const t=new Image,i=new Promise((e,i)=>{t.onload=()=>e(t),t.onerror=e=>i(Error("Error loading image: "+(e.message||"Unknown error")))});t.src=s,this._cachedData=await i,e(this._cachedData)}else if(["mp3","wav","ogg","aac"].includes(i)||s.startsWith("data:audio/")){const t=new Audio,i=new Promise((e,i)=>{t.oncanplaythrough=()=>e(t),t.onerror=e=>i(Error("Error loading audio: "+(e.message||"Unknown error")))});t.src=s,this._cachedData=await i,e(this._cachedData)}else if("js"===i)try{const t=await fetch(s);if(!t.ok)throw Error("Failed to fetch script: "+s);const i=await t.text();this._cachedData=i,e(this._cachedData)}catch(e){t(e)}else try{const t=await fetch(s);if(!t.ok)throw Error("Failed to fetch asset: "+s);const i=await t.text();this._cachedData=i,e(this._cachedData)}catch(e){t(e)}return}const i=await window.fileBrowser.readFile(this.path);if(!i)throw Error("File not found: "+this.path);const s=this.getExtension();if(["png","jpg","jpeg","gif","webp","svg"].includes(s)||i.startsWith("data:image/")){const t=new Image,s=new Promise((e,i)=>{t.onload=()=>e(t),t.onerror=e=>i(Error("Error loading image: "+(e.message||"Unknown error")))});t.src=i,this._cachedData=await s,e(this._cachedData)}else if(["mp3","wav","ogg","aac"].includes(s)){const t=new Audio,s=new Promise((e,i)=>{t.oncanplaythrough=()=>e(t),t.onerror=e=>i(Error("Error loading audio: "+(e.message||"Unknown error")))});t.src=i,this._cachedData=await s,e(this._cachedData)}else this._cachedData=i,e(this._cachedData)}catch(e){console.error(`Error loading asset ${this.path}:`,e),this._cachedData=null,t(e)}finally{this._isLoading=!1}}),this._loadPromise):null}clone(){const e=new AssetReference(this.path,this.type);return e._cachedData=this._cachedData,e}toJSON(){return{path:this.path,type:this.type}}static fromJSON(e){return e?new AssetReference(e.path,e.type||"any"):new AssetReference}}window.AssetReference=AssetReference;class SpriteRenderer extends Module{static allowMultiple=!1;static namespace="Visual";static description="Displays a sprite/image";static iconClass="fas fa-image";constructor(){super("SpriteRenderer"),window.AssetReference||console.warn("AssetReference not found, SpriteRenderer may not work correctly");try{this.imageAsset=new(window.AssetReference||function(e){return{path:e}})(null,"image")}catch(e){console.error("Error creating AssetReference:",e),this.imageAsset={path:null,load:()=>Promise.resolve(null)}}this.width=64,this.height=64,this.drawingCanvas="normal",this.color="#ffffff",this.flipX=!1,this.flipY=!1,this.pivot=new Vector2(.5,.5),this.sliceMode=!1,this.sliceBorder={left:10,right:10,top:10,bottom:10},this.scaleMode="stretch",this.frameX=0,this.frameY=0,this.frameWidth=64,this.frameHeight=64,this.frames=1,this._image=null,this._isLoaded=!1,this._imageWidth=0,this._imageHeight=0,this.registerProperties(),setTimeout(()=>this.refreshInspector(),100),this.addCustomStyles()}registerProperties(){this.clearProperties(),this.exposeProperty("imageAsset","asset",this.imageAsset,{description:"Sprite image to display",assetType:"image",fileTypes:["png","jpg","jpeg","gif","webp"],onAssetSelected:e=>{this.setSprite(e)}}),this.exposeProperty("drawingCanvas","enum",this.drawingCanvas,{description:"Which canvas to draw the sprite on",options:[{value:"normal",label:"Normal"},{value:"background",label:"Background"},{value:"gui",label:"GUI"}],onChange:e=>{this.drawingCanvas=e}}),this.exposeProperty("width","number",this.width,{description:"Width of the sprite in pixels",min:1,max:2048,step:1,onChange:e=>{this.width=e,window.editor?.refreshCanvas()}}),this.exposeProperty("height","number",this.height,{description:"Height of the sprite in pixels",min:1,max:2048,step:1,onChange:e=>{this.height=e,window.editor?.refreshCanvas()}}),this.exposeProperty("scaleMode","enum",this.scaleMode,{description:"How the image should be scaled to fit the dimensions",enumValues:[{value:"stretch",label:"Stretch"},{value:"fit",label:"Fit (preserve aspect ratio)"},{value:"fill",label:"Fill (preserve aspect ratio, may crop)"},{value:"tile",label:"Tile (repeat image)"},{value:"9-slice",label:"9-Slice (stretchable borders)"}],onChange:e=>{const t=this.scaleMode;this.scaleMode=e,"9-slice"===e?(this.sliceMode=!0,"9-slice"!==t&&this.refreshBorderControls()):(this.sliceMode=!1,"9-slice"===t&&this.refreshBorderControls()),window.editor?.refreshCanvas()},cssClass:"scale-mode-dropdown"}),this.exposeProperty("color","color",this.color,{description:"Tint color for the sprite",onChange:e=>{this.color=e,window.editor?.refreshCanvas()}}),this.exposeProperty("flipX","boolean",this.flipX,{description:"Flip the sprite horizontally",onChange:e=>{this.flipX=e,window.editor?.refreshCanvas()}}),this.exposeProperty("flipY","boolean",this.flipY,{description:"Flip the sprite vertically",onChange:e=>{this.flipY=e,window.editor?.refreshCanvas()}}),this.exposeProperty("pivot","vector2",this.pivot,{description:"Pivot point for rotation (0,0 = top left, 1,1 = bottom right)",onChange:e=>{this.pivot=e,window.editor?.refreshCanvas()}}),("9-slice"===this.scaleMode||this.sliceMode)&&this.addSliceBorderProperties()}addSliceBorderProperties(){this.exposeProperty("sliceBorder.left","number",this.sliceBorder.left,{description:"Left border size for 9-slice",min:0,max:100,step:1,label:"Border Left",onChange:e=>{this.sliceBorder.left=e,window.editor?.refreshCanvas()}}),this.exposeProperty("sliceBorder.right","number",this.sliceBorder.right,{description:"Right border size for 9-slice",min:0,max:100,step:1,label:"Border Right",onChange:e=>{this.sliceBorder.right=e,window.editor?.refreshCanvas()}}),this.exposeProperty("sliceBorder.top","number",this.sliceBorder.top,{description:"Top border size for 9-slice",min:0,max:100,step:1,label:"Border Top",onChange:e=>{this.sliceBorder.top=e,window.editor?.refreshCanvas()}}),this.exposeProperty("sliceBorder.bottom","number",this.sliceBorder.bottom,{description:"Bottom border size for 9-slice",min:0,max:100,step:1,label:"Border Bottom",onChange:e=>{this.sliceBorder.bottom=e,window.editor?.refreshCanvas()}})}clearProperties(){if(this.properties)for(const e in this.properties)this.properties.hasOwnProperty(e)&&delete this.properties[e]}refreshBorderControls(){this.registerProperties(),this.refreshInspector()}async start(){this._isLoaded||await this.loadImage()}async loadImage(){if(this.imageAsset&&this.imageAsset.embedded&&!this.imageAsset.path)return console.log("Skipping path-based loading for embedded image data - already loaded"),this._image;if(!this.imageAsset||!this.imageAsset.path&&!this.imageAsset.embedded)return this._isLoaded||this.imageAsset&&this.imageAsset.embedded||console.warn("No image asset path to load"),null;try{if(console.log("Loading image for SpriteRenderer:",this.imageAsset.path),this.imageAsset.path){const e=await this.loadFromAssetManager(this.imageAsset.path);if(e)return e}if(window.editor&&window.editor.fileBrowser&&this.imageAsset.path)try{const e=await this.loadImageFromFileBrowser(this.imageAsset.path);if(e)return console.log("Image loaded via FileBrowser successfully"),this._image=e,this._imageWidth=e.naturalWidth||e.width,this._imageHeight=e.naturalHeight||e.height,this._isLoaded=!0,e}catch(e){console.warn("FileBrowser loading failed, trying fallback:",e)}if(this.imageAsset.embedded&&"function"==typeof this.imageAsset.load){console.log("Loading embedded image data");const e=await this.imageAsset.load();if(e)return this._image=e,this._imageWidth=e.naturalWidth||e.width,this._imageHeight=e.naturalHeight||e.height,this._isLoaded=!0,e}return this.imageAsset.path?await this.fallbackLoadImage(this.imageAsset.path):null}catch(e){return console.error("Error loading sprite image:",e),this._image=null,this._isLoaded=!1,null}}async loadImageFromFileBrowser(e){try{const t=window.editor.fileBrowser,i=await t.readFile(e);if(!i)throw Error("Could not read file from FileBrowser: "+e);if(console.log("FileBrowser content type:",typeof i,i.substring?i.substring(0,50)+"...":"Binary data"),"string"==typeof i&&i.startsWith("data:image")){console.log("Loading image from data URL via FileBrowser");const e=await this.loadImageFromDataURL(i);return 64===this.width&&64===this.height&&(this.width=e.naturalWidth,this.height=e.naturalHeight,console.log(`Auto-sized sprite to ${this.width}x${this.height}`),window.editor&&window.editor.inspector&&window.editor.inspector.refreshModuleUI(this)),e}if("string"!=typeof i||i.startsWith("data:")){if(i instanceof Blob||i instanceof ArrayBuffer){console.log("Converting binary content to data URL");let t=i;i instanceof ArrayBuffer&&(t=new Blob([i],{type:"image/"+e.split(".").pop().toLowerCase()}));const s=await this.blobToDataURL(t),o=await this.loadImageFromDataURL(s);return 64===this.width&&64===this.height&&(this.width=o.naturalWidth,this.height=o.naturalHeight,console.log(`Auto-sized sprite to ${this.width}x${this.height}`),window.editor&&window.editor.inspector&&window.editor.inspector.refreshModuleUI(this)),o}throw Error("Unsupported file content type for image: "+typeof i)}try{const t=e.split(".").pop().toLowerCase();let s,o="image/png";"jpg"===t||"jpeg"===t?o="image/jpeg":"gif"===t?o="image/gif":"webp"===t?o="image/webp":"svg"===t&&(o="image/svg+xml"),s=i.startsWith("data:")&&i.startsWith("data:")?i:`data:${o};base64,${i}`,console.log("Attempting to load as constructed data URL");const n=await this.loadImageFromDataURL(s);return 64===this.width&&64===this.height&&(this.width=n.naturalWidth,this.height=n.naturalHeight,console.log(`Auto-sized sprite to ${this.width}x${this.height}`),window.editor&&window.editor.inspector&&window.editor.inspector.refreshModuleUI(this)),n}catch(t){throw console.error("Failed to construct data URL:",t),Error("File content is not a valid image: "+e)}}catch(e){throw console.error("Error loading image from FileBrowser:",e),e}}async blobToDataURL(e){return new Promise((t,i)=>{const s=new FileReader;s.onload=()=>t(s.result),s.onerror=i,s.readAsDataURL(e)})}refreshInspector(){window.editor&&window.editor.inspector&&(window.editor.inspector.clearModuleCache&&window.editor.inspector.clearModuleCache(this),window.editor.inspector.refreshModuleUI(this),window.editor.refreshCanvas())}fallbackLoadImage(e){return new Promise((t,i)=>{if(!e)return void i(Error("No image path provided"));const s=new Image;if(window.assetManager&&window.assetManager.cache){const o=window.assetManager.normalizePath?window.assetManager.normalizePath(e):e.replace(/^\/+/,"").replace(/\\/g,"/");console.log("Looking for cached asset:",o),console.log("Available cached assets:",Object.keys(window.assetManager.cache));const n=[e,o,e.replace(/^[\/\\]+/,""),e.replace(/\\/g,"/"),e.split("/").pop(),e.split("\\").pop(),decodeURIComponent(e),"/"+e.replace(/^[\/\\]+/,""),"/"+o];let r=null,a=null;for(const e of n)if(window.assetManager.cache[e]){r=window.assetManager.cache[e],a=e,console.log("Found cached asset with path variation:",a);break}if(!r){if("file:"===window.location.protocol||!window.fileBrowser){const t=`Image not found in asset cache: ${e}. This is likely an export issue. Available assets: ${Object.keys(window.assetManager.cache).join(", ")}`;return console.error(t),void i(Error(t))}return console.warn("Asset not in cache, trying direct load for development mode"),void this.tryMultipleImagePaths(s,e).then(t).catch(i)}if(r instanceof HTMLImageElement)return console.log("Using cached HTMLImageElement"),this._image=r,this._imageWidth=r.naturalWidth||r.width,this._imageHeight=r.naturalHeight||r.height,this._isLoaded=!0,void t(r);if("string"==typeof r&&r.startsWith("data:"))console.log("Loading cached data URL"),s.src=r;else{if(!r.content||"string"!=typeof r.content||!r.content.startsWith("data:"))return console.error("Cached asset is not a valid image format:",typeof r,r),void i(Error(`Cached asset for ${e} is not a valid image`));console.log("Loading cached asset content as data URL"),s.src=r.content}}else console.warn("No asset manager or cache available"),s.src=e;s.onload=()=>{console.log("Image loaded successfully:",s.src.substring(0,100)+"..."),this._image=s,this._imageWidth=s.naturalWidth||s.width,this._imageHeight=s.naturalHeight||s.height,this._isLoaded=!0,t(s)},s.onerror=t=>{console.error("Error loading image:",e,t),i(Error("Failed to load image: "+e))}})}async tryMultipleImagePaths(e,t){if(window.editor&&window.editor.fileBrowser){const e=window.editor.fileBrowser,i=[t,t.replace(/^[\/\\]+/,""),"assets/"+t.replace(/^[\/\\]+/,""),"images/"+t.replace(/^[\/\\]+/,""),"src/assets/"+t.replace(/^[\/\\]+/,""),"public/assets/"+t.replace(/^[\/\\]+/,""),"assets/"+t.split(/[\/\\]/).pop(),"images/"+t.split(/[\/\\]/).pop(),"src/assets/"+t.split(/[\/\\]/).pop(),"public/assets/"+t.split(/[\/\\]/).pop()];console.log("Trying FileBrowser paths for image:",t,i);for(const t of i)try{if(await e.fileExists(t)){console.log("Found file in FileBrowser:",t);const e=await this.loadImageFromFileBrowser(t);if(e)return this._image=e,this._imageWidth=e.naturalWidth||e.width,this._imageHeight=e.naturalHeight||e.height,this._isLoaded=!0,e}}catch(e){continue}}if(window.assetManager&&window.assetManager.cache){const e=window.assetManager.cache,i=t.replace(/^[\/\\]+/,"").replace(/\\/g,"/"),s=[t,i,"/"+i,i.split("/").pop(),i.split("\\").pop(),decodeURIComponent(t),decodeURIComponent(i)];console.log("Trying AssetManager cache paths:",s),console.log("Available cached assets:",Object.keys(e));for(const t of s)if(e[t]){const i=e[t];if(i instanceof HTMLImageElement)return console.log("Found cached image:",t),this._image=i,this._imageWidth=i.naturalWidth||i.width,this._imageHeight=i.naturalHeight||i.height,this._isLoaded=!0,i;if("string"==typeof i&&i.startsWith("data:"))return console.log("Loading cached data URL:",t),this.loadImageFromDataURL(i)}}return console.warn("All relative path attempts failed, falling back to direct URL loading"),this.directUrlFallback(e,t)}async directUrlFallback(e,t){console.warn("Using direct URL fallback - this may not work in all environments:",t);const i=t.replace(/^\/+/,"").replace(/\\/g,"/"),s=[i,"assets/"+i,"images/"+i,t];console.log("Trying direct URL paths:",s);for(const t of s)try{if(await this.testImagePath(t))return console.log("Successfully loaded image from direct URL:",t),new Promise((i,s)=>{e.onload=()=>{this._image=e,this._imageWidth=e.naturalWidth||e.width,this._imageHeight=e.naturalHeight||e.height,this._isLoaded=!0,i(e)},e.onerror=s,e.src=t})}catch(e){continue}throw Error("Could not load image from any of the attempted paths for: "+t)}testImagePath(e){return new Promise(t=>{const i=new Image;i.onload=()=>t(!0),i.onerror=()=>t(!1),setTimeout(()=>t(!1),3e3),i.src=e})}resolveImagePath(e){if(!e)return"";if(e.startsWith("http")||e.startsWith("data:")||e.startsWith("blob:"))return e;const t=e.replace(/^\/+/,"").replace(/\\/g,"/");return window.location.origin+window.location.pathname.replace(/\/[^\/]*$/,"/")+t}async setSprite(e){if(console.log("setSprite called with path:",e),null==e)return this.imageAsset=null,this._image=null,void(this._isLoaded=!1);if(this.imageAsset&&this.imageAsset.path===e)console.log("Sprite path unchanged, skipping");else try{window.AssetReference?this.imageAsset=new window.AssetReference(e,"image"):this.imageAsset={path:e,type:"image",load:()=>window.assetManager?window.assetManager.getAssetByPath(e):this.fallbackLoadImage(e)};const t=await this.loadImage();t?console.log("Image loaded successfully:",t.src||"data URL"):console.warn("Failed to load image"),window.editor&&window.editor.refreshCanvas()}catch(e){console.error("Error setting sprite:",e)}}draw(e){if(!this._image||!this._isLoaded||0===this.width||0===this.height)return void this.drawPlaceholder(e);const t=this.width*this.pivot.x,i=this.height*this.pivot.y;e.save(),(this.flipX||this.flipY)&&e.scale(this.flipX?-1:1,this.flipY?-1:1),this.drawWithScaleMode(e,-t,-i),"#ffffff"!==this.color&&(e.globalCompositeOperation="multiply",e.fillStyle=this.color,e.fillRect(-t,-i,this.width,this.height)),e.restore()}drawFrame(e,t,i){e.drawImage(this._image,this.frameX*this.frameWidth,this.frameY*this.frameHeight,this.frameWidth,this.frameHeight,t,i,this.width,this.height)}registerCustomInspectorHandlers(){window.editor&&window.editor.inspector&&window.editor.inspector.registerCustomUIHandler("SpriteRenderer","imageAsset",(e,t)=>{e.classList.contains("image-preview")&&t.setupDragAndDrop(e)})}onInspectorCreated(){this.registerCustomInspectorHandlers()}setupDragAndDrop(e){e&&(e.addEventListener("dragover",t=>{t.preventDefault(),t.stopPropagation(),e.classList.add("drag-over")}),e.addEventListener("dragleave",()=>{e.classList.remove("drag-over")}),e.addEventListener("drop",async t=>{t.preventDefault(),t.stopPropagation(),e.classList.remove("drag-over"),await this.handleImageDrop(t.dataTransfer)&&window.editor&&window.editor.inspector&&(window.editor.inspector.refreshModuleUI(this),window.editor.refreshCanvas())}))}async handleImageDrop(e){try{if(e.files&&e.files.length>0){const t=e.files[0];if(!t.type.startsWith("image/"))return console.warn("Dropped file is not an image:",t.type),!1;const i=window.editor?.fileBrowser||window.fileBrowser;if(!i)return console.warn("FileBrowser not available for image upload"),!1;await i.handleFileUpload(t);const s=`${i.currentPath}/${t.name}`;return await this.setSprite(s),console.log("Successfully set sprite to:",s),!0}const t=e.getData("application/json");if(t)try{const e=JSON.parse(t);if(e&&e.length>0){const t=e[0].path;if(t&&this.isImagePath(t))return await this.setSprite(t),console.log("Successfully set sprite to:",t),!0}}catch(e){console.error("Error parsing drag JSON data:",e)}const i=e.getData("text/plain");return!(!i||!this.isImagePath(i)||(await this.setSprite(i),console.log("Successfully set sprite to:",i),0))}catch(e){return console.error("Error handling image drop:",e),!1}}isImagePath(e){if(!e)return!1;const t=e.toLowerCase();return[".png",".jpg",".jpeg",".gif",".webp",".svg"].some(e=>t.endsWith(e))}async loadImageFromFile(){const e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=async e=>{if(e.target.files&&e.target.files[0]){const t=e.target.files[0],i=window.editor?.fileBrowser;if(!i)return void console.warn("FileBrowser not available for image upload");await i.handleFileUpload(t);const s=`${i.currentPath}/${t.name}`;await this.setSprite(s)}},e.click()}loadImageFromDataURL(e){return new Promise((t,i)=>{const s=new Image;s.onload=()=>{console.log("Image loaded from data URL successfully"),t(s)},s.onerror=e=>{console.error("Error loading image from data URL:",e),i(Error("Failed to load image from data URL"))},s.src=e})}async loadImageFromUrl(){const e=await this.promptUrlInput();if(e)try{const t=new Image,i=new Promise((i,s)=>{t.onload=()=>i(!0),t.onerror=()=>s(Error("Failed to load image from URL: "+e)),setTimeout(()=>s(Error("Image loading timed out")),1e4)});t.crossOrigin="anonymous",t.src=e,await i;const s=window.editor?.fileBrowser;if(!s)return console.warn("FileBrowser not available for image upload"),void await this.setSprite(e);const o=await this.fetchImageAsDataURL(e),n=this.generateFilenameFromUrl(e);await s.createFile(`${s.currentPath}/${n}`,o);const r=`${s.currentPath}/${n}`;await this.setSprite(r)}catch(e){console.error("Error loading image from URL:",e),alert("Failed to load image: "+e.message)}}async fetchImageAsDataURL(e){try{const t=await fetch(e,{mode:"cors"}),i=await t.blob();return new Promise(e=>{const t=new FileReader;t.onloadend=()=>e(t.result),t.readAsDataURL(i)})}catch(t){return console.warn("Could not fetch image (possible CORS issue), using direct URL"),e}}generateFilenameFromUrl(e){try{const t=new URL(e).pathname.split("/").pop();if(t&&t.includes("."))return t}catch(e){}return`image_${Math.random().toString(36).substring(2,10)}.png`}async promptUrlInput(){return new Promise(e=>{const t=document.createElement("div");t.className="url-input-dialog",t.innerHTML='\n                <div class="url-input-content">\n                    <h3>Enter Image URL</h3>\n                    <input type="text" placeholder="https://example.com/image.png" class="url-input-field">\n                    <div class="url-input-buttons">\n                        <button class="cancel-btn">Cancel</button>\n                        <button class="ok-btn">OK</button>\n                    </div>\n                </div>\n            ';const i=document.createElement("style");i.innerHTML="\n                .url-input-dialog {\n                    position: fixed;\n                    top: 0;\n                    left: 0;\n                    width: 100%;\n                    height: 100%;\n                    background-color: rgba(0,0,0,0.5);\n                    display: flex;\n                    align-items: center;\n                    justify-content: center;\n                    z-index: 10000;\n                }\n                .url-input-content {\n                    background-color: #2a2a2a;\n                    border-radius: 4px;\n                    padding: 20px;\n                    width: 400px;\n                    box-shadow: 0 2px 10px rgba(0,0,0,0.2);\n                }\n                .url-input-content h3 {\n                    margin-top: 0;\n                    color: #eee;\n                }\n                .url-input-field {\n                    width: 100%;\n                    padding: 8px;\n                    margin: 10px 0;\n                    background: #333;\n                    border: 1px solid #555;\n                    color: #eee;\n                    border-radius: 2px;\n                }\n                .url-input-buttons {\n                    display: flex;\n                    justify-content: flex-end;\n                    margin-top: 15px;\n                }\n                .url-input-buttons button {\n                    padding: 6px 12px;\n                    margin-left: 10px;\n                    background: #444;\n                    border: none;\n                    color: #eee;\n                    border-radius: 2px;\n                    cursor: pointer;\n                }\n                .url-input-buttons button.ok-btn {\n                    background: #2196F3;\n                }\n                .url-input-buttons button:hover {\n                    opacity: 0.9;\n                }\n            ",document.head.appendChild(i),document.body.appendChild(t);const s=t.querySelector(".url-input-field"),o=t.querySelector(".cancel-btn"),n=t.querySelector(".ok-btn"),r=()=>{document.body.removeChild(t),document.head.removeChild(i)},a=()=>{r(),e(null)},l=()=>{const t=s.value.trim();r(),e(t||null)};o.addEventListener("click",a),n.addEventListener("click",l),s.addEventListener("keydown",e=>{"Enter"===e.key&&l(),"Escape"===e.key&&a()}),setTimeout(()=>s.focus(),50)})}drawPlaceholder(e){const t=this.width*this.pivot.x,i=this.height*this.pivot.y;e.save(),e.strokeStyle="#aaaaaa",e.fillStyle="#333333",e.lineWidth=2,e.fillRect(-t,-i,this.width||64,this.height||64),e.strokeRect(-t,-i,this.width||64,this.height||64),e.fillStyle="#aaaaaa";const s=.5*Math.min(this.width||64,this.height||64),o=-t+(this.width||64)/2-s/2,n=-i+(this.height||64)/2-s/2;e.fillRect(o,n,s,s),e.fillStyle="#333333",e.beginPath(),e.arc(o+.7*s,n+.3*s,.15*s,0,2*Math.PI),e.fill(),e.restore()}drawWithScaleMode(e,t,i){switch(this.scaleMode){case"fit":this.drawFit(e,t,i);break;case"fill":this.drawFill(e,t,i);break;case"tile":this.drawTile(e,t,i);break;case"9-slice":this.drawNineSlice(e,t,i);break;default:e.drawImage(this._image,t,i,this.width,this.height)}}drawFit(e,t,i){const s=this._imageWidth/this._imageHeight;let o,n,r,a;s>this.width/this.height?(o=this.width,n=this.width/s,r=0,a=(this.height-n)/2):(n=this.height,o=this.height*s,r=(this.width-o)/2,a=0),e.drawImage(this._image,0,0,this._imageWidth,this._imageHeight,t+r,i+a,o,n)}drawFill(e,t,i){const s=this._imageWidth/this._imageHeight,o=this.width/this.height;let n,r,a,l;s>o?(l=this._imageHeight,a=this._imageHeight*o,n=(this._imageWidth-a)/2,r=0):(a=this._imageWidth,l=this._imageWidth/o,n=0,r=(this._imageHeight-l)/2),e.drawImage(this._image,n,r,a,l,t,i,this.width,this.height)}drawTile(e,t,i){const s=e.createPattern(this._image,"repeat");s?(e.save(),e.beginPath(),e.rect(t,i,this.width,this.height),e.clip(),e.fillStyle=s,e.fillRect(t,i,this.width,this.height),e.restore()):e.drawImage(this._image,t,i,this.width,this.height)}drawNineSlice(e,t,i){const s=this._image,o=this.width,n=this.height,r=this.sliceBorder,a=Math.min(r.left,this._imageWidth/3),l=Math.min(r.right,this._imageWidth/3),h=Math.min(r.top,this._imageHeight/3),c=Math.min(r.bottom,this._imageHeight/3),d=Math.floor(this._imageWidth/2),p=Math.floor(this._imageHeight/2),u=Math.min(a,d),g=Math.min(l,d),m=Math.min(h,p),f=Math.min(c,p),y=[0,u,this._imageWidth-g,this._imageWidth],w=[0,m,this._imageHeight-f,this._imageHeight],b=[t,t+u,t+o-g,t+o],x=[i,i+m,i+n-f,i+n];for(let t=0;3>t;t++)for(let i=0;3>i;i++){const o=y[i],n=w[t],r=y[i+1]-o,a=w[t+1]-n,l=b[i],h=x[t],c=b[i+1]-l,d=x[t+1]-h;r>0&&a>0&&c>0&&d>0&&e.drawImage(s,o,n,r,a,l,h,c,d)}}addCustomStyles(){if(document.getElementById("sprite-renderer-styles"))return;const e=document.createElement("style");e.id="sprite-renderer-styles",e.innerHTML='\n            .scale-mode-dropdown {\n                width: 100%;\n                background-color: #333;\n                color: #eee;\n                border: 1px solid #555;\n                padding: 8px;\n                border-radius: 3px;\n                font-size: 12px;\n                height: auto !important;\n                appearance: menulist; /* Show dropdown arrow */\n            }\n            \n            .scale-mode-dropdown option {\n                background-color: #333;\n                color: #eee;\n                padding: 6px;\n            }\n            \n            .scale-mode-dropdown:focus {\n                outline: none;\n                border-color: #2196F3;\n            }\n            \n            /* Ensure border controls are correctly aligned */\n            .property-row input[data-prop-name^="sliceBorder"] {\n                width: 60px;\n                text-align: right;\n            }\n        ',document.head.appendChild(e)}async loadImageFromData(e){return new Promise((t,i)=>{const s=new Image;s.onload=()=>{this._image=s,this._imageWidth=s.naturalWidth,this._imageHeight=s.naturalHeight,this._isLoaded=!0,console.log("Image loaded from data URL, dimensions:",this._imageWidth,"x",this._imageHeight),window.editor&&window.editor.refreshCanvas(),t(s)},s.onerror=e=>{console.error("Failed to load image from data URL:",e),i(e)},s.src=e})}async loadFromAssetManager(e){if(!e)return null;try{if(window.assetManager){const t=await window.assetManager.getAssetByPath(e);if(t&&t instanceof HTMLImageElement)return this._image=t,this._imageWidth=t.naturalWidth||t.width,this._imageHeight=t.naturalHeight||t.height,this._isLoaded=!0,console.log("Image loaded from AssetManager:",e),t}return await this.fallbackLoadImage(e)}catch(e){return console.error("Error loading from AssetManager:",e),null}}toJSON(){const e=super.toJSON()||{};return e.imageAsset=this.imageAsset?{path:this.imageAsset.path,type:"image",embedded:this.imageAsset.embedded||!1}:null,e.width=this.width,e.height=this.height,e.color=this.color,e.flipX=this.flipX,e.flipY=this.flipY,e.pivot={x:this.pivot.x,y:this.pivot.y},e.scaleMode=this.scaleMode,e.frameX=this.frameX,e.frameY=this.frameY,e.frameWidth=this.frameWidth,e.frameHeight=this.frameHeight,e.frames=this.frames,e.sliceMode=this.sliceMode,e.sliceBorder={...this.sliceBorder},e}fromJSON(e){if(super.fromJSON(e),e)if(void 0!==e.width&&(this.width=e.width),void 0!==e.height&&(this.height=e.height),void 0!==e.color&&(this.color=e.color),void 0!==e.flipX&&(this.flipX=e.flipX),void 0!==e.flipY&&(this.flipY=e.flipY),void 0!==e.pivot&&(this.pivot=e.pivot),void 0!==e.scaleMode&&(this.scaleMode=e.scaleMode),void 0!==e.sliceMode&&(this.sliceMode=e.sliceMode),void 0!==e.sliceBorder&&(this.sliceBorder=e.sliceBorder),e.imageAsset&&e.imageAsset.path){console.log("Loading sprite from AssetManager:",e.imageAsset.path);try{window.AssetReference?this.imageAsset=new window.AssetReference(e.imageAsset.path,"image"):this.imageAsset={path:e.imageAsset.path,type:"image",embedded:e.imageAsset.embedded||!1,load:()=>this.loadFromAssetManager(e.imageAsset.path)},this.loadFromAssetManager(e.imageAsset.path)}catch(e){console.error("Error restoring image asset:",e)}}else this.imageAsset={path:null,type:"image",load:()=>Promise.resolve(null)},this._image=null,this._isLoaded=!1}}window.SpriteRenderer=SpriteRenderer;class RigidBody extends Module{static allowMultiple=!1;static namespace="Matter.js";static description="Physics component that adds a physical body to a GameObject for Matter.js";constructor(){if(super("RigidBody"),this.body=null,this.bodyType="dynamic",this.density=1,this.friction=.8,this.restitution=.1,this.linearDamping=.01,this.angularDamping=.01,this.isSensor=!1,this.collisionFilter={category:1,mask:4294967295,group:0},this.useGravity=!0,this.frictionAir=.01,this.sleepingAllowed=!0,this.label="",this.shape="rectangle",this.width=50,this.height=50,this.radius=25,this.vertices=[],this.fixedRotation=!1,this.marchingCubesTerrain="",this.marchingCubesRadius=150,this.inCollision=new Set,this.bodyNeedsUpdate=!1,this._skipRebuild=!0,this.exposeProperty("bodyType","enum",this.bodyType,{options:["dynamic","static","kinematic"],onChange:e=>{this.bodyType=e,this._skipRebuild||this.rebuildBody()}}),this.exposeProperty("shape","enum",this.shape,{options:["rectangle","circle","capsule","polygon"],onChange:e=>{this.shape=e,this._skipRebuild||this.rebuildBody()}}),this.exposeProperty("width","number",this.width,{min:1,onChange:e=>{this.width=e,this._skipRebuild||this.rebuildBody()}}),this.exposeProperty("height","number",this.height,{min:1,onChange:e=>{this.height=e,this._skipRebuild||this.rebuildBody()}}),this.exposeProperty("radius","number",this.radius,{min:1,onChange:e=>{this.radius=e,this._skipRebuild||this.rebuildBody()}}),this.exposeProperty("density","number",this.density,{min:.001,max:100,onChange:e=>{this.density=e,this.body&&Matter.Body.setDensity(this.body,e)}}),this.exposeProperty("friction","number",this.friction,{min:0,max:1,onChange:e=>{this.friction=e,this.body&&(this.body.friction=e)}}),this.exposeProperty("restitution","number",this.restitution,{min:0,max:1,onChange:e=>{this.restitution=e,this.body&&(this.body.restitution=e)}}),this.exposeProperty("useGravity","boolean",this.useGravity,{onChange:e=>{this.useGravity=e,this.body&&(this.body.ignoreGravity=!e)}}),this.exposeProperty("frictionAir","number",this.frictionAir,{min:0,max:1,onChange:e=>{this.frictionAir=e,this.body&&(this.body.frictionAir=e)}}),this.exposeProperty("sleepingAllowed","boolean",this.sleepingAllowed,{onChange:e=>{this.sleepingAllowed=e,this.body&&(this.body.sleepThreshold=e?60:-1)}}),this.exposeProperty("label","string",this.label,{onChange:e=>{this.label=e,this.body&&(this.body.label=e)}}),this.exposeProperty("fixedRotation","boolean",!1,{onChange:e=>{if(this.fixedRotation=e,this.body)if(e)this.body.inertia=1/0,this.body.inverseInertia=0;else{if("circle"===this.shape){const e=this.body.mass,t=this.radius;this.body.inertia=e*t*t}else{const e=this.body.mass;let t=0;const i=this.body.vertices,s=this.body.position;for(let e=0;e<i.length;e++){const o=i[e],n=o.x-s.x,r=o.y-s.y;t+=n*n+r*r}this.body.inertia=e*(t/i.length)}this.body.inverseInertia=1/this.body.inertia}}}),this.exposeProperty("isSensor","boolean",this.isSensor,{onChange:e=>{this.isSensor=e,this.body&&(this.body.isSensor=e)}}),this.exposeProperty("marchingCubesTerrain","string",this.marchingCubesTerrain,{onChange:e=>{this.marchingCubesTerrain=e}}),this.exposeProperty("marchingCubesRadius","number",this.marchingCubesRadius,{min:10,onChange:e=>{this.marchingCubesRadius=e}}),this.boundOnCollisionStart=this.onCollisionStart.bind(this),this.boundOnCollisionEnd=this.onCollisionEnd.bind(this),this.gameObject){const e=this.gameObject.getWorldPosition();this.initialPosition={x:e.x,y:e.y},this.initialAngle=this.gameObject.angle}else this.initialPosition=null,this.initialAngle=null}start(){if(window.physicsManager){if(this.gameObject){const e=this.gameObject.getWorldPosition();this.initialPosition={x:e.x,y:e.y},this.initialAngle=this.gameObject.angle}this.onStart(),Matter.Events.on(window.physicsManager.engine,"collisionStart",this.boundOnCollisionStart),Matter.Events.on(window.physicsManager.engine,"collisionEnd",this.boundOnCollisionEnd)}else console.error("Physics manager not found. Make sure it's initialized before using RigidBody.")}createBody(){if(!this.gameObject)return;if(this.removeBody(),!window.physicsManager)return console.error("PhysicsManager not found or not initialized"),null;let e,t=this.gameObject.getWorldPosition();const i=this.gameObject.angle*(Math.PI/180),s=this.gameObject.size?.x*this.gameObject.scale.x||this.width,o=this.gameObject.size?.y*this.gameObject.scale.y||this.height,n=(this.gameObject.size?.x*this.gameObject.scale.x||this.radius)/2,r={friction:this.friction,frictionAir:this.frictionAir,restitution:this.restitution,density:this.density,isSensor:this.isSensor,isStatic:"static"===this.bodyType,angle:i,label:this.label||this.gameObject.name||"Body",collisionFilter:this.collisionFilter,sleepThreshold:this.sleepingAllowed?60:-1};try{switch(this.shape){case"rectangle":default:e=Matter.Bodies.rectangle(t.x,t.y,s,o,r);break;case"circle":e=Matter.Bodies.circle(t.x,t.y,n,r);break;case"capsule":const i=Math.min(s,o)/2,a=Math.max(s,o)-2*i;if(o>s){const o=a,n=Matter.Bodies.rectangle(t.x,t.y,s,o,r),l=Matter.Bodies.circle(t.x,t.y-o/2,i,r),h=Matter.Bodies.circle(t.x,t.y+o/2,i,r);e=Matter.Body.create({parts:[n,l,h],...r})}else{const s=a,n=Matter.Bodies.rectangle(t.x,t.y,s,o,r),l=Matter.Bodies.circle(t.x-s/2,t.y,i,r),h=Matter.Bodies.circle(t.x+s/2,t.y,i,r);e=Matter.Body.create({parts:[n,l,h],...r})}break;case"polygon":let l=this.gameObject.polygonPoints?.length?this.gameObject.polygonPoints.map(e=>({x:e.x,y:e.y})):this.vertices;e=l&&l.length>=3?Matter.Bodies.fromVertices(t.x,t.y,l,r):Matter.Bodies.polygon(t.x,t.y,3,n,r)}}catch(e){return console.error("Error creating physics body:",e),null}"static"===this.bodyType?(e.inertia=1/0,e.inverseInertia=0,e.inverseMass=0,e.mass=1/0,e.velocity.x=0,e.velocity.y=0,e.angularVelocity=0):"kinematic"===this.bodyType?(e.inertia=1/0,e.inverseInertia=0,e.mass=1/0,e.inverseMass=0):e.mass=this.density*e.area||1,this.fixedRotation&&(e.inertia=1/0,e.inverseInertia=0),e&&(e.ignoreGravity=!this.useGravity);try{window.physicsManager&&e&&(window.physicsManager.registerBody(e,this.gameObject),window.physicsManager.engine.world.bodies.includes(e)||(console.warn(`Body for ${r.label} was not properly added to the physics world`),Matter.World.add(window.physicsManager.engine.world,e)))}catch(e){console.error("Error registering physics body:",e)}return e&&(this.body=e,this.body.module=this),e}setAngle(e){if(this.body){const t=e*(Math.PI/180);Matter.Body.setAngle(this.body,t)}}rotate(e){if(this.body){const t=e;Matter.Body.setAngle(this.body,this.body.angle+t)}}updateMass(e=1){if(this.body&&"dynamic"===this.bodyType){const t=this.body.area||1,i=this.density*t*e;Matter.Body.setMass(this.body,i)}}onStart(){this.pendingBodyCreation&&!this.body&&(console.log("Creating pending RigidBody for:",this.gameObject?.name),this.createBody(),this.pendingBodyCreation=!1)}resetPosition(){this.initialPosition&&this.gameObject&&(this.gameObject.setWorldPosition(this.initialPosition.x,this.initialPosition.y),this.gameObject.angle=this.initialAngle||0,this.body&&(Matter.Body.setPosition(this.body,{x:this.initialPosition.x,y:this.initialPosition.y}),Matter.Body.setAngle(this.body,(this.initialAngle||0)*(Math.PI/180))))}removeBody(){this.body&&window.physicsManager&&(window.physicsManager.removeBody(this.body),this.body=null)}rebuildBody(){if(this.gameObject&&window.physicsManager){const e=this.gameObject.getWorldPosition();this.initialPosition={x:e.x,y:e.y},this.initialAngle=this.gameObject.angle,this.createBody()}}applyForce(e){this.body&&Matter.Body.applyForce(this.body,this.body.position,{x:e.x,y:e.y})}applyImpulse(e){if(this.body){const t=this.body.position;Matter.Body.applyForce(this.body,t,{x:e.x/this.body.mass,y:e.y/this.body.mass})}}applyTorque(e){this.body&&Matter.Body.setAngularVelocity(this.body,this.body.angularVelocity+e)}setAngularVelocity(e){if(this.body){const t=e*(Math.PI/180);Matter.Body.setAngularVelocity(this.body,t)}}setVelocity(e){this.body&&Matter.Body.setVelocity(this.body,{x:e.x,y:e.y})}getVelocity(){return this.body?new Vector2(this.body.velocity.x,this.body.velocity.y):new Vector2(0,0)}setAngularVelocity(e){if(this.body){const t=e*(Math.PI/180);Matter.Body.setAngularVelocity(this.body,t)}}getAngularVelocity(){return this.body?this.body.angularVelocity*(180/Math.PI):0}updateColliderSize(){if(!this.gameObject||this._skipRebuild)return;const e=this.gameObject.size?.x*this.gameObject.scale.x||this.width,t=this.gameObject.size?.y*this.gameObject.scale.y||this.height,i=(this.gameObject.size?.x*this.gameObject.scale.x||this.radius)/2,s=this.width,o=this.height,n=this.radius;(Math.abs(e-s)>.1||Math.abs(t-o)>.1||Math.abs(i-n)>.1)&&(this.width=e,this.height=t,this.radius=i,this.rebuildBody())}onCollisionStart(e){const t=e.pairs;for(let e=0;e<t.length;e++){const i=t[e];if(i.bodyA===this.body){this.inCollision.add(i.bodyB);const e=window.physicsManager.bodies.get(i.bodyB);e&&this.gameObject&&this.gameObject.onCollisionEnter&&this.gameObject.onCollisionEnter(e)}else if(i.bodyB===this.body){this.inCollision.add(i.bodyA);const e=window.physicsManager.bodies.get(i.bodyA);e&&this.gameObject&&this.gameObject.onCollisionEnter&&this.gameObject.onCollisionEnter(e)}}}onCollisionEnd(e){const t=e.pairs;for(let e=0;e<t.length;e++){const i=t[e];if(i.bodyA===this.body){this.inCollision.delete(i.bodyB);const e=window.physicsManager.bodies.get(i.bodyB);e&&this.gameObject&&this.gameObject.onCollisionExit&&this.gameObject.onCollisionExit(e)}else if(i.bodyB===this.body){this.inCollision.delete(i.bodyA);const e=window.physicsManager.bodies.get(i.bodyA);e&&this.gameObject&&this.gameObject.onCollisionExit&&this.gameObject.onCollisionExit(e)}}}beginLoop(){if(this.updateColliderSize(),this.body&&"static"===this.bodyType&&this.gameObject){const e=this.gameObject.getWorldPosition(),t=this.gameObject.angle*(Math.PI/180);Matter.Body.setPosition(this.body,{x:e.x,y:e.y}),Matter.Body.setAngle(this.body,t)}if(this.fixedRotation&&this.body&&(Matter.Body.setAngularVelocity(this.body,0),this.body.angle=0),this.marchingCubesTerrain)try{const e=this.getGameObjectByName(this.marchingCubesTerrain).getModule("MarchingCubesTerrain");if(e){const t=this.gameObject.getWorldPosition();e.activateRigidBodiesRegion(this.gameObject.id,t.x,t.y,this.marchingCubesRadius)}else console.warn(`MarchingCubesTerrain object named "${this.marchingCubesTerrain}" not found.`)}catch(e){console.error("Error accessing marching cubes terrain:",e)}}onEnable(){this.pendingBodyCreation&&!this.body&&window.physicsManager&&(this.createBody(),this.pendingBodyCreation=!1)}drawGizmos(e){const t=this.gameObject,i=(t.position,t.angle,this.gameObject.size?.x*this.gameObject.scale.x||this.width),s=this.gameObject.size?.y*this.gameObject.scale.y||this.height,o=(this.gameObject.size?.x*this.gameObject.scale.x||this.radius)/2;switch(e.save(),e.strokeStyle=this.isSensor?"#00ff00":"#ffffff",e.lineWidth="static"===this.bodyType?2:1,e.setLineDash("kinematic"===this.bodyType?[5,5]:[]),e.beginPath(),this.shape){case"rectangle":e.rect(-i/2,-s/2,i,s);break;case"circle":e.arc(0,0,o,0,2*Math.PI),e.moveTo(0,0),e.lineTo(o,0);break;case"capsule":const t=Math.min(i,s)/2,n=Math.max(i,s)-2*t;if(s>i){const s=n/2;e.rect(-i/2,-s,i,n),e.arc(0,-s,t,Math.PI,0,!1),e.arc(0,s,t,0,Math.PI,!1)}else{const i=n/2;e.rect(-i,-s/2,n,s),e.arc(-i,0,t,Math.PI/2,-Math.PI/2,!1),e.arc(i,0,t,-Math.PI/2,Math.PI/2,!1)}break;case"polygon":const r=this.gameObject.polygonPoints?.length?this.gameObject.polygonPoints:this.vertices.length?this.vertices:[{x:0,y:-o},{x:-o,y:o},{x:o,y:o}];if(r.length>0){e.moveTo(r[0].x,r[0].y);for(let t=1;t<r.length;t++)e.lineTo(r[t].x,r[t].y);e.closePath()}}e.stroke(),e.restore()}onDestroy(){window.physicsManager&&window.physicsManager.engine&&(Matter.Events.off(window.physicsManager.engine,"collisionStart",this.boundOnCollisionStart),Matter.Events.off(window.physicsManager.engine,"collisionEnd",this.boundOnCollisionEnd)),this.removeBody()}toJSON(){return{...super.toJSON(),bodyType:this.bodyType,shape:this.shape,width:this.width,height:this.height,radius:this.radius,density:this.density,friction:this.friction,frictionAir:this.frictionAir,restitution:this.restitution,fixedRotation:this.fixedRotation,marchingCubesTerrain:this.marchingCubesTerrain,marchingCubesRadius:this.marchingCubesRadius,isSensor:this.isSensor,useGravity:this.useGravity,sleepingAllowed:this.sleepingAllowed,label:this.label,collisionFilter:{...this.collisionFilter},vertices:this.vertices}}fromJSON(e){if(super.fromJSON(e),this.bodyType=e.bodyType??this.bodyType,this.shape=e.shape??this.shape,this.width=e.width??this.width,this.height=e.height??this.height,this.radius=e.radius??this.radius,this.density=e.density??this.density,this.friction=e.friction??this.friction,this.frictionAir=e.frictionAir??this.frictionAir,this.restitution=e.restitution??this.restitution,this.fixedRotation=e.fixedRotation??!1,this.marchingCubesTerrain=e.marchingCubesTerrain??this.marchingCubesTerrain,this.marchingCubesRadius=e.marchingCubesRadius??this.marchingCubesRadius,this.isSensor=e.isSensor??!1,this.useGravity=e.useGravity??!0,this.sleepingAllowed=e.sleepingAllowed??!0,this.label=e.label??"",this.collisionFilter={...this.collisionFilter,...e.collisionFilter},this.vertices=e.vertices??[],this.gameObject){const e=this.gameObject.getWorldPosition();this.initialPosition={x:e.x,y:e.y},this.initialAngle=this.gameObject.angle}this.pendingBodyCreation=!0}}window.RigidBody=RigidBody;class SpriteRendererBackground extends Module{static allowMultiple=!1;static namespace="Visual";static description="Displays a sprite/image";static iconClass="fas fa-image";constructor(){super("SpriteRendererBackground"),window.AssetReference||console.warn("AssetReference not found, SpriteRendererBackground may not work correctly");try{this.imageAsset=new(window.AssetReference||function(e){return{path:e}})(null,"image")}catch(e){console.error("Error creating AssetReference:",e),this.imageAsset={path:null,load:()=>Promise.resolve(null)}}this.width=64,this.height=64,this.drawingCanvas="normal",this.color="#ffffff",this.flipX=!1,this.flipY=!1,this.pivot=new Vector2(.5,.5),this.sliceMode=!1,this.sliceBorder={left:10,right:10,top:10,bottom:10},this.scaleMode="stretch",this.frameX=0,this.frameY=0,this.frameWidth=64,this.frameHeight=64,this.frames=1,this._image=null,this._isLoaded=!1,this._imageWidth=0,this._imageHeight=0,this.registerProperties(),setTimeout(()=>this.refreshInspector(),100),this.addCustomStyles()}registerProperties(){this.clearProperties(),this.exposeProperty("imageAsset","asset",this.imageAsset,{description:"Sprite image to display",assetType:"image",fileTypes:["png","jpg","jpeg","gif","webp"],onAssetSelected:e=>{this.setSprite(e)}}),this.exposeProperty("drawingCanvas","enum",this.drawingCanvas,{description:"Which canvas to draw the sprite on",options:[{value:"normal",label:"Normal"},{value:"background",label:"Background"},{value:"gui",label:"GUI"}],onChange:e=>{this.drawingCanvas=e}}),this.exposeProperty("width","number",this.width,{description:"Width of the sprite in pixels",min:1,max:2048,step:1,onChange:e=>{this.width=e,window.editor?.refreshCanvas()}}),this.exposeProperty("height","number",this.height,{description:"Height of the sprite in pixels",min:1,max:2048,step:1,onChange:e=>{this.height=e,window.editor?.refreshCanvas()}}),this.exposeProperty("scaleMode","enum",this.scaleMode,{description:"How the image should be scaled to fit the dimensions",enumValues:[{value:"stretch",label:"Stretch"},{value:"fit",label:"Fit (preserve aspect ratio)"},{value:"fill",label:"Fill (preserve aspect ratio, may crop)"},{value:"tile",label:"Tile (repeat image)"},{value:"9-slice",label:"9-Slice (stretchable borders)"}],onChange:e=>{const t=this.scaleMode;this.scaleMode=e,"9-slice"===e?(this.sliceMode=!0,"9-slice"!==t&&this.refreshBorderControls()):(this.sliceMode=!1,"9-slice"===t&&this.refreshBorderControls()),window.editor?.refreshCanvas()},cssClass:"scale-mode-dropdown"}),this.exposeProperty("color","color",this.color,{description:"Tint color for the sprite",onChange:e=>{this.color=e,window.editor?.refreshCanvas()}}),this.exposeProperty("flipX","boolean",this.flipX,{description:"Flip the sprite horizontally",onChange:e=>{this.flipX=e,window.editor?.refreshCanvas()}}),this.exposeProperty("flipY","boolean",this.flipY,{description:"Flip the sprite vertically",onChange:e=>{this.flipY=e,window.editor?.refreshCanvas()}}),this.exposeProperty("pivot","vector2",this.pivot,{description:"Pivot point for rotation (0,0 = top left, 1,1 = bottom right)",onChange:e=>{this.pivot=e,window.editor?.refreshCanvas()}}),("9-slice"===this.scaleMode||this.sliceMode)&&this.addSliceBorderProperties()}addSliceBorderProperties(){this.exposeProperty("sliceBorder.left","number",this.sliceBorder.left,{description:"Left border size for 9-slice",min:0,max:100,step:1,label:"Border Left",onChange:e=>{this.sliceBorder.left=e,window.editor?.refreshCanvas()}}),this.exposeProperty("sliceBorder.right","number",this.sliceBorder.right,{description:"Right border size for 9-slice",min:0,max:100,step:1,label:"Border Right",onChange:e=>{this.sliceBorder.right=e,window.editor?.refreshCanvas()}}),this.exposeProperty("sliceBorder.top","number",this.sliceBorder.top,{description:"Top border size for 9-slice",min:0,max:100,step:1,label:"Border Top",onChange:e=>{this.sliceBorder.top=e,window.editor?.refreshCanvas()}}),this.exposeProperty("sliceBorder.bottom","number",this.sliceBorder.bottom,{description:"Bottom border size for 9-slice",min:0,max:100,step:1,label:"Border Bottom",onChange:e=>{this.sliceBorder.bottom=e,window.editor?.refreshCanvas()}})}clearProperties(){if(this.properties)for(const e in this.properties)this.properties.hasOwnProperty(e)&&delete this.properties[e]}refreshBorderControls(){this.registerProperties(),this.refreshInspector()}async start(){this._isLoaded||await this.loadImage()}async loadImage(){if(this.imageAsset&&this.imageAsset.embedded&&!this.imageAsset.path)return console.log("Skipping path-based loading for embedded image data - already loaded"),this._image;if(!this.imageAsset||!this.imageAsset.path&&!this.imageAsset.embedded)return this._isLoaded||this.imageAsset&&this.imageAsset.embedded||console.warn("No image asset path to load"),null;try{if(console.log("Loading image for SpriteRendererBackground:",this.imageAsset.path),this.imageAsset.path){const e=await this.loadFromAssetManager(this.imageAsset.path);if(e)return e}if(window.editor&&window.editor.fileBrowser&&this.imageAsset.path)try{const e=await this.loadImageFromFileBrowser(this.imageAsset.path);if(e)return console.log("Image loaded via FileBrowser successfully"),this._image=e,this._imageWidth=e.naturalWidth||e.width,this._imageHeight=e.naturalHeight||e.height,this._isLoaded=!0,e}catch(e){console.warn("FileBrowser loading failed, trying fallback:",e)}if(this.imageAsset.embedded&&"function"==typeof this.imageAsset.load){console.log("Loading embedded image data");const e=await this.imageAsset.load();if(e)return this._image=e,this._imageWidth=e.naturalWidth||e.width,this._imageHeight=e.naturalHeight||e.height,this._isLoaded=!0,e}return this.imageAsset.path?await this.fallbackLoadImage(this.imageAsset.path):null}catch(e){return console.error("Error loading sprite image:",e),this._image=null,this._isLoaded=!1,null}}async loadImageFromFileBrowser(e){try{const t=window.editor.fileBrowser,i=await t.readFile(e);if(!i)throw Error("Could not read file from FileBrowser: "+e);if(console.log("FileBrowser content type:",typeof i,i.substring?i.substring(0,50)+"...":"Binary data"),"string"==typeof i&&i.startsWith("data:image")){console.log("Loading image from data URL via FileBrowser");const e=await this.loadImageFromDataURL(i);return 64===this.width&&64===this.height&&(this.width=e.naturalWidth,this.height=e.naturalHeight,console.log(`Auto-sized sprite to ${this.width}x${this.height}`),window.editor&&window.editor.inspector&&window.editor.inspector.refreshModuleUI(this)),e}if("string"!=typeof i||i.startsWith("data:")){if(i instanceof Blob||i instanceof ArrayBuffer){console.log("Converting binary content to data URL");let t=i;i instanceof ArrayBuffer&&(t=new Blob([i],{type:"image/"+e.split(".").pop().toLowerCase()}));const s=await this.blobToDataURL(t),o=await this.loadImageFromDataURL(s);return 64===this.width&&64===this.height&&(this.width=o.naturalWidth,this.height=o.naturalHeight,console.log(`Auto-sized sprite to ${this.width}x${this.height}`),window.editor&&window.editor.inspector&&window.editor.inspector.refreshModuleUI(this)),o}throw Error("Unsupported file content type for image: "+typeof i)}try{const t=e.split(".").pop().toLowerCase();let s,o="image/png";"jpg"===t||"jpeg"===t?o="image/jpeg":"gif"===t?o="image/gif":"webp"===t?o="image/webp":"svg"===t&&(o="image/svg+xml"),s=i.startsWith("data:")&&i.startsWith("data:")?i:`data:${o};base64,${i}`,console.log("Attempting to load as constructed data URL");const n=await this.loadImageFromDataURL(s);return 64===this.width&&64===this.height&&(this.width=n.naturalWidth,this.height=n.naturalHeight,console.log(`Auto-sized sprite to ${this.width}x${this.height}`),window.editor&&window.editor.inspector&&window.editor.inspector.refreshModuleUI(this)),n}catch(t){throw console.error("Failed to construct data URL:",t),Error("File content is not a valid image: "+e)}}catch(e){throw console.error("Error loading image from FileBrowser:",e),e}}async blobToDataURL(e){return new Promise((t,i)=>{const s=new FileReader;s.onload=()=>t(s.result),s.onerror=i,s.readAsDataURL(e)})}refreshInspector(){window.editor&&window.editor.inspector&&(window.editor.inspector.clearModuleCache&&window.editor.inspector.clearModuleCache(this),window.editor.inspector.refreshModuleUI(this),window.editor.refreshCanvas())}fallbackLoadImage(e){return new Promise((t,i)=>{if(!e)return void i(Error("No image path provided"));const s=new Image;if(window.assetManager&&window.assetManager.cache){const o=window.assetManager.normalizePath?window.assetManager.normalizePath(e):e.replace(/^\/+/,"").replace(/\\/g,"/");console.log("Looking for cached asset:",o),console.log("Available cached assets:",Object.keys(window.assetManager.cache));const n=[e,o,e.replace(/^[\/\\]+/,""),e.replace(/\\/g,"/"),e.split("/").pop(),e.split("\\").pop(),decodeURIComponent(e),"/"+e.replace(/^[\/\\]+/,""),"/"+o];let r=null,a=null;for(const e of n)if(window.assetManager.cache[e]){r=window.assetManager.cache[e],a=e,console.log("Found cached asset with path variation:",a);break}if(!r){if("file:"===window.location.protocol||!window.fileBrowser){const t=`Image not found in asset cache: ${e}. This is likely an export issue. Available assets: ${Object.keys(window.assetManager.cache).join(", ")}`;return console.error(t),void i(Error(t))}return console.warn("Asset not in cache, trying direct load for development mode"),void this.tryMultipleImagePaths(s,e).then(t).catch(i)}if(r instanceof HTMLImageElement)return console.log("Using cached HTMLImageElement"),this._image=r,this._imageWidth=r.naturalWidth||r.width,this._imageHeight=r.naturalHeight||r.height,this._isLoaded=!0,void t(r);if("string"==typeof r&&r.startsWith("data:"))console.log("Loading cached data URL"),s.src=r;else{if(!r.content||"string"!=typeof r.content||!r.content.startsWith("data:"))return console.error("Cached asset is not a valid image format:",typeof r,r),void i(Error(`Cached asset for ${e} is not a valid image`));console.log("Loading cached asset content as data URL"),s.src=r.content}}else console.warn("No asset manager or cache available"),s.src=e;s.onload=()=>{console.log("Image loaded successfully:",s.src.substring(0,100)+"..."),this._image=s,this._imageWidth=s.naturalWidth||s.width,this._imageHeight=s.naturalHeight||s.height,this._isLoaded=!0,t(s)},s.onerror=t=>{console.error("Error loading image:",e,t),i(Error("Failed to load image: "+e))}})}async tryMultipleImagePaths(e,t){if(window.editor&&window.editor.fileBrowser){const e=window.editor.fileBrowser,i=[t,t.replace(/^[\/\\]+/,""),"assets/"+t.replace(/^[\/\\]+/,""),"images/"+t.replace(/^[\/\\]+/,""),"src/assets/"+t.replace(/^[\/\\]+/,""),"public/assets/"+t.replace(/^[\/\\]+/,""),"assets/"+t.split(/[\/\\]/).pop(),"images/"+t.split(/[\/\\]/).pop(),"src/assets/"+t.split(/[\/\\]/).pop(),"public/assets/"+t.split(/[\/\\]/).pop()];console.log("Trying FileBrowser paths for image:",t,i);for(const t of i)try{if(await e.fileExists(t)){console.log("Found file in FileBrowser:",t);const e=await this.loadImageFromFileBrowser(t);if(e)return this._image=e,this._imageWidth=e.naturalWidth||e.width,this._imageHeight=e.naturalHeight||e.height,this._isLoaded=!0,e}}catch(e){continue}}if(window.assetManager&&window.assetManager.cache){const e=window.assetManager.cache,i=t.replace(/^[\/\\]+/,"").replace(/\\/g,"/"),s=[t,i,"/"+i,i.split("/").pop(),i.split("\\").pop(),decodeURIComponent(t),decodeURIComponent(i)];console.log("Trying AssetManager cache paths:",s),console.log("Available cached assets:",Object.keys(e));for(const t of s)if(e[t]){const i=e[t];if(i instanceof HTMLImageElement)return console.log("Found cached image:",t),this._image=i,this._imageWidth=i.naturalWidth||i.width,this._imageHeight=i.naturalHeight||i.height,this._isLoaded=!0,i;if("string"==typeof i&&i.startsWith("data:"))return console.log("Loading cached data URL:",t),this.loadImageFromDataURL(i)}}return console.warn("All relative path attempts failed, falling back to direct URL loading"),this.directUrlFallback(e,t)}async directUrlFallback(e,t){console.warn("Using direct URL fallback - this may not work in all environments:",t);const i=t.replace(/^\/+/,"").replace(/\\/g,"/"),s=[i,"assets/"+i,"images/"+i,t];console.log("Trying direct URL paths:",s);for(const t of s)try{if(await this.testImagePath(t))return console.log("Successfully loaded image from direct URL:",t),new Promise((i,s)=>{e.onload=()=>{this._image=e,this._imageWidth=e.naturalWidth||e.width,this._imageHeight=e.naturalHeight||e.height,this._isLoaded=!0,i(e)},e.onerror=s,e.src=t})}catch(e){continue}throw Error("Could not load image from any of the attempted paths for: "+t)}testImagePath(e){return new Promise(t=>{const i=new Image;i.onload=()=>t(!0),i.onerror=()=>t(!1),setTimeout(()=>t(!1),3e3),i.src=e})}resolveImagePath(e){if(!e)return"";if(e.startsWith("http")||e.startsWith("data:")||e.startsWith("blob:"))return e;const t=e.replace(/^\/+/,"").replace(/\\/g,"/");return window.location.origin+window.location.pathname.replace(/\/[^\/]*$/,"/")+t}async setSprite(e){if(console.log("setSprite called with path:",e),null==e)return this.imageAsset=null,this._image=null,void(this._isLoaded=!1);if(this.imageAsset&&this.imageAsset.path===e)console.log("Sprite path unchanged, skipping");else try{window.AssetReference?this.imageAsset=new window.AssetReference(e,"image"):this.imageAsset={path:e,type:"image",load:()=>window.assetManager?window.assetManager.getAssetByPath(e):this.fallbackLoadImage(e)};const t=await this.loadImage();t?console.log("Image loaded successfully:",t.src||"data URL"):console.warn("Failed to load image"),window.editor&&window.editor.refreshCanvas()}catch(e){console.error("Error setting sprite:",e)}}draw(e){if(!this._image||!this._isLoaded||0===this.width||0===this.height)return void this.drawPlaceholder(e);const t=this.width*this.pivot.x,i=this.height*this.pivot.y;e.save(),(this.flipX||this.flipY)&&e.scale(this.flipX?-1:1,this.flipY?-1:1),e=this.getBackgroundCanvas(),this.drawWithScaleMode(e,-t,-i),"#ffffff"!==this.color&&(e.globalCompositeOperation="multiply",e.fillStyle=this.color,e.fillRect(-t,-i,this.width,this.height)),e.restore()}drawFrame(e,t,i){e.drawImage(this._image,this.frameX*this.frameWidth,this.frameY*this.frameHeight,this.frameWidth,this.frameHeight,t,i,this.width,this.height)}registerCustomInspectorHandlers(){window.editor&&window.editor.inspector&&window.editor.inspector.registerCustomUIHandler("SpriteRendererBackground","imageAsset",(e,t)=>{e.classList.contains("image-preview")&&t.setupDragAndDrop(e)})}onInspectorCreated(){this.registerCustomInspectorHandlers()}setupDragAndDrop(e){e&&(e.addEventListener("dragover",t=>{t.preventDefault(),t.stopPropagation(),e.classList.add("drag-over")}),e.addEventListener("dragleave",()=>{e.classList.remove("drag-over")}),e.addEventListener("drop",async t=>{t.preventDefault(),t.stopPropagation(),e.classList.remove("drag-over"),await this.handleImageDrop(t.dataTransfer)&&window.editor&&window.editor.inspector&&(window.editor.inspector.refreshModuleUI(this),window.editor.refreshCanvas())}))}async handleImageDrop(e){try{if(e.files&&e.files.length>0){const t=e.files[0];if(!t.type.startsWith("image/"))return console.warn("Dropped file is not an image:",t.type),!1;const i=window.editor?.fileBrowser||window.fileBrowser;if(!i)return console.warn("FileBrowser not available for image upload"),!1;await i.handleFileUpload(t);const s=`${i.currentPath}/${t.name}`;return await this.setSprite(s),console.log("Successfully set sprite to:",s),!0}const t=e.getData("application/json");if(t)try{const e=JSON.parse(t);if(e&&e.length>0){const t=e[0].path;if(t&&this.isImagePath(t))return await this.setSprite(t),console.log("Successfully set sprite to:",t),!0}}catch(e){console.error("Error parsing drag JSON data:",e)}const i=e.getData("text/plain");return!(!i||!this.isImagePath(i)||(await this.setSprite(i),console.log("Successfully set sprite to:",i),0))}catch(e){return console.error("Error handling image drop:",e),!1}}isImagePath(e){if(!e)return!1;const t=e.toLowerCase();return[".png",".jpg",".jpeg",".gif",".webp",".svg"].some(e=>t.endsWith(e))}async loadImageFromFile(){const e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=async e=>{if(e.target.files&&e.target.files[0]){const t=e.target.files[0],i=window.editor?.fileBrowser;if(!i)return void console.warn("FileBrowser not available for image upload");await i.handleFileUpload(t);const s=`${i.currentPath}/${t.name}`;await this.setSprite(s)}},e.click()}loadImageFromDataURL(e){return new Promise((t,i)=>{const s=new Image;s.onload=()=>{console.log("Image loaded from data URL successfully"),t(s)},s.onerror=e=>{console.error("Error loading image from data URL:",e),i(Error("Failed to load image from data URL"))},s.src=e})}async loadImageFromUrl(){const e=await this.promptUrlInput();if(e)try{const t=new Image,i=new Promise((i,s)=>{t.onload=()=>i(!0),t.onerror=()=>s(Error("Failed to load image from URL: "+e)),setTimeout(()=>s(Error("Image loading timed out")),1e4)});t.crossOrigin="anonymous",t.src=e,await i;const s=window.editor?.fileBrowser;if(!s)return console.warn("FileBrowser not available for image upload"),void await this.setSprite(e);const o=await this.fetchImageAsDataURL(e),n=this.generateFilenameFromUrl(e);await s.createFile(`${s.currentPath}/${n}`,o);const r=`${s.currentPath}/${n}`;await this.setSprite(r)}catch(e){console.error("Error loading image from URL:",e),alert("Failed to load image: "+e.message)}}async fetchImageAsDataURL(e){try{const t=await fetch(e,{mode:"cors"}),i=await t.blob();return new Promise(e=>{const t=new FileReader;t.onloadend=()=>e(t.result),t.readAsDataURL(i)})}catch(t){return console.warn("Could not fetch image (possible CORS issue), using direct URL"),e}}generateFilenameFromUrl(e){try{const t=new URL(e).pathname.split("/").pop();if(t&&t.includes("."))return t}catch(e){}return`image_${Math.random().toString(36).substring(2,10)}.png`}async promptUrlInput(){return new Promise(e=>{const t=document.createElement("div");t.className="url-input-dialog",t.innerHTML='\n                <div class="url-input-content">\n                    <h3>Enter Image URL</h3>\n                    <input type="text" placeholder="https://example.com/image.png" class="url-input-field">\n                    <div class="url-input-buttons">\n                        <button class="cancel-btn">Cancel</button>\n                        <button class="ok-btn">OK</button>\n                    </div>\n                </div>\n            ';const i=document.createElement("style");i.innerHTML="\n                .url-input-dialog {\n                    position: fixed;\n                    top: 0;\n                    left: 0;\n                    width: 100%;\n                    height: 100%;\n                    background-color: rgba(0,0,0,0.5);\n                    display: flex;\n                    align-items: center;\n                    justify-content: center;\n                    z-index: 10000;\n                }\n                .url-input-content {\n                    background-color: #2a2a2a;\n                    border-radius: 4px;\n                    padding: 20px;\n                    width: 400px;\n                    box-shadow: 0 2px 10px rgba(0,0,0,0.2);\n                }\n                .url-input-content h3 {\n                    margin-top: 0;\n                    color: #eee;\n                }\n                .url-input-field {\n                    width: 100%;\n                    padding: 8px;\n                    margin: 10px 0;\n                    background: #333;\n                    border: 1px solid #555;\n                    color: #eee;\n                    border-radius: 2px;\n                }\n                .url-input-buttons {\n                    display: flex;\n                    justify-content: flex-end;\n                    margin-top: 15px;\n                }\n                .url-input-buttons button {\n                    padding: 6px 12px;\n                    margin-left: 10px;\n                    background: #444;\n                    border: none;\n                    color: #eee;\n                    border-radius: 2px;\n                    cursor: pointer;\n                }\n                .url-input-buttons button.ok-btn {\n                    background: #2196F3;\n                }\n                .url-input-buttons button:hover {\n                    opacity: 0.9;\n                }\n            ",document.head.appendChild(i),document.body.appendChild(t);const s=t.querySelector(".url-input-field"),o=t.querySelector(".cancel-btn"),n=t.querySelector(".ok-btn"),r=()=>{document.body.removeChild(t),document.head.removeChild(i)},a=()=>{r(),e(null)},l=()=>{const t=s.value.trim();r(),e(t||null)};o.addEventListener("click",a),n.addEventListener("click",l),s.addEventListener("keydown",e=>{"Enter"===e.key&&l(),"Escape"===e.key&&a()}),setTimeout(()=>s.focus(),50)})}drawPlaceholder(e){const t=this.width*this.pivot.x,i=this.height*this.pivot.y;e.save(),e.strokeStyle="#aaaaaa",e.fillStyle="#333333",e.lineWidth=2,e.fillRect(-t,-i,this.width||64,this.height||64),e.strokeRect(-t,-i,this.width||64,this.height||64),e.fillStyle="#aaaaaa";const s=.5*Math.min(this.width||64,this.height||64),o=-t+(this.width||64)/2-s/2,n=-i+(this.height||64)/2-s/2;e.fillRect(o,n,s,s),e.fillStyle="#333333",e.beginPath(),e.arc(o+.7*s,n+.3*s,.15*s,0,2*Math.PI),e.fill(),e.restore()}drawWithScaleMode(e,t,i){switch(this.scaleMode){case"fit":this.drawFit(e,t,i);break;case"fill":this.drawFill(e,t,i);break;case"tile":this.drawTile(e,t,i);break;case"9-slice":this.drawNineSlice(e,t,i);break;default:e.drawImage(this._image,t,i,this.width,this.height)}}drawFit(e,t,i){const s=this._imageWidth/this._imageHeight;let o,n,r,a;s>this.width/this.height?(o=this.width,n=this.width/s,r=0,a=(this.height-n)/2):(n=this.height,o=this.height*s,r=(this.width-o)/2,a=0),e.drawImage(this._image,0,0,this._imageWidth,this._imageHeight,t+r,i+a,o,n)}drawFill(e,t,i){const s=this._imageWidth/this._imageHeight,o=this.width/this.height;let n,r,a,l;s>o?(l=this._imageHeight,a=this._imageHeight*o,n=(this._imageWidth-a)/2,r=0):(a=this._imageWidth,l=this._imageWidth/o,n=0,r=(this._imageHeight-l)/2),e.drawImage(this._image,n,r,a,l,t,i,this.width,this.height)}drawTile(e,t,i){const s=e.createPattern(this._image,"repeat");s?(e.save(),e.beginPath(),e.rect(t,i,this.width,this.height),e.clip(),e.fillStyle=s,e.fillRect(t,i,this.width,this.height),e.restore()):e.drawImage(this._image,t,i,this.width,this.height)}drawNineSlice(e,t,i){const s=this._image,o=this.width,n=this.height,r=this.sliceBorder,a=Math.min(r.left,this._imageWidth/3),l=Math.min(r.right,this._imageWidth/3),h=Math.min(r.top,this._imageHeight/3),c=Math.min(r.bottom,this._imageHeight/3),d=Math.floor(this._imageWidth/2),p=Math.floor(this._imageHeight/2),u=Math.min(a,d),g=Math.min(l,d),m=Math.min(h,p),f=Math.min(c,p),y=[0,u,this._imageWidth-g,this._imageWidth],w=[0,m,this._imageHeight-f,this._imageHeight],b=[t,t+u,t+o-g,t+o],x=[i,i+m,i+n-f,i+n];for(let t=0;3>t;t++)for(let i=0;3>i;i++){const o=y[i],n=w[t],r=y[i+1]-o,a=w[t+1]-n,l=b[i],h=x[t],c=b[i+1]-l,d=x[t+1]-h;r>0&&a>0&&c>0&&d>0&&e.drawImage(s,o,n,r,a,l,h,c,d)}}addCustomStyles(){if(document.getElementById("sprite-renderer-styles"))return;const e=document.createElement("style");e.id="sprite-renderer-styles",e.innerHTML='\n            .scale-mode-dropdown {\n                width: 100%;\n                background-color: #333;\n                color: #eee;\n                border: 1px solid #555;\n                padding: 8px;\n                border-radius: 3px;\n                font-size: 12px;\n                height: auto !important;\n                appearance: menulist; /* Show dropdown arrow */\n            }\n            \n            .scale-mode-dropdown option {\n                background-color: #333;\n                color: #eee;\n                padding: 6px;\n            }\n            \n            .scale-mode-dropdown:focus {\n                outline: none;\n                border-color: #2196F3;\n            }\n            \n            /* Ensure border controls are correctly aligned */\n            .property-row input[data-prop-name^="sliceBorder"] {\n                width: 60px;\n                text-align: right;\n            }\n        ',document.head.appendChild(e)}async loadImageFromData(e){return new Promise((t,i)=>{const s=new Image;s.onload=()=>{this._image=s,this._imageWidth=s.naturalWidth,this._imageHeight=s.naturalHeight,this._isLoaded=!0,console.log("Image loaded from data URL, dimensions:",this._imageWidth,"x",this._imageHeight),window.editor&&window.editor.refreshCanvas(),t(s)},s.onerror=e=>{console.error("Failed to load image from data URL:",e),i(e)},s.src=e})}async loadFromAssetManager(e){if(!e)return null;try{if(window.assetManager){const t=await window.assetManager.getAssetByPath(e);if(t&&t instanceof HTMLImageElement)return this._image=t,this._imageWidth=t.naturalWidth||t.width,this._imageHeight=t.naturalHeight||t.height,this._isLoaded=!0,console.log("Image loaded from AssetManager:",e),t}return await this.fallbackLoadImage(e)}catch(e){return console.error("Error loading from AssetManager:",e),null}}toJSON(){const e=super.toJSON()||{};return e.imageAsset=this.imageAsset?{path:this.imageAsset.path,type:"image",embedded:this.imageAsset.embedded||!1}:null,e.width=this.width,e.height=this.height,e.color=this.color,e.flipX=this.flipX,e.flipY=this.flipY,e.pivot={x:this.pivot.x,y:this.pivot.y},e.scaleMode=this.scaleMode,e.frameX=this.frameX,e.frameY=this.frameY,e.frameWidth=this.frameWidth,e.frameHeight=this.frameHeight,e.frames=this.frames,e.sliceMode=this.sliceMode,e.sliceBorder={...this.sliceBorder},e}fromJSON(e){if(super.fromJSON(e),e)if(void 0!==e.width&&(this.width=e.width),void 0!==e.height&&(this.height=e.height),void 0!==e.color&&(this.color=e.color),void 0!==e.flipX&&(this.flipX=e.flipX),void 0!==e.flipY&&(this.flipY=e.flipY),void 0!==e.pivot&&(this.pivot=e.pivot),void 0!==e.scaleMode&&(this.scaleMode=e.scaleMode),void 0!==e.sliceMode&&(this.sliceMode=e.sliceMode),void 0!==e.sliceBorder&&(this.sliceBorder=e.sliceBorder),e.imageAsset&&e.imageAsset.path){console.log("Loading sprite from AssetManager:",e.imageAsset.path);try{window.AssetReference?this.imageAsset=new window.AssetReference(e.imageAsset.path,"image"):this.imageAsset={path:e.imageAsset.path,type:"image",embedded:e.imageAsset.embedded||!1,load:()=>this.loadFromAssetManager(e.imageAsset.path)},this.loadFromAssetManager(e.imageAsset.path)}catch(e){console.error("Error restoring image asset:",e)}}else this.imageAsset={path:null,type:"image",load:()=>Promise.resolve(null)},this._image=null,this._isLoaded=!1}}window.SpriteRendererBackground=SpriteRendererBackground;class ObjectTiling extends Module{static namespace="Objects";static description="Tiles objects in a finite or infinite grid, with removable objects";static allowMultiple=!1;static iconClass="fas fa-th-large";constructor(){super("ObjectTiling"),this.ignoreGameObjectTransform=!0,this.objectName="",this.tileWidth=64,this.tileHeight=64,this.xCount=5,this.yCount=5,this.infinite=!1,this.spacingX=0,this.spacingY=0,this.chunkSize=512,this.paddingChunks=2,this._originalObject=null,this._tiledObjects=[],this._chunkCache=new Map,this._lastViewportKey="",this._needsRebuild=!1,this.exposeProperty("objectName","string",this.objectName,{onChange:e=>{this.objectName=e,this._scheduleRebuild()}}),this.exposeProperty("tileWidth","number",this.tileWidth,{min:1,max:1e3,step:1,onChange:e=>{this.tileWidth=e,this._scheduleRebuild()}}),this.exposeProperty("tileHeight","number",this.tileHeight,{min:1,max:1e3,step:1,onChange:e=>{this.tileHeight=e,this._scheduleRebuild()}}),this.exposeProperty("xCount","number",this.xCount,{min:1,max:100,step:1,onChange:e=>{this.xCount=e,this._scheduleRebuild()}}),this.exposeProperty("yCount","number",this.yCount,{min:1,max:100,step:1,onChange:e=>{this.yCount=e,this._scheduleRebuild()}}),this.exposeProperty("infinite","boolean",this.infinite,{onChange:e=>{this.infinite=e,this._scheduleRebuild()}}),this.exposeProperty("spacingX","number",this.spacingX,{min:0,max:100,step:1,onChange:e=>{this.spacingX=e,this._scheduleRebuild()}}),this.exposeProperty("spacingY","number",this.spacingY,{min:0,max:100,step:1,onChange:e=>{this.spacingY=e,this._scheduleRebuild()}}),this.exposeProperty("chunkSize","number",this.chunkSize,{min:64,max:2048,step:64,onChange:e=>{this.chunkSize=e,this._scheduleRebuild()}}),this.exposeProperty("paddingChunks","number",this.paddingChunks,{min:0,max:4,step:1})}style(e){e.startGroup("Object Settings",!1,{backgroundColor:"rgba(150,200,150,0.1)",padding:8,borderRadius:6}),e.exposeProperty("objectName","string",this.objectName,{label:"Object Name"}),e.exposeProperty("infinite","boolean",this.infinite,{label:"Infinite Tiling"}),e.endGroup(),e.addDivider(),e.startGroup("Tile Dimensions",!1,{backgroundColor:"rgba(200,200,255,0.1)",padding:8,borderRadius:6}),e.exposeProperty("tileWidth","number",this.tileWidth,{label:"Tile Width"}),e.exposeProperty("tileHeight","number",this.tileHeight,{label:"Tile Height"}),e.exposeProperty("spacingX","number",this.spacingX,{label:"Horizontal Spacing"}),e.exposeProperty("spacingY","number",this.spacingY,{label:"Vertical Spacing"}),e.endGroup(),this.infinite?(e.addDivider(),e.startGroup("Infinite Settings",!1,{backgroundColor:"rgba(255,255,200,0.1)",padding:8,borderRadius:6}),e.exposeProperty("chunkSize","number",this.chunkSize,{label:"Chunk Size"}),e.exposeProperty("paddingChunks","number",this.paddingChunks,{label:"Padding Chunks"}),e.endGroup()):(e.addDivider(),e.startGroup("Finite Grid",!1,{backgroundColor:"rgba(255,200,200,0.1)",padding:8,borderRadius:6}),e.exposeProperty("xCount","number",this.xCount,{label:"Tiles Across"}),e.exposeProperty("yCount","number",this.yCount,{label:"Tiles Down"}),e.endGroup())}preload(){}start(){this._findOriginalObject(),this._originalObject&&this.gameObject?this.infinite||this._createFiniteGrid():this._scheduleRebuild()}loop(e){if(this._needsRebuild&&this.gameObject&&(this._needsRebuild=!1,this._resetTiling()),!(this.infinite&&window.engine&&window.engine.viewport&&this.gameObject))return;const t=window.engine.viewport,i=t.y-t.height/2,s=t.x-t.width/2,o=t.x+t.width/2,n=t.y+t.height/2,r=Math.floor((s-this.gameObject.position.x)/this.chunkSize)-this.paddingChunks,a=Math.floor((o-this.gameObject.position.x)/this.chunkSize)+this.paddingChunks,l=Math.floor((i-this.gameObject.position.y)/this.chunkSize)-this.paddingChunks,h=Math.floor((n-this.gameObject.position.y)/this.chunkSize)+this.paddingChunks,c=new Set;for(let e=r;a>=e;e++)for(let t=l;h>=t;t++){const i=this._chunkKey(e,t);c.add(i),this._ensureChunkAt(e,t)}for(const e of this._chunkCache.keys())c.has(e)||(this._chunkCache.get(e).forEach(e=>{e.parent&&e.parent.removeChild(e),window.engine&&window.engine.removeDynamicObject&&window.engine.removeDynamicObject(e)}),this._chunkCache.delete(e))}draw(e){}drawGizmos(e){if(this.gameObject&&(e.strokeStyle="rgba(0,255,0,0.5)",e.lineWidth=1,!this.infinite)){for(let t=0;t<=this.xCount;t++)e.beginPath(),e.moveTo(t*(this.tileWidth+this.spacingX),0),e.lineTo(t*(this.tileWidth+this.spacingX),this.yCount*(this.tileHeight+this.spacingY)),e.stroke();for(let t=0;t<=this.yCount;t++)e.beginPath(),e.moveTo(0,t*(this.tileHeight+this.spacingY)),e.lineTo(this.xCount*(this.tileWidth+this.spacingX),t*(this.tileHeight+this.spacingY)),e.stroke()}}onDestroy(){this._clearAllObjects()}toJSON(){return{...super.toJSON(),objectName:this.objectName,tileWidth:this.tileWidth,tileHeight:this.tileHeight,xCount:this.xCount,yCount:this.yCount,infinite:this.infinite,spacingX:this.spacingX,spacingY:this.spacingY,chunkSize:this.chunkSize,paddingChunks:this.paddingChunks}}fromJSON(e){super.fromJSON(e),e&&(this.objectName=e.objectName??this.objectName,this.tileWidth=e.tileWidth??this.tileWidth,this.tileHeight=e.tileHeight??this.tileHeight,this.xCount=e.xCount??this.xCount,this.yCount=e.yCount??this.yCount,this.infinite=e.infinite??this.infinite,this.spacingX=e.spacingX??this.spacingX,this.spacingY=e.spacingY??this.spacingY,this.chunkSize=e.chunkSize??this.chunkSize,this.paddingChunks=e.paddingChunks??this.paddingChunks,this._scheduleRebuild())}_scheduleRebuild(){this._needsRebuild=!0}_findOriginalObject(){this.objectName?(this._originalObject=window.engine?.findGameObjectByName(this.objectName),this._originalObject||console.warn(`ObjectTiling: Object with name "${this.objectName}" not found.`)):this._originalObject=null}_resetTiling(){this._clearAllObjects(),this._chunkCache.clear(),this._findOriginalObject(),this._originalObject&&this.gameObject&&(this.infinite||this._createFiniteGrid())}_clearAllObjects(){this._tiledObjects.forEach(e=>{e.parent&&e.parent.removeChild(e),window.engine&&window.engine.removeDynamicObject&&window.engine.removeDynamicObject(e)}),this._tiledObjects=[];for(const e of this._chunkCache.values())e.forEach(e=>{e.parent&&e.parent.removeChild(e),window.engine&&window.engine.removeDynamicObject&&window.engine.removeDynamicObject(e)});this._chunkCache.clear()}_createFiniteGrid(){if(this._originalObject&&this.gameObject)for(let e=0;e<this.xCount;e++)for(let t=0;t<this.yCount;t++){const i=this._originalObject.clone();i.position.x=this.gameObject.position.x+e*(this.tileWidth+this.spacingX),i.position.y=this.gameObject.position.y+t*(this.tileHeight+this.spacingY),this.gameObject.addChild(i),this._tiledObjects.push(i),window.engine&&window.engine.dynamicObjects&&window.engine.dynamicObjects.add(i)}}_chunkKey(e,t){return`${e},${t}`}_ensureChunkAt(e,t){const i=this._chunkKey(e,t);if(this._chunkCache.has(i))return;const s=this._createChunkObjects(e,t);this._chunkCache.set(i,s)}_createChunkObjects(e,t){if(!this._originalObject||!this.gameObject)return[];const i=[],s=Math.ceil(this.chunkSize/(this.tileWidth+this.spacingX))+1,o=Math.ceil(this.chunkSize/(this.tileHeight+this.spacingY))+1;for(let n=0;s>n;n++)for(let s=0;o>s;s++){const o=this._originalObject.clone();o.position.x=this.gameObject.position.x+e*this.chunkSize+n*(this.tileWidth+this.spacingX),o.position.y=this.gameObject.position.y+t*this.chunkSize+s*(this.tileHeight+this.spacingY),this.gameObject.addChild(o),i.push(o),window.engine&&window.engine.dynamicObjects&&window.engine.dynamicObjects.add(o)}return i}removeObject(e){const t=this._tiledObjects.indexOf(e);t>-1&&this._tiledObjects.splice(t,1);for(const[t,i]of this._chunkCache){const t=i.indexOf(e);if(t>-1){i.splice(t,1);break}}e.parent&&e.parent.removeChild(e),window.engine&&window.engine.removeDynamicObject&&window.engine.removeDynamicObject(e)}}window.ObjectTiling=ObjectTiling;class FollowTarget extends Module{static allowMultiple=!1;static namespace="Utility";static description="Makes object follow a target with various follow modes";static iconClass="fas fa-crosshairs";constructor(){super("FollowTarget"),this.targetName="",this.targetPosition=new Vector2(0,0),this.followMode="smooth",this.followSpeed=5,this.smoothing=.1,this.minDistance=0,this.maxDistance=0,this.stopDistance=5,this.offset=new Vector2(0,0),this.constrainToX=!1,this.constrainToY=!1,this.lookAtTarget=!1,this.force=500,this.maxVelocity=200,this.targetObject=null,this.lastTargetPosition=new Vector2(0,0),this.exposeProperty("targetName","string",this.targetName,{description:"Name of the target object to follow (leave empty to use targetPosition)"}),this.exposeProperty("targetPosition","vector2",this.targetPosition,{description:"Fixed position to follow (used when targetName is empty)"}),this.exposeProperty("followMode","enum",this.followMode,{options:["smooth","instant","physics"],description:"How the object follows the target"}),this.exposeProperty("followSpeed","number",this.followSpeed,{min:.1,max:20,step:.1,description:"Speed of following (for smooth mode)"}),this.exposeProperty("smoothing","number",this.smoothing,{min:.01,max:1,step:.01,description:"Smoothing factor (0.01 = very smooth, 1.0 = instant)"}),this.exposeProperty("minDistance","number",this.minDistance,{min:0,max:500,step:1,description:"Minimum distance to maintain from target"}),this.exposeProperty("maxDistance","number",this.maxDistance,{min:0,max:1e3,step:1,description:"Maximum distance before starting to follow (0 = no limit)"}),this.exposeProperty("stopDistance","number",this.stopDistance,{min:0,max:100,step:1,description:"Distance at which to stop following"}),this.exposeProperty("offset","vector2",this.offset,{description:"Offset from target position"}),this.exposeProperty("constrainToX","boolean",this.constrainToX,{description:"Only follow on X axis"}),this.exposeProperty("constrainToY","boolean",this.constrainToY,{description:"Only follow on Y axis"}),this.exposeProperty("lookAtTarget","boolean",this.lookAtTarget,{description:"Rotate to face the target"}),this.exposeProperty("force","number",this.force,{min:10,max:2e3,step:10,description:"Force applied for physics mode"}),this.exposeProperty("maxVelocity","number",this.maxVelocity,{min:10,max:1e3,step:10,description:"Maximum velocity for physics mode"})}start(){this.findTarget()}findTarget(){this.targetName&&""!==this.targetName.trim()?this.gameObject.scene&&(this.targetObject=this.gameObject.scene.findGameObjectByName(this.targetName),this.targetObject||console.warn(`FollowTarget: Target object "${this.targetName}" not found`)):this.targetObject=null}getTargetPosition(){return this.targetObject?new Vector2(this.targetObject.position.x+this.offset.x,this.targetObject.position.y+this.offset.y):new Vector2(this.targetPosition.x+this.offset.x,this.targetPosition.y+this.offset.y)}loop(e){this.targetName&&!this.targetObject&&this.findTarget();const t=this.getTargetPosition(),i=this.gameObject.position,s=Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2));if(0!==this.maxDistance&&s<=this.maxDistance||s<=this.stopDistance)return;let o=t.x-i.x,n=t.y-i.y;switch(s>0&&(o/=s,n/=s),this.constrainToX&&(n=0),this.constrainToY&&(o=0),this.minDistance>0&&s<this.minDistance&&(o*=-1,n*=-1),this.followMode){case"instant":this.applyInstantFollow(t,o,n,s);break;case"smooth":this.applySmoothFollow(t,o,n,s,e);break;case"physics":this.applyPhysicsFollow(o,n,s,e)}this.lookAtTarget&&s>0&&(this.gameObject.rotation=Math.atan2(n,o)),this.lastTargetPosition=t}applyInstantFollow(e,t,i,s){if(this.minDistance>0&&s<=this.minDistance){const e=this.minDistance-s;this.gameObject.position.x-=t*e,this.gameObject.position.y-=i*e}else{const e=Math.max(0,s-this.stopDistance);this.gameObject.position.x+=t*e,this.gameObject.position.y+=i*e}}applySmoothFollow(e,t,i,s,o){let n=e.x,r=e.y;if(this.stopDistance>0&&(n-=t*this.stopDistance,r-=i*this.stopDistance),this.minDistance>0&&s<this.minDistance){const e=this.minDistance-s;n=this.gameObject.position.x-t*e,r=this.gameObject.position.y-i*e}const a=Math.min(1,this.smoothing*this.followSpeed*o);this.gameObject.position.x+=(n-this.gameObject.position.x)*a,this.gameObject.position.y+=(r-this.gameObject.position.y)*a}applyPhysicsFollow(e,t,i,s){const o=this.gameObject.getModule("RigidBody");if(!o)return void console.warn("FollowTarget: Physics mode requires RigidBody component");let n=e*this.force,r=t*this.force;this.minDistance>0&&i<this.minDistance&&(n*=-2,r*=-2),o.applyForce(new Vector2(n*s,r*s));const a=o.getVelocity(),l=Math.sqrt(a.x*a.x+a.y*a.y);if(l>this.maxVelocity){const e=this.maxVelocity/l;o.setVelocity(new Vector2(a.x*e,a.y*e))}}setTarget(e){this.targetName=e,this.findTarget()}setTargetPosition(e,t){this.targetPosition.x=e,this.targetPosition.y=t,this.targetObject=null,this.targetName=""}toJSON(){const e=super.toJSON();return e.targetName=this.targetName,e.targetPosition={x:this.targetPosition.x,y:this.targetPosition.y},e.followMode=this.followMode,e.followSpeed=this.followSpeed,e.smoothing=this.smoothing,e.minDistance=this.minDistance,e.maxDistance=this.maxDistance,e.stopDistance=this.stopDistance,e.offset={x:this.offset.x,y:this.offset.y},e.constrainToX=this.constrainToX,e.constrainToY=this.constrainToY,e.lookAtTarget=this.lookAtTarget,e.force=this.force,e.maxVelocity=this.maxVelocity,e}fromJSON(e){super.fromJSON(e),void 0!==e.targetName&&(this.targetName=e.targetName),void 0!==e.targetPosition&&(this.targetPosition=new Vector2(e.targetPosition.x,e.targetPosition.y)),void 0!==e.followMode&&(this.followMode=e.followMode),void 0!==e.followSpeed&&(this.followSpeed=e.followSpeed),void 0!==e.smoothing&&(this.smoothing=e.smoothing),void 0!==e.minDistance&&(this.minDistance=e.minDistance),void 0!==e.maxDistance&&(this.maxDistance=e.maxDistance),void 0!==e.stopDistance&&(this.stopDistance=e.stopDistance),void 0!==e.offset&&(this.offset=new Vector2(e.offset.x,e.offset.y)),void 0!==e.constrainToX&&(this.constrainToX=e.constrainToX),void 0!==e.constrainToY&&(this.constrainToY=e.constrainToY),void 0!==e.lookAtTarget&&(this.lookAtTarget=e.lookAtTarget),void 0!==e.force&&(this.force=e.force),void 0!==e.maxVelocity&&(this.maxVelocity=e.maxVelocity)}}window.FollowTarget=FollowTarget;class Spawner extends Module{static allowMultiple=!0;static namespace="Utility";static description="Spawns game objects or prefabs at intervals or on trigger";static iconClass="fas fa-plus-circle";constructor(){super("Spawner"),this.spawnMode="interval",this.spawnInterval=2,this.spawnCount=1,this.maxSpawns=-1,this.autoStart=!0,this.spawnObjectName="SpawnedObject",this.destroyOriginal=!1,this.spawnType="gameobject",this.inheritPosition=!0,this.inheritRotation=!1,this.inheritScale=!1,this.spawnArea="point",this.spawnRadius=50,this.spawnWidth=100,this.spawnHeight=100,this.spawnOffset=new Vector2(0,0),this.randomRotation=!1,this.randomScale=!1,this.minScale=.8,this.maxScale=1.2,this.giveVelocity=!1,this.velocityDirection=new Vector2(0,-1),this.velocityMagnitude=100,this.velocityVariation=20,this.useGravity=!1,this.gravityDirection=new Vector2(0,1),this.gravityMagnitude=9.81,this.randomDirection=!1,this.velocityConeAngle=0,this.velocityDirection=new Vector2(0,-1),this.setLifetime=!1,this.lifetime=5,this.lifetimeVariation=1,this.isActive=!1,this.timer=0,this.spawnedCount=0,this.spawnedObjects=[],this.gameObjectReference=null,this.exposeProperty("spawnMode","enum",this.spawnMode,{options:["interval","manual","trigger"],description:"When to spawn objects",onChange:e=>{this.spawnMode=e}}),this.exposeProperty("spawnInterval","number",this.spawnInterval,{min:.1,max:60,step:.1,description:"Time between spawns (for interval mode)",onChange:e=>{this.spawnInterval=e}}),this.exposeProperty("spawnCount","number",this.spawnCount,{min:1,max:20,step:1,description:"Number of objects to spawn per trigger",onChange:e=>{this.spawnCount=e}}),this.exposeProperty("maxSpawns","number",this.maxSpawns,{min:-1,max:1e3,step:1,description:"Maximum total spawns (-1 for unlimited)",onChange:e=>{this.maxSpawns=e}}),this.exposeProperty("autoStart","boolean",this.autoStart,{description:"Start spawning automatically",onChange:e=>{this.autoStart=e}}),this.exposeProperty("spawnObjectName","string",this.spawnObjectName,{description:"Name of prefab or object to spawn",onChange:e=>{this.spawnObjectName=e}}),this.exposeProperty("destroyOriginal","boolean",this.destroyOriginal,{description:"Destroy the original template game object after spawning",onChange:e=>{this.destroyOriginal=e}}),this.exposeProperty("spawnType","enum",this.spawnType,{options:["gameobject","prefab","basic"],description:"Type of object to spawn",onChange:e=>{this.spawnType=e}}),this.exposeProperty("spawnArea","enum",this.spawnArea,{options:["point","circle","rectangle","line"],description:"Area shape for spawning",onChange:e=>{this.spawnArea=e}}),this.exposeProperty("spawnRadius","number",this.spawnRadius,{min:0,max:500,step:1,description:"Radius for circle spawn area",onChange:e=>{this.spawnRadius=e}}),this.exposeProperty("spawnWidth","number",this.spawnWidth,{min:1,max:1e3,step:1,description:"Width for rectangle spawn area",onChange:e=>{this.spawnWidth=e}}),this.exposeProperty("spawnHeight","number",this.spawnHeight,{min:1,max:1e3,step:1,description:"Height for rectangle spawn area",onChange:e=>{this.spawnHeight=e}}),this.exposeProperty("spawnOffset","vector2",this.spawnOffset,{description:"Offset from spawner position",onChange:e=>{this.spawnOffset=e}}),this.exposeProperty("randomRotation","boolean",this.randomRotation,{description:"Give spawned objects random rotation",onChange:e=>{this.randomRotation=e}}),this.exposeProperty("velocityConeAngle","number",this.velocityConeAngle,{min:0,max:180,step:1,description:"Cone angle spread for velocity (degrees)",onChange:e=>{this.velocityConeAngle=e}}),this.exposeProperty("velocityDirection","vector2",this.velocityDirection,{description:"Base direction for velocity cone",onChange:e=>{this.velocityDirection=e}}),this.exposeProperty("useGravity","boolean",this.useGravity,{description:"Apply gravity to spawned objects",onChange:e=>{this.useGravity=e}}),this.exposeProperty("gravityDirection","vector2",this.gravityDirection,{description:"Direction of gravity",onChange:e=>{this.gravityDirection=e}}),this.exposeProperty("gravityMagnitude","number",this.gravityMagnitude,{min:0,max:100,step:.1,description:"Magnitude of gravity",onChange:e=>{this.gravityMagnitude=e}}),this.exposeProperty("randomScale","boolean",this.randomScale,{description:"Give spawned objects random scale",onChange:e=>{this.randomScale=e}}),this.exposeProperty("minScale","number",this.minScale,{min:.1,max:2,step:.1,description:"Minimum random scale",onChange:e=>{this.minScale=e}}),this.exposeProperty("maxScale","number",this.maxScale,{min:.1,max:5,step:.1,description:"Maximum random scale",onChange:e=>{this.maxScale=e}}),this.exposeProperty("giveVelocity","boolean",this.giveVelocity,{description:"Give spawned objects initial velocity",onChange:e=>{this.giveVelocity=e}}),this.exposeProperty("velocityDirection","vector2",this.velocityDirection,{description:"Direction for initial velocity",onChange:e=>{this.velocityDirection=e}}),this.exposeProperty("velocityMagnitude","number",this.velocityMagnitude,{min:0,max:1e3,step:10,description:"Initial velocity magnitude",onChange:e=>{this.velocityMagnitude=e}}),this.exposeProperty("velocityVariation","number",this.velocityVariation,{min:0,max:100,step:1,description:"Velocity magnitude variation",onChange:e=>{this.velocityVariation=e}}),this.exposeProperty("randomDirection","boolean",this.randomDirection,{description:"Random velocity direction",onChange:e=>{this.randomDirection=e}}),this.exposeProperty("setLifetime","boolean",this.setLifetime,{description:"Automatically destroy spawned objects after time",onChange:e=>{this.setLifetime=e}}),this.exposeProperty("lifetime","number",this.lifetime,{min:.1,max:60,step:.1,description:"Lifetime of spawned objects",onChange:e=>{this.lifetime=e}}),this.exposeProperty("lifetimeVariation","number",this.lifetimeVariation,{min:0,max:10,step:.1,description:"Lifetime variation",onChange:e=>{this.lifetimeVariation=e}})}start(){this.autoStart&&"interval"===this.spawnMode&&(this.startSpawning(),this.timer=0)}startSpawning(){this.isActive=!0,this.timer=0}stopSpawning(){this.isActive=!1}spawn(){if(-1===this.maxSpawns||this.spawnedCount<this.maxSpawns)for(let e=0;e<this.spawnCount;e++)this.spawnSingleObject()}loop(e){"interval"===this.spawnMode&&this.isActive&&(this.timer+=e,this.timer<this.spawnInterval||(this.spawn(),this.timer=0)),this.spawnedObjects=this.spawnedObjects.filter(e=>e&&!e.destroyed)}spawnSingleObject(){let e=null;return console.log(`Spawner: Attempting to spawn "${this.spawnObjectName}" using spawnType: ${this.spawnType}`),"prefab"===this.spawnType?e=this.trySpawnPrefab():"gameobject"===this.spawnType?e=this.trySpawnTemplate():"basic"===this.spawnType&&(e=this.createBasicObject()),e?(console.log("Spawner: Successfully spawned object using preferred method: "+this.spawnType),e):(console.log(`Spawner: Preferred method "${this.spawnType}" failed, trying fallbacks...`),"gameobject"!==this.spawnType&&(e=this.trySpawnTemplate(),e)?(console.log("Spawner: Fallback template spawn succeeded"),e):"prefab"!==this.spawnType&&(e=this.trySpawnPrefab(),e)?(console.log("Spawner: Fallback prefab spawn succeeded"),e):"basic"!==this.spawnType&&(e=this.createBasicObject(),e)?(console.log("Spawner: Fallback basic spawn succeeded"),e):(console.log(`Spawner: All spawn methods failed for "${this.spawnObjectName}"`),null))}trySpawnPrefab(){if(window.engine&&"function"==typeof window.engine.instantiatePrefab)try{const e=this.getSpawnPosition(),t=window.engine.gameObjects?window.engine.gameObjects.length:0,i=window.engine.dynamicObjects?window.engine.dynamicObjects.size:0,s=window.engine.instantiatePrefab(this.spawnObjectName,e.x,e.y),o=window.engine.gameObjects?window.engine.gameObjects.length:0,n=window.engine.dynamicObjects?window.engine.dynamicObjects.size:0,r=o>t||n>i;let a=null;if(s&&"object"==typeof s&&s.position)a=s,console.log("Spawner: Got prefab instance directly from instantiatePrefab: "+this.spawnObjectName);else if(r){if(window.engine.gameObjects&&o>t)a=window.engine.gameObjects[window.engine.gameObjects.length-1];else if(window.engine.dynamicObjects&&n>i){const e=Array.from(window.engine.dynamicObjects);a=e[e.length-1]}console.log("Spawner: Detected successful prefab instantiation by object count change: "+this.spawnObjectName)}if(a)return console.log(`Spawner: Successfully instantiated prefab "${this.spawnObjectName}" at (${e.x}, ${e.y})`),this.applySpawnTransforms(a,e),this.spawnedObjects.push(a),this.spawnedCount++,a;console.log(`Spawner: Prefab instantiation failed or no objects detected for "${this.spawnObjectName}"`)}catch(e){console.log(`Spawner: Failed to instantiate prefab "${this.spawnObjectName}":`,e)}return null}trySpawnTemplate(){if(window.engine){const e=window.engine.findGameObjectByName(this.spawnObjectName);if(e)try{const t=e.clone(!1),i=this.getSpawnPosition();return t.position=new Vector2(i.x,i.y),console.log(`Spawner: Cloned existing object "${this.spawnObjectName}" at (${i.x}, ${i.y})`),this.applySpawnTransforms(t,i),window.engine.gameObjects&&(window.engine.gameObjects.push(t),t.engine=window.engine,window.engine.dynamicObjects&&(window.engine.dynamicObjects.add(t),t._isDynamic=!0),t.start&&t.start()),this.spawnedObjects.push(t),this.spawnedCount++,t}catch(e){console.error(`Spawner: Failed to clone object "${this.spawnObjectName}":`,e)}}return null}applySpawnTransforms(e,t){if(this.inheritRotation?e.angle=this.gameObject.angle||0:this.randomRotation&&(e.angle=360*Math.random()),this.inheritScale&&this.gameObject.scale)e.scale=new Vector2(this.gameObject.scale.x,this.gameObject.scale.y);else if(this.randomScale){const t=this.minScale+Math.random()*(this.maxScale-this.minScale);e.scale=new Vector2(t,t)}this.giveVelocity&&this.applyVelocityToObject(e),this.useGravity&&this.applyGravityToObject(e),this.setLifetime&&this.applyLifetimeToObject(e)}applyVelocityToObject(e){try{let t=e.getModule("BasicPhysics");if(!t&&(t=new BasicPhysics,e.addModule(t),"function"==typeof t.start&&(e._started||e.started||e._hasStarted)))try{t.start()}catch{}let i=new Vector2(this.velocityDirection.x,this.velocityDirection.y);if(i=i.normalize(),this.velocityConeAngle>0){const e=this.velocityConeAngle*Math.PI/180/2,t=(Math.random()-.5)*e*2,s=Math.cos(t),o=Math.sin(t);i=new Vector2(i.x*s-i.y*o,i.x*o+i.y*s)}else if(this.randomDirection){const e=Math.random()*Math.PI*2;i=new Vector2(Math.cos(e),Math.sin(e))}const s=(Math.random()-.5)*this.velocityVariation,o=this.velocityMagnitude+s,n=new Vector2(i.x*o,i.y*o);t.setVelocity(n.x,n.y)}catch(e){console.error("Error applying velocity to spawned object:",e)}}applyGravityToObject(e){try{let t=e.getModule("BasicPhysics");if(!t&&(t=new BasicPhysics,e.addModule(t),"function"==typeof t.start&&(e._started||e.started||e._hasStarted)))try{t.start()}catch{}t.gravityEnabled=this.useGravity,t.setGravity(this.gravityDirection.x*this.gravityMagnitude,this.gravityDirection.y*this.gravityMagnitude)}catch(e){console.error("Error applying gravity to spawned object:",e)}}applyLifetimeToObject(e){let t=e.getModule("Timer");if(t)console.log(`Object ${e.name||"spawned object"} already has Timer module`);else{if(void 0===Timer&&window.Timer&&(Timer=window.Timer),void 0===Timer)return void console.warn("Timer module not available for lifetime management");if(t=new Timer,t.duration=this.lifetime+(Math.random()-.5)*this.lifetimeVariation,t.actionType="destroy",t.autoStart=!0,t.repeat=!1,t.gameObject=e,e.addModule(t),"function"==typeof t.start)try{t.start(),console.log(`Started Timer module for ${e.name||"spawned object"} with ${t.duration}s lifetime`)}catch(e){console.error("Error starting Timer module:",e)}}}createBasicObject(){const e=new GameObject(this.spawnObjectName),t=this.getSpawnPosition();e.position=new Vector2(t.x,t.y),this.applySpawnTransforms(e,t);const i=new DrawCircle;return i.radius=10,i.color="#"+Math.floor(16777215*Math.random()).toString(16),e.addModule(i),this.gameObject.scene?(this.gameObject.scene.gameObjects.push(e),e.scene=this.gameObject.scene,e.start()):window.engine&&window.engine.gameObjects&&(window.engine.gameObjects.push(e),e.engine=window.engine,window.engine.dynamicObjects&&(window.engine.dynamicObjects.add(e),e._isDynamic=!0),e.start&&e.start()),this.spawnedObjects.push(e),this.spawnedCount++,console.log(`Spawner: Created basic ${this.spawnObjectName} at (${t.x}, ${t.y})`),e}getSpawnPosition(){const e=new Vector2(this.gameObject.position.x+this.spawnOffset.x,this.gameObject.position.y+this.spawnOffset.y);switch(this.spawnArea){case"circle":const t=Math.random()*Math.PI*2,i=Math.random()*this.spawnRadius;return new Vector2(e.x+Math.cos(t)*i,e.y+Math.sin(t)*i);case"rectangle":return new Vector2(e.x+(Math.random()-.5)*this.spawnWidth,e.y+(Math.random()-.5)*this.spawnHeight);case"line":const s=Math.random();return new Vector2(e.x+(s-.5)*this.spawnWidth,e.y);default:return e}}destroyAllSpawned(){for(const e of this.spawnedObjects)e&&!e.destroyed&&e.destroy();this.spawnedObjects=[]}getActiveSpawnCount(){return this.spawnedObjects.filter(e=>e&&!e.destroyed).length}toJSON(){const e=super.toJSON();return e.spawnMode=this.spawnMode,e.spawnInterval=this.spawnInterval,e.spawnCount=this.spawnCount,e.maxSpawns=this.maxSpawns,e.autoStart=this.autoStart,e.spawnObjectName=this.spawnObjectName,e.spawnType=this.spawnType,e.inheritPosition=this.inheritPosition,e.inheritRotation=this.inheritRotation,e.inheritScale=this.inheritScale,e.spawnArea=this.spawnArea,e.spawnRadius=this.spawnRadius,e.spawnWidth=this.spawnWidth,e.spawnHeight=this.spawnHeight,e.spawnOffset={x:this.spawnOffset.x,y:this.spawnOffset.y},e.randomRotation=this.randomRotation,e.randomScale=this.randomScale,e.minScale=this.minScale,e.maxScale=this.maxScale,e.giveVelocity=this.giveVelocity,e.velocityDirection={x:this.velocityDirection.x,y:this.velocityDirection.y},e.velocityMagnitude=this.velocityMagnitude,e.velocityVariation=this.velocityVariation,e.randomDirection=this.randomDirection,e.setLifetime=this.setLifetime,e.lifetime=this.lifetime,e.lifetimeVariation=this.lifetimeVariation,e.velocityConeAngle=this.velocityConeAngle,e.velocityDirection={x:this.velocityDirection.x,y:this.velocityDirection.y},e}fromJSON(e){super.fromJSON(e),void 0!==e.spawnMode&&(this.spawnMode=e.spawnMode),void 0!==e.spawnInterval&&(this.spawnInterval=e.spawnInterval),void 0!==e.spawnCount&&(this.spawnCount=e.spawnCount),void 0!==e.maxSpawns&&(this.maxSpawns=e.maxSpawns),void 0!==e.autoStart&&(this.autoStart=e.autoStart),void 0!==e.spawnObjectName&&(this.spawnObjectName=e.spawnObjectName),void 0!==e.spawnType&&(this.spawnType=e.spawnType),void 0!==e.inheritPosition&&(this.inheritPosition=e.inheritPosition),void 0!==e.inheritRotation&&(this.inheritRotation=e.inheritRotation),void 0!==e.inheritScale&&(this.inheritScale=e.inheritScale),void 0!==e.spawnArea&&(this.spawnArea=e.spawnArea),void 0!==e.spawnRadius&&(this.spawnRadius=e.spawnRadius),void 0!==e.spawnWidth&&(this.spawnWidth=e.spawnWidth),void 0!==e.spawnHeight&&(this.spawnHeight=e.spawnHeight),void 0!==e.spawnOffset&&(this.spawnOffset=new Vector2(e.spawnOffset.x,e.spawnOffset.y)),void 0!==e.randomRotation&&(this.randomRotation=e.randomRotation),void 0!==e.randomScale&&(this.randomScale=e.randomScale),void 0!==e.minScale&&(this.minScale=e.minScale),void 0!==e.maxScale&&(this.maxScale=e.maxScale),void 0!==e.giveVelocity&&(this.giveVelocity=e.giveVelocity),void 0!==e.velocityDirection&&(this.velocityDirection=new Vector2(e.velocityDirection.x,e.velocityDirection.y)),void 0!==e.velocityMagnitude&&(this.velocityMagnitude=e.velocityMagnitude),void 0!==e.velocityVariation&&(this.velocityVariation=e.velocityVariation),void 0!==e.randomDirection&&(this.randomDirection=e.randomDirection),void 0!==e.setLifetime&&(this.setLifetime=e.setLifetime),void 0!==e.lifetime&&(this.lifetime=e.lifetime),void 0!==e.lifetimeVariation&&(this.lifetimeVariation=e.lifetimeVariation),void 0!==e.velocityConeAngle&&(this.velocityConeAngle=e.velocityConeAngle),void 0!==e.velocityDirection&&(this.velocityDirection=new Vector2(e.velocityDirection.x,e.velocityDirection.y))}}window.Spawner=Spawner;class SimpleMovementController extends Module{static allowMultiple=!1;static namespace="Controllers";static description="Basic character movement controller for 2D games";constructor(){super("SimpleMovementController"),this.speed=200,this.usePhysics=!1,this.allowDiagonal=!0,this.acceleration=.2,this.deceleration=.1,this.velocity=new Vector2(0,0),this.controlScheme="both",this.exposeProperty("speed","number",200,{min:0,max:1e3,step:10,description:"Movement speed in pixels per second",style:{label:"Movement Speed",slider:!0},onChange:e=>{this.speed=e}}),this.exposeProperty("usePhysics","boolean",!1,{description:"Use physics-based movement (requires RigidBody)",style:{label:"Use Physics Movement"},onChange:e=>{this.usePhysics=e}}),this.exposeProperty("allowDiagonal","boolean",!0,{description:"Enable diagonal movement",style:{label:"Allow Diagonal Movement"},onChange:e=>{this.allowDiagonal=e}}),this.exposeProperty("acceleration","number",.2,{min:.01,max:1,step:.01,description:"Acceleration factor (1 = instant)",style:{label:"Acceleration"},onChange:e=>{this.acceleration=e}}),this.exposeProperty("deceleration","number",.1,{min:.01,max:1,step:.01,description:"Deceleration factor when no input (1 = instant stop)",style:{label:"Deceleration"},onChange:e=>{this.deceleration=e}}),this.exposeProperty("controlScheme","enum","both",{options:["arrows","wasd","both"],description:"Input control scheme to use",style:{label:"Control Scheme"},onChange:e=>{this.controlScheme=e}})}getRequirements(){return this.usePhysics?["RigidBody"]:[]}loop(e){if(!window.input)return;let t=0,i=0;if("arrows"!==this.controlScheme&&"both"!==this.controlScheme||(window.input.keyDown("ArrowRight")&&(t+=1),window.input.keyDown("ArrowLeft")&&(t-=1),window.input.keyDown("ArrowDown")&&(i+=1),window.input.keyDown("ArrowUp")&&(i-=1)),"wasd"!==this.controlScheme&&"both"!==this.controlScheme||(window.input.keyDown("KeyD")&&(t+=1),window.input.keyDown("KeyA")&&(t-=1),window.input.keyDown("KeyS")&&(i+=1),window.input.keyDown("KeyW")&&(i-=1)),this.allowDiagonal||0===t||0===i){if(0!==t&&0!==i){const e=Math.sqrt(t*t+i*i);t/=e,i/=e}}else i=0;const s=t*this.speed,o=i*this.speed;if(0!==t?this.velocity.x+=(s-this.velocity.x)*this.acceleration:(this.velocity.x*=1-this.deceleration,.1>Math.abs(this.velocity.x)&&(this.velocity.x=0)),0!==i?this.velocity.y+=(o-this.velocity.y)*this.acceleration:(this.velocity.y*=1-this.deceleration,.1>Math.abs(this.velocity.y)&&(this.velocity.y=0)),this.usePhysics){const t=this.gameObject.getModule("RigidBody");t?t.setVelocity(this.velocity):(this.gameObject.position.x+=this.velocity.x*e,this.gameObject.position.y+=this.velocity.y*e)}else this.gameObject.position.x+=this.velocity.x*e,this.gameObject.position.y+=this.velocity.y*e}toJSON(){const e=super.toJSON();return e.speed=this.speed,e.usePhysics=this.usePhysics,e.allowDiagonal=this.allowDiagonal,e.acceleration=this.acceleration,e.deceleration=this.deceleration,e.controlScheme=this.controlScheme,e}fromJSON(e){super.fromJSON(e),void 0!==e.speed&&(this.speed=e.speed),void 0!==e.usePhysics&&(this.usePhysics=e.usePhysics),void 0!==e.allowDiagonal&&(this.allowDiagonal=e.allowDiagonal),void 0!==e.acceleration&&(this.acceleration=e.acceleration),void 0!==e.deceleration&&(this.deceleration=e.deceleration),void 0!==e.controlScheme&&(this.controlScheme=e.controlScheme)}}window.SimpleMovementController=SimpleMovementController;class CameraController extends Module{static allowMultiple=!1;static namespace="Camera";static description="Control the viewport camera for the game scene. ";static iconClass="fas fa-video";constructor(){super("CameraController"),this.position=new Vector2(0,0),this.followSpeed=5,this.zoomSpeed=2,this.zoom=1,this.targetZoom=1,this.bounds=null,this.offset=new Vector2(0,0),this.positionDamping=.85,this.zoomDamping=.85,this.dynamicZoomEnabled=!1,this.maxZoomOut=.2,this.zoomSmoothness=.85,this.zoomIntensityMultiplier=.001,this.shakeIntensity=0,this.shakeDuration=0,this.shakeTimer=0,this.shakeDecay=1,this.followOwner=!0,this.followOwnerAngle=!1,this.followAngleOffset=0,this.currentAngle=0,this.targetAngle=0,this.exposeProperty("followOwner","boolean",!0,{description:"Whether camera follows this GameObject",onChange:e=>{this.followOwner=e}}),this.exposeProperty("followSpeed","number",5,{description:"How quickly the camera follows its target",min:.1,max:20,step:.1,onChange:e=>{this.followSpeed=e}}),this.exposeProperty("zoom","number",1,{description:"Camera zoom level (1.0 = 100%)",min:.1,max:10,step:.1,onChange:e=>{this.zoom=e}}),this.exposeProperty("targetZoom","number",1,{description:"Target zoom level (base zoom level)",min:.1,max:10,step:.1,onChange:e=>{this.targetZoom=e}}),this.exposeProperty("positionDamping","number",.85,{description:"Smoothness of camera movement (0-1)",min:0,max:.99,step:.01,onChange:e=>{this.positionDamping=e}}),this.exposeProperty("zoomDamping","number",.85,{description:"Smoothness of camera zoom (0-1)",min:0,max:.99,step:.01,onChange:e=>{this.zoomDamping=e}}),this.exposeProperty("dynamicZoomEnabled","boolean",!1,{description:"Enable dynamic zoom based on GameObject speed",onChange:e=>{this.dynamicZoomEnabled=e}}),this.exposeProperty("maxZoomOut","number",.5,{description:"Maximum zoom out level",min:.1,max:10,step:.1,onChange:e=>{this.maxZoomOut=e}}),this.exposeProperty("zoomSmoothness","number",.85,{description:"Smoothness of dynamic zoom (0-1)",min:0,max:.99,step:.01,onChange:e=>{this.zoomSmoothness=e}}),this.exposeProperty("zoomIntensityMultiplier","number",.01,{description:"Multiplier for zoom intensity based on speed",min:.001,max:1,step:.001,onChange:e=>{this.zoomIntensityMultiplier=e}}),this.exposeProperty("shakeIntensity","number",0,{description:"Intensity of camera shake effect",min:0,max:100,step:1,onChange:e=>{this.shakeIntensity=e}}),this.exposeProperty("shakeTimer","number",0,{description:"Internal timer for shake effect",readOnly:!0,onChange:e=>{this.shakeTimer=e}}),this.exposeProperty("offset","vector2",this.offset,{description:"Camera offset from this GameObject",onChange:e=>{this.offset=new Vector2(e.x,e.y)}})}style(e){e.startGroup("Camera Follow",!1,{backgroundColor:"rgba(100,150,255,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("followOwner","boolean",this.followOwner,{label:"Follow GameObject"}),e.exposeProperty("followSpeed","number",this.followSpeed,{label:"Follow Speed"}),e.exposeProperty("offset","vector2",this.offset,{label:"Camera Offset"}),e.endGroup(),e.addDivider(),e.startGroup("Zoom & Dynamics",!1,{backgroundColor:"rgba(150,255,150,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("zoom","number",this.zoom,{label:"Zoom"}),e.exposeProperty("targetZoom","number",this.targetZoom,{label:"Target Zoom"}),e.exposeProperty("zoomDamping","number",this.zoomDamping,{label:"Zoom Damping"}),e.exposeProperty("dynamicZoomEnabled","boolean",this.dynamicZoomEnabled,{label:"Dynamic Zoom"}),e.exposeProperty("maxZoomOut","number",this.maxZoomOut,{label:"Max Zoom Out"}),e.exposeProperty("zoomSmoothness","number",this.zoomSmoothness,{label:"Zoom Smoothness"}),e.exposeProperty("zoomIntensityMultiplier","number",this.zoomIntensityMultiplier,{label:"Zoom Intensity Multiplier"}),e.endGroup(),e.addDivider(),e.startGroup("Shake & Misc",!1,{backgroundColor:"rgba(255,150,150,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("shakeIntensity","number",this.shakeIntensity,{label:"Shake Intensity"}),e.exposeProperty("shakeTimer","number",this.shakeTimer,{label:"Shake Timer"}),e.exposeProperty("positionDamping","number",this.positionDamping,{label:"Position Damping"}),e.endGroup()}onAttach(e){const t=e.getWorldPosition();this.position=new Vector2(t.x,t.y),this.updateSceneViewport()}getTargetPosition(){if(!this.gameObject||!this.followOwner)return this.position.clone();const e=this.gameObject.getWorldPosition();return new Vector2(e.x+this.offset.x,e.y+this.offset.y)}jumpToTarget(){this.position=this.getTargetPosition(),this.updateSceneViewport()}moveTo(e,t=!1){const i=this.followOwner;this.followOwner=!1,t?(this.position=e.clone(),this.updateSceneViewport()):this._targetPosition=e.clone(),i&&setTimeout(()=>{this.followOwner=i},1e3)}setZoom(e,t=!1){this.targetZoom=Math.max(.1,e),t&&(this.zoom=this.targetZoom,this.updateSceneViewport())}shake(e=10,t=.5){this.shakeIntensity=e,this.shakeDuration=t,this.shakeTimer=t}applyBounds(){if(!this.bounds)return;const e=window.engine;if(!e||!e.scene)return;const t=e.scene.settings||{},i=t.viewportWidth||800,s=t.viewportHeight||600,o=i/2/this.zoom,n=s/2/this.zoom;this.bounds&&(this.position.x=Math.max(this.bounds.x+o,Math.min(this.bounds.x+this.bounds.width-o,this.position.x)),this.position.y=Math.max(this.bounds.y+n,Math.min(this.bounds.y+this.bounds.height-n,this.position.y)))}updateSceneViewport(){const e=window.engine;if(!e)return void console.warn("CameraController: Engine not available, cannot update viewport.");const t=e.viewport.width?e.viewport.width:800,i=e.viewport.height?e.viewport.height:600;let s=this.position.x,o=this.position.y,n=0,r=0;this.zoom,this.zoom,e.viewport.angle=this.currentAngle,this.shakeTimer>0&&(n=(2*Math.random()-1)*this.shakeIntensity,r=(2*Math.random()-1)*this.shakeIntensity),e.viewport.x=s-t/2+n,e.viewport.y=o-i/2+r,e.viewport.width=t,e.viewport.height=i,e.viewport.zoom=this.zoom,e.resizeCanvas&&e.resizeCanvas()}loop(e){this.dynamicZoomEnabled&&(this.followOwner=!0,this._targetPosition=void 0);const t=this.followOwner?this.getTargetPosition():this._targetPosition||this.position;if(this.followOwnerAngle&&this.gameObject?this.targetAngle=this.gameObject.angle+this.followAngleOffset:this.targetAngle=0,!this.position.equals(t)){const i=1-Math.pow(this.positionDamping,e*this.followSpeed);this.position.x=this.position.x+(t.x-this.position.x)*i,this.position.y=this.position.y+(t.y-this.position.y)*i}if(this.followOwnerAngle&&this.gameObject){const t=1-Math.pow(this.positionDamping,e*this.followSpeed);let i=this.targetAngle-this.currentAngle;for(;i>Math.PI;)i-=2*Math.PI;for(;-Math.PI>i;)i+=2*Math.PI;this.currentAngle+=i*t}else if(!this.followOwnerAngle&&Math.abs(this.currentAngle)>.001){const t=1-Math.pow(this.positionDamping,e*this.followSpeed);let i=-this.currentAngle;for(;i>Math.PI;)i-=2*Math.PI;for(;-Math.PI>i;)i+=2*Math.PI;this.currentAngle+=i*t,.001>Math.abs(this.currentAngle)&&(this.currentAngle=0)}if(this.zoom!==this.targetZoom){const t=1-Math.pow(this.zoomDamping,e*this.zoomSpeed);this.zoom+=(this.targetZoom-this.zoom)*t,.001>Math.abs(this.zoom-this.targetZoom)&&(this.zoom=this.targetZoom)}if(this.dynamicZoomEnabled&&this.gameObject&&this.gameObject.previousPosition){const t=this.gameObject.previousPosition,i=this.gameObject.position;let s=1-Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2))/(e||1)*this.zoomIntensityMultiplier;s=Math.max(this.maxZoomOut,Math.min(1,s)),this.targetZoom=s;const o=1-Math.pow(this.zoomSmoothness,e*this.zoomSpeed);this.zoom+=(this.targetZoom-this.zoom)*o,.001>Math.abs(this.zoom-this.targetZoom)&&(this.zoom=this.targetZoom)}this.shakeTimer>0&&(this.shakeTimer-=e,this.shakeTimer>0?this.shakeIntensity*=this.shakeDecay:(this.shakeTimer=0,this.shakeIntensity=0)),this.zoom>.1||(this.zoom=.1,this.targetZoom=.1),this.updateSceneViewport()}setBounds(e,t,i,s){this.bounds={x:e,y:t,width:i,height:s}}clearBounds(){this.bounds=null}pan(e,t,i=!1){this.followOwner=!1;const s=new Vector2(this.position.x+e,this.position.y+t);this.moveTo(s,i)}centerOn(e,t,i=!1){this.followOwner=!1,this.moveTo(new Vector2(e,t),i)}onEnable(){if(this.gameObject){const e=this.gameObject.getWorldPosition();this.position=new Vector2(e.x,e.y),this.updateSceneViewport()}}onAttach(e){const t=e.getWorldPosition();this.position=new Vector2(t.x,t.y),setTimeout(()=>{this.jumpToTarget()},0)}toJSON(){const e=super.toJSON()||{};return e.position={x:this.position.x,y:this.position.y},e.zoom=this.zoom,e.targetZoom=this.targetZoom,e.followOwner=this.followOwner,e.followSpeed=this.followSpeed,e.zoomSpeed=this.zoomSpeed,e.positionDamping=this.positionDamping,e.zoomDamping=this.zoomDamping,e.offset={x:this.offset.x,y:this.offset.y},e.followOwnerAngle=this.followOwnerAngle,e.followAngleOffset=this.followAngleOffset,e.currentAngle=this.currentAngle,e.targetAngle=this.targetAngle,this.bounds&&(e.bounds={...this.bounds}),e}fromJSON(e){super.fromJSON(e),e&&(e.position&&(this.position=new Vector2(e.position.x,e.position.y)),void 0!==e.zoom&&(this.zoom=e.zoom),void 0!==e.targetZoom&&(this.targetZoom=e.targetZoom),void 0!==e.followOwner&&(this.followOwner=e.followOwner),void 0!==e.followSpeed&&(this.followSpeed=e.followSpeed),void 0!==e.zoomSpeed&&(this.zoomSpeed=e.zoomSpeed),void 0!==e.positionDamping&&(this.positionDamping=e.positionDamping),void 0!==e.zoomDamping&&(this.zoomDamping=e.zoomDamping),void 0!==e.followOwnerAngle&&(this.followOwnerAngle=e.followOwnerAngle),void 0!==e.followAngleOffset&&(this.followAngleOffset=e.followAngleOffset),void 0!==e.currentAngle&&(this.currentAngle=e.currentAngle),void 0!==e.targetAngle&&(this.targetAngle=e.targetAngle),e.offset&&(this.offset=new Vector2(e.offset.x,e.offset.y)),e.bounds&&(this.bounds={...e.bounds}),this.updateSceneViewport())}}window.CameraController=CameraController;class Tween extends Module{static allowMultiple=!0;static namespace="Animation";static description="Animates object properties over time with easing";static iconClass="fas fa-play-circle";constructor(){super("Tween"),this.targetProperty="position.x",this.startValue=0,this.endValue=100,this.duration=1,this.delay=0,this.easing="linear",this.loopPlay=!1,this.pingPong=!1,this.autoStart=!0,this.isPlaying=!1,this.currentTime=0,this.delayTime=0,this.direction=1,this.originalValue=null,this.exposeProperty("targetProperty","string",this.targetProperty,{description:"Property to animate (e.g., 'position.x', 'scale.y', 'rotation')",onChange:e=>this.targetProperty=e}),this.exposeProperty("endValue","number",this.endValue,{description:"Ending value of the animation",onChange:e=>this.endValue=e}),this.exposeProperty("duration","number",this.duration,{min:.1,max:10,step:.1,description:"Duration of the animation in seconds",onChange:e=>this.duration=e,style:{slider:!0,range:[.1,10],help:"How long the tween lasts (seconds)",group:"Timing",header:"Tween Timing",color:"#0078D7"}}),this.exposeProperty("delay","number",this.delay,{min:0,max:5,step:.1,description:"Delay before starting animation in seconds",onChange:e=>this.delay=e}),this.exposeProperty("easing","enum",this.easing,{options:["linear","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInSine","easeOutSine","easeInOutSine"],description:"Easing function for the animation",onChange:e=>this.easing=e}),this.exposeProperty("loopPlay","boolean",this.loopPlay,{description:"Loop the animation indefinitely",onChange:e=>this.loopPlay=e}),this.exposeProperty("pingPong","boolean",this.pingPong,{description:"Reverse direction each loop cycle",onChange:e=>this.pingPong=e}),this.exposeProperty("autoStart","boolean",this.autoStart,{description:"Start animation automatically when enabled",onChange:e=>this.autoStart=e})}style(e){e.addHeader("Tween Animation","tween-header").startGroup("Target",!1,{color:"#0078D7"}).exposeProperty("targetProperty","string",this.targetProperty,{label:"Target Property"}).addHelpText("E.g. 'position.x', 'scale.y', 'rotation'").endGroup().startGroup("Values",!1).exposeProperty("endValue","number",this.endValue,{label:"End Value"}).endGroup().startGroup("Timing",!1).addSlider("duration",this.duration,.1,10,.1,e=>this.duration=e,{label:"Duration"}).addSlider("delay",this.delay,0,5,.1,e=>this.delay=e,{label:"Delay"}).endGroup().startGroup("Options",!1).addDropdown("easing",this.easing,["linear","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInSine","easeOutSine","easeInOutSine"],e=>this.easing=e,{label:"Easing"}).exposeProperty("loopPlay","boolean",this.loopPlay).exposeProperty("pingPong","boolean",this.pingPong).exposeProperty("autoStart","boolean",this.autoStart).endGroup()}start(){this.autoStart&&this.play()}play(){this.isPlaying=!0,this.currentTime=0,this.delayTime=0,this.direction=1,.01>this.duration&&(this.duration=.01),0>this.delay&&(this.delay=0);const e=this.getPropertyValue();null===this.originalValue&&(this.originalValue=e),this.startValue=e}stop(){this.isPlaying=!1,this.currentTime=0,this.delayTime=0}pause(){this.isPlaying=!1}resume(){this.isPlaying=!0}reset(){this.stop(),null!==this.originalValue&&this.setPropertyValue(this.originalValue)}loop(e){if(!this.isPlaying)return;if(this.delayTime<this.delay)return void(this.delayTime+=e);this.currentTime+=e*this.direction;let t=Math.max(0,Math.min(1,this.currentTime/this.duration));const i=this.applyEasing(t),s=this.startValue+(this.endValue-this.startValue)*i;this.setPropertyValue(s),this.currentTime<this.duration?this.currentTime>0||-1!==this.direction||this.pingPong&&(this.direction=1,this.currentTime=0):this.loopPlay?this.pingPong?(this.direction*=-1,this.currentTime=this.duration):this.currentTime=0:(this.isPlaying=!1,this.setPropertyValue(this.endValue))}applyEasing(e){switch(this.easing){case"easeInQuad":return e*e;case"easeOutQuad":return e*(2-e);case"easeInOutQuad":return.5>e?2*e*e:(4-2*e)*e-1;case"easeInCubic":return e*e*e;case"easeOutCubic":return--e*e*e+1;case"easeInOutCubic":return.5>e?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1;case"easeInSine":return 1-Math.cos(e*Math.PI/2);case"easeOutSine":return Math.sin(e*Math.PI/2);case"easeInOutSine":return-(Math.cos(Math.PI*e)-1)/2;default:return e}}getPropertyValue(){const e=this.targetProperty.split(".");let t=this.gameObject;for(let i=0;i<e.length-1;i++){if(!t||void 0===t[e[i]])return console.warn(`Tween: Property path "${this.targetProperty}" not found on gameObject`),0;t=t[e[i]]}const i=e[e.length-1];return t&&void 0!==t[i]?t[i]:(console.warn(`Tween: Final property "${i}" not found on gameObject`),0)}setPropertyValue(e){const t=this.targetProperty.split(".");let i=this.gameObject;for(let e=0;e<t.length-1;e++){if(!i||void 0===i[t[e]])return void console.warn(`Tween: Property path "${this.targetProperty}" not found on gameObject`);i=i[t[e]]}const s=t[t.length-1];i&&void 0!==i[s]?i[s]=e:console.warn(`Tween: Final property "${s}" not found on gameObject`)}toJSON(){const e=super.toJSON();return e.targetProperty=this.targetProperty,e.startValue=this.startValue,e.endValue=this.endValue,e.duration=this.duration,e.delay=this.delay,e.easing=this.easing,e.loopPlay=this.loopPlay,e.pingPong=this.pingPong,e.autoStart=this.autoStart,e}fromJSON(e){super.fromJSON(e),void 0!==e.targetProperty&&(this.targetProperty=e.targetProperty),void 0!==e.startValue&&(this.startValue=e.startValue),void 0!==e.endValue&&(this.endValue=e.endValue),void 0!==e.duration&&(this.duration=e.duration),void 0!==e.delay&&(this.delay=e.delay),void 0!==e.easing&&(this.easing=e.easing),void 0!==e.loopPlay&&(this.loopPlay=e.loopPlay),void 0!==e.pingPong&&(this.pingPong=e.pingPong),void 0!==e.autoStart&&(this.autoStart=e.autoStart)}}window.Tween=Tween;class Timer extends Module{static allowMultiple=!0;static namespace="Animation";static description="Executes actions after time intervals";static iconClass="fas fa-clock";constructor(){super("Timer"),this.duration=1,this.repeat=!1,this.repeatCount=-1,this.autoStart=!0,this.actionType="log",this.customMessage="Timer finished!",this.isRunning=!1,this.currentTime=0,this.completedCycles=0,this.exposeProperty("duration","number",this.duration,{min:.1,max:60,step:.1,description:"Timer duration in seconds",onChange:e=>this.duration=e}),this.exposeProperty("repeat","boolean",this.repeat,{description:"Repeat the timer",onChange:e=>this.repeat=e}),this.exposeProperty("repeatCount","number",this.repeatCount,{min:-1,max:100,step:1,description:"Number of repeats (-1 for infinite)",onChange:e=>this.repeatCount=e}),this.exposeProperty("autoStart","boolean",this.autoStart,{description:"Start timer automatically when enabled",onChange:e=>this.autoStart=e}),this.exposeProperty("actionType","enum",this.actionType,{options:["log","destroy","disable","enable","custom"],description:"Action to perform when timer completes",onChange:e=>this.actionType=e}),this.exposeProperty("customMessage","string",this.customMessage,{description:"Message to log when timer completes",onChange:e=>this.customMessage=e})}start(){this.autoStart&&this.startTimer()}startTimer(){this.isRunning=!0,this.currentTime=0,this.completedCycles=0}stopTimer(){this.isRunning=!1,this.currentTime=0}pauseTimer(){this.isRunning=!1}resumeTimer(){this.isRunning=!0}resetTimer(){this.currentTime=0,this.completedCycles=0}loop(e){this.isRunning&&(this.currentTime+=e,this.currentTime<this.duration||(this.executeAction(),this.completedCycles++,this.repeat&&(-1===this.repeatCount||this.completedCycles<this.repeatCount)?this.currentTime=0:this.isRunning=!1))}executeAction(){switch(this.actionType){case"log":console.log(this.customMessage);break;case"destroy":this.gameObject&&this.gameObject.destroy&&this.gameObject.destroy();break;case"disable":this.gameObject&&(this.gameObject.active=!1);break;case"enable":this.gameObject&&(this.gameObject.active=!0);break;case"custom":this.gameObject&&this.gameObject.emit&&this.gameObject.emit("timerComplete",{timer:this,message:this.customMessage,cycle:this.completedCycles}),console.log("Timer: "+this.customMessage)}}getRemainingTime(){return Math.max(0,this.duration-this.currentTime)}getProgress(){return Math.min(1,this.currentTime/this.duration)}toJSON(){const e=super.toJSON();return e.duration=this.duration,e.repeat=this.repeat,e.repeatCount=this.repeatCount,e.autoStart=this.autoStart,e.actionType=this.actionType,e.customMessage=this.customMessage,e}fromJSON(e){super.fromJSON(e),void 0!==e.duration&&(this.duration=e.duration),void 0!==e.repeat&&(this.repeat=e.repeat),void 0!==e.repeatCount&&(this.repeatCount=e.repeatCount),void 0!==e.autoStart&&(this.autoStart=e.autoStart),void 0!==e.actionType&&(this.actionType=e.actionType),void 0!==e.customMessage&&(this.customMessage=e.customMessage)}}window.Timer=Timer;class ParticleSystem extends Module{static allowMultiple=!0;static namespace="Effects";static description="Creates particle effects like fire, smoke, explosions with image support";static iconClass="fas fa-fire";constructor(){super("ParticleSystem"),this.emissionRate=10,this.maxParticles=100,this.emissionShape="point",this.emissionRadius=0,this.emissionWidth=50,this.emissionHeight=50,this.particleLifetime=2,this.particleLifetimeVariation=.5,this.startSize=5,this.endSize=1,this.sizeVariation=2,this.startColor="#ffffff",this.endColor="#ffffff",this.startAlpha=1,this.endAlpha=0,this.startVelocityX=0,this.startVelocityY=-50,this.velocityVariationX=20,this.velocityVariationY=20,this.gravity=0,this.drag=.98,this.particleShape="circle",this.blendMode="normal",this.useAlphaGradient=!1,this.gradientType="radial",this.gradientDirection=0,this.useImageParticles=!1,this.imageAsset=null,this.imageScaleMode="stretch",this.imageRotation=0,this.imageFlipX=!1,this.imageFlipY=!1,this.autoStart=!0,this.loopEmitter=!0,this.duration=5,this.useObjectPooling=!0,this.enableBatching=!0,this.maxBatchSize=50,this.cullingEnabled=!0,this.cullingMargin=100,this.particles=[],this.particlePool=[],this.isEmitting=!1,this.emissionTimer=0,this.accumulateWhenFull=!1,this.systemTimer=0,this._image=null,this._isImageLoaded=!1,this._imageWidth=0,this._imageHeight=0,this.lastCullTime=0,this.cullInterval=100,this.batchedParticles=new Map,this.setupProperties(),this.createImageAssetReference()}createImageAssetReference(){try{window.AssetReference?this.imageAsset=new window.AssetReference(null,"image"):this.imageAsset={path:null,type:"image",embedded:!1,load:()=>Promise.resolve(null)}}catch(e){console.error("Error creating AssetReference for ParticleSystem:",e),this.imageAsset={path:null,type:"image",embedded:!1,load:()=>Promise.resolve(null)}}}setupProperties(){this.exposeProperty("emissionRate","number",this.emissionRate,{min:.1,max:100,step:.1,description:"Particles emitted per second",onChange:e=>{this.emissionRate=e}}),this.exposeProperty("maxParticles","number",this.maxParticles,{min:1,max:1e3,step:1,description:"Maximum number of particles",onChange:e=>{this.maxParticles=e}}),this.exposeProperty("emissionShape","enum",this.emissionShape,{options:["point","circle","rectangle"],description:"Shape of emission area",onChange:e=>{this.emissionShape=e}}),this.exposeProperty("emissionRadius","number",this.emissionRadius,{min:0,max:200,step:1,description:"Radius for circle emission",onChange:e=>{this.emissionRadius=e}}),this.exposeProperty("particleLifetime","number",this.particleLifetime,{min:.1,max:10,step:.1,description:"How long particles live (seconds)",onChange:e=>{this.particleLifetime=e}}),this.exposeProperty("particleLifetimeVariation","number",this.particleLifetimeVariation,{min:0,max:5,step:.1,description:"Random variation in lifetime",onChange:e=>{this.particleLifetimeVariation=e}}),this.exposeProperty("startSize","number",this.startSize,{min:1,max:50,step:1,description:"Initial particle size",onChange:e=>{this.startSize=e}}),this.exposeProperty("endSize","number",this.endSize,{min:0,max:50,step:1,description:"Final particle size",onChange:e=>{this.endSize=e}}),this.exposeProperty("startColor","color",this.startColor,{description:"Initial particle color",onChange:e=>{this.startColor=e}}),this.exposeProperty("endColor","color",this.endColor,{description:"Final particle color",onChange:e=>{this.endColor=e}}),this.exposeProperty("startAlpha","number",this.startAlpha,{min:0,max:1,step:.1,description:"Initial particle opacity",onChange:e=>{this.startAlpha=e}}),this.exposeProperty("endAlpha","number",this.endAlpha,{min:0,max:1,step:.1,description:"Final particle opacity",onChange:e=>{this.endAlpha=e}}),this.exposeProperty("startVelocityY","number",this.startVelocityY,{min:-200,max:200,step:1,description:"Initial Y velocity",onChange:e=>{this.startVelocityY=e}}),this.exposeProperty("velocityVariationX","number",this.velocityVariationX,{min:0,max:100,step:1,description:"Random X velocity variation",onChange:e=>{this.velocityVariationX=e}}),this.exposeProperty("velocityVariationY","number",this.velocityVariationY,{min:0,max:100,step:1,description:"Random Y velocity variation",onChange:e=>{this.velocityVariationY=e}}),this.exposeProperty("gravity","number",this.gravity,{min:-500,max:500,step:1,description:"Gravity force applied to particles",onChange:e=>{this.gravity=e}}),this.exposeProperty("drag","number",this.drag,{min:.9,max:1,step:.01,description:"Air resistance (1.0 = no drag)",onChange:e=>{this.drag=e}}),this.exposeProperty("particleShape","enum",this.particleShape,{options:["circle","square","line","image","gameobject"],description:"Shape of individual particles",onChange:e=>{this.particleShape=e,this.useImageParticles="image"===e,this.refreshInspector()}}),this.exposeProperty("blendMode","enum",this.blendMode,{options:["normal","additive","multiply","screen","overlay"],description:"Particle blend mode",onChange:e=>{this.blendMode=e}}),this.exposeProperty("useAlphaGradient","boolean",this.useAlphaGradient,{description:"Use alpha mask gradients for particles",onChange:e=>{this.useAlphaGradient=e,this.refreshInspector()}}),this.useAlphaGradient&&(this.exposeProperty("gradientType","enum",this.gradientType,{options:["radial","linear"],description:"Type of alpha gradient",onChange:e=>{this.gradientType=e}}),"linear"===this.gradientType&&this.exposeProperty("gradientDirection","number",this.gradientDirection,{min:0,max:360,step:1,description:"Linear gradient direction (degrees)",onChange:e=>{this.gradientDirection=e}})),this.useImageParticles&&(this.exposeProperty("imageAsset","asset",this.imageAsset,{description:"Image for particles",assetType:"image",fileTypes:["png","jpg","jpeg","gif","webp"],onAssetSelected:e=>{this.setParticleImage(e)},onDropCallback:this.handleImageDrop.bind(this),showImageDropdown:!0}),this.exposeProperty("imageScaleMode","enum",this.imageScaleMode,{options:["stretch","fit","maintain"],description:"How image scales to particle size",onChange:e=>{this.imageScaleMode=e}}),this.exposeProperty("imageRotation","number",this.imageRotation,{min:0,max:360,step:1,description:"Additional image rotation (degrees)",onChange:e=>{this.imageRotation=e}}),this.exposeProperty("imageFlipX","boolean",this.imageFlipX,{description:"Flip image horizontally",onChange:e=>{this.imageFlipX=e}}),this.exposeProperty("imageFlipY","boolean",this.imageFlipY,{description:"Flip image vertically",onChange:e=>{this.imageFlipY=e}})),this.exposeProperty("useObjectPooling","boolean",this.useObjectPooling,{description:"Use object pooling for better performance",onChange:e=>{this.useObjectPooling=e,e||(this.particlePool=[])}}),this.exposeProperty("enableBatching","boolean",this.enableBatching,{description:"Enable batch rendering for similar particles",onChange:e=>{this.enableBatching=e}}),this.exposeProperty("cullingEnabled","boolean",this.cullingEnabled,{description:"Cull particles outside viewport",onChange:e=>{this.cullingEnabled=e}}),this.exposeProperty("autoStart","boolean",this.autoStart,{description:"Start emitting automatically",onChange:e=>{this.autoStart=e}}),this.exposeProperty("loopEmitter","boolean",this.loopEmitter,{description:"Loop the particle system",onChange:e=>{this.loopEmitter=e}})}style(e){e.addHeader("Particle System","particle-header").startGroup("Emission",!1,{color:"#4A90E2"}).exposeProperty("emissionRate","number",this.emissionRate,{label:"Emission Rate",min:.1,max:100,step:.1,description:"Particles emitted per second"}).exposeProperty("maxParticles","number",this.maxParticles,{label:"Max Particles",min:1,max:1e3,step:1,description:"Maximum number of particles"}).exposeProperty("emissionShape","enum",this.emissionShape,{label:"Emission Shape",options:["point","circle","rectangle"],description:"Shape of emission area"}),"circle"===this.emissionShape&&e.exposeProperty("emissionRadius","number",this.emissionRadius,{label:"Emission Radius",min:0,max:200,step:1,description:"Radius for circle emission"}),"rectangle"===this.emissionShape&&e.exposeProperty("emissionWidth","number",this.emissionWidth,{label:"Emission Width",min:10,max:500,step:1,description:"Width for rectangle emission"}).exposeProperty("emissionHeight","number",this.emissionHeight,{label:"Emission Height",min:10,max:500,step:1,description:"Height for rectangle emission"}),e.endGroup().startGroup("Particle Properties",!1,{color:"#E74C3C"}).exposeProperty("particleLifetime","number",this.particleLifetime,{label:"Lifetime",min:.1,max:10,step:.1,description:"How long particles live (seconds)"}).exposeProperty("particleLifetimeVariation","number",this.particleLifetimeVariation,{label:"Lifetime Variation",min:0,max:5,step:.1,description:"Random variation in lifetime"}).exposeProperty("startSize","number",this.startSize,{label:"Start Size",min:1,max:50,step:1,description:"Initial particle size"}).exposeProperty("endSize","number",this.endSize,{label:"End Size",min:0,max:50,step:1,description:"Final particle size"}).exposeProperty("sizeVariation","number",this.sizeVariation,{label:"Size Variation",min:0,max:20,step:1,description:"Random size variation"}).exposeProperty("startColor","color",this.startColor,{label:"Start Color",description:"Initial particle color"}).exposeProperty("endColor","color",this.endColor,{label:"End Color",description:"Final particle color"}).exposeProperty("startAlpha","number",this.startAlpha,{label:"Start Alpha",min:0,max:1,step:.1,description:"Initial particle opacity"}).exposeProperty("endAlpha","number",this.endAlpha,{label:"End Alpha",min:0,max:1,step:.1,description:"Final particle opacity"}).endGroup().startGroup("Movement",!1,{color:"#2ECC71"}).exposeProperty("startVelocityX","number",this.startVelocityX,{label:"Start Velocity X",min:-200,max:200,step:1,description:"Initial X velocity"}).exposeProperty("startVelocityY","number",this.startVelocityY,{label:"Start Velocity Y",min:-200,max:200,step:1,description:"Initial Y velocity"}).exposeProperty("velocityVariationX","number",this.velocityVariationX,{label:"X Velocity Variation",min:0,max:100,step:1,description:"Random X velocity variation"}).exposeProperty("velocityVariationY","number",this.velocityVariationY,{label:"Y Velocity Variation",min:0,max:100,step:1,description:"Random Y velocity variation"}).exposeProperty("gravity","number",this.gravity,{label:"Gravity",min:-500,max:500,step:1,description:"Gravity force applied to particles"}).exposeProperty("drag","number",this.drag,{label:"Drag",min:.9,max:1,step:.01,description:"Air resistance (1.0 = no drag)"}).endGroup().startGroup("Visual",!1,{color:"#9B59B6"}).exposeProperty("particleShape","enum",this.particleShape,{label:"Particle Shape",options:["circle","square","line","image"],description:"Shape of individual particles"}).exposeProperty("blendMode","enum",this.blendMode,{label:"Blend Mode",options:["normal","additive","multiply","screen","overlay"],description:"Particle blend mode"}).exposeProperty("useAlphaGradient","boolean",this.useAlphaGradient,{label:"Use Alpha Gradient",description:"Use alpha mask gradients for particles"}),this.useAlphaGradient&&(e.exposeProperty("gradientType","enum",this.gradientType,{label:"Gradient Type",options:["radial","linear"],description:"Type of alpha gradient"}),"linear"===this.gradientType&&e.exposeProperty("gradientDirection","number",this.gradientDirection,{label:"Gradient Direction",min:0,max:360,step:1,description:"Linear gradient direction (degrees)"})),e.endGroup(),"image"===this.particleShape&&e.startGroup("Image Particles",!1,{color:"#F39C12"}).exposeProperty("imageAsset","asset",this.imageAsset,{label:"Particle Image",description:"Image for particles",assetType:"image",fileTypes:["png","jpg","jpeg","gif","webp"],onAssetSelected:e=>{this.setParticleImage(e)},onDropCallback:this.handleImageDrop.bind(this),showImageDropdown:!0}).exposeProperty("imageScaleMode","enum",this.imageScaleMode,{label:"Scale Mode",options:["stretch","fit","maintain"],description:"How image scales to particle size"}).exposeProperty("imageRotation","number",this.imageRotation,{label:"Image Rotation",min:0,max:360,step:1,description:"Additional image rotation (degrees)"}).exposeProperty("imageFlipX","boolean",this.imageFlipX,{label:"Flip X",description:"Flip image horizontally"}).exposeProperty("imageFlipY","boolean",this.imageFlipY,{label:"Flip Y",description:"Flip image vertically"}).endGroup(),e.startGroup("Performance",!1,{color:"#34495E"}).exposeProperty("useObjectPooling","boolean",this.useObjectPooling,{label:"Object Pooling",description:"Use object pooling for better performance"}).exposeProperty("enableBatching","boolean",this.enableBatching,{label:"Enable Batching",description:"Enable batch rendering for similar particles"}).exposeProperty("maxBatchSize","number",this.maxBatchSize,{label:"Max Batch Size",min:10,max:100,step:5,description:"Maximum particles per batch"}).exposeProperty("cullingEnabled","boolean",this.cullingEnabled,{label:"Culling Enabled",description:"Cull particles outside viewport"}),this.cullingEnabled&&e.exposeProperty("cullingMargin","number",this.cullingMargin,{label:"Culling Margin",min:50,max:500,step:25,description:"Margin for particle culling"}),e.endGroup().startGroup("Control",!1,{color:"#1ABC9C"}).exposeProperty("autoStart","boolean",this.autoStart,{label:"Auto Start",description:"Start emitting automatically"}).exposeProperty("loopEmitter","boolean",this.loopEmitter,{label:"Loop Emitter",description:"Loop the particle system"}),this.loopEmitter||e.exposeProperty("duration","number",this.duration,{label:"Duration",min:.1,max:60,step:.1,description:"Duration for non-looping systems"}),e.endGroup()}refreshInspector(){setTimeout(()=>{window.editor&&window.editor.inspector&&window.editor.inspector.refreshModuleUI(this)},10)}async handleImageDrop(e){try{if(e.files&&e.files.length>0){const t=e.files[0];if(!t.type.startsWith("image/"))return console.warn("Dropped file is not an image:",t.type),!1;const i=window.editor?.fileBrowser||window.fileBrowser;if(!i)return console.warn("FileBrowser not available for image upload"),!1;await i.handleFileUpload(t);const s=`${i.currentPath}/${t.name}`;return await this.setParticleImage(s),console.log("Successfully set particle image to:",s),!0}const t=e.getData("application/json");if(t)try{const e=JSON.parse(t);if(e&&e.length>0){const t=e[0].path;if(t&&this.isImagePath(t))return await this.setParticleImage(t),console.log("Successfully set particle image to:",t),!0}}catch(e){console.error("Error parsing drag JSON data:",e)}return!1}catch(e){return console.error("Error handling image drop:",e),!1}}isImagePath(e){if(!e)return!1;const t=e.toLowerCase();return[".png",".jpg",".jpeg",".gif",".webp",".svg"].some(e=>t.endsWith(e))}async setParticleImage(e){if(console.log("setParticleImage called with path:",e),null==e)return this.imageAsset=null,this._image=null,void(this._isImageLoaded=!1);if(this.imageAsset&&this.imageAsset.path===e)console.log("Particle image path unchanged, skipping");else try{window.AssetReference?this.imageAsset=new window.AssetReference(e,"image"):this.imageAsset={path:e,type:"image",embedded:!1,load:()=>window.assetManager?window.assetManager.getAssetByPath(e):this.fallbackLoadImage(e)},console.log("Created imageAsset:",this.imageAsset);const t=await this.loadImage();t?console.log("Particle image loaded successfully:",t.src||"data URL"):console.warn("Failed to load particle image"),window.editor&&window.editor.refreshCanvas()}catch(e){console.error("Error setting particle image:",e)}}async loadImage(){if(this.imageAsset&&this.imageAsset.embedded&&!this.imageAsset.path)return console.log("Skipping path-based loading for embedded image data - already loaded"),this._image;if(!this.imageAsset||!this.imageAsset.path&&!this.imageAsset.embedded)return this._isImageLoaded||this.imageAsset&&this.imageAsset.embedded||console.warn("No particle image asset path to load"),null;try{if(console.log("Loading particle image:",this.imageAsset.path),this.imageAsset.path){const e=await this.loadFromAssetManager(this.imageAsset.path);if(e)return e}if(window.editor&&window.editor.fileBrowser&&this.imageAsset.path)try{const e=await this.loadImageFromFileBrowser(this.imageAsset.path);if(e)return console.log("Particle image loaded via FileBrowser successfully"),this._image=e,this._imageWidth=e.naturalWidth||e.width,this._imageHeight=e.naturalHeight||e.height,this._isImageLoaded=!0,e}catch(e){console.warn("FileBrowser loading failed, trying fallback:",e)}if(this.imageAsset.embedded&&"function"==typeof this.imageAsset.load){console.log("Loading embedded particle image data");const e=await this.imageAsset.load();if(e)return this._image=e,this._imageWidth=e.naturalWidth||e.width,this._imageHeight=e.naturalHeight||e.height,this._isImageLoaded=!0,e}return this.imageAsset.path?await this.fallbackLoadImage(this.imageAsset.path):null}catch(e){return console.error("Error loading particle image:",e),this._image=null,this._isImageLoaded=!1,null}}async loadFromAssetManager(e){if(!e)return null;try{if(window.assetManager){const t=await window.assetManager.getAssetByPath(e);if(t&&t instanceof HTMLImageElement)return this._image=t,this._imageWidth=t.naturalWidth||t.width,this._imageHeight=t.naturalHeight||t.height,this._isImageLoaded=!0,console.log("Particle image loaded from AssetManager:",e),t}return await this.fallbackLoadImage(e)}catch(e){return console.error("Error loading particle image from AssetManager:",e),null}}async forceReloadImage(){if(console.log("Force reloading particle image..."),this._image=null,this._isImageLoaded=!1,this._imageWidth=0,this._imageHeight=0,this.imageAsset&&this.imageAsset.path)try{await this.loadImage()&&(console.log("Force reload successful"),window.editor&&window.editor.refreshCanvas())}catch(e){console.error("Force reload failed:",e)}}async loadImageFromFileBrowser(e){try{const t=window.editor.fileBrowser,i=await t.readFile(e);if(!i)throw Error("Could not read file from FileBrowser: "+e);if(console.log("Loading particle image from FileBrowser:",e),"string"==typeof i&&i.startsWith("data:image"))return console.log("Loading particle image from data URL via FileBrowser"),this.loadImageFromDataURL(i);if("string"!=typeof i||i.startsWith("data:")){if(i instanceof Blob||i instanceof ArrayBuffer){let t=i;i instanceof ArrayBuffer&&(t=new Blob([i],{type:"image/"+e.split(".").pop().toLowerCase()}));const s=await this.blobToDataURL(t);return this.loadImageFromDataURL(s)}throw Error("File content is not a valid image data URL: "+e)}try{const t=e.split(".").pop().toLowerCase();let s="image/png";"jpg"===t||"jpeg"===t?s="image/jpeg":"gif"===t?s="image/gif":"webp"===t?s="image/webp":"svg"===t&&(s="image/svg+xml");const o=i.startsWith("data:")?i:`data:${s};base64,${i}`;return console.log("Loading particle image from constructed data URL"),this.loadImageFromDataURL(o)}catch(e){throw console.error("Failed to construct data URL for particle image:",e),e}}catch(e){throw console.error("Error loading particle image from FileBrowser:",e),e}}async blobToDataURL(e){return new Promise((t,i)=>{const s=new FileReader;s.onload=()=>t(s.result),s.onerror=i,s.readAsDataURL(e)})}fallbackLoadImage(e){return new Promise((t,i)=>{if(!e)return void i(Error("No image path provided"));const s=new Image;if(window.assetManager&&window.assetManager.cache){const o=window.assetManager.normalizePath?window.assetManager.normalizePath(e):e.replace(/^\/+/,"").replace(/\\/g,"/");console.log("Looking for cached particle asset:",o),console.log("Available cached assets:",Object.keys(window.assetManager.cache));const n=[e,o,e.replace(/^[\/\\]+/,""),e.replace(/\\/g,"/"),e.split("/").pop(),e.split("\\").pop(),decodeURIComponent(e),"/"+e.replace(/^[\/\\]+/,""),"/"+o];let r=null,a=null;for(const e of n)if(window.assetManager.cache[e]){r=window.assetManager.cache[e],a=e,console.log("Found cached particle asset with path variation:",a);break}if(r){if(r instanceof HTMLImageElement)return console.log("Using cached HTMLImageElement for particle"),this._image=r,this._imageWidth=r.naturalWidth||r.width,this._imageHeight=r.naturalHeight||r.height,this._isImageLoaded=!0,void t(r);if("string"==typeof r&&r.startsWith("data:"))console.log("Loading cached data URL for particle"),s.src=r;else{if(!r.content||"string"!=typeof r.content||!r.content.startsWith("data:"))return console.error("Cached particle asset is not a valid image format:",typeof r,r),void i(Error(`Cached asset for ${e} is not a valid image`));console.log("Loading cached asset content as data URL for particle"),s.src=r.content}}else{if("file:"===window.location.protocol||!window.fileBrowser){const t=`Particle image not found in asset cache: ${e}. This is likely an export issue. Available assets: ${Object.keys(window.assetManager.cache).join(", ")}`;return console.error(t),void i(Error(t))}console.warn("Particle asset not in cache, trying direct load for development mode"),s.src=e}}else console.warn("No asset manager or cache available for particle image"),s.src=e;s.onload=()=>{console.log("Particle image loaded successfully:",s.src.substring?s.src.substring(0,100)+"...":"Image loaded"),this._image=s,this._imageWidth=s.naturalWidth||s.width,this._imageHeight=s.naturalHeight||s.height,this._isImageLoaded=!0,t(s)},s.onerror=t=>{console.error("Error loading particle image:",e,t),i(Error("Failed to load particle image: "+e))}})}loadImageFromDataURL(e){return new Promise((t,i)=>{const s=new Image;s.onload=()=>{console.log("Particle image loaded from data URL successfully"),this._image=s,this._imageWidth=s.naturalWidth||s.width,this._imageHeight=s.naturalHeight||s.height,this._isImageLoaded=!0,t(s)},s.onerror=e=>{console.error("Error loading particle image from data URL:",e),i(Error("Failed to load particle image from data URL"))},s.src=e})}async loadImageFromData(e){return new Promise((t,i)=>{if(!e||"string"!=typeof e)return void i(Error("Invalid data URL provided"));const s=new Image;s.onload=()=>{0!==s.naturalWidth&&0!==s.naturalHeight?(this._image=s,this._imageWidth=s.naturalWidth,this._imageHeight=s.naturalHeight,this._isImageLoaded=!0,console.log("Particle image loaded from data URL, dimensions:",this._imageWidth,"x",this._imageHeight),window.editor&&window.editor.refreshCanvas(),t(s)):i(Error("Image loaded but has invalid dimensions"))},s.onerror=e=>{console.error("Failed to load particle image from data URL:",e),this._image=null,this._isImageLoaded=!1,i(Error("Failed to load image from data URL"))},setTimeout(()=>{this._isImageLoaded||i(Error("Image loading timeout"))},1e4),s.src=e})}start(){this.autoStart&&this.startEmission(),this.useImageParticles&&!this._isImageLoaded&&this.loadImage()}startEmission(){this.isEmitting=!0,this.systemTimer=0,this.emissionTimer=0}stopEmission(){this.isEmitting=!1,this.emissionTimer=0}clearParticles(){this.useObjectPooling&&this.particlePool.push(...this.particles),this.particles=[]}loop(e){const t=performance.now();if(this.systemTimer+=e,this.loopEmitter||this.systemTimer<this.duration||(this.isEmitting=!1,this.systemTimer=0),this.loopEmitter&&this.systemTimer>=this.duration&&(this.systemTimer=0),this.isEmitting){const t=e*this.emissionRate;for(this.emissionTimer+=t;this.emissionTimer>=1&&this.particles.length<this.maxParticles;)this.emitParticle(),this.emissionTimer=0,this.systemTimer=0;this.particles.length<this.maxParticles||(this.emissionTimer=0,this.systemTimer=0)}else this.emissionTimer=0,this.systemTimer=0;this.updateParticles(e),this.cullingEnabled&&performance.now()-this.lastCullTime>this.cullInterval&&(this.cullParticles(),this.lastCullTime=performance.now()),this.enableBatching&&this.prepareBatchedParticles();const i=performance.now()-t;i>5&&console.warn(`ParticleSystem: Slow frame detected: ${i.toFixed(2)}ms with ${this.particles.length} particles`)}updateParticles(e){for(let t=this.particles.length-1;t>=0;t--){const i=this.particles[t];if(this.updateParticle(i,e),0>=i.life){const e=this.particles.splice(t,1)[0];this.useObjectPooling&&(this.resetParticle(e),this.particlePool.push(e))}}}cullParticles(){if(!window.engine||!window.engine.viewport)return;const e=window.engine.viewport,t=this.cullingMargin,i=e.x-e.width/2-t,s=e.x+e.width/2+t,o=e.y-e.height/2-t,n=e.y+e.height/2+t;for(let e=this.particles.length-1;e>=0;e--){const t=this.particles[e];if(t.x<i||t.x>s||t.y<o||t.y>n){const t=this.particles.splice(e,1)[0];this.useObjectPooling&&(this.resetParticle(t),this.particlePool.push(t))}}}prepareBatchedParticles(){this.batchedParticles.clear();for(const e of this.particles){const t=this.getBatchKey(e);this.batchedParticles.has(t)||this.batchedParticles.set(t,[]);const i=this.batchedParticles.get(t);i.length<this.maxBatchSize&&i.push(e)}}getBatchKey(e){const t=e.life/e.maxLife,i=Math.floor(10*t);return`${this.particleShape}_${i}_${Math.floor(e.size/5)}`}emitParticle(){let e;switch(this.useObjectPooling&&this.particlePool.length>0?(e=this.particlePool.pop(),this.resetParticle(e)):e=this.createParticle(),this.emissionShape){case"circle":const t=Math.random()*Math.PI*2,i=Math.random()*this.emissionRadius;e.x=Math.cos(t)*i,e.y=Math.sin(t)*i;break;case"rectangle":e.x=(Math.random()-.5)*this.emissionWidth,e.y=(Math.random()-.5)*this.emissionHeight;break;default:e.x=0,e.y=0}this.particles.push(e)}createParticle(){return{x:0,y:0,vx:this.startVelocityX+(Math.random()-.5)*this.velocityVariationX,vy:this.startVelocityY+(Math.random()-.5)*this.velocityVariationY,life:this.particleLifetime+(Math.random()-.5)*this.particleLifetimeVariation,maxLife:this.particleLifetime+(Math.random()-.5)*this.particleLifetimeVariation,size:this.startSize+(Math.random()-.5)*this.sizeVariation,rotation:Math.random()*Math.PI*2,rotationSpeed:5*(Math.random()-.5),initialSize:this.startSize+(Math.random()-.5)*this.sizeVariation,targetSize:this.endSize,birthTime:performance.now()}}resetParticle(e){e.x=0,e.y=0,e.vx=this.startVelocityX+(Math.random()-.5)*this.velocityVariationX,e.vy=this.startVelocityY+(Math.random()-.5)*this.velocityVariationY,e.life=this.particleLifetime+(Math.random()-.5)*this.particleLifetimeVariation,e.maxLife=e.life,e.size=this.startSize+(Math.random()-.5)*this.sizeVariation,e.rotation=Math.random()*Math.PI*2,e.rotationSpeed=5*(Math.random()-.5),e.initialSize=e.size,e.targetSize=this.endSize,e.birthTime=performance.now()}updateParticle(e,t){if(e.life-=t,0!==this.gravity){const i=(this.gameObject?.angle||0)*Math.PI/180,s=Math.sin(i)*this.gravity*t,o=Math.cos(i)*this.gravity*t;e.vx+=s,e.vy+=o}e.vx*=this.drag,e.vy*=this.drag,e.x+=e.vx*t,e.y+=e.vy*t,e.rotation+=e.rotationSpeed*t;const i=e.life/e.maxLife,s=1-i;e.size=e.initialSize*i+e.targetSize*s}draw(e){this.enabled&&0!==this.particles.length&&(e&&"function"==typeof e.save?(e.save(),this.setBlendMode(e),this.enableBatching?this.drawBatchedParticles(e):this.drawIndividualParticles(e),e.restore()):console.warn("Invalid canvas context provided to ParticleSystem.draw"))}setBlendMode(e){switch(this.blendMode){case"additive":e.globalCompositeOperation="lighter";break;case"multiply":e.globalCompositeOperation="multiply";break;case"screen":e.globalCompositeOperation="screen";break;case"overlay":e.globalCompositeOperation="overlay";break;default:e.globalCompositeOperation="source-over"}}drawBatchedParticles(e){for(const[t,i]of this.batchedParticles)if(0!==i.length){this.setBatchProperties(e,i[0]);for(const t of i)this.drawSingleParticle(e,t)}}drawIndividualParticles(e){for(const t of this.particles)this.drawParticle(e,t)}setBatchProperties(e,t){const i=t.life/t.maxLife,s=1-i,o=this.startAlpha*i+this.endAlpha*s;if(e.globalAlpha=o,"image"!==this.particleShape){const t=this.hexToRgb(this.startColor),o=this.hexToRgb(this.endColor),n=`rgb(${Math.round(t.r*i+o.r*s)}, ${Math.round(t.g*i+o.g*s)}, ${Math.round(t.b*i+o.b*s)})`;e.fillStyle=n,e.strokeStyle=n}}drawParticle(e,t){const i=t.life/t.maxLife,s=1-i,o=t.size,n=this.hexToRgb(this.startColor),r=this.hexToRgb(this.endColor),a=Math.round(n.r*i+r.r*s),l=Math.round(n.g*i+r.g*s),h=Math.round(n.b*i+r.b*s),c=this.startAlpha*i+this.endAlpha*s;e.save(),e.translate(t.x,t.y),e.rotate(t.rotation),e.globalAlpha=c,"image"===this.particleShape&&this.useImageParticles?this.drawImageParticle(e,t,o):this.drawShapeParticle(e,t,o,a,l,h),e.restore()}drawSingleParticle(e,t){e.save(),e.translate(t.x,t.y),e.rotate(t.rotation),"image"===this.particleShape&&this.useImageParticles?this.drawImageParticle(e,t,t.size):this.drawShapeParticleWithCurrentStyle(e,t,t.size),e.restore()}drawImageParticle(e,t,i){if(!(this._image&&this._isImageLoaded&&this._image instanceof HTMLImageElement&&this._image.complete&&0!==this._image.naturalWidth))return void this.drawFallbackParticle(e,i);let s,o;switch(e.save(),(this.imageFlipX||this.imageFlipY)&&e.scale(this.imageFlipX?-1:1,this.imageFlipY?-1:1),0!==this.imageRotation&&e.rotate(this.imageRotation*Math.PI/180),this.imageScaleMode){case"fit":const e=this._imageWidth/this._imageHeight;e>1?(s=i,o=i/e):(s=i*e,o=i);break;case"maintain":s=this._imageWidth,o=this._imageHeight;break;default:s=i,o=i}this.useAlphaGradient&&this.applyAlphaGradient(e,s,o);try{e.drawImage(this._image,-s/2,-o/2,s,o)}catch(t){console.warn("Error drawing particle image, falling back to shape:",t),this.drawFallbackParticle(e,i)}e.restore()}drawShapeParticle(e,t,i,s,o,n){const r=`rgb(${s}, ${o}, ${n})`;e.fillStyle=r,e.strokeStyle=r,this.useAlphaGradient?this.drawShapeWithAlphaGradient(e,i,r):this.drawBasicShape(e,i)}drawShapeParticleWithCurrentStyle(e,t,i){this.useAlphaGradient?this.drawShapeWithAlphaGradient(e,i,e.fillStyle):this.drawBasicShape(e,i)}drawBasicShape(e,t){switch(this.particleShape){case"circle":e.beginPath(),e.arc(0,0,t/2,0,2*Math.PI),e.fill();break;case"square":e.fillRect(-t/2,-t/2,t,t);break;case"line":e.lineWidth=Math.max(1,t/4),e.beginPath(),e.moveTo(-t/2,0),e.lineTo(t/2,0),e.stroke()}}drawShapeWithAlphaGradient(e,t,i){let s;if("radial"===this.gradientType)s=e.createRadialGradient(0,0,0,0,0,t/2),s.addColorStop(0,i),s.addColorStop(.7,i.replace("rgb","rgba").replace(")",", 0.5)")),s.addColorStop(1,i.replace("rgb","rgba").replace(")",", 0)"));else{const o=this.gradientDirection*Math.PI/180,n=t/2,r=Math.cos(o+Math.PI)*n,a=Math.sin(o+Math.PI)*n,l=Math.cos(o)*n,h=Math.sin(o)*n;s=e.createLinearGradient(r,a,l,h),s.addColorStop(0,i.replace("rgb","rgba").replace(")",", 0)")),s.addColorStop(.3,i.replace("rgb","rgba").replace(")",", 0.5)")),s.addColorStop(.7,i),s.addColorStop(1,i.replace("rgb","rgba").replace(")",", 0)"))}switch(e.fillStyle=s,this.particleShape){case"circle":e.beginPath(),e.arc(0,0,t/2,0,2*Math.PI),e.fill();break;case"square":e.fillRect(-t/2,-t/2,t,t);break;case"line":e.lineWidth=Math.max(1,t/4),e.strokeStyle=s,e.beginPath(),e.moveTo(-t/2,0),e.lineTo(t/2,0),e.stroke()}}applyAlphaGradient(e,t,i){let s;if("radial"===this.gradientType){const o=Math.max(t,i)/2;s=e.createRadialGradient(0,0,0,0,0,o),s.addColorStop(0,"rgba(255, 255, 255, 1)"),s.addColorStop(.7,"rgba(255, 255, 255, 0.5)"),s.addColorStop(1,"rgba(255, 255, 255, 0)")}else{const o=this.gradientDirection*Math.PI/180,n=t/2,r=i/2,a=Math.cos(o+Math.PI)*n,l=Math.sin(o+Math.PI)*r,h=Math.cos(o)*n,c=Math.sin(o)*r;s=e.createLinearGradient(a,l,h,c),s.addColorStop(0,"rgba(255, 255, 255, 0)"),s.addColorStop(.3,"rgba(255, 255, 255, 0.5)"),s.addColorStop(.7,"rgba(255, 255, 255, 1)"),s.addColorStop(1,"rgba(255, 255, 255, 0)")}e.save(),e.globalCompositeOperation="destination-in",e.fillStyle=s,e.fillRect(-t/2,-i/2,t,i),e.restore()}drawFallbackParticle(e,t){const i=this.hexToRgb(this.startColor),s=(this.hexToRgb(this.endColor),Math.round(i.r)),o=Math.round(i.g),n=Math.round(i.b);e.fillStyle=`rgb(${s}, ${o}, ${n})`,e.beginPath(),e.arc(0,0,t/2,0,2*Math.PI),e.fill()}hexToRgb(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:255,g:255,b:255}}burst(e=10){for(let t=0;e>t&&this.particles.length<this.maxParticles;t++)this.emitParticle()}getParticleCount(){return this.particles.length}getPoolSize(){return this.particlePool.length}clone(e=null){const t=super.clone(e);if(this._image&&this._isImageLoaded)if(t._image=this._image,t._isImageLoaded=!0,t._imageWidth=this._imageWidth,t._imageHeight=this._imageHeight,this.imageAsset&&this.imageAsset.embedded){const e=this._image.src;t.imageAsset={path:null,type:"image",embedded:!0,load:()=>Promise.resolve(t._image)},t._image.src=e}else this.imageAsset&&(t.imageAsset={...this.imageAsset});else this.imageAsset&&(t.imageAsset={...this.imageAsset});return t}toJSON(){const e=super.toJSON();return e.emissionRate=this.emissionRate,e.maxParticles=this.maxParticles,e.emissionShape=this.emissionShape,e.emissionRadius=this.emissionRadius,e.emissionWidth=this.emissionWidth,e.emissionHeight=this.emissionHeight,e.particleLifetime=this.particleLifetime,e.particleLifetimeVariation=this.particleLifetimeVariation,e.startSize=this.startSize,e.endSize=this.endSize,e.sizeVariation=this.sizeVariation,e.startColor=this.startColor,e.endColor=this.endColor,e.startAlpha=this.startAlpha,e.endAlpha=this.endAlpha,e.startVelocityX=this.startVelocityX,e.startVelocityY=this.startVelocityY,e.velocityVariationX=this.velocityVariationX,e.velocityVariationY=this.velocityVariationY,e.gravity=this.gravity,e.drag=this.drag,e.particleShape=this.particleShape,e.blendMode=this.blendMode,e.useAlphaGradient=this.useAlphaGradient,e.gradientType=this.gradientType,e.gradientDirection=this.gradientDirection,e.useImageParticles=this.useImageParticles,e.imageAsset=this.imageAsset?{path:this.imageAsset.path,type:"image",embedded:this.imageAsset.embedded||!1}:null,e.imageScaleMode=this.imageScaleMode,e.imageRotation=this.imageRotation,e.imageFlipX=this.imageFlipX,e.imageFlipY=this.imageFlipY,e.autoStart=this.autoStart,e.loopEmitter=this.loopEmitter,e.duration=this.duration,e.useObjectPooling=this.useObjectPooling,e.enableBatching=this.enableBatching,e.cullingEnabled=this.cullingEnabled,e}fromJSON(e){if(super.fromJSON(e),e)if(void 0!==e.emissionRate&&(this.emissionRate=e.emissionRate),void 0!==e.maxParticles&&(this.maxParticles=e.maxParticles),void 0!==e.emissionShape&&(this.emissionShape=e.emissionShape),void 0!==e.emissionRadius&&(this.emissionRadius=e.emissionRadius),void 0!==e.emissionWidth&&(this.emissionWidth=e.emissionWidth),void 0!==e.emissionHeight&&(this.emissionHeight=e.emissionHeight),void 0!==e.particleLifetime&&(this.particleLifetime=e.particleLifetime),void 0!==e.particleLifetimeVariation&&(this.particleLifetimeVariation=e.particleLifetimeVariation),void 0!==e.startSize&&(this.startSize=e.startSize),void 0!==e.endSize&&(this.endSize=e.endSize),void 0!==e.sizeVariation&&(this.sizeVariation=e.sizeVariation),void 0!==e.startColor&&(this.startColor=e.startColor),void 0!==e.endColor&&(this.endColor=e.endColor),void 0!==e.startAlpha&&(this.startAlpha=e.startAlpha),void 0!==e.endAlpha&&(this.endAlpha=e.endAlpha),void 0!==e.startVelocityX&&(this.startVelocityX=e.startVelocityX),void 0!==e.startVelocityY&&(this.startVelocityY=e.startVelocityY),void 0!==e.velocityVariationX&&(this.velocityVariationX=e.velocityVariationX),void 0!==e.velocityVariationY&&(this.velocityVariationY=e.velocityVariationY),void 0!==e.gravity&&(this.gravity=e.gravity),void 0!==e.drag&&(this.drag=e.drag),void 0!==e.particleShape&&(this.particleShape=e.particleShape,this.useImageParticles="image"===e.particleShape),void 0!==e.blendMode&&(this.blendMode=e.blendMode),void 0!==e.useAlphaGradient&&(this.useAlphaGradient=e.useAlphaGradient),void 0!==e.gradientType&&(this.gradientType=e.gradientType),void 0!==e.gradientDirection&&(this.gradientDirection=e.gradientDirection),void 0!==e.useImageParticles&&(this.useImageParticles=e.useImageParticles),void 0!==e.imageScaleMode&&(this.imageScaleMode=e.imageScaleMode),void 0!==e.imageRotation&&(this.imageRotation=e.imageRotation),void 0!==e.imageFlipX&&(this.imageFlipX=e.imageFlipX),void 0!==e.imageFlipY&&(this.imageFlipY=e.imageFlipY),void 0!==e.autoStart&&(this.autoStart=e.autoStart),void 0!==e.loopEmitter&&(this.loopEmitter=e.loopEmitter),void 0!==e.duration&&(this.duration=e.duration),void 0!==e.useObjectPooling&&(this.useObjectPooling=e.useObjectPooling),void 0!==e.enableBatching&&(this.enableBatching=e.enableBatching),void 0!==e.cullingEnabled&&(this.cullingEnabled=e.cullingEnabled),e.imageAsset&&e.imageAsset.path){console.log("Loading particle image from AssetManager:",e.imageAsset.path);try{window.AssetReference?this.imageAsset=new window.AssetReference(e.imageAsset.path,"image"):this.imageAsset={path:e.imageAsset.path,type:"image",embedded:e.imageAsset.embedded||!1,load:()=>window.assetManager?window.assetManager.getAssetByPath(e.imageAsset.path):this.loadFromAssetManager(e.imageAsset.path)},this.loadFromAssetManager(e.imageAsset.path)}catch(e){console.error("Error restoring particle image asset:",e)}}else this.imageAsset={path:null,type:"image",load:()=>Promise.resolve(null)},this._image=null,this._isImageLoaded=!1}}window.ParticleSystem=ParticleSystem;class RigidBodyDragger extends Module{static allowMultiple=!1;static namespace="Matter.js";static description="Allows dragging RigidBody objects with mouse and touch input for Matter.js";constructor(){super("RigidBodyDragger"),this.isDragging=!1,this.dragOffset=new Vector2(0,0),this.lastMousePos=new Vector2(0,0),this.dragStartPos=new Vector2(0,0),this.originalBodyType=null,this.touchId=null,this.enabled=!0,this.dragButton="left",this.maintainVelocity=!1,this.damping=.95,this.force=.1,this.maxDistance=null,this.constrainToArea=null,this.showDragIndicator=!0,this.dragIndicatorColor="#00ff00",this.dragIndicatorAlpha=.5,this.rigidBody=null,this.originalPosition=null,this.originalGravityEnabled=!0,this.require("RigidBody"),this.exposeProperty("enabled","boolean",this.enabled,{onChange:e=>{this.setEnabled(e)}}),this.exposeProperty("dragButton","enum",this.dragButton,{options:["left","middle","right"],onChange:e=>{this.dragButton=e}}),this.exposeProperty("maintainVelocity","boolean",this.maintainVelocity,{onChange:e=>{this.maintainVelocity=e}}),this.exposeProperty("damping","number",this.damping,{min:.01,max:1,step:.01,onChange:e=>{this.damping=e}}),this.exposeProperty("force","number",this.force,{min:.001,max:1,step:.001,onChange:e=>{this.force=e}}),this.exposeProperty("showDragIndicator","boolean",this.showDragIndicator)}start(){if(this.rigidBody=this.gameObject.getModule("RigidBody"),this.rigidBody&&this.gameObject){const e=this.gameObject.getWorldPosition();this.originalPosition=new Vector2(e.x,e.y)}}loop(){(this.rigidBody||(this.rigidBody=this.gameObject.getModule("RigidBody"),this.rigidBody))&&(this.handleMouseInput(),this.handleTouchInput(),this.updateDragging())}handleMouseInput(){if(!window.input)return;const e=window.input.getMousePosition(!0),t={left:0,middle:1,right:2}[this.dragButton]??0,i=window.input.mousePressed(t),s=window.input.mouseDown(t),o=window.input.mouseReleased(t),n=(window.input.getDebugState(),window.input.mouseButtonsDown.left),r=window.input.mouseButtons.left,a=window.input.mouseButtonsUp.left,l=(i||n||!this.isDragging&&(s||r))&&!this.isDragging&&this.enabled,h=this.isDragging&&(o||a||!(s||r));l&&this.isPointOverObject(e)&&this.startDragging(e),h&&this.stopDragging(),this.isDragging&&null===this.touchId&&(this.lastMousePos=e)}handleTouchInput(){if(!window.input)return;const e=window.input.getTouches(),t=window.input.touchesStarted,i=window.input.touchesEnded;if(!this.isDragging)for(const e in t){const i=t[e];if(this.isPointOverObject(i.position)){this.touchId=e,this.startDragging(i.position);break}}this.isDragging&&null!==this.touchId&&e[this.touchId]&&(this.lastMousePos=e[this.touchId].position),this.isDragging&&null!==this.touchId&&i[this.touchId]&&this.stopDragging()}isPointOverObject(e){if(!this.rigidBody||!this.rigidBody.body)return!1;const t=this.rigidBody.body;if("undefined"==typeof Matter)return!1;const i=t.bounds,s=!(e.x<i.min.x||e.x>i.max.x||e.y<i.min.y||e.y>i.max.y);window.physicsManager?.world?.bodies?.includes(t);try{const i=Matter.Query.point([t],{x:e.x,y:e.y});return!!(window.physicsManager&&window.physicsManager.world&&Matter.Query.point(window.physicsManager.world.bodies,{x:e.x,y:e.y}).find(e=>e.id===t.id))||i.length>0}catch(e){return s}}startDragging(e){if(!this.rigidBody||!this.rigidBody.body)return;this.isDragging=!0,this.dragStartPos=e.clone(),this.lastMousePos=e.clone();const t=this.rigidBody.body.position;this.dragOffset=new Vector2(e.x-t.x,e.y-t.y),this.originalBodyType=this.rigidBody.bodyType,"dynamic"===this.originalBodyType&&(this.rigidBody.bodyType="static",this.originalGravityEnabled=this.rigidBody.useGravity,this.rigidBody.useGravity=!1),this.gameObject.onDragStart&&this.gameObject.onDragStart()}stopDragging(){if(this.isDragging){if(this.isDragging=!1,this.touchId=null,this.rigidBody&&this.rigidBody.body&&this.originalBodyType&&"dynamic"===this.originalBodyType){if(this.rigidBody.bodyType="dynamic",this.rigidBody.useGravity=this.originalGravityEnabled,"circle"===this.rigidBody.shape){const e=this.rigidBody.body.mass,t=this.rigidBody.radius;this.rigidBody.body.inertia=e*t*t}else{const e=this.rigidBody.body.vertices,t=this.rigidBody.body.position;let i=0;for(let s=0;s<e.length;s++){const o=e[s],n=o.x-t.x,r=o.y-t.y;i+=n*n+r*r}this.rigidBody.body.inertia=this.rigidBody.body.mass*(i/e.length)}if(this.rigidBody.body.inverseInertia=1/this.rigidBody.body.inertia,this.maintainVelocity&&this.lastMousePos&&this.dragStartPos){const e=new Vector2(.1*(this.lastMousePos.x-this.dragStartPos.x),.1*(this.lastMousePos.y-this.dragStartPos.y));Matter.Body.setVelocity(this.rigidBody.body,e)}}this.gameObject.onDragEnd&&this.gameObject.onDragEnd()}}updateDragging(){if(!this.isDragging||!this.rigidBody||!this.rigidBody.body)return;const e=new Vector2(this.lastMousePos.x-this.dragOffset.x,this.lastMousePos.y-this.dragOffset.y);if(this.maxDistance&&this.originalPosition&&e.distanceTo(this.originalPosition)>this.maxDistance){const t=e.subtract(this.originalPosition).normalize();e.x=this.originalPosition.x+t.x*this.maxDistance,e.y=this.originalPosition.y+t.y*this.maxDistance}if(this.constrainToArea){const t=this.constrainToArea;e.x=Math.max(t.x,Math.min(t.x+t.width,e.x)),e.y=Math.max(t.y,Math.min(t.y+t.height,e.y))}Matter.Body.setPosition(this.rigidBody.body,{x:e.x,y:e.y}),this.gameObject.onDragUpdate&&this.gameObject.onDragUpdate(e)}render(e){if(this.showDragIndicator&&this.isDragging&&this.rigidBody){if(e.save(),e.globalAlpha=this.dragIndicatorAlpha,e.strokeStyle=this.dragIndicatorColor,e.lineWidth=2,this.dragStartPos&&this.lastMousePos&&(e.beginPath(),e.moveTo(this.dragStartPos.x,this.dragStartPos.y),e.lineTo(this.lastMousePos.x,this.lastMousePos.y),e.stroke()),this.rigidBody.body){const t=this.rigidBody.body.position,i=Math.max(this.rigidBody.width||50,this.rigidBody.height||50)/2+10;e.beginPath(),e.arc(t.x,t.y,i,0,2*Math.PI),e.stroke()}e.restore()}}setMaxDistance(e){this.maxDistance=e}setConstraintArea(e){this.constrainToArea=e}getIsDragging(){return this.isDragging}getDragPosition(){return this.isDragging?this.lastMousePos.clone():null}forceStopDragging(){this.isDragging&&this.stopDragging()}setEnabled(e){this.enabled=e,!e&&this.isDragging&&this.forceStopDragging()}onDestroy(){this.isDragging&&this.stopDragging()}toJSON(){return{...super.toJSON(),enabled:this.enabled,dragButton:this.dragButton,maintainVelocity:this.maintainVelocity,damping:this.damping,force:this.force,maxDistance:this.maxDistance,constrainToArea:this.constrainToArea,showDragIndicator:this.showDragIndicator,dragIndicatorColor:this.dragIndicatorColor,dragIndicatorAlpha:this.dragIndicatorAlpha}}fromJSON(e){super.fromJSON(e),this.enabled=e.enabled??this.enabled,this.dragButton=e.dragButton??this.dragButton,this.maintainVelocity=e.maintainVelocity??this.maintainVelocity,this.damping=e.damping??this.damping,this.force=e.force??this.force,this.maxDistance=e.maxDistance??this.maxDistance,this.constrainToArea=e.constrainToArea??this.constrainToArea,this.showDragIndicator=e.showDragIndicator??this.showDragIndicator,this.dragIndicatorColor=e.dragIndicatorColor??this.dragIndicatorColor,this.dragIndicatorAlpha=e.dragIndicatorAlpha??this.dragIndicatorAlpha}}window.RigidBodyDragger=RigidBodyDragger;class Joint extends Module{static allowMultiple=!0;static namespace="Matter.js";static description="Physics component that creates constraints/joints between GameObjects for Matter.js";constructor(){super("Joint"),this.ignoreGameObjectTransform=!0,this.constraint=null,this.jointType="distance",this.targetObjectName="",this.targetObject=null,this.pointA={x:0,y:0},this.pointB={x:0,y:0},this.length=100,this.stiffness=.8,this.damping=.1,this.strength=1,this.enableLimits=!1,this.minLength=50,this.maxLength=200,this.enableMotor=!1,this.motorSpeed=0,this.maxMotorTorque=1e3,this.axis={x:1,y:0},this.showDebug=!1,this.debugColor="#ff0000",this.lineAlpha=1,this.lineThickness=2,this.springCoils=8,this.isConnected=!1,this.autoConnect=!0,this._skipRebuild=!0,this.requireModule("RigidBody"),this.exposeProperty("jointType","enum",this.jointType,{options:["distance","spring","revolute","prismatic","weld","mouse"],onChange:e=>{this.jointType=e,this._skipRebuild||this.rebuildConstraint()}}),this.exposeProperty("targetObjectName","string",this.targetObjectName,{onChange:e=>{this.targetObjectName=e,this._skipRebuild||this.findAndConnectTarget()}}),this.exposeProperty("pointA","vector2",this.pointA,{onChange:e=>{this.pointA=e,this._skipRebuild||this.updateConstraintPoints()}}),this.exposeProperty("pointB","vector2",this.pointB,{onChange:e=>{this.pointB=e,this._skipRebuild||this.updateConstraintPoints()}}),this.exposeProperty("length","number",this.length,{min:0,onChange:e=>{this.length=e,this.constraint&&(this.constraint.length=e)}}),this.exposeProperty("stiffness","number",this.stiffness,{min:0,max:1,step:.01,onChange:e=>{this.stiffness=e,this.constraint&&(this.constraint.stiffness=e)}}),this.exposeProperty("damping","number",this.damping,{min:0,max:1,step:.01,onChange:e=>{this.damping=e,this.constraint&&(this.constraint.damping=e)}}),this.exposeProperty("strength","number",this.strength,{min:0,max:1,step:.01,onChange:e=>{this.strength=e,this.constraint&&(this.constraint.stiffness=e)}}),this.exposeProperty("enableLimits","boolean",this.enableLimits,{onChange:e=>{this.enableLimits=e,this._skipRebuild||this.rebuildConstraint()}}),this.exposeProperty("minLength","number",this.minLength,{min:0,onChange:e=>{this.minLength=e}}),this.exposeProperty("maxLength","number",this.maxLength,{min:0,onChange:e=>{this.maxLength=e}}),this.exposeProperty("enableMotor","boolean",this.enableMotor,{onChange:e=>{this.enableMotor=e,this._skipRebuild||this.rebuildConstraint()}}),this.exposeProperty("motorSpeed","number",this.motorSpeed,{min:-360,max:360,onChange:e=>{this.motorSpeed=e}}),this.exposeProperty("showDebug","boolean",this.showDebug,{onChange:e=>{this.showDebug=e}}),this.exposeProperty("debugColor","string",this.debugColor,{onChange:e=>{this.debugColor=e}}),this.exposeProperty("lineAlpha","number",this.lineAlpha,{min:0,max:1,step:.01,onChange:e=>{this.lineAlpha=e}}),this.exposeProperty("lineThickness","number",this.lineThickness,{min:1,max:10,step:1,onChange:e=>{this.lineThickness=e}}),this.exposeProperty("springCoils","number",this.springCoils,{min:2,max:32,step:1,onChange:e=>{this.springCoils=e}}),this.exposeProperty("autoConnect","boolean",this.autoConnect)}start(){window.physicsManager?this.autoConnect&&this.findAndConnectTarget():console.error("Physics manager not found. Make sure it's initialized before using Joint.")}loop(){this.update(),this.constraint||this.createConstraint(),this.findAndConnectTarget()}findAndConnectTarget(){this.targetObjectName&&this.gameObject&&(this.targetObject&&this.targetObject.name===this.targetObjectName||(this.targetObject=this.findGameObjectByName(this.targetObjectName),this.targetObject?this.createConstraint():console.warn(`Joint: Target object "${this.targetObjectName}" not found`)))}findGameObjectByName(e){return window.engine?window.engine.gameObjects.find(t=>t.name===e):null}createConstraint(){if(!this.gameObject||!this.targetObject)return;if(this.removeConstraint(),!window.physicsManager)return void console.error("PhysicsManager not found or not initialized");const e=this.gameObject.getModule("RigidBody"),t=this.targetObject.getModule("RigidBody");if(!e||!e.body)return void console.error("Joint: Source object must have a RigidBody component");if(!t||!t.body)return void console.error("Joint: Target object must have a RigidBody component");const i={bodyA:e.body,bodyB:t.body,pointA:{x:this.pointA.x,y:this.pointA.y},pointB:{x:this.pointB.x,y:this.pointB.y},length:this.length,stiffness:this.stiffness,damping:this.damping,label:`${this.gameObject.name}_to_${this.targetObject.name}`};try{switch(this.jointType){case"distance":case"prismatic":this.constraint=Matter.Constraint.create({...i,stiffness:this.strength});break;case"spring":this.constraint=Matter.Constraint.create({...i,stiffness:.01,damping:.01});break;case"revolute":this.constraint=Matter.Constraint.create({...i,length:0,stiffness:1}),this.enableMotor&&(this.constraint.angularStiffness=.1,this.constraint.targetAngle=0);break;case"weld":this.constraint=Matter.Constraint.create({...i,length:0,stiffness:1,damping:0});break;case"mouse":this.constraint=Matter.Constraint.create({...i,stiffness:.2,damping:0});break;default:this.constraint=Matter.Constraint.create(i)}this.constraint&&(Matter.World.add(window.physicsManager.engine.world,this.constraint),this.isConnected=!0,this.constraint.module=this,console.log(`Joint created: ${this.jointType} between ${this.gameObject.name} and ${this.targetObject.name}`))}catch(e){console.error("Error creating joint constraint:",e)}}removeConstraint(){this.constraint&&window.physicsManager&&(Matter.World.remove(window.physicsManager.engine.world,this.constraint),this.constraint=null,this.isConnected=!1)}rebuildConstraint(){this.isConnected&&this.createConstraint()}updateConstraintPoints(){this.constraint&&(this.constraint.pointA={x:this.pointA.x,y:this.pointA.y},this.constraint.pointB={x:this.pointB.x,y:this.pointB.y})}connectTo(e,t=null,i=null){this.targetObject=e,this.targetObjectName=e.name,t&&(this.pointA=t),i&&(this.pointB=i),this.createConstraint()}disconnect(){this.removeConstraint(),this.targetObject=null}setMotorSpeed(e){if(this.motorSpeed=e,this.constraint&&"revolute"===this.jointType&&this.enableMotor){const t=(e*(Math.PI/180)-(this.constraint.bodyA.angularVelocity-this.constraint.bodyB.angularVelocity))*this.maxMotorTorque;Matter.Body.setAngularVelocity(this.constraint.bodyA,this.constraint.bodyA.angularVelocity+t/this.constraint.bodyA.inertia),Matter.Body.setAngularVelocity(this.constraint.bodyB,this.constraint.bodyB.angularVelocity-t/this.constraint.bodyB.inertia)}}getCurrentDistance(){if(this.constraint&&this.constraint.bodyA&&this.constraint.bodyB){const e=this.constraint.bodyA.position,t=this.constraint.bodyB.position,i=t.x-e.x,s=t.y-e.y;return Math.sqrt(i*i+s*s)}return 0}getCurrentAngle(){return this.constraint&&this.constraint.bodyA&&this.constraint.bodyB?(this.constraint.bodyB.angle-this.constraint.bodyA.angle)*(180/Math.PI):0}update(){if(this.constraint&&"revolute"===this.jointType&&this.enableMotor&&0!==this.motorSpeed&&this.setMotorSpeed(this.motorSpeed),this.constraint&&"spring"===this.jointType){const e=this.constraint.bodyA,t=this.constraint.bodyB;if(e&&t){const i=Matter.Vector.add(e.position,Matter.Vector.rotate(this.constraint.pointA,e.angle)),s=Matter.Vector.add(t.position,Matter.Vector.rotate(this.constraint.pointB,t.angle)),o=Matter.Vector.sub(s,i),n=Matter.Vector.magnitude(o);if(n>0){const r=Matter.Vector.normalise(o),a=n-this.length,l=Matter.Vector.sub(t.velocity,e.velocity),h=Matter.Vector.dot(l,r),c=-this.stiffness*a*.001+-this.damping*h*.01,d=Matter.Vector.mult(r,c);Matter.Body.applyForce(e,i,d),Matter.Body.applyForce(t,s,Matter.Vector.neg(d))}}}}draw(e){if(!this.showDebug||!this.constraint)return;const t=this.gameObject?.getWorldPosition()??{x:0,y:0},i=this.targetObject?.getWorldPosition()??{x:0,y:0},s={x:t.x+this.pointA.x,y:t.y+this.pointA.y},o={x:i.x+this.pointB.x,y:i.y+this.pointB.y};if(e.save(),e.strokeStyle=this.debugColor,e.globalAlpha=this.lineAlpha,e.lineWidth=this.lineThickness,"spring"===this.jointType){const t=this.springCoils,i=o.x-s.x,n=o.y-s.y,r=Math.sqrt(i*i+n*n),a=Math.atan2(n,i),l=Math.min(10,r/t/2);e.beginPath();for(let o=0;t>=o;o++){const r=o/t,h=s.x+r*i,c=s.y+r*n,d=(o%2==0?1:-1)*l,p=a+Math.PI/2,u=Math.cos(p)*d,g=Math.sin(p)*d;0===o?e.moveTo(h,c):e.lineTo(h+u,c+g)}e.lineTo(o.x,o.y),e.stroke()}else e.setLineDash([5,5]),e.beginPath(),e.moveTo(s.x,s.y),e.lineTo(o.x,o.y),e.stroke();e.setLineDash([]),e.globalAlpha=1,e.fillStyle=this.debugColor,e.beginPath(),e.arc(s.x,s.y,3,0,2*Math.PI),e.fill(),e.beginPath(),e.arc(o.x,o.y,3,0,2*Math.PI),e.fill(),e.restore()}onDestroy(){this.removeConstraint()}toJSON(){return{...super.toJSON(),jointType:this.jointType,targetObjectName:this.targetObjectName,pointA:{...this.pointA},pointB:{...this.pointB},length:this.length,stiffness:this.stiffness,damping:this.damping,strength:this.strength,enableLimits:this.enableLimits,minLength:this.minLength,maxLength:this.maxLength,enableMotor:this.enableMotor,motorSpeed:this.motorSpeed,maxMotorTorque:this.maxMotorTorque,axis:{...this.axis},showDebug:this.showDebug,debugColor:this.debugColor,debugColor:this.debugColor,lineAlpha:this.lineAlpha,lineThickness:this.lineThickness,springCoils:this.springCoils,autoConnect:this.autoConnect}}fromJSON(e){super.fromJSON(e),this.jointType=e.jointType??this.jointType,this.targetObjectName=e.targetObjectName??this.targetObjectName,this.pointA={...this.pointA,...e.pointA},this.pointB={...this.pointB,...e.pointB},this.length=e.length??this.length,this.stiffness=void 0!==e.stiffness?e.stiffness:this.stiffness,this.damping=void 0!==e.damping?e.damping:this.damping,this.strength=void 0!==e.strength?e.strength:this.strength,this.enableLimits=e.enableLimits??!1,this.minLength=e.minLength??this.minLength,this.maxLength=e.maxLength??this.maxLength,this.enableMotor=e.enableMotor??!1,this.motorSpeed=e.motorSpeed??this.motorSpeed,this.maxMotorTorque=e.maxMotorTorque??this.maxMotorTorque,this.axis={...this.axis,...e.axis},this.showDebug=e.showDebug??!1,this.debugColor=e.debugColor??this.debugColor,this.autoConnect=void 0!==e.autoConnect?e.autoConnect:this.autoConnect,this.debugColor=e.debugColor??this.debugColor,this.lineAlpha=e.lineAlpha??this.lineAlpha,this.lineThickness=e.lineThickness??this.lineThickness,this.springCoils=e.springCoils??this.springCoils}}window.Joint=Joint;class GravityFieldMatter extends Module{static allowMultiple=!1;static namespace="Matter.js";static description="Creates gravitational fields that can attract or repel dynamic RigidBody objects for Matter.js";constructor(){super("GravityFieldMatter"),this.fieldType="pull",this.strength=100,this.range=200,this.falloffType="linear",this.minRange=0,this.affectSelf=!1,this.onlyAffectTagged=!1,this.requiredTags=[],this.excludedTags=[],this.showGizmo=!0,this.gizmoColor="#00ff00",this.gizmoAlpha=.3,this.affectedBodies=new Set,this.updateInterval=16,this.lastUpdateTime=0,this.showPulse=!1,this.pulseSpeed=1.5,this.pulseAlpha=.5,this.exposeProperty("fieldType","enum",this.fieldType,{options:["pull","push"],onChange:e=>{this.fieldType=e}}),this.exposeProperty("strength","number",this.strength,{min:0,max:1e3,step:1,onChange:e=>{this.strength=e}}),this.exposeProperty("range","number",this.range,{min:1,max:2e3,step:1,onChange:e=>{this.range=e}}),this.exposeProperty("minRange","number",this.minRange,{min:0,max:500,step:1,onChange:e=>{this.minRange=Math.min(e,this.range-1)}}),this.exposeProperty("falloffType","enum",this.falloffType,{options:["none","linear","quadratic"],onChange:e=>{this.falloffType=e}}),this.exposeProperty("affectSelf","boolean",this.affectSelf,{onChange:e=>{this.affectSelf=e}}),this.exposeProperty("onlyAffectTagged","boolean",this.onlyAffectTagged,{onChange:e=>{this.onlyAffectTagged=e}}),this.exposeProperty("showPulse","boolean",this.showPulse,{onChange:e=>{this.showPulse=e}}),this.exposeProperty("pulseSpeed","number",this.pulseSpeed,{min:.1,max:10,step:.1,onChange:e=>{this.pulseSpeed=e}}),this.exposeProperty("pulseAlpha","number",this.pulseAlpha,{min:0,max:1,step:.05,onChange:e=>{this.pulseAlpha=e}}),this.exposeProperty("showGizmo","boolean",this.showGizmo,{onChange:e=>{this.showGizmo=e}}),this.exposeProperty("gizmoColor","color",this.gizmoColor,{onChange:e=>{this.gizmoColor=e}}),this.exposeProperty("gizmoAlpha","number",this.gizmoAlpha,{min:0,max:1,step:.1,onChange:e=>{this.gizmoAlpha=e}})}start(){window.physicsManager?this.lastUpdateTime=performance.now():console.error("Physics manager not found. GravityFieldMatter requires a physics manager.")}loop(e){if(!window.physicsManager||!this.gameObject)return;const t=performance.now();if(t-this.lastUpdateTime<this.updateInterval)return;this.lastUpdateTime=t;const i=this.gameObject.getWorldPosition(),s=window.engine?.gameObjects||[];this.affectedBodies.clear();for(const e of s){if(!this.isValidTarget(e,i))continue;const t=e.getModule("RigidBody");if(!t||!t.body)continue;if("dynamic"!==t.bodyType)continue;const s=e.getWorldPosition(),o=this.calculateDistance(i,s);this.applyGravitationalForce(t,i,s,o),this.affectedBodies.add(t.body)}}draw(e){if(!this.showPulse||!this.gameObject)return;this.gameObject.getWorldPosition();const t=performance.now()/1e3;this._pulseTime=t*this.pulseSpeed;const i=this.range,s=this.minRange;for(let t=0;3>t;t++){let o,n=(this._pulseTime+.5*t)%1;o="push"===this.fieldType?s+n*(i-s):i-n*(i-s);const r=this.pulseAlpha*(1-n);e.save(),e.beginPath(),e.arc(0,0,o,0,2*Math.PI),e.strokeStyle=this.gizmoColor,e.globalAlpha=r,e.lineWidth=4,e.stroke(),e.restore()}}isValidTarget(e,t){if(!e||e===this.gameObject)return!1;if(e===this.gameObject&&!this.affectSelf)return!1;const i=e.getWorldPosition(),s=this.calculateDistance(t,i);return!(s>this.range||s<this.minRange||this.onlyAffectTagged&&this.requiredTags.length>0&&!this.requiredTags.some(t=>e.tags?.includes(t))||this.excludedTags.length>0&&this.excludedTags.some(t=>e.tags?.includes(t)))}calculateDistance(e,t){const i=t.x-e.x,s=t.y-e.y;return Math.sqrt(i*i+s*s)}applyGravitationalForce(e,t,i,s){if(0===s)return;let o=t.x-i.x,n=t.y-i.y;const r=Math.sqrt(o*o+n*n);if(0===r)return;o/=r,n/=r,"push"===this.fieldType&&(o=-o,n=-n);let a=this.strength;switch(this.falloffType){case"linear":a*=1-s/this.range;break;case"quadratic":const e=s/this.range;a*=1-e*e}a*=.001*e.body.mass;const l={x:o*a,y:n*a};e.applyForce(l)}addRequiredTag(e){this.requiredTags.includes(e)||this.requiredTags.push(e)}removeRequiredTag(e){const t=this.requiredTags.indexOf(e);t>-1&&this.requiredTags.splice(t,1)}addExcludedTag(e){this.excludedTags.includes(e)||this.excludedTags.push(e)}removeExcludedTag(e){const t=this.excludedTags.indexOf(e);t>-1&&this.excludedTags.splice(t,1)}getAffectedBodies(){return Array.from(this.affectedBodies)}isAffectingBody(e){return this.affectedBodies.has(e)}drawGizmos(){if(!this.showGizmo||!this.gameObject)return;const e=this.gameObject.getWorldPosition();if(window.gizmoRenderer){window.gizmoRenderer.drawCircle(e.x,e.y,this.range,this.gizmoColor,this.gizmoAlpha),this.minRange>0&&window.gizmoRenderer.drawCircle(e.x,e.y,this.minRange,"#ff0000",.5*this.gizmoAlpha),window.gizmoRenderer.drawCircle(e.x,e.y,5,"pull"===this.fieldType?"#00ff00":"#ff0000",1);const t=20,i=8;for(let s=0;i>s;s++){const o=s/i*Math.PI*2,n=e.x+Math.cos(o)*(this.minRange+10),r=e.y+Math.sin(o)*(this.minRange+10);let a,l;"pull"===this.fieldType?(a=e.x+Math.cos(o)*(this.minRange+t),l=e.y+Math.sin(o)*(this.minRange+t)):(a=e.x+Math.cos(o)*(this.minRange-t),l=e.y+Math.sin(o)*(this.minRange-t)),window.gizmoRenderer?.drawArrow(n,r,a,l,"#ffffff",.8)}}}toJSON(){return{...super.toJSON(),fieldType:this.fieldType,strength:this.strength,range:this.range,minRange:this.minRange,falloffType:this.falloffType,affectSelf:this.affectSelf,onlyAffectTagged:this.onlyAffectTagged,requiredTags:[...this.requiredTags],excludedTags:[...this.excludedTags],showGizmo:this.showGizmo,gizmoColor:this.gizmoColor,gizmoAlpha:this.gizmoAlpha,updateInterval:this.updateInterval}}fromJSON(e){super.fromJSON(e),this.fieldType=e.fieldType??this.fieldType,this.strength=e.strength??this.strength,this.range=e.range??this.range,this.minRange=e.minRange??this.minRange,this.falloffType=e.falloffType??this.falloffType,this.affectSelf=e.affectSelf??this.affectSelf,this.onlyAffectTagged=e.onlyAffectTagged??this.onlyAffectTagged,this.requiredTags=e.requiredTags??[],this.excludedTags=e.excludedTags??[],this.showGizmo=e.showGizmo??this.showGizmo,this.gizmoColor=e.gizmoColor??this.gizmoColor,this.gizmoAlpha=e.gizmoAlpha??this.gizmoAlpha,this.updateInterval=e.updateInterval??this.updateInterval}}window.GravityFieldMatter=GravityFieldMatter;class WindZoneMatter extends Module{static allowMultiple=!1;static namespace="Matter.js";static description="Creates wind zones that apply forces to dynamic RigidBody objects for Matter.js";constructor(){super("WindZoneMatter"),this.width=200,this.height=200,this.windDirection=0,this.windStrength=50,this.turbulence=0,this.falloffType="none",this.affectSelf=!1,this.onlyAffectTagged=!1,this.requiredTags=[],this.excludedTags=[],this.showGizmo=!0,this.gizmoColor="#00aaff",this.gizmoAlpha=.3,this.showArrows=!0,this.arrowCount=5,this.updateInterval=16,this.lastUpdateTime=0,this.affectedBodies=new Set,this.exposeProperty("width","number",this.width,{min:10,max:2e3,step:10,onChange:e=>{this.width=e}}),this.exposeProperty("height","number",this.height,{min:10,max:2e3,step:10,onChange:e=>{this.height=e}}),this.exposeProperty("windDirection","number",this.windDirection,{min:0,max:360,step:1,onChange:e=>{this.windDirection=e%360}}),this.exposeProperty("windStrength","number",this.windStrength,{min:0,max:500,step:1,onChange:e=>{this.windStrength=e}}),this.exposeProperty("turbulence","number",this.turbulence,{min:0,max:1,step:.05,onChange:e=>{this.turbulence=e}}),this.exposeProperty("falloffType","enum",this.falloffType,{options:["none","linear","quadratic"],onChange:e=>{this.falloffType=e}}),this.exposeProperty("affectSelf","boolean",this.affectSelf,{onChange:e=>{this.affectSelf=e}}),this.exposeProperty("onlyAffectTagged","boolean",this.onlyAffectTagged,{onChange:e=>{this.onlyAffectTagged=e}}),this.exposeProperty("showGizmo","boolean",this.showGizmo,{onChange:e=>{this.showGizmo=e}}),this.exposeProperty("gizmoColor","color",this.gizmoColor,{onChange:e=>{this.gizmoColor=e}}),this.exposeProperty("gizmoAlpha","number",this.gizmoAlpha,{min:0,max:1,step:.1,onChange:e=>{this.gizmoAlpha=e}}),this.exposeProperty("showArrows","boolean",this.showArrows,{onChange:e=>{this.showArrows=e}}),this.exposeProperty("arrowCount","number",this.arrowCount,{min:1,max:20,step:1,onChange:e=>{this.arrowCount=e}})}start(){window.physicsManager?this.lastUpdateTime=performance.now():console.error("Physics manager not found. WindZoneMatter requires a physics manager.")}loop(e){if(!window.physicsManager||!this.gameObject)return;const t=performance.now();if(t-this.lastUpdateTime<this.updateInterval)return;this.lastUpdateTime=t;const i=this.gameObject.getWorldPosition(),s=this.gameObject.angle*(Math.PI/180),o=window.engine?.gameObjects||[];this.affectedBodies.clear();for(const e of o){if(!this.isValidTarget(e))continue;const t=e.getModule("RigidBody");if(!t||!t.body)continue;if("dynamic"!==t.bodyType)continue;const o=e.getWorldPosition();this.isPointInWindZone(o,i,s)&&(this.applyWindForce(t,o,i,s),this.affectedBodies.add(t.body))}}isValidTarget(e){return!(!e||e===this.gameObject||e===this.gameObject&&!this.affectSelf||this.onlyAffectTagged&&this.requiredTags.length>0&&!this.requiredTags.some(t=>e.tags?.includes(t))||this.excludedTags.length>0&&this.excludedTags.some(t=>e.tags?.includes(t)))}isPointInWindZone(e,t,i){const s=e.x-t.x,o=e.y-t.y,n=Math.cos(-i),r=Math.sin(-i),a=s*n-o*r,l=s*r+o*n,h=this.width/2,c=this.height/2;return!(-h>a||a>h||-c>l||l>c)}applyWindForce(e,t,i,s){const o=(this.windDirection+this.gameObject.angle)*(Math.PI/180);let n=Math.cos(o),r=Math.sin(o);if(this.turbulence>0){n+=2*(Math.random()-.5)*this.turbulence,r+=2*(Math.random()-.5)*this.turbulence;const e=Math.sqrt(n*n+r*r);e>0&&(n/=e,r/=e)}let a=this.windStrength;if("none"!==this.falloffType){const e=t.x-i.x,s=t.y-i.y,o=Math.sqrt(e*e+s*s),n=Math.sqrt(this.width*this.width+this.height*this.height)/2;if(n>0){const e=Math.min(o/n,1);switch(this.falloffType){case"linear":a*=1-e;break;case"quadratic":a*=1-e*e}}}a*=.001*e.body.mass;const l={x:n*a,y:r*a};e.applyForce(l)}drawWindArrows(e,t){const i=(this.windDirection+this.gameObject.angle)*(Math.PI/180),s=.3*Math.min(this.width,this.height),o=Math.max(this.width,this.height)/(this.arrowCount+1);for(let t=1;t<=this.arrowCount;t++){const n=i+Math.PI/2,r=(t-(this.arrowCount+1)/2)*o,a=e.x+Math.cos(n)*r*.5,l=e.y+Math.sin(n)*r*.5,h=a-Math.cos(i)*s*.5,c=l-Math.sin(i)*s*.5,d=a+Math.cos(i)*s*.5,p=l+Math.sin(i)*s*.5;window.gizmoRenderer.drawArrow(h,c,d,p,"#ffffff",.8)}}draw(e){if(this.showGizmo&&this.gameObject){if(this.gameObject.angle,e.save(),e.strokeStyle=this.gizmoColor,e.globalAlpha=this.gizmoAlpha,e.lineWidth=2,e.strokeRect(-this.width/2,-this.height/2,this.width,this.height),e.fillStyle=this.gizmoColor,e.globalAlpha=.2*this.gizmoAlpha,e.fillRect(-this.width/2,-this.height/2,this.width,this.height),this.showArrows){e.globalAlpha=.8,e.strokeStyle="#ffffff",e.lineWidth=2;const t=this.windDirection*(Math.PI/180),i=.2*Math.min(this.width,this.height),s=Math.max(this.width,this.height)/(this.arrowCount+1);for(let o=1;o<=this.arrowCount;o++){const n=t+Math.PI/2,r=(o-(this.arrowCount+1)/2)*s*.5,a=Math.cos(n)*r,l=Math.sin(n)*r,h=a-Math.cos(t)*i*.5,c=l-Math.sin(t)*i*.5,d=a+Math.cos(t)*i*.5,p=l+Math.sin(t)*i*.5;e.beginPath(),e.moveTo(h,c),e.lineTo(d,p),e.stroke();const u=.3*i,g=Math.PI/6;e.beginPath(),e.moveTo(d,p),e.lineTo(d-u*Math.cos(t-g),p-u*Math.sin(t-g)),e.moveTo(d,p),e.lineTo(d-u*Math.cos(t+g),p-u*Math.sin(t+g)),e.stroke()}}e.restore()}}addRequiredTag(e){this.requiredTags.includes(e)||this.requiredTags.push(e)}removeRequiredTag(e){const t=this.requiredTags.indexOf(e);t>-1&&this.requiredTags.splice(t,1)}addExcludedTag(e){this.excludedTags.includes(e)||this.excludedTags.push(e)}removeExcludedTag(e){const t=this.excludedTags.indexOf(e);t>-1&&this.excludedTags.splice(t,1)}getAffectedBodies(){return Array.from(this.affectedBodies)}isAffectingBody(e){return this.affectedBodies.has(e)}toJSON(){return{...super.toJSON(),width:this.width,height:this.height,windDirection:this.windDirection,windStrength:this.windStrength,turbulence:this.turbulence,falloffType:this.falloffType,affectSelf:this.affectSelf,onlyAffectTagged:this.onlyAffectTagged,requiredTags:[...this.requiredTags],excludedTags:[...this.excludedTags],showGizmo:this.showGizmo,gizmoColor:this.gizmoColor,gizmoAlpha:this.gizmoAlpha,showArrows:this.showArrows,arrowCount:this.arrowCount,updateInterval:this.updateInterval}}fromJSON(e){super.fromJSON(e),this.width=e.width??this.width,this.height=e.height??this.height,this.windDirection=e.windDirection??this.windDirection,this.windStrength=e.windStrength??this.windStrength,this.turbulence=e.turbulence??this.turbulence,this.falloffType=e.falloffType??this.falloffType,this.affectSelf=e.affectSelf??this.affectSelf,this.onlyAffectTagged=e.onlyAffectTagged??this.onlyAffectTagged,this.requiredTags=e.requiredTags??[],this.excludedTags=e.excludedTags??[],this.showGizmo=e.showGizmo??this.showGizmo,this.gizmoColor=e.gizmoColor??this.gizmoColor,this.gizmoAlpha=e.gizmoAlpha??this.gizmoAlpha,this.showArrows=e.showArrows??this.showArrows,this.arrowCount=e.arrowCount??this.arrowCount,this.updateInterval=e.updateInterval??this.updateInterval}}window.WindZoneMatter=WindZoneMatter;class VehiclePhysics extends Module{static allowMultiple=!1;static namespace="Matter.js";static description="Realistic top-down vehicle physics with steering, acceleration, and drift mechanics for Matter.js";static iconClass="fas fa-car";constructor(){super("VehiclePhysics"),this.playerControlled=!0,this.upKey="arrowup",this.downKey="arrowdown",this.leftKey="arrowleft",this.rightKey="arrowright",this.handbrakeKey=" ",this.weight=1e3,this.maxSpeed=1e3,this.acceleration=300,this.brakeForce=250,this.decelerationRate=.05,this.reverseMaxSpeed=250,this.maxTurnAngle=45,this.wheelTurnSpeed=90,this.wheelReturnSpeed=90,this.turnMultiplier=20,this.dragCoefficient=.95,this.lateralGrip=.85,this.minTurnSpeed=50,this.wheelBase=60,this.frontWheelDrive=!1,this.differentialStrength=.6,this.antiRoll=.3,this.tireMarkEnabled=!0,this.tireMarkScale=1,this.tireMarkOpacity=.7,this.tireMarkDistanceApart=40,this.tireMarkLifetime=10,this.tireMarkOffsetX=-40,this.tireMarkOffsetY=0,this.tireMarkLength=32,this.lastLeftMarkPos=null,this.lastRightMarkPos=null,this.minMarkSpacing=32,this.gtaStyleVehicle=!1,this.enterKey="enter",this.enterDistance=80,this.playerInside=!1,this.playerGameObject=null,this.playerOriginalPosition=null,this.hidePlayerWhenInside=!0,this.ejectOnDestroy=!0,this.showEnterPrompt=!0,this.handbrakeForce=6,this.driftThreshold=.8,this.tractionLoss=.4,this.powerOversteerStrength=1.2,this.frontGripAdvantage=.15,this.driftRecoveryRate=1.2,this.velocityDriftFactor=.7,this.tractionControlEnabled=!0,this.tractionControlStrength=.6,this.absEnabled=!0,this.absStrength=.8,this.currentSpeed=0,this.currentWheelAngle=0,this.throttleInput=0,this.targetThrottleInput=0,this.steeringInput=0,this.targetSteeringInput=0,this.isAccelerating=!1,this.isBraking=!1,this.isTurning=!1,this.isHandbraking=!1,this.isDrifting=!1,this.driftAngle=0,this.currentTraction=1,this.wheelSpinAmount=0,this.rigidBody=null,this.showDebugInfo=!1,this.showWheelDirection=!0,this.showDriftInfo=!0,this.require("RigidBody"),this.exposeProperty("weight","number",this.weight,{description:"Vehicle weight in kg",min:1,max:5e3,step:10,onChange:e=>{this.weight=e}}),this.exposeProperty("playerControlled","boolean",this.playerControlled,{description:"Can be controlled with arrow keys",onChange:e=>{this.playerControlled=e}}),this.exposeProperty("maxSpeed","number",this.maxSpeed,{description:"Maximum forward speed",min:1,max:500,onChange:e=>{this.maxSpeed=e}}),this.exposeProperty("acceleration","number",this.acceleration,{description:"Acceleration force",min:.1,max:100,onChange:e=>{this.acceleration=e}}),this.exposeProperty("brakeForce","number",this.brakeForce,{description:"Braking force",min:.1,max:1e3,onChange:e=>{this.brakeForce=e}}),this.exposeProperty("frontWheelDrive","boolean",this.frontWheelDrive,{description:"Front wheel drive vs rear wheel drive",onChange:e=>{this.frontWheelDrive=e}}),this.exposeProperty("handbrakeForce","number",this.handbrakeForce,{description:"Handbrake drift strength",min:.1,max:1,step:.1,onChange:e=>{this.handbrakeForce=e}}),this.exposeProperty("tractionLoss","number",this.tractionLoss,{description:"Traction loss under hard acceleration",min:0,max:1,step:.1,onChange:e=>{this.tractionLoss=e}}),this.exposeProperty("showDebugInfo","boolean",this.showDebugInfo,{description:"Show speed and steering debug info",onChange:e=>{this.showDebugInfo=e}}),this.exposeProperty("showDriftInfo","boolean",this.showDriftInfo,{description:"Show drift debug information",onChange:e=>{this.showDriftInfo=e}})}style(e){e.startGroup("Vehicle Controls",!1,{backgroundColor:"rgba(100, 200, 100, 0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("playerControlled","boolean",this.playerControlled,{description:"Enable arrow key controls",style:{label:"Player Controlled"}}),e.exposeProperty("handbrakeKey","string",this.handbrakeKey,{description:"Key for handbrake/drift",style:{label:"Handbrake Key"}}),e.endGroup(),e.startGroup("Performance",!1,{backgroundColor:"rgba(255, 150, 100, 0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("weight","number",this.weight,{description:"Vehicle weight in kg",min:1,max:5e3,step:10}),e.exposeProperty("maxSpeed","number",this.maxSpeed,{description:"Top speed in pixels per second",min:50,max:1e3,step:25,style:{label:"Max Speed",slider:!0}}),e.exposeProperty("acceleration","number",this.acceleration,{description:"How quickly the vehicle accelerates",min:100,max:2e3,step:50,style:{label:"Acceleration",slider:!0}}),e.exposeProperty("brakeForce","number",this.brakeForce,{description:"Braking strength",min:200,max:2e3,step:50,style:{label:"Brake Force",slider:!0}}),e.exposeProperty("decelerationRate","number",this.decelerationRate,{description:"Natural slowdown when coasting",min:.05,max:.5,step:.05,style:{label:"Deceleration",slider:!0}}),e.endGroup(),e.startGroup("Drive Type & Traction",!1,{backgroundColor:"rgba(255, 200, 100, 0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("frontWheelDrive","boolean",this.frontWheelDrive,{description:"FWD vs RWD affects handling and drift characteristics",style:{label:"Front Wheel Drive"}}),e.exposeProperty("tractionLoss","number",this.tractionLoss,{description:"Traction loss under hard acceleration",min:0,max:1,step:.1,style:{label:"Power Traction Loss",slider:!0}}),e.exposeProperty("powerOversteerStrength","number",this.powerOversteerStrength,{description:"RWD oversteer multiplier",min:.5,max:3,step:.1,style:{label:"RWD Oversteer",slider:!0}}),e.exposeProperty("frontGripAdvantage","number",this.frontGripAdvantage,{description:"FWD cornering grip advantage",min:0,max:.5,step:.05,style:{label:"FWD Grip Bonus",slider:!0}}),e.endGroup(),e.startGroup("Tire Marks",!1,{backgroundColor:"rgba(100, 100, 100, 0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("tireMarkEnabled","boolean",this.tireMarkEnabled,{description:"Enable tire mark decals",style:{label:"Enabled"}}),e.exposeProperty("tireMarkScale","number",this.tireMarkScale,{description:"Scale of tire marks",min:.1,max:5,step:.1,style:{label:"Scale",slider:!0}}),e.exposeProperty("tireMarkOpacity","number",this.tireMarkOpacity,{description:"Initial opacity of tire marks",min:.1,max:1,step:.1,style:{label:"Opacity",slider:!0}}),e.exposeProperty("tireMarkDistanceApart","number",this.tireMarkDistanceApart,{description:"Distance between left and right tire marks",min:10,max:100,step:5,style:{label:"Distance Apart",slider:!0}}),e.exposeProperty("tireMarkLifetime","number",this.tireMarkLifetime,{description:"Lifetime in seconds before fading (0 = no fade)",min:0,max:60,step:1,style:{label:"Lifetime (s)",slider:!0}}),e.exposeProperty("tireMarkOffsetX","number",this.tireMarkOffsetX,{description:"Offset from center X (positive = right)",min:-50,max:50,step:5,style:{label:"Offset X",slider:!0}}),e.exposeProperty("tireMarkOffsetY","number",this.tireMarkOffsetY,{description:"Offset from center Y (positive = back)",min:-50,max:50,step:5,style:{label:"Offset Y",slider:!0}}),e.exposeProperty("tireMarkLength","number",this.tireMarkLength,{description:"Length/width of individual tire marks",min:5,max:100,step:5,style:{label:"Mark Length",slider:!0}}),e.exposeProperty("minMarkSpacing","number",this.minMarkSpacing,{description:"Minimum gap between consecutive marks",min:5,max:100,step:5,style:{label:"Mark Spacing",slider:!0}}),e.endGroup(),e.startGroup("Drift System",!1,{backgroundColor:"rgba(200, 100, 255, 0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("handbrakeForce","number",this.handbrakeForce,{description:"Handbrake drift strength (higher = more sliding)",min:.1,max:1,step:.1,style:{label:"Handbrake Strength",slider:!0}}),e.exposeProperty("driftThreshold","number",this.driftThreshold,{description:"Speed threshold for drift initiation",min:.3,max:1,step:.1,style:{label:"Drift Speed Threshold",slider:!0}}),e.exposeProperty("driftRecoveryRate","number",this.driftRecoveryRate,{description:"How quickly traction recovers",min:1,max:10,step:.5,style:{label:"Traction Recovery",slider:!0}}),e.exposeProperty("velocityDriftFactor","number",this.velocityDriftFactor,{description:"How much velocity affects drift angle",min:.1,max:2,step:.1,style:{label:"Velocity Drift Factor",slider:!0}}),e.endGroup(),e.startGroup("Steering",!1,{backgroundColor:"rgba(150, 150, 255, 0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("turnMultiplier","number",this.turnMultiplier,{description:"Steering strength multiplier",min:.1,max:5,step:.1,style:{label:"Turn Multiplier",slider:!0}}),e.exposeProperty("maxTurnAngle","number",this.maxTurnAngle,{description:"Maximum wheel turn angle",min:15,max:90,step:5,style:{label:"Max Turn Angle",slider:!0}}),e.exposeProperty("lateralGrip","number",this.lateralGrip,{description:"Base tire grip for cornering",min:.1,max:1,step:.05,style:{label:"Base Tire Grip",slider:!0}}),e.endGroup(),e.startGroup("Driver Assists",!0,{backgroundColor:"rgba(100, 255, 200, 0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("tractionControlEnabled","boolean",this.tractionControlEnabled,{description:"Simulates traction control system",style:{label:"Traction Control"}}),e.exposeProperty("tractionControlStrength","number",this.tractionControlStrength,{description:"TC effectiveness",min:0,max:1,step:.1,style:{label:"TC Strength",slider:!0}}),e.exposeProperty("absEnabled","boolean",this.absEnabled,{description:"Anti-lock braking system",style:{label:"ABS"}}),e.endGroup(),e.startGroup("Debug",!0,{backgroundColor:"rgba(200, 200, 200, 0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("showDebugInfo","boolean",this.showDebugInfo,{description:"Display basic vehicle debug information",style:{label:"Debug Info"}}),e.exposeProperty("showDriftInfo","boolean",this.showDriftInfo,{description:"Display drift-specific debug information",style:{label:"Drift Debug"}}),e.exposeProperty("showWheelDirection","boolean",this.showWheelDirection,{description:"Show wheel and velocity vectors",style:{label:"Wheel Vectors"}}),e.endGroup(),e.startGroup("GTA Vehicle System",!1,{backgroundColor:"rgba(255, 100, 255, 0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("gtaStyleVehicle","boolean",this.gtaStyleVehicle,{description:"Enable GTA-style enter/exit system",style:{label:"GTA Style Vehicle"}}),e.exposeProperty("enterKey","string",this.enterKey,{description:"Key to enter/exit vehicle",style:{label:"Enter/Exit Key"}}),e.exposeProperty("enterDistance","number",this.enterDistance,{description:"Distance player needs to be to enter",min:30,max:200,step:10,style:{label:"Enter Distance",slider:!0}}),e.exposeProperty("hidePlayerWhenInside","boolean",this.hidePlayerWhenInside,{description:"Hide player sprite when inside vehicle",style:{label:"Hide Player Inside"}}),e.exposeProperty("showEnterPrompt","boolean",this.showEnterPrompt,{description:"Show enter/exit prompts",style:{label:"Show Enter Prompt"}}),e.endGroup(),e.addDivider(),e.addHelpText("Enhanced physics with realistic drift mechanics. Use handbrake + steering to initiate drifts. RWD vehicles have more oversteer, FWD have better traction.")}start(){this.rigidBody=this.gameObject.getModule("RigidBody"),this.rigidBody?(this.rigidBody.useGravity=!1,this.rigidBody.bodyType="dynamic",this.rigidBody.friction=.1,this.rigidBody.frictionAir=.02,this.rigidBody.density=1.5,this.rigidBody.body&&(this.rigidBody.body.ignoreGravity=!0),this.rigidBody.updateMass(this.weight),console.log(this.playerControlled?"Player-controlled vehicle initialized.":"AI-controlled vehicle initialized.")):console.error("VehiclePhysics requires a RigidBody component on the same GameObject!")}loop(e){this.rigidBody&&this.rigidBody.body&&(this.gtaStyleVehicle&&this.handleVehicleEntry(),this.isAccelerating=!1,this.isBraking=!1,this.isTurning=!1,this.isHandbraking=!1,this.targetThrottleInput=0,this.targetSteeringInput=0,this.playerControlled&&(!this.gtaStyleVehicle||this.playerInside)&&(window.input.keyDown(this.upKey)&&(this.targetThrottleInput=1,this.isAccelerating=!0),window.input.keyDown(this.downKey)&&(this.targetThrottleInput=-1,this.isBraking=!0),window.input.keyDown(this.leftKey)&&(this.targetSteeringInput=-1,this.isTurning=!0),window.input.keyDown(this.rightKey)&&(this.targetSteeringInput=1,this.isTurning=!0),window.input.keyDown(this.handbrakeKey)&&(this.isHandbraking=!0)),this.tireMarkEnabled&&this.isLosingTraction()?this.createTireMarks():(this.lastLeftMarkPos=null,this.lastRightMarkPos=null),this.updateInputs(e),this.updateWheelSteering(e),this.updateTractionSystem(e),this.updateVehiclePhysics(e),this.updateDriftPhysics(e))}handleVehicleEntry(){if(!window.engine||!window.engine.gameObjectManager)return;if(this.playerGameObject||(this.playerGameObject=this.findPlayerGameObject()),!this.playerGameObject)return;const e=this.playerGameObject.getWorldPosition(),t=this.gameObject.getWorldPosition();this.calculateDistance(e,t)>this.enterDistance?this.hideEnterPromptUI():(!this.playerInside&&this.showEnterPrompt&&this.showEnterPromptUI(),window.input.keyPressed(this.enterKey)&&(this.playerInside?this.exitVehicle():this.enterVehicle())),this.playerInside&&this.playerGameObject&&this.updatePlayerPositionInVehicle()}enterVehicle(){if(!this.playerGameObject||this.playerInside)return;console.log("Player entering vehicle"),this.playerOriginalPosition=this.playerGameObject.getWorldPosition(),this.playerInside=!0;const e=this.gameObject.getWorldPosition();this.playerGameObject.setWorldPosition(e.x,e.y),this.hidePlayerWhenInside&&this.setPlayerVisibility(!1),this.setPlayerMovementEnabled(!1),this.hideEnterPromptUI()}exitVehicle(){if(!this.playerGameObject||!this.playerInside)return;console.log("Player exiting vehicle");const e=this.gameObject.getWorldPosition(),t=this.gameObject.angle*(Math.PI/180),i=e.x-60*Math.sin(t),s=e.y+60*Math.cos(t);this.playerGameObject.setWorldPosition(i,s),this.playerInside=!1,this.hidePlayerWhenInside&&this.setPlayerVisibility(!0),this.setPlayerMovementEnabled(!0),this.playerOriginalPosition=null}updatePlayerPositionInVehicle(){if(!this.playerGameObject||!this.playerInside)return;const e=this.gameObject.getWorldPosition();this.playerGameObject.setWorldPosition(e.x,e.y)}findPlayerGameObject(){let e=window.engine.gameObjectManager.findGameObjectByTag("Player");return e||(e=window.engine.gameObjectManager.getAllGameObjects().find(e=>e.name&&e.name.toLowerCase().includes("player"))),e||(e=window.engine.gameObjectManager.getAllGameObjects().find(e=>e.getModule("PlayerMovement")||e.getModule("Movement")||e.getModule("TopDownMovement"))),e}calculateDistance(e,t){const i=e.x-t.x,s=e.y-t.y;return Math.sqrt(i*i+s*s)}setPlayerVisibility(e){if(!this.playerGameObject)return;const t=this.playerGameObject.getModule("SpriteRenderer");t&&(t.visible=e);const i=this.playerGameObject.getModule("Renderer");i&&(i.visible=e)}setPlayerMovementEnabled(e){if(!this.playerGameObject)return;const t=this.playerGameObject.getModule("PlayerMovement");t&&"function"==typeof t.setEnabled&&t.setEnabled(e);const i=this.playerGameObject.getModule("Movement");i&&"function"==typeof i.setEnabled&&i.setEnabled(e);const s=this.playerGameObject.getModule("TopDownMovement");s&&"function"==typeof s.setEnabled&&s.setEnabled(e)}showEnterPromptUI(){this._promptShown||(this._promptShown=!0,console.log(`Press ${this.enterKey.toUpperCase()} to enter vehicle`))}hideEnterPromptUI(){this._promptShown=!1}updateInputs(e){if(0!==this.targetThrottleInput){let t=this.targetThrottleInput>0?.01*this.acceleration:.01*this.brakeForce;this.throttleInput=this.lerp(this.throttleInput,this.targetThrottleInput,t*e)}else this.throttleInput=this.lerp(this.throttleInput,0,this.decelerationRate*e*60);0!==this.targetSteeringInput?this.steeringInput=this.lerp(this.steeringInput,this.targetSteeringInput,8*e):this.steeringInput=this.lerp(this.steeringInput,0,6*e)}updateWheelSteering(e){let t=this.steeringInput*this.maxTurnAngle,i=this.wheelTurnSpeed;0===this.targetSteeringInput&&this.isMoving()&&(i=this.wheelReturnSpeed);let s=t-this.currentWheelAngle,o=i*e;Math.abs(s)>o?this.currentWheelAngle+=Math.sign(s)*o:this.currentWheelAngle=t}updateTractionSystem(e){const t=this.currentSpeed/this.maxSpeed,i=Math.abs(this.throttleInput);if(this.wheelSpinAmount=0,this.isAccelerating&&i>.7){let e=i*this.tractionLoss;this.frontWheelDrive||(e*=1+Math.abs(this.steeringInput)*this.powerOversteerStrength),e*=.5+.5*t,this.wheelSpinAmount=e}let s=1;if(this.wheelSpinAmount>0&&(s=Math.max(.2,1-this.wheelSpinAmount),this.tractionControlEnabled&&(s=this.lerp(s,1,this.tractionControlStrength))),this.isHandbraking){let e=this.handbrakeForce;s=this.frontWheelDrive?Math.max(.3,s-.7*e):Math.max(.1,s-e)}this.frontWheelDrive&&!this.isHandbraking&&.3>this.wheelSpinAmount&&(s=Math.min(1,s+this.frontGripAdvantage)),this.currentTraction=this.lerp(this.currentTraction,s,this.driftRecoveryRate*e)}updateVehiclePhysics(e){const t=this.rigidBody.body,i=this.rigidBody.getVelocity();this.currentSpeed=Math.sqrt(i.x*i.x+i.y*i.y);const s=this.gameObject.angle*(Math.PI/180),o=Math.cos(s),n=Math.sin(s),r=-Math.sin(s),a=Math.cos(s),l=i.x*o+i.y*n,h=i.x*r+i.y*a;if(Math.abs(this.throttleInput)>.01){let t=this.throttleInput>0?this.maxSpeed:-this.reverseMaxSpeed,i=Math.abs(this.throttleInput>0?this.acceleration:this.brakeForce);0>this.throttleInput&&this.absEnabled&&(i*=.3+.7*this.currentTraction*this.absStrength);let s=Math.abs(l)/Math.abs(t);s>.8&&(i*=Math.max(.1,1-s));let r=i*this.throttleInput*this.currentTraction*e*60;this.wheelSpinAmount>.5&&Math.abs(this.steeringInput)>.3&&(r*=.7),this.rigidBody.applyForce({x:o*r,y:n*r})}if(!this.isAccelerating&&this.isMoving()){const e=s+this.currentWheelAngle*Math.PI/180,t=Math.cos(e),o=Math.sin(e),n=i.x*t+i.y*o,r=t*n,a=o*n,l=.05+.2*(1-Math.min(1,this.currentSpeed/this.maxSpeed)),h=l*(1-this.currentTraction),c=Math.max(l,h),d=(r-i.x)*c,p=(a-i.y)*c;this.rigidBody.applyForce({x:d,y:p})}if(Math.abs(this.currentWheelAngle)>1&&this.isMoving()){const e=this.currentWheelAngle*Math.PI/180,t=s+e,i=Math.cos(t),o=Math.sin(t);let n=this.currentSpeed*Math.sin(e)*this.currentTraction;!this.frontWheelDrive&&this.wheelSpinAmount>.3&&(n*=1.5+.5*Math.abs(this.throttleInput)),this.rigidBody.applyForce({x:i*n*.5,y:o*n*.5});let r=l/(this.wheelBase/Math.tan(Math.abs(e)))*(this.currentWheelAngle/Math.abs(this.currentWheelAngle))*this.turnMultiplier;r*=this.currentTraction,!this.frontWheelDrive&&this.isAccelerating&&this.wheelSpinAmount>.3&&(r*=1.3),r=Math.max(-5,Math.min(5,r)),this.rigidBody.setAngularVelocity(r)}if(this.currentSpeed>0){const e=l*l*(1-this.dragCoefficient)*.01;this.rigidBody.applyForce({x:-o*e*Math.sign(l),y:-n*e*Math.sign(l)});let t=this.lateralGrip*this.currentTraction;const i=Math.abs(h)*h*t*.5;this.rigidBody.applyForce({x:-r*i,y:-a*i})}if(0!==t.angularVelocity){const i=.8*t.angularVelocity*this.currentTraction;t.angularVelocity-=i*e}}updateDriftPhysics(e){if(!this.rigidBody||!this.rigidBody.body)return;const t=this.rigidBody.getVelocity(),i=this.gameObject.angle*(Math.PI/180),s=Math.atan2(t.y,t.x);let o=180/Math.PI*(s-i);for(;o>180;)o-=360;for(;-180>o;)o+=360;this.driftAngle=o*this.velocityDriftFactor;const n=this.currentSpeed/this.maxSpeed,r=this.driftThreshold;if(this.isDrifting=n>r&&(Math.abs(this.driftAngle)>15||this.isHandbraking||.8>this.currentTraction),this.isHandbraking&&n>.2&&Math.abs(this.steeringInput)>.01){const s=-Math.sin(i),o=Math.cos(i),n=-1*this.handbrakeForce*this.currentSpeed;this.rigidBody.applyForce({x:t.x*n*e,y:t.y*n*e});const r=this.currentSpeed*this.handbrakeForce*Math.sign(this.steeringInput);this.rigidBody.applyForce({x:s*r*e,y:o*r*e});const a=.8;this.rigidBody.applyForce({x:-t.x*a*e,y:-t.y*a*e})}}lerp(e,t,i){return e+(t-e)*Math.max(0,Math.min(1,i))}draw(e){if(this.showDebugInfo||this.showWheelDirection||this.showDriftInfo){if(this.gameObject.getWorldPosition(),e.save(),this.showDebugInfo){e.fillStyle="white",e.font="12px Arial",e.textAlign="center";const t=Math.round(this.currentSpeed),i=Math.round(this.gameObject.angle%360),s=Math.round(this.currentWheelAngle),o=Math.round(100*this.throttleInput);e.fillText(`Speed: ${t}px/s`,0,-70),e.fillText(`Angle: ${i}\xb0`,0,-58),e.fillText(`Wheels: ${s}\xb0`,0,-46),e.fillText(`Throttle: ${o}%`,0,-34),this.isAccelerating&&e.fillText("ACCEL",0,-22),this.isBraking&&e.fillText("BRAKE",0,-22),this.isTurning&&e.fillText("TURN",0,-10),this.isHandbraking&&e.fillText("HANDBRAKE",0,2)}if(this.gtaStyleVehicle&&this.drawVehicleUI(e),this.showDriftInfo){e.fillStyle=this.isDrifting?"orange":"lightblue",e.font="11px Arial",e.textAlign="center";const t=Math.round(100*this.currentTraction),i=Math.round(this.driftAngle),s=Math.round(100*this.wheelSpinAmount);let o=this.showDebugInfo?14:-58;if(e.fillText(`Traction: ${t}%`,0,o),e.fillText(`Drift: ${i}\xb0`,0,o+12),e.fillText(`Wheel Spin: ${s}%`,0,o+24),this.isDrifting&&(e.fillStyle="orange",e.fillText("DRIFTING!",0,o+36)),e.fillStyle="yellow",e.fillText(this.frontWheelDrive?"FWD":"RWD",0,o+48),this.tractionControlEnabled||this.absEnabled){e.fillStyle="lime";let t=[];this.tractionControlEnabled&&t.push("TC"),this.absEnabled&&t.push("ABS"),e.fillText(t.join(" "),0,o+60)}}if(this.showWheelDirection){try{const t=this.rigidBody.getVelocity();if(!t)return;this.currentSpeed>10&&(e.strokeStyle=this.isDrifting?"orange":"lime",e.lineWidth=3,e.beginPath(),e.moveTo(0,0),e.lineTo(.5*t.x,.5*t.y),e.stroke())}catch(e){}if(e.strokeStyle="red",e.lineWidth=2,e.beginPath(),e.moveTo(0,0),e.lineTo(30,0),e.stroke(),Math.abs(this.currentWheelAngle)>1){const t=0+this.currentWheelAngle*Math.PI/180;e.strokeStyle="lime",e.lineWidth=2,e.beginPath(),e.moveTo(0,0),e.lineTo(25*Math.cos(t),25*Math.sin(t)),e.stroke()}const t=15+10*this.currentTraction;if(e.strokeStyle=`hsl(${120*this.currentTraction}, 100%, 50%)`,e.lineWidth=2,e.beginPath(),e.arc(0,0,t,0,2*Math.PI),e.stroke(),this.wheelSpinAmount>.1){e.strokeStyle="red",e.lineWidth=1;for(let t=0;6>t;t++){const i=t/6*Math.PI*2,s=35+Math.sin(.01*Date.now()+t)*this.wheelSpinAmount*5;e.beginPath(),e.moveTo(0,0),e.lineTo(Math.cos(i)*s,Math.sin(i)*s),e.stroke()}}}e.restore()}}drawVehicleUI(e){if(!this.playerGameObject)return;const t=this.playerGameObject.getWorldPosition(),i=this.gameObject.getWorldPosition(),s=this.calculateDistance(t,i);if(e.save(),!this.playerInside&&s<=this.enterDistance&&this.showEnterPrompt){e.fillStyle="white",e.strokeStyle="black",e.lineWidth=2,e.font="14px Arial",e.textAlign="center";const t=`Press ${this.enterKey.toUpperCase()} to enter`,i=e.measureText(t).width;e.fillStyle="rgba(0, 0, 0, 0.7)",e.fillRect(-i/2-5,-120,i+10,25),e.fillStyle="white",e.fillText(t,0,-100)}this.playerInside&&(e.fillStyle="lime",e.font="12px Arial",e.textAlign="center",e.fillText("DRIVING",0,-85),e.fillStyle="yellow",e.font="10px Arial",e.fillText(`Press ${this.enterKey.toUpperCase()} to exit`,0,-73)),this.showDebugInfo&&!this.playerInside&&(e.strokeStyle="cyan",e.lineWidth=1,e.setLineDash([5,5]),e.beginPath(),e.arc(0,0,this.enterDistance,0,2*Math.PI),e.stroke(),e.setLineDash([])),e.restore()}onDestroy(){this.playerInside&&this.ejectOnDestroy&&this.exitVehicle()}isLosingTraction(){return.8>this.currentTraction||this.isDrifting||this.wheelSpinAmount>.3||this.isHandbraking}createTireMarks(){if(!window.engine)return;const e=this.gameObject.getWorldPosition(),t=this.gameObject.angle*(Math.PI/180),i=this.rigidBody.getVelocity(),s=Math.atan2(i.y,i.x),o=this.isDrifting?s:t,n=Math.cos(o),r=Math.sin(o),a=this.tireMarkOffsetX,l=this.tireMarkOffsetY,h=e.x+a*n-l*r-this.tireMarkDistanceApart/2*r,c=e.y+a*r+l*n+this.tireMarkDistanceApart/2*n,d=e.x+a*n-l*r+this.tireMarkDistanceApart/2*r,p=e.y+a*r+l*n-this.tireMarkDistanceApart/2*n,u=this.minMarkSpacing*this.tireMarkScale,g=Math.max(1,u-.05*this.currentSpeed),m=!this.lastLeftMarkPos||this.distance(this.lastLeftMarkPos,{x:h,y:c})>=g,f=!this.lastRightMarkPos||this.distance(this.lastRightMarkPos,{x:d,y:p})>=g;if(!m&&!f)return;let y,w,b,x,v,M;if(this.lastLeftMarkPos){const e=h-this.lastLeftMarkPos.x,t=c-this.lastLeftMarkPos.y,i=Math.sqrt(e*e+t*t);i>0?(y=this.lastLeftMarkPos.x+e/i*g,w=this.lastLeftMarkPos.y+t/i*g,b=Math.atan2(t,e)):(y=h,w=c,b=s)}else y=h,w=c,b=s;if(this.lastRightMarkPos){const e=d-this.lastRightMarkPos.x,t=p-this.lastRightMarkPos.y,i=Math.sqrt(e*e+t*t);i>0?(x=this.lastRightMarkPos.x+e/i*g,v=this.lastRightMarkPos.y+t/i*g,M=Math.atan2(t,e)):(x=d,v=p,M=s)}else x=d,v=p,M=s;m&&(window.engine.addDecal(y,w,this.drawTireMark.bind(this),{scale:this.tireMarkScale,alpha:this.tireMarkOpacity,rotation:b,lifetime:this.tireMarkLifetime,width:this.tireMarkLength,height:8}),this.lastLeftMarkPos={x:y,y:w}),f&&(window.engine.addDecal(x,v,this.drawTireMark.bind(this),{scale:this.tireMarkScale,alpha:this.tireMarkOpacity,rotation:M,lifetime:this.tireMarkLifetime,width:this.tireMarkLength,height:8}),this.lastRightMarkPos={x:x,y:v})}distance(e,t){const i=e.x-t.x,s=e.y-t.y;return Math.sqrt(i*i+s*s)}drawTireMark(e){e.fillStyle="black",e.fillRect(0,0,32,8)}drawGizmos(e){if(!this.showWheelDirection)return;this.gameObject.getWorldPosition(),this.gameObject.angle,e.save();const t=.3*this.wheelBase,i=this.currentWheelAngle*Math.PI/180;e.save(),e.translate(0,-t),e.rotate(i),this.frontWheelDrive?e.fillStyle=`hsla(${120*this.currentTraction}, 100%, 50%, 0.8)`:e.fillStyle="rgba(255, 255, 0, 0.7)",e.fillRect(-8,-4,16,8),this.frontWheelDrive&&this.wheelSpinAmount>.2&&(e.strokeStyle="red",e.lineWidth=1,e.beginPath(),e.arc(0,0,6,0,2*Math.PI),e.stroke()),e.restore(),e.save(),e.translate(0,t),this.frontWheelDrive?e.fillStyle="rgba(255, 255, 0, 0.5)":e.fillStyle=`hsla(${120*this.currentTraction}, 100%, 50%, 0.8)`,e.fillRect(-8,-4,16,8),!this.frontWheelDrive&&this.wheelSpinAmount>.2&&(e.strokeStyle="red",e.lineWidth=1,e.beginPath(),e.arc(0,0,6,0,2*Math.PI),e.stroke()),this.isHandbraking&&(e.strokeStyle="orange",e.lineWidth=2,e.beginPath(),e.arc(0,0,10,0,2*Math.PI),e.stroke()),e.restore(),e.restore()}accelerate(e=1){this.targetThrottleInput=Math.max(0,Math.min(1,e)),this.isAccelerating=!0}brake(e=1){this.targetThrottleInput=-Math.max(0,Math.min(1,e)),this.isBraking=!0}steer(e=1){this.targetSteeringInput=Math.max(-1,Math.min(1,e)),this.isTurning=!0}handbrake(e=!0){this.isHandbraking=e}getCurrentSpeed(){return this.currentSpeed}isMoving(){return 0!==this.currentSpeed}getCurrentWheelAngle(){return this.currentWheelAngle}getThrottleInput(){return this.throttleInput}getDriftAngle(){return this.driftAngle}getTraction(){return this.currentTraction}getWheelSpinAmount(){return this.wheelSpinAmount}toJSON(){return{...super.toJSON(),playerControlled:this.playerControlled,maxSpeed:this.maxSpeed,acceleration:this.acceleration,brakeForce:this.brakeForce,decelerationRate:this.decelerationRate,reverseMaxSpeed:this.reverseMaxSpeed,maxTurnAngle:this.maxTurnAngle,turnMultiplier:this.turnMultiplier,wheelTurnSpeed:this.wheelTurnSpeed,wheelReturnSpeed:this.wheelReturnSpeed,dragCoefficient:this.dragCoefficient,lateralGrip:this.lateralGrip,minTurnSpeed:this.minTurnSpeed,wheelBase:this.wheelBase,frontWheelDrive:this.frontWheelDrive,differentialStrength:this.differentialStrength,antiRoll:this.antiRoll,handbrakeForce:this.handbrakeForce,driftThreshold:this.driftThreshold,tractionLoss:this.tractionLoss,powerOversteerStrength:this.powerOversteerStrength,frontGripAdvantage:this.frontGripAdvantage,driftRecoveryRate:this.driftRecoveryRate,velocityDriftFactor:this.velocityDriftFactor,tractionControlEnabled:this.tractionControlEnabled,tractionControlStrength:this.tractionControlStrength,absEnabled:this.absEnabled,absStrength:this.absStrength,showDebugInfo:this.showDebugInfo,showWheelDirection:this.showWheelDirection,showDriftInfo:this.showDriftInfo,upKey:this.upKey,downKey:this.downKey,leftKey:this.leftKey,rightKey:this.rightKey,handbrakeKey:this.handbrakeKey,tireMarkOpacity:this.tireMarkOpacity,tireMarkScale:this.tireMarkScale,tireMarkLifetime:this.tireMarkLifetime,tireMarkDistanceApart:this.tireMarkDistanceApart,tireMarkEnabled:this.tireMarkEnabled,tireMarkOffsetX:this.tireMarkOffsetX,tireMarkOffsetY:this.tireMarkOffsetY,tireMarkLength:this.tireMarkLength,minMarkSpacing:this.minMarkSpacing,gtaStyleVehicle:this.gtaStyleVehicle,enterKey:this.enterKey,enterDistance:this.enterDistance,hidePlayerWhenInside:this.hidePlayerWhenInside,showEnterPrompt:this.showEnterPrompt,ejectOnDestroy:this.ejectOnDestroy}}fromJSON(e){super.fromJSON(e),e&&(this.playerControlled=void 0===e.playerControlled||e.playerControlled,this.maxSpeed=e.maxSpeed||300,this.acceleration=e.acceleration||600,this.brakeForce=e.brakeForce||800,this.decelerationRate=e.decelerationRate||.15,this.reverseMaxSpeed=e.reverseMaxSpeed||150,this.maxTurnAngle=e.maxTurnAngle||45,this.turnMultiplier=e.turnMultiplier||1,this.wheelTurnSpeed=e.wheelTurnSpeed||180,this.wheelReturnSpeed=e.wheelReturnSpeed||120,this.dragCoefficient=e.dragCoefficient||.95,this.lateralGrip=e.lateralGrip||.85,this.minTurnSpeed=e.minTurnSpeed||50,this.wheelBase=e.wheelBase||60,this.frontWheelDrive=void 0===e.frontWheelDrive||e.frontWheelDrive,this.differentialStrength=e.differentialStrength||.8,this.antiRoll=e.antiRoll||.3,this.handbrakeForce=e.handbrakeForce||.3,this.driftThreshold=e.driftThreshold||.8,this.tractionLoss=e.tractionLoss||.4,this.powerOversteerStrength=e.powerOversteerStrength||1.2,this.frontGripAdvantage=e.frontGripAdvantage||.15,this.driftRecoveryRate=e.driftRecoveryRate||3,this.velocityDriftFactor=e.velocityDriftFactor||.7,this.tractionControlEnabled=void 0===e.tractionControlEnabled||e.tractionControlEnabled,this.tractionControlStrength=e.tractionControlStrength||.6,this.absEnabled=void 0===e.absEnabled||e.absEnabled,this.absStrength=e.absStrength||.8,this.showDebugInfo=e.showDebugInfo||!1,this.showWheelDirection=void 0===e.showWheelDirection||e.showWheelDirection,this.showDriftInfo=void 0===e.showDriftInfo||e.showDriftInfo,this.upKey=e.upKey||"arrowup",this.downKey=e.downKey||"arrowdown",this.leftKey=e.leftKey||"arrowleft",this.rightKey=e.rightKey||"arrowright",this.handbrakeKey=e.handbrakeKey||" ",this.tireMarkOpacity=void 0!==e.tireMarkOpacity?e.tireMarkOpacity:.5,this.tireMarkScale=e.tireMarkScale||1,this.tireMarkLifetime=e.tireMarkLifetime||8e3,this.tireMarkDistanceApart=e.tireMarkDistanceApart||12,this.tireMarkEnabled=void 0===e.tireMarkEnabled||e.tireMarkEnabled,this.tireMarkOffsetX=e.tireMarkOffsetX||0,this.tireMarkOffsetY=e.tireMarkOffsetY||0,this.tireMarkLength=e.tireMarkLength||32,this.minMarkSpacing=e.minMarkSpacing||32,this.gtaStyleVehicle=!1,this.enterKey=e.enterKey||"enter",this.enterDistance=e.enterDistance||80,this.hidePlayerWhenInside=void 0===e.hidePlayerWhenInside||e.hidePlayerWhenInside,this.showEnterPrompt=void 0===e.showEnterPrompt||e.showEnterPrompt,this.ejectOnDestroy=void 0===e.ejectOnDestroy||e.ejectOnDestroy)}}window.VehiclePhysics=VehiclePhysics;class PlatformControllerMatter extends Module{static allowMultiple=!1;static namespace="Matter.js";static description="Controllable 2D platform character with jumping and movement for Matter.js";static iconClass="fas fa-user";constructor(){super("PlatformControllerMatter"),this.playerControlled=!0,this.leftKey="arrowleft",this.rightKey="arrowright",this.jumpKey="arrowup",this.moveSpeed=200,this.jumpForce=400,this.airControl=.7,this.groundFriction=.8,this.airFriction=.02,this.maxJumpTime=.3,this.coyoteTime=.15,this.jumpBufferTime=.15,this.maxWalkableAngle=45,this.slideAngle=60,this.slideForce=150,this.slopeSnapForce=300,this.groundDetectionDistance=10,this.groundDetectionWidth=.8,this.isGrounded=!1,this.isJumping=!1,this.jumpTime=0,this.coyoteTimer=0,this.jumpBufferTimer=0,this.facingDirection=1,this.groundNormal={x:0,y:-1},this.groundAngle=0,this.isOnSlope=!1,this.canWalkOnSlope=!0,this.shouldSlide=!1,this.rigidBody=null,this.moveInput=0,this.showDebugInfo=!1,this.require("RigidBody"),this.exposeProperty("playerControlled","boolean",this.playerControlled,{description:"Can be controlled with arrow keys",onChange:e=>{this.playerControlled=e}}),this.exposeProperty("moveSpeed","number",this.moveSpeed,{description:"Horizontal movement speed",min:50,max:1e3,step:10,onChange:e=>{this.moveSpeed=e}}),this.exposeProperty("jumpForce","number",this.jumpForce,{description:"Jump force",min:100,max:1e3,step:10,onChange:e=>{this.jumpForce=e}}),this.exposeProperty("airControl","number",this.airControl,{description:"Air control multiplier",min:0,max:1,step:.1,onChange:e=>{this.airControl=e}}),this.exposeProperty("maxWalkableAngle","number",this.maxWalkableAngle,{description:"Maximum walkable slope angle (degrees)",min:0,max:90,step:5,onChange:e=>{this.maxWalkableAngle=e}}),this.exposeProperty("slideAngle","number",this.slideAngle,{description:"Angle where sliding starts (degrees)",min:0,max:90,step:5,onChange:e=>{this.slideAngle=e}}),this.exposeProperty("slopeSnapForce","number",this.slopeSnapForce,{description:"Force to snap character to ground on slopes",min:0,max:1e3,step:50,onChange:e=>{this.slopeSnapForce=e}}),this.exposeProperty("showDebugInfo","boolean",this.showDebugInfo,{description:"Show debug information",onChange:e=>{this.showDebugInfo=e}})}start(){this.rigidBody=this.gameObject.getModule("RigidBody"),this.rigidBody?(this.rigidBody.useGravity=!0,this.rigidBody.bodyType="dynamic",this.rigidBody.friction=this.groundFriction,this.rigidBody.frictionAir=this.airFriction,this.rigidBody.density=1,this.rigidBody.fixedRotation=!0,this.jumpBufferTimer=0,this.coyoteTimer=0,console.log(this.playerControlled?"Player-controlled character initialized.":"AI-controlled character initialized.")):console.error("PlatformCharacter requires a RigidBody component on the same GameObject!")}loop(e){this.rigidBody&&this.rigidBody.body&&(this.coyoteTimer=Math.max(0,this.coyoteTimer-e),this.jumpBufferTimer=Math.max(0,this.jumpBufferTimer-e),this.checkGrounded(),this.handleInput(e),this.applySlopeEffects(e),this.applyMovement(e),this.applyJumping(e),this.applySlopeSnapping(e))}checkGrounded(){if(!this.rigidBody||!this.rigidBody.body)return;const e=this.gameObject.position,t=this.rigidBody.width||32,i=this.rigidBody.height||32,s=e.y+.5*i-1,o=t*this.groundDetectionWidth*.5,n=[new Vector2(e.x,s),new Vector2(e.x-o,s),new Vector2(e.x+o,s)],r=new Vector2(0,1),a=this.groundDetectionDistance,l=this._getRaycastObjects(),h=[];for(const e of n){const t=window.Raycast.castAll(e,r,a,l,65535,this.gameObject);t&&h.push(t)}const c=this.rigidBody.getVelocity();if(this.isGrounded,h.length>0){h.sort((e,t)=>e.distance-t.distance);const e=h[0].distance;let t=0,i=0;for(const e of h)t+=e.normal.x,i+=e.normal.y;const s=Math.hypot(t,i)||1,o={x:t/s,y:i/s};this.groundNormal=o,this.groundAngle=Math.acos(Math.abs(o.y))*(180/Math.PI),this.isOnSlope=this.groundAngle>2,this.canWalkOnSlope=this.groundAngle<=this.maxWalkableAngle,this.shouldSlide=this.groundAngle>this.slideAngle;const n=1;this.isGrounded=e<=this.groundDetectionDistance+n&&c.y>=-100}else this.isGrounded=!1,this.isOnSlope=!1,this.canWalkOnSlope=!0,this.shouldSlide=!1,this.groundNormal={x:0,y:-1},this.groundAngle=0;if(this.rigidBody&&this.rigidBody.body)if(this.isGrounded)if(15>this.groundAngle)this.rigidBody.body.friction=.1;else if(this.groundAngle<this.maxWalkableAngle){const e=(this.groundAngle-15)/(this.maxWalkableAngle-15);this.rigidBody.body.friction=.1+(this.groundFriction-.1)*e}else this.rigidBody.body.friction=this.groundFriction;else this.rigidBody.body.friction=this.airFriction;this.isGrounded&&(this.coyoteTimer=this.coyoteTime,this.isJumping&&c.y>=-50&&(this.isJumping=!1,this.jumpTime=0))}_getRaycastObjects(){return window.engine&&window.engine.gameObjects?window.engine.gameObjects:window.scene&&window.scene.gameObjects?window.scene.gameObjects:[]}raycastGround(e,t){e.x;const i=e.y+t,s=Matter.Composite.allBodies(this.rigidBody.engine.world);for(const t of s)if(t!==this.rigidBody.body&&!(e.x<t.bounds.min.x||e.x>t.bounds.max.x||i<t.bounds.min.y||e.y>t.bounds.max.y)){const i=.5*(t.bounds.min.x+t.bounds.max.x),s=.5*(t.bounds.min.y+t.bounds.max.y),o=e.x-i,n=e.y-s,r=Math.sqrt(o*o+n*n);return{hit:!0,normal:r>0?{x:o/r,y:n/r}:{x:0,y:-1}}}return{hit:!1,normal:{x:0,y:-1}}}handleInput(e){this.playerControlled&&(this.moveInput=0,window.input&&window.input.keyDown&&(window.input.keyDown(this.leftKey)&&(this.moveInput=-1,this.facingDirection=-1),window.input.keyDown(this.rightKey)&&(this.moveInput=1,this.facingDirection=1),window.input.keyPressed&&window.input.keyPressed(this.jumpKey)&&(this.jumpBufferTimer=this.jumpBufferTime)))}applySlopeEffects(e){if(this.isGrounded&&(this.rigidBody.getVelocity(),this.shouldSlide&&(Math.abs(this.moveInput)>0&&(this.moveInput>0&&0>this.groundNormal.x||0>this.moveInput&&this.groundNormal.x>0)&&(this.moveInput*=.1),.1>Math.abs(this.moveInput)||!this.canWalkOnSlope))){const t=this.groundNormal.x>0?-1:1,i=(this.groundAngle-this.slideAngle)/30,s=this.slideForce*Math.min(1,i);this.rigidBody.applyForce({x:t*s*e,y:0})}}applyMovement(e){const t=this.rigidBody.getVelocity();let i=this.moveInput*this.moveSpeed;if(this.isGrounded&&this.isOnSlope&&this.canWalkOnSlope)if(15>this.groundAngle)i=this.moveInput*this.moveSpeed;else{i=new Vector2(-this.groundNormal.y,this.groundNormal.x).multiply(this.moveInput).magnitude()*this.moveSpeed*Math.sign(this.moveInput);const e=1-this.groundAngle/this.maxWalkableAngle*.3;i*=Math.max(.7,e)}this.isGrounded&&!this.canWalkOnSlope&&(this.moveInput>0&&0>this.groundNormal.x||0>this.moveInput&&this.groundNormal.x>0)&&(i*=.1),this.isGrounded||(i*=this.airControl);let s=(i-t.x)*(this.isGrounded?2e3:800)*e;const o=this.moveSpeed*(this.isGrounded?5:3);s=Math.max(-o,Math.min(o,s)),Math.abs(s)>1&&this.rigidBody.applyForce({x:s,y:0})}applyJumping(e){if(this.jumpBufferTimer>0&&(this.isGrounded||this.coyoteTimer>0)&&!this.isJumping&&this.startJump(),this.isJumping&&this.jumpTime<this.maxJumpTime)if(window.input&&window.input.keyDown&&window.input.keyDown(this.jumpKey)){this.jumpTime+=e;const t=.3*this.jumpForce*e;this.rigidBody.applyForce({x:0,y:-t})}else this.isJumping=!1;this.jumpTime<this.maxJumpTime||(this.isJumping=!1)}applySlopeSnapping(e){if(!this.isGrounded||!this.isOnSlope||.1>Math.abs(this.moveInput)||this.isJumping)return;const t=this.rigidBody.getVelocity();if((this.moveInput>0&&this.groundNormal.x>0||0>this.moveInput&&0>this.groundNormal.x)&&t.y>0){const t=this.slopeSnapForce*e*(this.groundAngle/45);this.rigidBody.applyForce({x:0,y:t})}}startJump(){this.isJumping=!0,this.jumpTime=0,this.jumpBufferTimer=0,this.coyoteTimer=0;const e=this.groundNormal.x,t=this.groundNormal.y;this.rigidBody.applyImpulse({x:e*this.jumpForce*.05,y:t*this.jumpForce*.8})}draw(e){if(!this.showDebugInfo&&!this.rigidBody)return;e.save(),e.fillStyle="white",e.strokeStyle="yellow",e.font="10px Arial",e.textAlign="left";const t=this.rigidBody.getVelocity(),i=Math.round(Math.sqrt(t.x*t.x+t.y*t.y));let s=-80;e.fillText(`Speed: ${i}px/s`,20,0+s),s+=12,e.fillText("Grounded: "+this.isGrounded,20,0+s),s+=12,e.fillText("Jumping: "+this.isJumping,20,0+s),s+=12,e.fillText(`Slope: ${this.groundAngle.toFixed(1)}\xb0`,20,0+s),s+=12,e.fillText("Can Walk: "+this.canWalkOnSlope,20,0+s),s+=12,e.fillText("Should Slide: "+this.shouldSlide,20,0+s),s+=12,e.fillText("Coyote: "+this.coyoteTimer.toFixed(2),20,0+s),s+=12,e.fillText("Buffer: "+this.jumpBufferTimer.toFixed(2),20,0+s),this.isGrounded&&(e.strokeStyle=this.canWalkOnSlope?"green":"red",e.beginPath(),e.moveTo(0,0),e.lineTo(0+40*this.groundNormal.x,0+40*this.groundNormal.y),e.stroke()),e.strokeStyle=this.isGrounded?"lime":"red",e.lineWidth=2;const o=this.rigidBody.width||32,n=this.rigidBody.height||32;e.strokeRect(0-.4*o,0+.3*n,.8*o,this.groundDetectionDistance),e.restore()}calculateContactNormal(e,t){if(e.normal)return e.normal;const i=this.gameObject.getModule("Transform");if(!i)return{x:0,y:-1};const s=i.position,o=t.position.x,n=t.position.y,r=s.x-o,a=s.y-n,l=Math.sqrt(r*r+a*a);return l>0?{x:r/l,y:a/l}:{x:0,y:-1}}moveLeft(){this.moveInput=-1,this.facingDirection=-1}moveRight(){this.moveInput=1,this.facingDirection=1}stopMoving(){this.moveInput=0}jump(){this.jumpBufferTimer=this.jumpBufferTime}getIsGrounded(){return this.isGrounded}getFacingDirection(){return this.facingDirection}getGroundAngle(){return this.groundAngle}canWalkOnCurrentSlope(){return this.canWalkOnSlope}toJSON(){return{...super.toJSON(),playerControlled:this.playerControlled,moveSpeed:this.moveSpeed,jumpForce:this.jumpForce,airControl:this.airControl,groundFriction:this.groundFriction,airFriction:this.airFriction,maxJumpTime:this.maxJumpTime,coyoteTime:this.coyoteTime,jumpBufferTime:this.jumpBufferTime,maxWalkableAngle:this.maxWalkableAngle,slideAngle:this.slideAngle,slideForce:this.slideForce,groundDetectionDistance:this.groundDetectionDistance,groundDetectionWidth:this.groundDetectionWidth,showDebugInfo:this.showDebugInfo,leftKey:this.leftKey,rightKey:this.rightKey,jumpKey:this.jumpKey}}fromJSON(e){super.fromJSON(e),e&&(this.playerControlled=void 0===e.playerControlled||e.playerControlled,this.moveSpeed=e.moveSpeed||200,this.jumpForce=e.jumpForce||400,this.airControl=e.airControl||.7,this.groundFriction=e.groundFriction||.8,this.airFriction=e.airFriction||.02,this.maxJumpTime=e.maxJumpTime||.3,this.coyoteTime=e.coyoteTime||.15,this.jumpBufferTime=e.jumpBufferTime||.15,this.maxWalkableAngle=e.maxWalkableAngle||45,this.slideAngle=e.slideAngle||60,this.slideForce=e.slideForce||150,this.groundDetectionDistance=e.groundDetectionDistance||5,this.groundDetectionWidth=e.groundDetectionWidth||.8,this.showDebugInfo=e.showDebugInfo||!1,this.leftKey=e.leftKey||"arrowleft",this.rightKey=e.rightKey||"arrowright",this.jumpKey=e.jumpKey||"arrowup")}}window.PlatformControllerMatter=PlatformControllerMatter;class BasicPhysics extends Module{static namespace="Movement";static description="General physics module with collision, forces, layers, gravity, and collider support";static allowMultiple=!1;constructor(){super("BasicPhysics"),this.mass=1,this.velocity={x:0,y:0},this.gravity={x:0,y:0},this.angularVelocity=0,this.friction=.98,this.angularFriction=.95,this.bounciness=.7,this.contactFriction=.8,this.fixedPosition=!1,this.fixedRotation=!1,this.physicsLayer=0,this.useCollision=!1,this.colliderType="rectangle",this.polygonVertices=[],this.polygon=null,this.colliderRadius=10,this.colliderWidth=20,this.colliderHeight=20,this.gravityEnabled=!1,this.gravityMassAffectsOthers=!1,this.gravityPullRadius=0,this.drawColliderGizmo=!0,this.drawColliderInGame=!1,this.lastCollision=null,this.forces={x:0,y:0},this.exposeProperty("mass","number",1,{min:.1,max:100,step:.1,description:"Mass of the object",onChange:e=>{this.mass=Math.max(.1,e)}}),this.exposeProperty("gravity","vector2",this.gravity,{description:"Gravity force applied every frame (Vector2)",onChange:e=>{this.gravity=e}}),this.exposeProperty("fixedPosition","boolean",!1,{description:"If true, object does not move or rotate",onChange:e=>{this.fixedPosition=e}}),this.exposeProperty("fixedRotation","boolean",!1,{description:"If true, object does not rotate",onChange:e=>{this.fixedRotation=e}}),this.exposeProperty("useCollision","boolean",!0,{description:"Enable/disable collision detection",onChange:e=>{this.useCollision=e}}),this.exposeProperty("physicsLayer","number",0,{min:0,max:10,step:1,description:"Physics layer for collision filtering",onChange:e=>{this.physicsLayer=Math.max(0,e)}}),this.exposeProperty("colliderType","select","circle",{options:["circle","rectangle"],description:"Collider shape type",onChange:e=>{this.colliderType=e}}),this.exposeProperty("colliderRadius","number",10,{min:1,max:1e3,step:1,description:"Collider radius (for circle)",onChange:e=>{this.colliderRadius=Math.max(1,e)}}),this.exposeProperty("colliderWidth","number",20,{min:1,max:1e3,step:1,description:"Collider width (for rectangle)",onChange:e=>{this.colliderWidth=Math.max(1,e)}}),this.exposeProperty("colliderHeight","number",20,{min:1,max:1e3,step:1,description:"Collider height (for rectangle)",onChange:e=>{this.colliderHeight=Math.max(1,e)}}),this.exposeProperty("bounciness","number",.7,{min:0,max:1,step:.01,description:"Bounciness (restitution) on collision",onChange:e=>{this.bounciness=Math.max(0,Math.min(1,e))}}),this.exposeProperty("contactFriction","number",.8,{min:0,max:1,step:.01,description:"Friction applied on contact",onChange:e=>{this.contactFriction=Math.max(0,Math.min(1,e))}}),this.exposeProperty("gravityEnabled","boolean",!1,{description:"Enable gravity for this object",onChange:e=>{this.gravityEnabled=e}}),this.exposeProperty("gravityMassAffectsOthers","boolean",!1,{description:"If true, object's mass affects gravity pull on others",onChange:e=>{this.gravityMassAffectsOthers=e}}),this.exposeProperty("gravityPullRadius","number",0,{min:0,max:1e3,step:1,description:"Radius within which this object pulls others gravitationally",onChange:e=>{this.gravityPullRadius=Math.max(0,e)}}),this.exposeProperty("drawColliderGizmo","boolean",!0,{description:"Draw collider gizmo in editor",onChange:e=>{this.drawColliderGizmo=e}}),this.exposeProperty("drawColliderInGame","boolean",!1,{description:"Draw collider shape in game",onChange:e=>{this.drawColliderInGame=e}})}style(e){e.startGroup("Physics Properties",!1,{backgroundColor:"rgba(100,150,255,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("mass","number",this.mass,{min:.1,max:100,step:.1,description:"Mass of the object",label:"Mass"}),e.exposeProperty("gravityEnabled","boolean",this.gravityEnabled,{description:"Enable gravity for this object",label:"Gravity Enabled"}),this.gravityEnabled&&e.exposeProperty("gravity","vector2",this.gravity,{description:"Gravity force applied every frame (Vector2)",label:"Gravity Vector"}),e.exposeProperty("fixedPosition","boolean",this.fixedPosition,{description:"If true, object does not move or rotate",label:"Fixed Position"}),e.exposeProperty("fixedRotation","boolean",this.fixedRotation,{description:"If true, object does not rotate",label:"Fixed Rotation"}),e.exposeProperty("friction","number",this.friction,{min:0,max:1,step:.01,description:"Linear friction applied to velocity",label:"Friction"}),e.exposeProperty("angularFriction","number",this.angularFriction,{min:0,max:1,step:.01,description:"Angular friction applied to rotation",label:"Angular Friction"}),e.endGroup(),e.addDivider(),e.startGroup("Collision Properties",!1,{backgroundColor:"rgba(255,200,100,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("useCollision","boolean",this.useCollision,{description:"Enable/disable collision detection",label:"Use Collision"}),this.useCollision&&(e.exposeProperty("physicsLayer","number",this.physicsLayer,{min:0,max:10,step:1,description:"Physics layer for collision filtering",label:"Physics Layer"}),e.exposeProperty("colliderType","select",this.colliderType,{options:["circle","rectangle"],description:"Collider shape type",label:"Collider Type"}),"circle"===this.colliderType?e.exposeProperty("colliderRadius","number",this.colliderRadius,{min:1,max:1e3,step:1,description:"Collider radius (for circle)",label:"Collider Radius"}):"rectangle"===this.colliderType&&(e.exposeProperty("colliderWidth","number",this.colliderWidth,{min:1,max:1e3,step:1,description:"Collider width (for rectangle)",label:"Collider Width"}),e.exposeProperty("colliderHeight","number",this.colliderHeight,{min:1,max:1e3,step:1,description:"Collider height (for rectangle)",label:"Collider Height"})),e.exposeProperty("bounciness","number",this.bounciness,{min:0,max:1,step:.01,description:"Bounciness (restitution) on collision",label:"Bounciness"}),e.exposeProperty("contactFriction","number",this.contactFriction,{min:0,max:1,step:.01,description:"Friction applied on contact",label:"Contact Friction"}),e.exposeProperty("drawColliderGizmo","boolean",this.drawColliderGizmo,{description:"Draw collider gizmo in editor",label:"Draw Collider Gizmo"}),e.exposeProperty("drawColliderInGame","boolean",this.drawColliderInGame,{description:"Draw collider shape in game",label:"Draw Collider In Game"})),e.endGroup(),e.addDivider(),e.startGroup("Gravity Pull Properties",!1,{backgroundColor:"rgba(100,255,150,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("gravityMassAffectsOthers","boolean",this.gravityMassAffectsOthers,{description:"If true, object's mass affects gravity pull on others",label:"Gravity Mass Affects Others"}),e.exposeProperty("gravityPullRadius","number",this.gravityPullRadius,{min:0,max:1e3,step:1,description:"Radius within which this object pulls others gravitationally",label:"Gravity Pull Radius"}),e.endGroup()}addForce(e,t){this.fixedPosition||(this.forces.x+=e,this.forces.y+=t)}setVelocity(e,t){this.fixedPosition||(this.velocity.x=e,this.velocity.y=t)}setAngularVelocity(e){this.fixedPosition||this.fixedRotation||(this.angularVelocity=e)}setGravity(e,t){this.fixedPosition||(this.gravity.x=e,this.gravity.y=t)}getSpeed(){return Math.sqrt(this.velocity.x*this.velocity.x+this.velocity.y*this.velocity.y)}loop(e){if(this.gravityEnabled&&this.gravity&&!this.fixedPosition&&(this.velocity.x+=this.gravity.x*e,this.velocity.y+=this.gravity.y*e),this.gravityPullRadius>0&&window.engine&&window.engine.gameObjects)for(const t of window.engine.gameObjects){if(t===this.gameObject)continue;const i=t.getModule("BasicPhysics");if(!i||!i.gravityEnabled)continue;if(i.physicsLayer!==this.physicsLayer)continue;const s=t.position.x-this.gameObject.position.x,o=t.position.y-this.gameObject.position.y,n=Math.sqrt(s*s+o*o);if(n>0&&n<this.gravityPullRadius){const t=.1*this.mass*i.mass/(n*n),r=s/n*t,a=o/n*t;this.velocity.x+=r/this.mass*e,this.velocity.y+=a/this.mass*e,i.gravityMassAffectsOthers&&(i.velocity.x-=r/i.mass*e,i.velocity.y-=a/i.mass*e)}}for(this.velocity.x*=this.friction,this.velocity.y*=this.friction,this.angularVelocity*=this.angularFriction,this.fixedPosition||(this.gameObject.position.x+=this.velocity.x*e,this.gameObject.position.y+=this.velocity.y*e),this.fixedRotation||(this.gameObject.angle+=this.angularVelocity*e);this.gameObject.angle>=360;)this.gameObject.angle-=360;for(;0>this.gameObject.angle;)this.gameObject.angle+=360;this.useCollision&&this.handleCollisions(e)}drawGizmos(e){if(this.drawColliderGizmo){if(e.save(),e.globalAlpha=.5,e.strokeStyle="#40df31ff",e.lineWidth=2,"circle"===this.colliderType)e.beginPath(),e.arc(this.gameObject.position.x,this.gameObject.position.y,this.colliderRadius,0,2*Math.PI),e.stroke();else if("rectangle"===this.colliderType){const t=this.getRectangleCorners(this.gameObject.position,{width:this.colliderWidth,height:this.colliderHeight},this.gameObject.angle);e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let i=1;i<t.length;i++)e.lineTo(t[i].x,t[i].y);e.closePath(),e.stroke()}e.restore()}}draw(e){if(this.drawColliderInGame){if(e.save(),e.globalAlpha=.3,e.strokeStyle="#ff8800",e.lineWidth=2,"circle"===this.colliderType)e.beginPath(),e.arc(this.gameObject.position.x,this.gameObject.position.y,this.colliderRadius,0,2*Math.PI),e.stroke();else if("rectangle"===this.colliderType){const t=this.getRectangleCorners(this.gameObject.position,{width:this.colliderWidth,height:this.colliderHeight},this.gameObject.angle);e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let i=1;i<t.length;i++)e.lineTo(t[i].x,t[i].y);e.closePath(),e.stroke()}e.restore()}}handleCollisions(e){if(window.engine&&window.engine.gameObjects)for(const t of window.engine.gameObjects){if(t===this.gameObject)continue;const i=t.getModule("BasicPhysics");i&&i.useCollision&&i.physicsLayer===this.physicsLayer&&("circle"===this.colliderType&&"circle"===i.colliderType?this.handleCircleCollision(t,i,e):"rectangle"===this.colliderType&&"rectangle"===i.colliderType?this.handleRectangleCollision(t,i,e):this.handleCircleRectangleCollision(t,i,e))}}handleCircleRectangleCollision(e,t,i){let s,o,n,r,a,l;if("circle"===this.colliderType){s=this.gameObject.position,o=this,a=this.gameObject,n=e.position,r=t,l=e;var h=t.colliderWidth,c=t.colliderHeight,d=e.angle,p=this.colliderRadius}else s=e.position,o=t,a=e,n=this.gameObject.position,r=this,l=this.gameObject,h=this.colliderWidth,c=this.colliderHeight,d=this.gameObject.angle,p=t.colliderRadius;const u=this.getRectangleCorners(n,{width:h,height:c},d),g=this.pointInPolygon(s,u);let m={x:0,y:0},f=1/0;if(g)for(let e=0;e<u.length;e++){const t=u[e],i=u[(e+1)%u.length],o=this.closestPointOnLineSegment(s,t,i),n=Math.sqrt((s.x-o.x)**2+(s.y-o.y)**2);f>n&&(f=n,m=o)}else for(let e=0;e<u.length;e++){const t=u[e],i=u[(e+1)%u.length],o=this.closestPointOnLineSegment(s,t,i),n=Math.sqrt((s.x-o.x)**2+(s.y-o.y)**2);f>n&&(f=n,m=o)}const y=Math.sqrt((s.x-m.x)**2+(s.y-m.y)**2);if(g&&p>y||!g&&p>=y){let e,t;0===y?(e=1,t=0):(e=(s.x-m.x)/y,t=(s.y-m.y)/y);const i=p-y;this.resolveCollision(o,r,a,l,e,t,m.x,m.y,Math.abs(i))}}handleCircleCollision(e,t,i){const s=e.position.x-this.gameObject.position.x,o=e.position.y-this.gameObject.position.y,n=Math.sqrt(s*s+o*o),r=this.colliderRadius,a=r+t.colliderRadius;if(n>0&&a>n){const i=s/n,l=o/n,h=this.gameObject.position.x+i*r,c=this.gameObject.position.y+l*r,d=a-n;this.resolveCollision(this,t,this.gameObject,e,i,l,h,c,d)}}handleRectangleCollision(e,t,i){const s=this.getRectangleCorners(this.gameObject.position,{width:this.colliderWidth,height:this.colliderHeight},this.gameObject.angle),o=this.getRectangleCorners(e.position,{width:t.colliderWidth,height:t.colliderHeight},e.angle),n=this.getRectangleCollisionInfo(s,o);n.intersecting&&this.resolveCollision(this,t,this.gameObject,e,n.normal.x,n.normal.y,n.contactPoint.x,n.contactPoint.y,n.penetration)}closestPointOnLineSegment(e,t,i){const s=i.x-t.x,o=i.y-t.y,n=s*s+o*o;if(0===n)return{x:t.x,y:t.y};const r=Math.max(0,Math.min(1,((e.x-t.x)*s+(e.y-t.y)*o)/n));return{x:t.x+r*s,y:t.y+r*o}}resolveCollision(e,t,i,s,o,n,r,a,l){const h=e.fixedPosition,c=t.fixedPosition;if(h&&!c){s.position.x+=o*l,s.position.y+=n*l;const e=t.velocity.x*o+t.velocity.y*n;return t.velocity.x-=e*o,void(t.velocity.y-=e*n)}if(!h&&c){i.position.x-=o*l,i.position.y-=n*l;const t=e.velocity.x*o+e.velocity.y*n;return e.velocity.x-=t*o,void(e.velocity.y-=t*n)}const d=r-i.position.x,p=a-i.position.y,u=r-s.position.x,g=a-s.position.y,m={x:e.velocity.x-e.angularVelocity*p,y:e.velocity.y+e.angularVelocity*d},f={x:t.velocity.x-t.angularVelocity*g,y:t.velocity.y+t.angularVelocity*u};m.x+=e.gravity.x,m.y+=e.gravity.y,f.x+=t.gravity.x,f.y+=t.gravity.y;const y=(f.x-m.x)*o+(f.y-m.y)*n;if(y>0)return;const w=Math.min(e.contactFriction,t.contactFriction),b=Math.sqrt(e.gravity.x**2+e.gravity.y**2),x=-1*y/(1/e.mass+1/t.mass)+0*b,v=x*o,M=x*n;if(e.fixedPosition||(e.velocity.x-=v/e.mass,e.velocity.y-=M/e.mass,e.velocity.x*=w,e.velocity.y*=w),t.fixedPosition||(t.velocity.x+=v/t.mass,t.velocity.y+=M/t.mass,t.velocity.x*=w,t.velocity.y*=w),!e.fixedPosition){const t=this.getMomentOfInertia(e),i=d*-M-p*-v;e.angularVelocity+=i/t*(1+.1*b)}if(!t.fixedPosition){const e=this.getMomentOfInertia(t),i=u*M-g*v;t.angularVelocity+=i/e*(1+.1*b)}const C=e.mass+t.mass,_=t.mass/C,P=e.mass/C;e.fixedPosition||t.fixedPosition?e.fixedPosition?t.fixedPosition||(s.position.x+=o*l,s.position.y+=n*l):(i.position.x-=o*l,i.position.y-=n*l):(i.position.x-=o*l*_,i.position.y-=n*l*_,s.position.x+=o*l*P,s.position.y+=n*l*P)}getMomentOfInertia(e){if("circle"===e.colliderType)return.5*e.mass*e.colliderRadius*e.colliderRadius;{const t=e.colliderWidth,i=e.colliderHeight;return e.mass*(t*t+i*i)/12}}getRectangleCollisionInfo(e,t){const i=[this.getEdgeAxis(e,0),this.getEdgeAxis(e,1),this.getEdgeAxis(t,0),this.getEdgeAxis(t,1)];let s=1/0,o=null;for(const n of i){const[i,r]=this.projectPolygon(e,n),[a,l]=this.projectPolygon(t,n);if(a>r||i>l)return{intersecting:!1};const h=Math.min(r-a,l-i);s>h&&(s=h,o=n)}return{intersecting:!0,penetration:s,normal:o,contactPoint:this.getContactPoint(e,t)}}getRectangleCorners(e,t,i){const s=(t.width||20)/2,o=(t.height||20)/2,n=(i||0)*Math.PI/180;return[{x:-s,y:-o},{x:s,y:-o},{x:s,y:o},{x:-s,y:o}].map(t=>({x:e.x+t.x*Math.cos(n)-t.y*Math.sin(n),y:e.y+t.x*Math.sin(n)+t.y*Math.cos(n)}))}getEdgeAxis(e,t){const i=e[t],s=e[(t+1)%e.length],o=s.x-i.x,n=s.y-i.y,r=Math.sqrt(o*o+n*n);return{x:-n/r,y:o/r}}projectPolygon(e,t){let i=e[0].x*t.x+e[0].y*t.y,s=i;for(let o=1;o<e.length;o++){const n=e[o].x*t.x+e[o].y*t.y;i>n&&(i=n),n>s&&(s=n)}return[i,s]}getContactPoint(e,t){const i=[];for(const s of e)this.pointInPolygon(s,t)&&i.push(s);for(const s of t)this.pointInPolygon(s,e)&&i.push(s);if(0===i.length)return{x:(this.getCentroid(e).x+this.getCentroid(t).x)/2,y:(this.getCentroid(e).y+this.getCentroid(t).y)/2};const s=i.reduce((e,t)=>({x:e.x+t.x,y:e.y+t.y}),{x:0,y:0});return{x:s.x/i.length,y:s.y/i.length}}getCentroid(e){const t=e.reduce((e,t)=>({x:e.x+t.x,y:e.y+t.y}),{x:0,y:0});return{x:t.x/e.length,y:t.y/e.length}}pointInPolygon(e,t){let i=!1;for(let s=0,o=t.length-1;s<t.length;o=s++){const n=t[s].x,r=t[s].y,a=t[o].x,l=t[o].y;r>e.y!=l>e.y&&e.x<(a-n)*(e.y-r)/(l-r+1e-5)+n&&(i=!i)}return i}toJSON(){return{...super.toJSON(),mass:this.mass,velocity:this.velocity,angularVelocity:this.angularVelocity,friction:this.friction,angularFriction:this.angularFriction,bounciness:this.bounciness,contactFriction:this.contactFriction,fixedPosition:this.fixedPosition,physicsLayer:this.physicsLayer,colliderType:this.colliderType,colliderRadius:this.colliderRadius,colliderWidth:this.colliderWidth,colliderHeight:this.colliderHeight,gravityEnabled:this.gravityEnabled,gravityMassAffectsOthers:this.gravityMassAffectsOthers,gravityPullRadius:this.gravityPullRadius,gravity:this.gravity}}fromJSON(e){super.fromJSON(e),e&&(this.mass=e.mass??1,this.velocity=e.velocity?{x:e.velocity.x??0,y:e.velocity.y??0}:{x:0,y:0},this.gravity=e.gravity?{x:e.gravity.x??0,y:e.gravity.y??0}:{x:0,y:0},this.angularVelocity=e.angularVelocity??0,this.friction=e.friction??.98,this.angularFriction=e.angularFriction??.95,this.bounciness=e.bounciness??.7,this.contactFriction=e.contactFriction??.8,this.fixedPosition=e.fixedPosition??!1,this.physicsLayer=e.physicsLayer??0,this.colliderType=e.colliderType??"circle",this.colliderRadius=e.colliderRadius??10,this.colliderWidth=e.colliderWidth??20,this.colliderHeight=e.colliderHeight??20,this.gravityEnabled=e.gravityEnabled??!1,this.gravityMassAffectsOthers=e.gravityMassAffectsOthers??!1,this.gravityPullRadius=e.gravityPullRadius??0,this.drawColliderGizmo=void 0===e.drawColliderGizmo||e.drawColliderGizmo,this.drawColliderInGame=void 0!==e.drawColliderInGame&&e.drawColliderInGame,this.lastCollision=null,this.forces={x:0,y:0})}}window.BasicPhysics=BasicPhysics;class PhysicsKeyboardController extends Module{static allowMultiple=!1;static namespace="Movement";static description="Controls GameObject position using keyboard input";static iconClass="fas fa-keyboard";constructor(){super("PhysicsKeyboardController"),this.customDrawingModule="",this.speed=200,this.useAcceleration=!0,this.acceleration=.15,this.deceleration=.1,this.rotationSpeed=180,this.moveMode="direct",this.allowDiagonalMovement=!0,this.platformerMode=!1,this.jumpKey="space",this.jumpForce=400,this.isJumping=!1,this.grounded=!1,this.animIdle="idle",this.animWalk="walk",this.upKey=window.input.keys.up||"arrowup",this.downKey="arrowdown",this.leftKey="arrowleft",this.rightKey="arrowright",this.actionKey=" ",this.rotateLeftKey="q",this.rotateRightKey="e",this.velocity=new Vector2(0,0),this.setupProperties()}setupProperties(){this.exposeProperty("customDrawingModule","string",this.customDrawingModule,{description:"Custom drawing module for animations",style:{header:"Custom Drawing Module",label:"Drawing Module"},onChange:e=>{this.customDrawingModule=e}}),this.exposeProperty("animIdle","string",this.animIdle,{description:"Animation state for idle",style:{label:"Idle Animation"},onChange:e=>{this.animIdle=e}}),this.exposeProperty("animWalk","string",this.animWalk,{description:"Animation state for walking",style:{label:"Walk Animation"},onChange:e=>{this.animWalk=e}}),this.exposeProperty("speed","number",this.speed,{description:"Movement speed in pixels per second",min:0,max:1e3,step:10,style:{header:"Movement Settings",label:"Movement Speed",slider:!0},onChange:e=>{this.speed=e}}),this.exposeProperty("moveMode","enum",this.moveMode,{description:"Movement style",options:["direct","rotate-and-move"],style:{label:"Movement Style"},onChange:e=>{this.moveMode=e}}),this.exposeProperty("allowDiagonalMovement","boolean",this.allowDiagonalMovement,{description:"Allow movement in diagonal directions",style:{label:"Allow Diagonals"},onChange:e=>{this.allowDiagonalMovement=e}}),this.exposeProperty("platformerMode","boolean",this.platformerMode,{description:"Enable platformer physics (gravity, jump, horizontal movement)",style:{header:"Platformer Settings",label:"Platformer Mode"},onChange:e=>{this.platformerMode=e}}),this.exposeProperty("jumpKey","string",this.jumpKey,{description:"Key for jumping (platformer mode)",style:{label:"Jump Key"},onChange:e=>{this.jumpKey=e}}),this.exposeProperty("jumpForce","number",this.jumpForce,{description:"Jump force (platformer mode)",min:50,max:2e3,step:10,style:{label:"Jump Force",slider:!0},onChange:e=>{this.jumpForce=e}}),this.exposeProperty("useAcceleration","boolean",this.useAcceleration,{description:"Enable smooth acceleration/deceleration",style:{label:"Use Acceleration"},onChange:e=>{this.useAcceleration=e}}),this.exposeProperty("acceleration","number",this.acceleration,{description:"Acceleration rate (0-1, higher is faster)",min:.01,max:1,step:.01,style:{label:"Acceleration Rate",slider:!0},onChange:e=>{this.acceleration=e}}),this.exposeProperty("deceleration","number",this.deceleration,{description:"Deceleration rate when no input (0-1)",min:.01,max:1,step:.01,style:{label:"Deceleration Rate",slider:!0},onChange:e=>{this.deceleration=e}}),this.exposeProperty("rotationSpeed","number",this.rotationSpeed,{description:"Rotation speed in degrees per second",min:0,max:360,step:5,style:{label:"Rotation Speed",slider:!0},onChange:e=>{this.rotationSpeed=e}}),this.exposeProperty("upKey","string",this.upKey,{description:"Key for upward movement",style:{header:"Control Bindings",label:"Up Key"},onChange:e=>{this.upKey=e}}),this.exposeProperty("downKey","string",this.downKey,{description:"Key for downward movement",style:{label:"Down Key"},onChange:e=>{this.downKey=e}}),this.exposeProperty("leftKey","string",this.leftKey,{description:"Key for leftward movement",style:{label:"Left Key"},onChange:e=>{this.leftKey=e}}),this.exposeProperty("rightKey","string",this.rightKey,{description:"Key for rightward movement",style:{label:"Right Key"},onChange:e=>{this.rightKey=e}}),this.exposeProperty("actionKey","string",this.actionKey,{description:"Key for primary action",style:{label:"Action Key"},onChange:e=>{this.actionKey=e}}),this.exposeProperty("rotateLeftKey","string",this.rotateLeftKey,{description:"Key for rotating counter-clockwise",style:{label:"Rotate Left"},onChange:e=>{this.rotateLeftKey=e}}),this.exposeProperty("rotateRightKey","string",this.rotateRightKey,{description:"Key for rotating clockwise",style:{label:"Rotate Right"},onChange:e=>{this.rotateRightKey=e}})}style(e){e.startGroup("Animation Settings",!1,{backgroundColor:"rgba(100,150,255,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("customDrawingModule","string",this.customDrawingModule,{description:"Custom drawing module for animations",style:{header:"Custom Drawing Module",label:"Drawing Module"}}),e.exposeProperty("animIdle","string",this.animIdle,{description:"Animation state for idle",style:{label:"Idle Animation"}}),e.exposeProperty("animWalk","string",this.animWalk,{description:"Animation state for walking",style:{label:"Walk Animation"}}),e.endGroup(),e.startGroup("Movement Settings",!1,{backgroundColor:"rgba(100,150,255,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("speed","number",this.speed,{description:"Movement speed in pixels per second",min:0,max:1e3,step:10,style:{label:"Movement Speed",slider:!0}}),e.exposeProperty("moveMode","enum",this.moveMode,{description:"Movement style",options:["direct","rotate-and-move"],style:{label:"Movement Style"}}),e.exposeProperty("platformerMode","boolean",this.platformerMode,{description:"Enable platformer physics (gravity, jump, horizontal movement)",style:{header:"Platformer Settings",label:"Platformer Mode"}}),e.exposeProperty("jumpForce","number",this.jumpForce,{description:"Jump force (platformer mode)",min:50,max:2e3,step:10,style:{label:"Jump Force",slider:!0}}),e.exposeProperty("allowDiagonalMovement","boolean",this.allowDiagonalMovement,{description:"Allow movement in diagonal directions",style:{label:"Allow Diagonals"}}),e.exposeProperty("useAcceleration","boolean",this.useAcceleration,{description:"Enable smooth acceleration/deceleration",style:{label:"Use Acceleration"}}),e.exposeProperty("acceleration","number",this.acceleration,{description:"Acceleration rate (0-1, higher is faster)",min:.01,max:1,step:.01,style:{label:"Acceleration Rate",slider:!0}}),e.exposeProperty("deceleration","number",this.deceleration,{description:"Deceleration rate when no input (0-1)",min:.01,max:1,step:.01,style:{label:"Deceleration Rate",slider:!0}}),e.exposeProperty("rotationSpeed","number",this.rotationSpeed,{description:"Rotation speed in degrees per second",min:0,max:360,step:5,style:{label:"Rotation Speed",slider:!0}}),e.endGroup(),e.addDivider(),e.startGroup("Control Bindings",!0,{backgroundColor:"rgba(100,255,150,0.1)",borderRadius:"6px",padding:"8px"}),e.addHelpText("Type key names like 'a', 'space', 'arrowup', etc."),e.exposeProperty("jumpKey","string",this.jumpKey,{description:"Key for jumping (platformer mode)",style:{label:"Jump Key"}}),e.exposeProperty("upKey","string",this.upKey,{description:"Key for upward movement",style:{label:"Up Key"}}),e.exposeProperty("downKey","string",this.downKey,{description:"Key for downward movement",style:{label:"Down Key"}}),e.exposeProperty("leftKey","string",this.leftKey,{description:"Key for leftward movement",style:{label:"Left Key"}}),e.exposeProperty("rightKey","string",this.rightKey,{description:"Key for rightward movement",style:{label:"Right Key"}}),e.addSpace(10),e.exposeProperty("actionKey","string",this.actionKey,{description:"Key for primary action",style:{label:"Action Key"}}),e.exposeProperty("rotateLeftKey","string",this.rotateLeftKey,{description:"Key for rotating counter-clockwise",style:{label:"Rotate Left"}}),e.exposeProperty("rotateRightKey","string",this.rotateRightKey,{description:"Key for rotating clockwise",style:{label:"Rotate Right"}}),e.endGroup(),e.addButton("Reset Controls",()=>this.resetControls(),{primary:!0,fullWidth:!0,tooltip:"Reset all controls to default values"})}resetControls(){this.upKey="arrowup",this.downKey="arrowdown",this.leftKey="arrowleft",this.rightKey="arrowright",this.actionKey="space",this.rotateLeftKey="q",this.rotateRightKey="e",window.editor&&window.editor.inspector&&window.editor.inspector.refreshModuleUI(this)}loop(e){if(!window.input)return;const t=this.gameObject.getModule("BasicPhysics");if(this.platformerMode&&t){let e=0;window.input.keyDown(this.rightKey)&&(e+=1),window.input.keyDown(this.leftKey)&&(e-=1);const i=e*this.speed;return this.grounded=.1>Math.abs(t.velocity.y),window.input.keyPressed(this.jumpKey)&&this.grounded&&(t.velocity.y=-this.jumpForce,this.isJumping=!0),void(this.useAcceleration?t.velocity.x+=(i-t.velocity.x)*this.acceleration:t.velocity.x=i)}const i=this.gameObject.getModule(this.customDrawingModule);i&&(window.input.keyDown(this.leftKey)?(i.flipped=!0,i.setAnimation(this.animWalk),i.isPlaying=!0):window.input.keyDown(this.rightKey)?(i.flipped=!1,i.setAnimation(this.animWalk),i.isPlaying=!0):window.input.keyDown(this.upKey)||window.input.keyDown(this.downKey)?(i.setAnimation(this.animWalk),i.isPlaying=!0):(i.isPlaying=!1,i.setAnimation(this.animIdle))),window.input.keyDown(this.rotateLeftKey)&&(this.gameObject.angle-=this.rotationSpeed*e),window.input.keyDown(this.rotateRightKey)&&(this.gameObject.angle+=this.rotationSpeed*e);let s=0,o=0;if(window.input.keyDown(this.rightKey)&&(s+=1),window.input.keyDown(this.leftKey)&&(s-=1),window.input.keyDown(this.downKey)&&(o+=1),window.input.keyDown(this.upKey)&&(o-=1),this.allowDiagonalMovement||0===s||0===o||(o=0),"rotate-and-move"===this.moveMode){let e=0;window.input.keyDown(this.upKey)&&(e=-1),window.input.keyDown(this.downKey)&&(e=1);const t=this.gameObject.angle*Math.PI/180;s=Math.sin(t)*e,o=-Math.cos(t)*e,window.input.keyDown(this.leftKey)&&(s+=Math.cos(t),o+=Math.sin(t)),window.input.keyDown(this.rightKey)&&(s-=Math.cos(t),o-=Math.sin(t))}if(0!==s||0!==o){const e=Math.sqrt(s*s+o*o);s/=e,o/=e}const n=s*this.speed,r=o*this.speed;this.useAcceleration?(0!==s?this.velocity.x+=(n-this.velocity.x)*this.acceleration:(this.velocity.x*=1-this.deceleration,.1>Math.abs(this.velocity.x)&&(this.velocity.x=0)),0!==o?this.velocity.y+=(r-this.velocity.y)*this.acceleration:(this.velocity.y*=1-this.deceleration,.1>Math.abs(this.velocity.y)&&(this.velocity.y=0))):(this.velocity.x=n,this.velocity.y=r),t&&t.enabled?t.setVelocity(this.velocity.x,this.velocity.y):(this.gameObject.position.x+=this.velocity.x*e,this.gameObject.position.y+=this.velocity.y*e)}}window.PhysicsKeyboardController=PhysicsKeyboardController;class SimpleHealth extends Module{static allowMultiple=!1;static namespace="Attributes";static description="Basic health and damage system for GameObjects";constructor(){super("SimpleHealth"),this.maxHealth=100,this.currentHealth=100,this.invulnerable=!1,this.invulnerabilityTime=1,this.invulnerabilityTimer=0,this.showHealthBar=!0,this.healthBarColor="#ff0000",this.healthBarWidth=50,this.healthBarHeight=5,this.healthBarOffsetY=-20,this.isDead=!1,this.exposeProperty("maxHealth","number",100,{min:1,max:1e4,step:1,onChange:e=>{this.currentHealth=Math.min(this.currentHealth,e)}}),this.exposeProperty("currentHealth","number",100,{min:0,max:1e4,step:1,onChange:e=>{this.currentHealth=Math.min(e,this.maxHealth)}}),this.exposeProperty("invulnerabilityTime","number",1,{min:0,max:10,step:.1,description:"Time in seconds to be invulnerable after taking damage",onChange:e=>{this.invulnerabilityTime=e}}),this.exposeProperty("showHealthBar","boolean",!0,{description:"Whether to show the health bar in game",style:{label:"Show Health Bar"},onChange:e=>{this.showHealthBar=e}}),this.exposeProperty("healthBarColor","color","#ff0000",{description:"Color of the health bar",onChange:e=>{this.healthBarColor=e}}),this.exposeProperty("healthBarWidth","number",50,{min:10,max:200,step:5,onChange:e=>{this.healthBarWidth=e}}),this.exposeProperty("healthBarHeight","number",5,{min:1,max:20,step:1,description:"Height of the health bar",onChange:e=>{this.healthBarHeight=e}}),this.exposeProperty("healthBarOffsetY","number",-20,{min:-100,max:100,step:1,description:"Y-axis offset of the health bar",onChange:e=>{this.healthBarOffsetY=e}})}start(){this.currentHealth=this.maxHealth}loop(e){this.invulnerabilityTimer>0&&(this.invulnerabilityTimer-=e,this.invulnerabilityTimer>0||(this.invulnerable=!1))}applyDamage(e,t=null){return!this.isDead&&!this.invulnerable&&(this.currentHealth-=e,this.currentHealth=Math.max(0,this.currentHealth),this.invulnerable=!0,this.invulnerabilityTimer=this.invulnerabilityTime,this.currentHealth>0?this.gameObject&&this.gameObject.onDamage&&this.gameObject.onDamage(e,t):(this.isDead=!0,this.die(t)),!0)}heal(e){if(this.currentHealth>=this.maxHealth)return 0;const t=this.currentHealth;this.currentHealth+=e,this.currentHealth=Math.min(this.currentHealth,this.maxHealth);const i=this.currentHealth-t;return i>0&&this.gameObject&&this.gameObject.onHeal&&this.gameObject.onHeal(i),i}die(e=null){this.isDead||(this.isDead=!0,this.currentHealth=0,this.gameObject&&this.gameObject.onDeath&&this.gameObject.onDeath(e))}resetHealth(){this.currentHealth=this.maxHealth,this.isDead=!1,this.invulnerable=!1,this.invulnerabilityTimer=0}draw(e){if(!this.showHealthBar||this.isDead)return;e.save();const t=e.getTransform();e.setTransform(1,0,0,1,t.e,t.f);const i=this.currentHealth/this.maxHealth,s=-this.healthBarWidth/2,o=this.healthBarOffsetY;e.fillStyle="rgba(0, 0, 0, 0.5)",e.fillRect(s,o,this.healthBarWidth,this.healthBarHeight),e.fillStyle=this.healthBarColor,e.fillRect(s,o,this.healthBarWidth*i,this.healthBarHeight),e.strokeStyle="#ffffff",e.lineWidth=1,e.strokeRect(s,o,this.healthBarWidth,this.healthBarHeight),this.invulnerable&&Math.floor(Date.now()/100)%2==0&&(e.fillStyle="rgba(255, 255, 255, 0.3)",e.fillRect(s,o,this.healthBarWidth,this.healthBarHeight)),e.restore()}toJSON(){return{maxHealth:this.maxHealth,currentHealth:this.currentHealth,invulnerable:this.invulnerable,invulnerabilityTime:this.invulnerabilityTime,showHealthBar:this.showHealthBar,healthBarColor:this.healthBarColor,healthBarWidth:this.healthBarWidth,healthBarHeight:this.healthBarHeight,healthBarOffsetY:this.healthBarOffsetY,isDead:this.isDead}}fromJSON(e){this.maxHealth=e.maxHealth||100,this.currentHealth=e.currentHealth||100,this.invulnerable=e.invulnerable||!1,this.invulnerabilityTime=e.invulnerabilityTime||1,this.showHealthBar=void 0===e.showHealthBar||e.showHealthBar,this.healthBarColor=e.healthBarColor||"#ff0000",this.healthBarWidth=e.healthBarWidth||50,this.healthBarHeight=e.healthBarHeight||5,this.healthBarOffsetY=e.healthBarOffsetY||-20,this.isDead=e.isDead||!1,this.invulnerabilityTimer=0}}window.SimpleHealth=SimpleHealth;class AudioPlayer extends Module{static allowMultiple=!0;static namespace="Audio";static description="Plays audio files with playback controls";static iconClass="fas fa-volume-up";constructor(){super("AudioPlayer"),this.audioAsset=new AssetReference(null,"audio"),this.volume=1,this.loop=!1,this.playRate=1,this.autoplay=!1,this.playOnStart=!1,this.randomizeStart=!1,this.startTime=0,this.endTime=0,this.fadeInTime=0,this.fadeOutTime=0,this.spatialBlend=0,this.minDistance=1,this.maxDistance=500,this._audio=null,this._isLoaded=!1,this._isPlaying=!1,this._audioContext=null,this._gainNode=null,this._sourceNode=null,this._startTime=0,this._duration=0,this.exposeProperty("audioAsset","asset",this.audioAsset,{description:"Audio file to play",assetType:"audio",fileTypes:["mp3","wav","ogg","aac"]}),this.exposeProperty("volume","number",this.volume,{description:"Playback volume (0-1)",min:0,max:1,step:.01}),this.exposeProperty("loop","boolean",this.loop,{description:"Loop the audio"}),this.exposeProperty("playRate","number",this.playRate,{description:"Playback speed (1.0 = normal)",min:.25,max:4,step:.01}),this.exposeProperty("autoplay","boolean",this.autoplay,{description:"Automatically play when scene starts"}),this.exposeProperty("playOnStart","boolean",this.playOnStart,{description:"Play when this object becomes active"}),this.exposeProperty("spatialBlend","number",this.spatialBlend,{description:"2D (0) vs 3D (1) sound blend",min:0,max:1,step:.1})}async start(){await this.loadAudio(),(this.autoplay||this.playOnStart)&&this._isLoaded&&this.play()}onDestroy(){this.stop(),this._gainNode&&(this._gainNode.disconnect(),this._gainNode=null),this._audio=null}async loadAudio(){if(!this.audioAsset||!this.audioAsset.path)return this._audio=null,this._isLoaded=!1,null;try{const e=await this.audioAsset.load();return e instanceof HTMLAudioElement?(this._audio=e,this._isLoaded=!0,this._duration=e.duration,this.initializeAudioContext(),e):null}catch(e){return console.error("Error loading audio:",e),this._audio=null,this._isLoaded=!1,null}}initializeAudioContext(){if(!this._audioContext){const e=window.AudioContext||window.webkitAudioContext;if(!e)return console.warn("Web Audio API not supported in this browser"),!1;this._audioContext=new e}return this._gainNode||(this._gainNode=this._audioContext.createGain(),this._gainNode.gain.value=this.volume,this._gainNode.connect(this._audioContext.destination)),!0}async play(e={}){if(this._isLoaded||await this.loadAudio(),!this._audio||!this._isLoaded)return console.warn("Cannot play audio: not loaded"),!1;this.stop();try{const t=void 0!==e.loop?e.loop:this.loop,i=void 0!==e.volume?e.volume:this.volume,s=void 0!==e.rate?e.rate:this.playRate;if(!this._audioContext){this._audio.currentTime=e.startTime||this.startTime||0,this._audio.loop=t,this._audio.volume=i,this._audio.playbackRate=s;const o=this._audio.play();return o&&await o.catch(e=>(console.warn("Audio play error (may require user interaction):",e),!1)),this._isPlaying=!0,!0}const o=this._audioContext.createMediaElementSource(this._audio);o.connect(this._gainNode),this._gainNode.gain.value=i,this._audio.loop=t,this._audio.playbackRate=s,this._audio.currentTime=e.startTime||this.startTime||0;const n=this._audio.play();return n&&await n.catch(e=>(console.warn("Audio play error (may require user interaction):",e),!1)),this._sourceNode=o,this._isPlaying=!0,this._startTime=this._audioContext.currentTime,!0}catch(e){return console.error("Error playing audio:",e),!1}}stop(){if(this._audio)try{this._audio.pause(),this._audio.currentTime=0,this._sourceNode&&(this._sourceNode.disconnect(),this._sourceNode=null),this._isPlaying=!1}catch(e){console.error("Error stopping audio:",e)}}pause(){if(this._audio&&this._isPlaying)try{this._audio.pause(),this._isPlaying=!1}catch(e){console.error("Error pausing audio:",e)}}resume(){if(this._audio&&!this._isPlaying)try{const e=this._audio.play();e&&e.catch(e=>{console.warn("Audio resume error:",e)}),this._isPlaying=!0}catch(e){console.error("Error resuming audio:",e)}}setVolume(e,t=0){if(this.volume=Math.max(0,Math.min(1,e)),this._audio)if(t>0&&this._gainNode){const e=this._audioContext.currentTime;this._gainNode.gain.linearRampToValueAtTime(this.volume,e+t)}else this._gainNode?this._gainNode.gain.value=this.volume:this._audio.volume=this.volume}loop(e){this.spatialBlend>0&&this._isPlaying&&this.gameObject&&this.updateSpatialAudio()}updateSpatialAudio(){if(!window.engine||!window.engine.scene||0>=this.spatialBlend)return;const e=window.engine.scene.settings||{};if(!e.viewportX&&!e.viewportY)return;const t=new Vector2(e.viewportX+e.viewportWidth/2/(e.cameraZoom||1),e.viewportY+e.viewportHeight/2/(e.cameraZoom||1)),i=this.gameObject.getWorldPosition().distanceTo(t);let s=1;if(i>this.minDistance){const e=this.maxDistance-this.minDistance;s=e>0?1-Math.min(1,Math.max(0,(i-this.minDistance)/e)):i>this.minDistance?0:1}const o=this.volume*(1-this.spatialBlend)+this.volume*s*this.spatialBlend;this._gainNode?this._gainNode.gain.value=o:this._audio&&(this._audio.volume=o)}toJSON(){const e=super.toJSON()||{};return e.audioAsset=this.audioAsset?this.audioAsset.toJSON():null,e.volume=this.volume,e.loop=this.loop,e.playRate=this.playRate,e.autoplay=this.autoplay,e.playOnStart=this.playOnStart,e.startTime=this.startTime,e.endTime=this.endTime,e.fadeInTime=this.fadeInTime,e.fadeOutTime=this.fadeOutTime,e.spatialBlend=this.spatialBlend,e.minDistance=this.minDistance,e.maxDistance=this.maxDistance,e}fromJSON(e){super.fromJSON(e),e&&(e.audioAsset&&(this.audioAsset=AssetReference.fromJSON(e.audioAsset),this.loadAudio()),void 0!==e.volume&&(this.volume=e.volume),void 0!==e.loop&&(this.loop=e.loop),void 0!==e.playRate&&(this.playRate=e.playRate),void 0!==e.autoplay&&(this.autoplay=e.autoplay),void 0!==e.playOnStart&&(this.playOnStart=e.playOnStart),void 0!==e.startTime&&(this.startTime=e.startTime),void 0!==e.endTime&&(this.endTime=e.endTime),void 0!==e.fadeInTime&&(this.fadeInTime=e.fadeInTime),void 0!==e.fadeOutTime&&(this.fadeOutTime=e.fadeOutTime),void 0!==e.spatialBlend&&(this.spatialBlend=e.spatialBlend),void 0!==e.minDistance&&(this.minDistance=e.minDistance),void 0!==e.maxDistance&&(this.maxDistance=e.maxDistance))}}window.AudioPlayer=AudioPlayer;class BehaviorTrigger extends Module{static namespace="Logic";static description="Triggers actions based on events like collisions and key presses";static iconClass="fas fa-bolt";constructor(){super("BehaviorTrigger"),this.triggerType="collision",this.triggerKey="space",this.mouseButton="left",this.triggerTag="",this.timerInterval=1,this.timerRepeat=!0,this._timerCount=0,this.actionType="destroy",this.actionTarget="self",this.targetName="",this.toggleProperty="active",this.animationState="",this.messageType="damage",this.messageValue=10,this.spawnPrefab=null,this.spawnOffset=new Vector2(0,0),this.spawnInheritVelocity=!1,this.cooldown=0,this._cooldownTimer=0,this._canTrigger=!0,this.exposeProperty("triggerType","enum","collision",{description:"What causes the trigger to activate",options:["collision","key","mouse","timer"]}),this.exposeProperty("triggerKey","string","space",{description:"Key that activates the trigger",showIf:{property:"triggerType",value:"key"}}),this.exposeProperty("mouseButton","enum","left",{description:"Mouse button that activates the trigger",options:["left","middle","right"],showIf:{property:"triggerType",value:"mouse"}}),this.exposeProperty("triggerTag","string","",{description:"Only trigger for objects with this tag (empty = any)",showIf:{property:"triggerType",value:"collision"}}),this.exposeProperty("timerInterval","number",1,{description:"Time between trigger activations (seconds)",min:.1,max:60,step:.1,showIf:{property:"triggerType",value:"timer"}}),this.exposeProperty("timerRepeat","boolean",!0,{description:"Whether the timer repeats or fires once",showIf:{property:"triggerType",value:"timer"}}),this.exposeProperty("actionType","enum","destroy",{description:"Action to take when triggered",options:["destroy","spawn","animate","toggle","message","teleport"]}),this.exposeProperty("actionTarget","enum","self",{description:"What object the action affects",options:["self","other","byName"]}),this.exposeProperty("targetName","string","",{description:"Name of target object",showIf:{property:"actionTarget",value:"byName"}}),this.exposeProperty("toggleProperty","enum","active",{description:"Property to toggle",options:["active","visible","collisionEnabled"],showIf:{property:"actionType",value:"toggle"}}),this.exposeProperty("animationState","string","",{description:"Animation state to play",showIf:{property:"actionType",value:"animate"}}),this.exposeProperty("messageType","enum","damage",{description:"Type of message to send",options:["damage","heal","custom"],showIf:{property:"actionType",value:"message"}}),this.exposeProperty("messageValue","number",10,{description:"Value to send with message",showIf:{property:"actionType",value:"message"}}),this.exposeProperty("spawnOffset","vector2",this.spawnOffset,{description:"Offset from current position to spawn at",showIf:{property:"actionType",value:"spawn"}}),this.exposeProperty("spawnInheritVelocity","boolean",!1,{description:"Whether spawned object inherits velocity",showIf:{property:"actionType",value:"spawn"}}),this.exposeProperty("cooldown","number",0,{description:"Cooldown between triggers (seconds)",min:0,max:60,step:.1})}start(){this._canTrigger=!0,this._cooldownTimer=0,this._timerCount=0}onCollisionEnter(e){"collision"===this.triggerType&&(this.triggerTag&&!e.hasTag(this.triggerTag)||this.tryTriggerAction(e))}onTriggerEnter(e){"collision"===this.triggerType&&(this.triggerTag&&!e.hasTag(this.triggerTag)||this.tryTriggerAction(e))}tryTriggerAction(e=null){this._canTrigger&&(this.executeAction(e),this.cooldown>0&&(this._canTrigger=!1,this._cooldownTimer=this.cooldown))}executeAction(e=null){let t=null;switch(this.actionTarget){case"self":t=this.gameObject;break;case"other":t=e;break;case"byName":window.engine&&window.engine.scene&&(t=window.engine.getAllObjects(window.engine.gameObjects).find(e=>e.name===this.targetName))}if(t)switch(this.actionType){case"destroy":window.editor&&"function"==typeof window.editor.removeGameObject?window.editor.removeGameObject(t):t.active=!1;break;case"spawn":if(this.spawnPrefab){const e=this.gameObject.getWorldPosition().add(this.spawnOffset);if(window.editor&&"function"==typeof window.editor.createGameObjectFromPrefab){const t=window.editor.createGameObjectFromPrefab(this.spawnPrefab);if(t&&(t.position=e,this.spawnInheritVelocity)){const e=this.gameObject.getModule("RigidBody"),i=t.getModule("RigidBody");e&&i&&i.setVelocity(e.getVelocity())}}}break;case"animate":if(this.animationState){const e=t.getModule("Animator");e&&e.play(this.animationState)}break;case"toggle":switch(this.toggleProperty){case"active":t.active=!t.active;break;case"visible":t.visible=!t.visible;break;case"collisionEnabled":t.collisionEnabled=!t.collisionEnabled}break;case"message":switch(this.messageType){case"damage":const e=t.getModule("SimpleHealth");e&&e.applyDamage(this.messageValue,this.gameObject);break;case"heal":const i=t.getModule("SimpleHealth");i&&i.heal(this.messageValue);break;case"custom":t.onCustomEvent&&t.onCustomEvent(this.messageType,this.messageValue,this.gameObject)}break;case"teleport":const e=this.gameObject.getWorldPosition();t.position=e}else console.warn("BehaviorTrigger: No target object found for action "+this.actionType)}loop(e){!this._canTrigger&&this._cooldownTimer>0&&(this._cooldownTimer-=e,this._cooldownTimer>0||(this._canTrigger=!0,this._cooldownTimer=0)),"key"===this.triggerType&&this._canTrigger&&window.input&&window.input.keyPressed(this.triggerKey.toLowerCase())&&this.tryTriggerAction(),"mouse"===this.triggerType&&this._canTrigger&&window.input&&window.input.mousePressed(this.mouseButton)&&this.tryTriggerAction(),"timer"===this.triggerType&&this._canTrigger&&(this._timerCount+=e,this._timerCount<this.timerInterval||(this._timerCount=0,this.tryTriggerAction(),this.timerRepeat||(this.enabled=!1)))}toJSON(){const e=super.toJSON();return e.triggerType=this.triggerType,e.triggerKey=this.triggerKey,e.mouseButton=this.mouseButton,e.triggerTag=this.triggerTag,e.timerInterval=this.timerInterval,e.timerRepeat=this.timerRepeat,e.actionType=this.actionType,e.actionTarget=this.actionTarget,e.targetName=this.targetName,e.toggleProperty=this.toggleProperty,e.animationState=this.animationState,e.messageType=this.messageType,e.messageValue=this.messageValue,this.spawnPrefab&&(e.spawnPrefabId=this.spawnPrefab.id),e.spawnOffset={x:this.spawnOffset.x,y:this.spawnOffset.y},e.spawnInheritVelocity=this.spawnInheritVelocity,e.cooldown=this.cooldown,e}fromJSON(e){super.fromJSON(e),e.triggerType&&(this.triggerType=e.triggerType),e.triggerKey&&(this.triggerKey=e.triggerKey),e.mouseButton&&(this.mouseButton=e.mouseButton),void 0!==e.triggerTag&&(this.triggerTag=e.triggerTag),e.timerInterval&&(this.timerInterval=e.timerInterval),void 0!==e.timerRepeat&&(this.timerRepeat=e.timerRepeat),e.actionType&&(this.actionType=e.actionType),e.actionTarget&&(this.actionTarget=e.actionTarget),e.targetName&&(this.targetName=e.targetName),e.toggleProperty&&(this.toggleProperty=e.toggleProperty),e.animationState&&(this.animationState=e.animationState),e.messageType&&(this.messageType=e.messageType),void 0!==e.messageValue&&(this.messageValue=e.messageValue),e.spawnOffset&&(this.spawnOffset=new Vector2(e.spawnOffset.x,e.spawnOffset.y)),void 0!==e.spawnInheritVelocity&&(this.spawnInheritVelocity=e.spawnInheritVelocity),e.spawnPrefabId&&(this._pendingSpawnPrefabId=e.spawnPrefabId),e.cooldown&&(this.cooldown=e.cooldown)}}window.BehaviorTrigger=BehaviorTrigger;class Camera3DRasterizer extends Module{static namespace="3D";constructor(){super("Camera3DRasterizer"),this._position=new Vector3(0,0,0),this._rotation=new Vector3(0,0,0),this._fieldOfView=60,this._nearPlane=.1,this._farPlane=5e3,this._isActive=!0,this._backgroundColor="#000000",this._renderTextureWidth=320,this._renderTextureHeight=240,this._renderTextureSmoothing=!1,this._renderTexture=null,this._renderTextureCtx=null,this.viewportWidth=800,this.viewportHeight=600,this.drawGizmoInRuntime=!1,this._renderingMethod="raster",this._enableBackfaceCulling=!0,this._zBuffer=null,this._imageData=null,this._lightDirection=new Vector3(1,-1,-1),this._lightColor="#ffffff",this._lightIntensity=1,this._ambientIntensity=.3,this._dynamicLights=[],this._maxLights=4,this._lightFindDistance=500,this._useDynamicLighting=!0,this._skyColor="#87CEEB",this._floorColor="#95d5f3",this._skyColorHorizon="#da846aff",this._floorColorHorizon="#1a2c46",this._backgroundType="skybox",this._cloudsEnabled=!0,this._cloudSpeed=2.5,this._cloudDensity=.7,this._cloudScale=250,this._cloudSoftness=.8,this._cloudHeight=.2,this._cloudThickness=.8,this._cloudBrightness=.9,this._cloudTime=0,this._cloudNoiseCache=null,this._cloudResolution=.3,this._waterEnabled=!0,this._waterSpeed=2,this._waterWaveHeight=6,this._waterTime=0,this._hillsEnabled=!0,this._hillsSeed=12345,this._hillsMinHeight=.1,this._hillsMaxHeight=.4,this._hillsFrequency=.5,this._hillsRoughness=.6,this._hillsBaseColor="#597561ff",this._hillsTopColor="#4ba152ff",this._hillsUseFogColor=!1,this._hillsFogBlend=.7,this._waterReflectionEnabled=!0,this._waterReflectionOpacity=.9,this._waterReflectionDistortion=.55,this._showSun=!0,this._sunSize=30,this._sunGlowSize=60,this._lensFlareEnabled=!0,this._lensFlareIntensity=.8,this._lensFlareCount=5,this._lensFlareSpacing=.25,this._lensFlareSize=32,this._lensFlareColorShift=!0,this._specularEnabled=!0,this._specularBleedingEnabled=!1,this._specularPerMesh=!1,this._specularFullFace=!0,this._specularBloomEnabled=!0,this._specularBloomIntensity=.5,this._specularBloomRadius=2.5,this._specularBloomThreshold=.3,this._emissiveIntensity=1,this._fogEnabled=!1,this._fogColor="#a0a0a0",this._fogStart=100,this._fogEnd=500,this._fogDensity=1,this._showDebugInfo=!1,this._debugStats={totalFaces:0,renderedTriangles:0,culledFaces:0,clippedFaces:0,specularHighlights:0,renderTime:0},this.exposeProperty("position","vector3",this._position,{onChange:e=>this._position=e}),this.exposeProperty("rotation","vector3",this._rotation,{onChange:e=>this._rotation=e}),this.exposeProperty("fieldOfView","number",60,{min:1,max:179,onChange:e=>this._fieldOfView=e}),this.exposeProperty("nearPlane","number",.1,{min:.01,max:10,step:.01,onChange:e=>this._nearPlane=e}),this.exposeProperty("farPlane","number",1e3,{min:10,max:1e4,step:1,onChange:e=>this._farPlane=e}),this.exposeProperty("backgroundColor","color","#000000",{onChange:e=>this._backgroundColor=e}),this.exposeProperty("drawGizmoInRuntime","boolean",!1,{onChange:e=>this.drawGizmoInRuntime=e}),this.exposeProperty("renderTextureWidth","number",512,{min:64,max:2048,step:64,onChange:e=>{this._renderTextureWidth=e,this.updateRenderTexture()}}),this.exposeProperty("renderTextureHeight","number",512,{min:64,max:2048,step:64,onChange:e=>{this._renderTextureHeight=e,this.updateRenderTexture()}}),this.exposeProperty("renderTextureSmoothing","boolean",!1,{onChange:e=>this._renderTextureSmoothing=e}),this.exposeProperty("renderingMethod","dropdown","raster",{options:["raster"],onChange:e=>this._renderingMethod=e}),this.exposeProperty("lightDirection","vector3",this._lightDirection,{onChange:e=>this._lightDirection=e}),this.exposeProperty("lightColor","color","#ffffff",{onChange:e=>this._lightColor=e}),this.exposeProperty("lightIntensity","number",1,{min:0,max:2,step:.1,onChange:e=>this._lightIntensity=e}),this.exposeProperty("ambientIntensity","number",.3,{min:0,max:1,step:.05,onChange:e=>this._ambientIntensity=e}),this.exposeProperty("maxLights","number",this._maxLights,{min:0,max:16,step:1,onChange:e=>this._maxLights=e}),this.exposeProperty("lightFindDistance","number",this._lightFindDistance,{min:50,max:2e3,step:50,onChange:e=>this._lightFindDistance=e}),this.exposeProperty("useDynamicLighting","boolean",this._useDynamicLighting,{onChange:e=>this._useDynamicLighting=e}),this.exposeProperty("backgroundType","dropdown","skybox",{options:["skybox","transparent","solid"],onChange:e=>this._backgroundType=e}),this.exposeProperty("backgroundColor","color","#000000",{onChange:e=>this._backgroundColor=e}),this.exposeProperty("skyColor","color","#87CEEB",{onChange:e=>this._skyColor=e}),this.exposeProperty("skyColorHorizon","color","#87CEEB",{onChange:e=>this._skyColorHorizon=e}),this.exposeProperty("floorColor","color","#8B4513",{onChange:e=>this._floorColor=e}),this.exposeProperty("floorColorHorizon","color","#654321",{onChange:e=>this._floorColorHorizon=e}),this.exposeProperty("cloudsEnabled","boolean",!1,{onChange:e=>this._cloudsEnabled=e}),this.exposeProperty("cloudSpeed","number",.5,{min:.1,max:3,step:.1,onChange:e=>this._cloudSpeed=e}),this.exposeProperty("cloudDensity","number",.4,{min:0,max:1,step:.05,onChange:e=>this._cloudDensity=e}),this.exposeProperty("cloudScale","number",150,{min:50,max:500,step:10,onChange:e=>this._cloudScale=e}),this.exposeProperty("cloudSoftness","number",.6,{min:0,max:1,step:.05,onChange:e=>this._cloudSoftness=e}),this.exposeProperty("cloudHeight","number",.3,{min:0,max:1,step:.05,onChange:e=>this._cloudHeight=e}),this.exposeProperty("cloudThickness","number",.4,{min:.1,max:1,step:.05,onChange:e=>this._cloudThickness=e}),this.exposeProperty("cloudBrightness","number",1,{min:.5,max:2,step:.1,onChange:e=>this._cloudBrightness=e}),this.exposeProperty("cloudResolution","number",1,{min:.25,max:1,step:.05,onChange:e=>this._cloudResolution=e}),this.exposeProperty("waterEnabled","boolean",!1,{onChange:e=>this._waterEnabled=e}),this.exposeProperty("waterSpeed","number",1,{min:.1,max:5,step:.1,onChange:e=>this._waterSpeed=e}),this.exposeProperty("waterWaveHeight","number",10,{min:1,max:50,step:1,onChange:e=>this._waterWaveHeight=e}),this.exposeProperty("hillsEnabled","boolean",!1,{onChange:e=>this._hillsEnabled=e}),this.exposeProperty("hillsSeed","number",12345,{min:0,max:999999,step:1,onChange:e=>{this._hillsSeed=e,this._hillsCache=null}}),this.exposeProperty("hillsMinHeight","number",.1,{min:0,max:1,step:.05,onChange:e=>{this._hillsMinHeight=e,this._hillsCache=null}}),this.exposeProperty("hillsMaxHeight","number",.4,{min:0,max:1,step:.05,onChange:e=>{this._hillsMaxHeight=e,this._hillsCache=null}}),this.exposeProperty("hillsFrequency","number",.5,{min:.1,max:2,step:.1,onChange:e=>{this._hillsFrequency=e,this._hillsCache=null}}),this.exposeProperty("hillsRoughness","number",.6,{min:0,max:1,step:.05,onChange:e=>{this._hillsRoughness=e,this._hillsCache=null}}),this.exposeProperty("hillsBaseColor","color","#2d5016",{onChange:e=>this._hillsBaseColor=e}),this.exposeProperty("hillsTopColor","color","#8b7355",{onChange:e=>this._hillsTopColor=e}),this.exposeProperty("hillsUseFogColor","boolean",!0,{onChange:e=>this._hillsUseFogColor=e}),this.exposeProperty("hillsFogBlend","number",.7,{min:0,max:1,step:.05,onChange:e=>this._hillsFogBlend=e}),this.exposeProperty("waterReflectionEnabled","boolean",!0,{onChange:e=>this._waterReflectionEnabled=e}),this.exposeProperty("waterReflectionOpacity","number",.3,{min:0,max:1,step:.05,onChange:e=>this._waterReflectionOpacity=e}),this.exposeProperty("waterReflectionDistortion","number",.05,{min:0,max:.5,step:.01,onChange:e=>this._waterReflectionDistortion=e}),this.exposeProperty("showSun","boolean",!0,{onChange:e=>this._showSun=e}),this.exposeProperty("sunSize","number",30,{min:10,max:100,step:5,onChange:e=>this._sunSize=e}),this.exposeProperty("sunGlowSize","number",60,{min:20,max:200,step:10,onChange:e=>this._sunGlowSize=e}),this.exposeProperty("lensFlareEnabled","boolean",!0,{onChange:e=>this._lensFlareEnabled=e}),this.exposeProperty("lensFlareIntensity","number",.8,{min:0,max:1,step:.1,onChange:e=>this._lensFlareIntensity=e}),this.exposeProperty("lensFlareCount","number",5,{min:1,max:10,step:1,onChange:e=>this._lensFlareCount=e}),this.exposeProperty("lensFlareSpacing","number",.15,{min:.05,max:.5,step:.05,onChange:e=>this._lensFlareSpacing=e}),this.exposeProperty("lensFlareSize","number",20,{min:5,max:50,step:5,onChange:e=>this._lensFlareSize=e}),this.exposeProperty("lensFlareColorShift","boolean",!0,{onChange:e=>this._lensFlareColorShift=e}),this.exposeProperty("specularEnabled","boolean",!0,{onChange:e=>this._specularEnabled=e}),this.exposeProperty("specularFullFace","boolean",!1,{onChange:e=>this._specularFullFace=e}),this.exposeProperty("specularBloomEnabled","boolean",!1,{onChange:e=>this._specularBloomEnabled=e}),this.exposeProperty("specularBloomIntensity","number",.5,{min:0,max:1,step:.05,onChange:e=>this._specularBloomIntensity=e}),this.exposeProperty("specularBloomRadius","number",1.5,{min:1,max:3,step:.1,onChange:e=>this._specularBloomRadius=e}),this.exposeProperty("specularBloomThreshold","number",.3,{min:0,max:1,step:.05,onChange:e=>this._specularBloomThreshold=e}),this.exposeProperty("fogEnabled","boolean",!1,{onChange:e=>this._fogEnabled=e}),this.exposeProperty("fogColor","color","#a0a0a0",{onChange:e=>this._fogColor=e}),this.exposeProperty("fogStart","number",100,{min:0,max:1e3,step:10,onChange:e=>this._fogStart=e}),this.exposeProperty("fogEnd","number",500,{min:10,max:5e3,step:10,onChange:e=>this._fogEnd=e}),this.exposeProperty("fogDensity","number",1,{min:0,max:1,step:.05,onChange:e=>this._fogDensity=e}),this.exposeProperty("showDebugInfo","boolean",!1,{onChange:e=>this._showDebugInfo=e}),this._hillsCache=null,this._hillsCacheYaw=null,this.updateRenderTexture()}setAsActiveCamera(){this.gameObject&&(this.getGameObjects().forEach(e=>{const t=e.getModule("Camera3D");t&&t!==this&&(t._isActive=!1)}),this._isActive=!0)}getGameObjects(){return this.gameObject?this.getAllGameObjects():[]}projectPoint(e){const t=this.worldToCameraSpace(e),i=t.x;if(i<=this.nearPlane||i>=this.farPlane)return null;const s=this.viewportWidth/this.viewportHeight,o=this.fieldOfView*(Math.PI/180),n=1/Math.tan(.5*o);if(1e-6>i)return null;const r=t.y/i*(n/s),a=t.z/i*n,l=(.5*r+.5)*this.viewportWidth,h=(.5-.5*a)*this.viewportHeight;return new Vector2(l,h)}worldToCameraSpace(e){const t=this.gameObject&&this.gameObject.getWorldPosition?this.gameObject.getWorldPosition():{x:0,y:0};let i=0;this.gameObject&&("function"==typeof this.gameObject.getWorldDepth?i=this.gameObject.getWorldDepth():"number"==typeof this.gameObject.depth?i=this.gameObject.depth:this.gameObject.position&&this.gameObject.position.z&&(i=this.gameObject.position.z));const s=(t.x||0)+(this._position.x||0),o=(t.y||0)+(this._position.y||0),n=i+(this._position.z||0),r=new Vector3(s,o,n),a=((this.gameObject&&this.gameObject.getWorldRotation?this.gameObject.getWorldRotation():0)+(this._rotation.z||0))*(Math.PI/180),l=(this._rotation.y||0)*(Math.PI/180),h=(this._rotation.x||0)*(Math.PI/180);let c=this.subtractVector3(e,r);return c=this.rotateVectorZ(c,-a),c=this.rotateVectorY(c,-l),c=this.rotateVectorX(c,-h),c}subtractVector3(e,t){return new Vector3(e.x-t.x,e.y-t.y,e.z-t.z)}rotateVectorX(e,t){const i=Math.cos(t),s=Math.sin(t);return new Vector3(e.x,e.y*i-e.z*s,e.y*s+e.z*i)}rotateVectorY(e,t){const i=Math.cos(t),s=Math.sin(t);return new Vector3(e.x*i+e.z*s,e.y,-e.x*s+e.z*i)}rotateVectorZ(e,t){const i=Math.cos(t),s=Math.sin(t);return new Vector3(e.x*i-e.y*s,e.x*s+e.y*i,e.z)}clipPolygonAgainstNearPlane(e,t){if(!e||0===e.length)return[];const i=[],s=1e-4;for(let o=0;o<e.length;o++){const n=e[o],r=e[(o+1)%e.length],a=n.x>=t-s,l=r.x>=t-s;if(a&&l)i.push(r);else if(a&&!l){const e=Math.max(0,Math.min(1,(t-n.x)/(r.x-n.x)));i.push(new Vector3(t,n.y+e*(r.y-n.y),n.z+e*(r.z-n.z)))}else if(!a&&l){const e=Math.max(0,Math.min(1,(t-n.x)/(r.x-n.x)));i.push(new Vector3(t,n.y+e*(r.y-n.y),n.z+e*(r.z-n.z))),i.push(r)}}return i}projectCameraPoint(e){const t=e.x;if(1e-6>=t)return null;const i=this.viewportWidth/this.viewportHeight,s=this.fieldOfView*(Math.PI/180),o=1/Math.tan(.5*s),n=e.y/t*(o/i),r=e.z/t*o,a=(.5*n+.5)*this.viewportWidth,l=(.5-.5*r)*this.viewportHeight;return new Vector2(a,l)}isPointVisible(e){const t=this.worldToCameraSpace(e);return t.x>=this.nearPlane&&t.x<=this.farPlane}updateRenderTexture(){this._renderTexture&&this._renderTexture.width===this._renderTextureWidth&&this._renderTexture.height===this._renderTextureHeight||(this._renderTexture=document.createElement("canvas"),this._renderTexture.width=this._renderTextureWidth,this._renderTexture.height=this._renderTextureHeight,this._renderTextureCtx=this._renderTexture.getContext("2d"),this.viewportWidth=this._renderTextureWidth,this.viewportHeight=this._renderTextureHeight,this._zBuffer=new Float32Array(this._renderTextureWidth*this._renderTextureHeight),this._imageData=this._renderTextureCtx.createImageData(this._renderTextureWidth,this._renderTextureHeight))}getRenderTexture(){return this._renderTexture}getRenderTextureContext(){return this._renderTextureCtx}clearRenderTexture(){this._renderTextureCtx&&(this._renderTextureCtx.imageSmoothingEnabled=this._renderTextureSmoothing,this._renderTextureCtx.fillStyle=this._backgroundColor,this._renderTextureCtx.fillRect(0,0,this._renderTextureWidth,this._renderTextureHeight),this._zBuffer&&this._zBuffer.fill(1/0))}updateViewport(){this.viewportWidth=this._renderTextureWidth,this.viewportHeight=this._renderTextureHeight}calculateScreenNormal(e){if(3>e.length)return 0;const t=e[0],i=e[1],s=e[2],o=i.x-t.x,n=i.y-t.y,r=s.x-t.x;return o*(s.y-t.y)-n*r}drawTexturedTriangle(e,t,i,s){if(!s||3!==t.length||3!==i.length)return;e.save(),e.beginPath(),e.moveTo(t[0].x,t[0].y),e.lineTo(t[1].x,t[1].y),e.lineTo(t[2].x,t[2].y),e.closePath(),e.clip();const o=t[0].x,n=t[0].y,r=t[1].x,a=t[1].y,l=t[2].x,h=t[2].y,c=i[0].x*s.width,d=i[0].y*s.height,p=i[1].x*s.width,u=i[1].y*s.height,g=i[2].x*s.width,m=i[2].y*s.height,f=c*(u-m)-p*(d-m)+g*(d-u);if(Math.abs(f)>1e-4){const t=(o*(u-m)-r*(d-m)+l*(d-u))/f,i=(o*(g-p)-r*(g-c)+l*(p-c))/f,y=(o*(p*m-g*u)-r*(c*m-g*d)+l*(c*u-p*d))/f,w=(n*(u-m)-a*(d-m)+h*(d-u))/f,b=(n*(g-p)-a*(g-c)+h*(p-c))/f,x=(n*(p*m-g*u)-a*(c*m-g*d)+h*(c*u-p*d))/f;e.transform(t,w,i,b,y,x),e.drawImage(s,0,0)}e.restore()}hexToRgb(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:0,g:0,b:0}}registerLight(e){this._dynamicLights.includes(e)||this._dynamicLights.push(e)}unregisterLight(e){const t=this._dynamicLights.indexOf(e);t>-1&&this._dynamicLights.splice(t,1)}getNearbyLights(){if(!this._useDynamicLighting||0===this._maxLights)return[];const e=this.getCameraWorldPosition();return this._dynamicLights.filter(t=>{if(!t.gameObject||!t.gameObject.active)return!1;const i=t.getWorldPosition(),s=i.x-e.x,o=i.y-e.y,n=i.z-e.z;return Math.sqrt(s*s+o*o+n*n)<=this._lightFindDistance}).sort((t,i)=>{const s=t.getWorldPosition(),o=i.getWorldPosition();return Math.sqrt((s.x-e.x)**2+(s.y-e.y)**2+(s.z-e.z)**2)-Math.sqrt((o.x-e.x)**2+(o.y-e.y)**2+(o.z-e.z)**2)}).slice(0,this._maxLights)}getCameraWorldPosition(){const e=this.gameObject&&this.gameObject.getWorldPosition?this.gameObject.getWorldPosition():{x:0,y:0};let t=0;return this.gameObject&&("function"==typeof this.gameObject.getWorldDepth?t=this.gameObject.getWorldDepth():"number"==typeof this.gameObject.depth?t=this.gameObject.depth:this.gameObject.position&&this.gameObject.position.z&&(t=this.gameObject.position.z)),new Vector3((e.x||0)+(this._position.x||0),(e.y||0)+(this._position.y||0),t+(this._position.z||0))}calculateLightingWithDynamicLights(e,t,i,s){const o="string"==typeof i?this.hexToRgb(i):i,n={x:(e[0].x+e[1].x+e[2].x)/3,y:(e[0].y+e[1].y+e[2].y)/3,z:(e[0].z+e[1].z+e[2].z)/3},r=this.calculateLighting(t,i);if(!this._useDynamicLighting||0===this._maxLights)return r;const a=this.getNearbyLights();if(0===a.length)return r;let l=r.r,h=r.g,c=r.b;for(const e of a){if(!e.isTriangleLit(n,t,s))continue;const i=e.calculateLightContribution(n,t);i.intensity>.001&&(l+=o.r*(i.r/255),h+=o.g*(i.g/255),c+=o.b*(i.b/255))}return{r:Math.min(255,Math.round(l)),g:Math.min(255,Math.round(h)),b:Math.min(255,Math.round(c))}}calculateEmissiveColor(e,t){const i=e.material;if(!i||!i._emissiveColor)return t;const s=this.hexToRgb(i._emissiveColor),o=(i._emissiveIntensity||0)*(this._emissiveIntensity||1);return.01>o?t:{r:Math.min(255,t.r+Math.round(s.r*o)),g:Math.min(255,t.g+Math.round(s.g*o)),b:Math.min(255,t.b+Math.round(s.b*o))}}isPointOccluded(e,t,i=null){if(!t||0===t.length)return!1;const s=e.x,o=this.projectCameraPoint(e);if(!o)return!0;const n=Math.floor(o.x),r=Math.floor(o.y);if(0>n||n>=this._renderTextureWidth||0>r||r>=this._renderTextureHeight)return!0;const a=o.x,l=o.y;for(const e of t){if(e===i)continue;if(e.isCulled)continue;if(!e.v0||!e.v1||!e.v2)continue;if(!e.v0.screen||!e.v1.screen||!e.v2.screen)continue;const t=e.v0.screen,o=e.v1.screen,n=e.v2.screen,r=(o.y-n.y)*(t.x-n.x)+(n.x-o.x)*(t.y-n.y);if(1e-6>Math.abs(r))continue;const h=((o.y-n.y)*(a-n.x)+(n.x-o.x)*(l-n.y))/r,c=((n.y-t.y)*(a-n.x)+(t.x-n.x)*(l-n.y))/r,d=1-h-c;if(h>=-.001&&c>=-.001&&d>=-.001){const t=e.v0.cameraPos?.x,i=e.v1.cameraPos?.x,o=e.v2.cameraPos?.x;if(void 0===t||void 0===i||void 0===o)continue;if(1e-6>=t||1e-6>=i||1e-6>=o)continue;const n=h/t+c/i+d/o;if(0>=n)continue;if(s-.05>1/n)return!0}}return!1}calculateFogFactor(e){if(!this._fogEnabled)return 0;if(e<=this._fogStart)return 0;if(e>=this._fogEnd)return this._fogDensity;const t=this._fogEnd-this._fogStart,i=(e-this._fogStart)/t*this._fogDensity;return Math.max(0,Math.min(this._fogDensity,i))}applyFog(e,t){if(!this._fogEnabled)return e;const i=this.calculateFogFactor(t);if(0===i)return e;const s=this.hexToRgb(this._fogColor);return{r:Math.round(e.r*(1-i)+s.r*i),g:Math.round(e.g*(1-i)+s.g*i),b:Math.round(e.b*(1-i)+s.b*i)}}isInFrustum(e,t){const i=this.worldToCameraSpace(e);if(i.x+t<this._nearPlane||i.x-t>this._farPlane)return!1;const s=this.viewportWidth/this.viewportHeight,o=this._fieldOfView*(Math.PI/180),n=Math.tan(.5*o),r=i.x*n*s;if(Math.abs(i.y)-t>r)return!1;const a=i.x*n;return Math.abs(i.z)-t<=a}renderRasterOptimized(){const e=performance.now(),t=this.getGameObjects(),i=this._renderTextureCtx,s=this._imageData,o=(s.data,this._renderTextureWidth),n=this._renderTextureHeight;this._debugStats.totalFaces=0,this._debugStats.renderedTriangles=0,this._debugStats.culledFaces=0,this._debugStats.clippedFaces=0,this._debugStats.specularHighlights=0;const r=new Uint32Array(s.data.buffer);this.clearBackgroundFast(r,o,n);const a=[],l=[],h=[],c=new Map;this.preRender(r,o,n),t.forEach(e=>{if(!e.active)return;const t=e.getModule("Mesh3D")||e.getModule("CubeMesh3D")||e.getModule("SphereMesh3D");if(!t)return;const i=e.getWorldPosition(),s=t.getBoundingRadius?t.getBoundingRadius():50,o=new Vector3(i.x,i.y,e.depth||0);if(!this.isInFrustum(o,s))return;const n=t.transformVertices();if(!n||!t.faces)return;const r=t.material,h=r?r.diffuseColor:t.faceColor||t._faceColor||"#888888";(t.enableLOD&&"function"==typeof t.applyLODSubdivision?t.applyLODSubdivision(t.faces,n,this):t.faces.map(e=>({face:e,level:0}))).forEach(({face:e,level:i})=>{let s;if(this._debugStats.totalFaces++,e[0]instanceof Vector3)s=e;else{const t=Array.isArray(e)?e:e.indices;if(!t||3>t.length)return;s=t.map(e=>n[e]).filter(e=>e)}if(3>s.length)return;const o=s.map(e=>this.worldToCameraSpace(e));if(3>o.length)return;const c=this.clipPolygonAgainstNearPlane(o,this._nearPlane);if(3>c.length)return void this._debugStats.clippedFaces++;const d=this.calculateFaceNormal(s[0],s[1],s[2]),p=this._enableBackfaceCulling&&this.shouldCullFace(c),u=c.map(e=>{const t=this.projectCameraPoint(e);return t?{screen:t,depth:e.x,cameraPos:e}:null}).filter(e=>e);if(3>u.length)return;const g=i=>e[0]instanceof Vector3?new Vector2(0,0):t.uvCoords&&t.uvCoords[i]?t.uvCoords[i]:new Vector2(0,0);for(let t=1;t<u.length-1;t++){const o=[s[0],s[Math.min(t,s.length-1)],s[Math.min(t+1,s.length-1)]];let n,c,m;if(e[0]instanceof Vector3)n=new Vector2(0,0),c=new Vector2(0,0),m=new Vector2(0,0);else{const i=Array.isArray(e)?e:e.indices;n=g(i[0]),c=g(i[Math.min(t,i.length-1)]),m=g(i[Math.min(t+1,i.length-1)])}const f=(u[0].cameraPos.x+u[t].cameraPos.x+u[t+1].cameraPos.x)/3,y={v0:u[0],v1:u[t],v2:u[t+1],uv0:n,uv1:c,uv2:m,worldVerts:o,worldNormal:d,material:r,faceColor:h,avgDepth:f,isCulled:p,lodLevel:i};a.push(y),p?this._debugStats.culledFaces++:(this._debugStats.renderedTriangles++,l.push(y))}})}),this._allTrianglesCache=l,l.sort((e,t)=>t.avgDepth-e.avgDepth),l.forEach(e=>{const t=this.calculateLightingWithDynamicLights(e.worldVerts,e.worldNormal,e.faceColor,a),i=this.calculateEmissiveColor(e,t),s=this.applyFog(i,e.avgDepth),l=255<<24|s.b<<16|s.g<<8|s.r;if(e.packedColor=l,e.fogFactor=this.calculateFogFactor(e.avgDepth),this.rasterizeTriangleFast(e,r,o,n),this._specularEnabled&&e.material&&e.material._specularColor&&.9>e.fogFactor){const t=[e.v0.screen,e.v1.screen,e.v2.screen];if(this._specularPerMesh){const i=e.material.gameObject;c.has(i)||c.set(i,{mesh:i,triangles:[],worldNormals:[],projectedBounds:{minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0}});const s=c.get(i);s.triangles.push(e),s.worldNormals.push(e.worldNormal);const o={minX:Math.min(t[0].x,t[1].x,t[2].x),maxX:Math.max(t[0].x,t[1].x,t[2].x),minY:Math.min(t[0].y,t[1].y,t[2].y),maxY:Math.max(t[0].y,t[1].y,t[2].y)};s.projectedBounds.minX=Math.min(s.projectedBounds.minX,o.minX),s.projectedBounds.maxX=Math.max(s.projectedBounds.maxX,o.maxX),s.projectedBounds.minY=Math.min(s.projectedBounds.minY,o.minY),s.projectedBounds.maxY=Math.max(s.projectedBounds.maxY,o.maxY)}else{const i=this.calculateSpecularHighlight(e,t);i&&(i.fogFactor=e.fogFactor,h.push(i))}}}),this._specularEnabled&&this._specularPerMesh&&c.size>0&&this.calculateMeshSpecularHighlights(c,h),this._debugStats.specularHighlights=h.length,h.length>0&&this.renderSpecularHighlights(h,s,o,n),this.postRender(r,o,n),i.putImageData(s,0,0),this.getNearbyLights().forEach(e=>{if(e._showLightSource){const t=e.getWorldPosition(),i=this.worldToCameraSpace(t);this.isPointOccluded(i,l)||e.drawLightSource(this)}}),this._showDebugInfo&&(this._debugStats.renderTime=performance.now()-e,this._debugStats.activeLights=this.getNearbyLights().length,this.drawDebugInfo(i)),this._allTrianglesCache=null}preRender(e,t,i){}postRender(e,t,i){}setPixel(e,t,i,s,o,n,r,a){t>=0&&r>t&&i>=0&&a>i&&(e[i*r+t]=255<<24|n<<16|o<<8|s)}getPixel(e,t,i,s,o){if(0>t||t>=s||0>i||i>=o)return null;const n=e[i*s+t];return{r:255&n,g:n>>8&255,b:n>>16&255}}blendPixel(e,t,i,s,o,n,r,a,l){if(0>t||t>=a||0>i||i>=l)return;if(0>=r)return;const h=i*a+t,c=e[h],d=c>>8&255,p=c>>16&255,u=Math.round((255&c)*(1-r)+s*r),g=Math.round(d*(1-r)+o*r),m=Math.round(p*(1-r)+n*r);e[h]=255<<24|m<<16|g<<8|u}drawLine(e,t,i,s,o,n,r,a,l,h){t=Math.round(t),i=Math.round(i),s=Math.round(s),o=Math.round(o);const c=Math.abs(s-t),d=Math.abs(o-i),p=s>t?1:-1,u=o>i?1:-1;let g=c-d;for(;this.setPixel(e,t,i,n,r,a,l,h),t!==s||i!==o;){const e=2*g;e>-d&&(g-=d,t+=p),c>e&&(g+=c,i+=u)}}drawCircle(e,t,i,s,o,n,r,a,l){let h=0,c=s,d=3-2*s;const p=(t,i,s,h)=>{this.setPixel(e,t+s,i+h,o,n,r,a,l),this.setPixel(e,t-s,i+h,o,n,r,a,l),this.setPixel(e,t+s,i-h,o,n,r,a,l),this.setPixel(e,t-s,i-h,o,n,r,a,l),this.setPixel(e,t+h,i+s,o,n,r,a,l),this.setPixel(e,t-h,i+s,o,n,r,a,l),this.setPixel(e,t+h,i-s,o,n,r,a,l),this.setPixel(e,t-h,i-s,o,n,r,a,l)};for(p(t,i,h,c);c>=h;)h++,d>0?(c--,d=d+4*(h-c)+10):d=d+4*h+6,p(t,i,h,c)}fillCircle(e,t,i,s,o,n,r,a,l){const h=s*s,c=Math.max(0,Math.floor(t-s)),d=Math.min(a-1,Math.ceil(t+s)),p=Math.max(0,Math.floor(i-s)),u=Math.min(l-1,Math.ceil(i+s));for(let s=p;u>=s;s++)for(let p=c;d>=p;p++){const c=p-t,d=s-i;c*c+d*d>h||this.setPixel(e,p,s,o,n,r,a,l)}}fillRect(e,t,i,s,o,n,r,a,l,h){const c=Math.max(0,Math.floor(t)),d=Math.min(l-1,Math.floor(t+s)),p=Math.max(0,Math.floor(i)),u=Math.min(h-1,Math.floor(i+o)),g=255<<24|a<<16|r<<8|n;for(let t=p;u>=t;t++){const i=t*l;for(let t=c;d>=t;t++)e[i+t]=g}}detectEdges(e,t,i,s=50){const o=new Uint8Array(t*i),n=[-1,0,1,-2,0,2,-1,0,1],r=[-1,-2,-1,0,0,0,1,2,1];for(let a=1;i-1>a;a++)for(let i=1;t-1>i;i++){let l=0,h=0;for(let s=-1;1>=s;s++)for(let o=-1;1>=o;o++){const c=e[(a+s)*t+(i+o)],d=((255&c)+(c>>8&255)+(c>>16&255))/3,p=3*(s+1)+(o+1);l+=d*n[p],h+=d*r[p]}const c=Math.sqrt(l*l+h*h);o[a*t+i]=c>s?255:0}return o}applyKernel(e,t,i,s,o=null){if(9!==s.length)return console.error("Kernel must be 3x3 (9 values)"),e;null===o&&0===(o=s.reduce((e,t)=>e+t,0))&&(o=1);const n=new Uint32Array(t*i);for(let r=1;i-1>r;r++)for(let i=1;t-1>i;i++){let a=0,l=0,h=0;for(let o=-1;1>=o;o++)for(let n=-1;1>=n;n++){const c=e[(r+o)*t+(i+n)],d=s[3*(o+1)+(n+1)];a+=(255&c)*d,l+=(c>>8&255)*d,h+=(c>>16&255)*d}a=Math.max(0,Math.min(255,Math.round(a/o))),l=Math.max(0,Math.min(255,Math.round(l/o))),h=Math.max(0,Math.min(255,Math.round(h/o))),n[r*t+i]=255<<24|h<<16|l<<8|a}for(let s=0;t>s;s++)n[s]=e[s],n[(i-1)*t+s]=e[(i-1)*t+s];for(let s=0;i>s;s++)n[s*t]=e[s*t],n[s*t+(t-1)]=e[s*t+(t-1)];return n}applyBoxBlur(e,t,i,s=1){const o=[,,,,,,,,,].fill(1);return this.applyKernel(e,t,i,o,9)}applyGaussianBlur(e,t,i){return this.applyKernel(e,t,i,[1,2,1,2,4,2,1,2,1],16)}applySharpen(e,t,i){return this.applyKernel(e,t,i,[0,-1,0,-1,5,-1,0,-1,0],1)}adjustBrightness(e,t,i,s){for(let t=0;t<e.length;t++){const i=e[t];let o=(255&i)+s,n=(i>>8&255)+s,r=(i>>16&255)+s;o=Math.max(0,Math.min(255,o)),n=Math.max(0,Math.min(255,n)),r=Math.max(0,Math.min(255,r)),e[t]=255<<24|r<<16|n<<8|o}}adjustContrast(e,t,i,s){const o=259*(s+255)/(255*(259-s));for(let t=0;t<e.length;t++){const i=e[t];let s=((255&i)-128)*o+128,n=((i>>8&255)-128)*o+128,r=((i>>16&255)-128)*o+128;s=Math.max(0,Math.min(255,s)),n=Math.max(0,Math.min(255,n)),r=Math.max(0,Math.min(255,r)),e[t]=255<<24|r<<16|n<<8|s}}adjustSaturation(e,t,i,s){for(let t=0;t<e.length;t++){const i=e[t],o=255&i,n=i>>8&255,r=i>>16&255,a=.299*o+.587*n+.114*r,l=Math.max(0,Math.min(255,a+(o-a)*s)),h=Math.max(0,Math.min(255,a+(n-a)*s)),c=Math.max(0,Math.min(255,a+(r-a)*s));e[t]=255<<24|c<<16|h<<8|l}}toGrayscale(e,t,i){for(let t=0;t<e.length;t++){const i=e[t],s=Math.round(.299*(255&i)+.587*(i>>8&255)+.114*(i>>16&255));e[t]=255<<24|s<<16|s<<8|s}}applyVignette(e,t,i,s=.5){const o=t/2,n=i/2,r=Math.sqrt(o*o+n*n);for(let a=0;i>a;a++)for(let i=0;t>i;i++){const l=i-o,h=a-n,c=1-Math.sqrt(l*l+h*h)/r*s,d=a*t+i,p=e[d];let u=(255&p)*c,g=(p>>8&255)*c,m=(p>>16&255)*c;u=Math.max(0,Math.min(255,u)),g=Math.max(0,Math.min(255,g)),m=Math.max(0,Math.min(255,m)),e[d]=255<<24|m<<16|g<<8|u}}drawDebugInfo(e){e.save(),e.fillStyle="rgba(0, 0, 0, 0.7)",e.fillRect(5,5,200,145),e.font="11px monospace",e.fillStyle="#00ff00",e.textAlign="left",e.textBaseline="top";const t=this._debugStats;["Total Faces: "+t.totalFaces,"Rendered Tris: "+t.renderedTriangles,"Culled: "+t.culledFaces,"Clipped: "+t.clippedFaces,"Specular: "+t.specularHighlights,`Active Lights: ${t.activeLights||0}/${this._maxLights}`,`Render Time: ${t.renderTime.toFixed(2)}ms`,"FPS: "+(1e3/t.renderTime).toFixed(1),`Resolution: ${this._renderTextureWidth}x${this._renderTextureHeight}`].forEach((t,i)=>{e.fillText(t,10,10+14*i)}),e.restore()}calculateSunPosition(){if(!this._showSun||"skybox"!==this._backgroundType)return null;const e=this._lightDirection,t=Math.sqrt(e.x**2+e.y**2+e.z**2),i={x:-e.x/t,y:-e.y/t,z:-e.z/t};if(0>=i.z)return null;const s=((this.gameObject&&this.gameObject.getWorldRotation?this.gameObject.getWorldRotation():0)+(this._rotation.z||0))*(Math.PI/180),o=(this._rotation.y||0)*(Math.PI/180),n=(this._rotation.x,Math.cos(-s)),r=Math.sin(-s);let a=i.x*n-i.y*r,l=i.x*r+i.y*n,h=i.z;const c=Math.cos(-o),d=Math.sin(-o),p=a*c+h*d,u=l,g=-a*d+h*c;if(0>=p)return null;const m=this.viewportWidth/this.viewportHeight,f=this._fieldOfView*(Math.PI/180),y=1/Math.tan(.5*f),w=1e3,b=g/w*y/(p/w),x=(u/w*(y/m)/(p/w)*.5+.5)*this.viewportWidth,v=(.5-.5*b)*this.viewportHeight;return new Vector2(x,v)}drawSun(e,t,i,s){if(!s)return;const o=Math.round(s.x),n=Math.round(s.y),r=this.hexToRgb(this._lightColor),a=this._sunGlowSize,l=Math.max(0,o-a),h=Math.min(t-1,o+a),c=Math.max(0,n-a),d=Math.min(i-1,n+a);for(let i=c;d>=i;i++)for(let s=l;h>=s;s++){const l=s-o,h=i-n,c=l*l+h*h;if(a*a>=c){const o=1-Math.sqrt(c)/a,n=o*o*.3;if(n>.01){const o=i*t+s,a=e[o],l=a>>8&255,h=a>>16&255,c=Math.min(255,Math.round((255&a)+r.r*n)),d=Math.min(255,Math.round(l+r.g*n)),p=Math.min(255,Math.round(h+r.b*n));e[o]=255<<24|p<<16|d<<8|c}}}const p=this._sunSize,u=Math.max(0,o-p),g=Math.min(t-1,o+p),m=Math.max(0,n-p),f=Math.min(i-1,n+p);for(let i=m;f>=i;i++)for(let s=u;g>=s;s++){const r=s-o,a=i-n,l=r*r+a*a;if(p*p>=l){const o=1-Math.sqrt(l)/p,n=o*o*(3-2*o),r=i*t+s,a=e[r],h=a>>8&255,c=a>>16&255,d=.7+.3*n,u=Math.min(255,Math.round((255&a)*(1-d)+255*d)),g=Math.min(255,Math.round(h*(1-d)+255*d)),m=Math.min(255,Math.round(c*(1-d)+255*d));e[r]=255<<24|m<<16|g<<8|u}}}drawLensFlare(e,t,i,s){if(!this._lensFlareEnabled||!s)return;const o=.5*t,n=.5*i,r=o-s.x,a=n-s.y,l=1-Math.min(1,Math.sqrt(r*r+a*a)/Math.sqrt(o*o+n*n));if(.1>l)return;const h=this.hexToRgb(this._lightColor);for(let o=0;o<this._lensFlareCount;o++){const n=(o+1)*this._lensFlareSpacing,c=s.x+r*n,d=s.y+a*n;if(0>c||c>=t||0>d||d>=i)continue;const p=o/(this._lensFlareCount-1),u=this._lensFlareSize*(.5+.5*p),g=this._lensFlareIntensity*l*(1-.3*p);let m={...h};if(this._lensFlareColorShift){const e=o%3/3;.33>e?(m.r=Math.min(255,1.2*h.r),m.g=Math.min(255,.8*h.g),m.b=Math.min(255,.6*h.b)):.66>e?(m.r=Math.min(255,.6*h.r),m.g=Math.min(255,1.2*h.g),m.b=Math.min(255,.8*h.b)):(m.r=Math.min(255,.8*h.r),m.g=Math.min(255,.6*h.g),m.b=Math.min(255,1.2*h.b))}this.drawFlareElement(e,t,i,c,d,u,g,m)}l>.3&&this.drawLensStreak(e,t,i,s,o,n,h,l)}drawFlareElement(e,t,i,s,o,n,r,a){const l=.5*n,h=Math.max(0,Math.floor(s-l)),c=Math.min(t-1,Math.ceil(s+l)),d=Math.max(0,Math.floor(o-l)),p=Math.min(i-1,Math.ceil(o+l)),u=l*l;for(let i=d;p>=i;i++)for(let n=h;c>=n;n++){const h=n-s,c=i-o,d=h*h+c*c;if(u>=d){const s=1-Math.sqrt(d)/l,o=r*s*s*(.95+.05*Math.cos(6*Math.atan2(c,h)))*.6;if(o>.01){const s=i*t+n,r=e[s],l=r>>8&255,h=r>>16&255,c=Math.min(255,Math.round((255&r)+a.r*o)),d=Math.min(255,Math.round(l+a.g*o)),p=Math.min(255,Math.round(h+a.b*o));e[s]=255<<24|p<<16|d<<8|c}}}}drawLensStreak(e,t,i,s,o,n,r,a){const l=.3*t*a,h=this._lensFlareIntensity*a*.3,c=Math.max(0,Math.floor(s.x-l)),d=Math.min(t-1,Math.ceil(s.x+l)),p=Math.max(0,Math.floor(s.y-2)),u=Math.min(i-1,Math.ceil(s.y+2));for(let i=p;u>=i;i++){const o=1-Math.abs(i-s.y)/2;for(let n=c;d>=n;n++){const a=h*(1-Math.abs(n-s.x)/l)*o;if(a>.01){const s=i*t+n,o=e[s],l=o>>8&255,h=o>>16&255,c=Math.min(255,Math.round((255&o)+r.r*a)),d=Math.min(255,Math.round(l+r.g*a)),p=Math.min(255,Math.round(h+r.b*a));e[s]=255<<24|p<<16|d<<8|c}}}}generateCloudNoise(e,t){const i=e=>1-((e^=e<<13)*(e*e*15731+789221)+1376312589&2147483647)/1073741824,s=Math.floor(e),o=Math.floor(t),n=e-s,r=t-o,a=n*n*(3-2*n),l=r*r*(3-2*r),h=i(s+i(o)),c=i(s+1+i(o)),d=i(s+i(o+1));return.5*(h+(c-h)*a+(d-h)*l+(h-c-d+i(s+1+i(o+1)))*a*l)+.5}generateCloudFBM(e,t,i=4){let s=0,o=1,n=1,r=0;for(let a=0;i>a;a++)s+=this.generateCloudNoise(e*n,t*n)*o,r+=o,o*=.5,n*=2;return s/r}renderClouds(e,t,i,s){if(!this._cloudsEnabled)return;this._cloudTime+=.016*this._cloudSpeed;const o=i*this._cloudThickness,n=s-i*this._cloudHeight,r=Math.max(0,Math.floor(n-o)),a=Math.min(i,Math.ceil(n));if(r>=a)return;const l=Math.max(1,Math.round(1/this._cloudResolution)),h=-((this.gameObject&&this.gameObject.getWorldRotation?this.gameObject.getWorldRotation():0)+(this._rotation.z||0))*(Math.PI/180),c=this._fieldOfView*(Math.PI/180),d=Math.tan(c/2);for(let s=r;a>s;s+=l){if(0>s||s>=i)continue;const r=(n-s)/o;if(0>r||r>1)continue;const a=1+2*(1-r),c=Math.sin(r*Math.PI);for(let o=0;t>o;o+=l){const n=2*(o/t-.5)*d*(t/i),r=Math.cos(h)*n-1*Math.sin(h),p=Math.sin(h)*n+1*Math.cos(h),u=(r*a+.1*this._cloudTime)/(.01*this._cloudScale),g=(p*a+.05*this._cloudTime)/(.01*this._cloudScale);let m=(this.generateCloudFBM(u,g,3)-(1-this._cloudDensity))/this._cloudDensity;if(m=Math.max(0,Math.min(1,m)),this._cloudSoftness>0&&(m=Math.pow(m,1+2*this._cloudSoftness)),m*=c,m>.01){const n=this.hexToRgb(this._lightColor),r=Math.round(255*this._cloudBrightness*(n.r/255)),a=Math.round(255*this._cloudBrightness*(n.g/255)),h=Math.round(255*this._cloudBrightness*(n.b/255));for(let n=0;l>n&&i>s+n;n++){const i=(s+n)*t;for(let s=0;l>s&&t>o+s;s++){const t=i+(o+s),n=e[t],l=n>>8&255,c=n>>16&255,d=Math.round((255&n)*(1-m)+r*m),p=Math.round(l*(1-m)+a*m),u=Math.round(c*(1-m)+h*m);e[t]=255<<24|u<<16|p<<8|d}}}}}}createSeededRandom(e){return function(){return(e=(9301*e+49297)%233280)/233280}}generateHillsProfile(){const e=this.createSeededRandom(this._hillsSeed),t=[],i=360,s=Array(i).fill(0);for(let t=0;4>t;t++){const o=Math.pow(2,t)*this._hillsFrequency,n=Math.pow(.5,t),r=Math.max(4,Math.floor(i/(20/o))),a=[];for(let t=0;r>t;t++)a.push({angle:t/r*360,height:e()});for(let e=0;i>e;e++){const t=e/i*r,o=Math.floor(t)%r,l=(o+1)%r,h=t-Math.floor(t),c=h*h*(3-2*h),d=a[o].height,p=d+(a[l].height-d)*c;s[e]+=p*n}}for(let o=0;i>o;o++){let i=s[o];this._hillsRoughness>0&&(i+=(e()-.5)*this._hillsRoughness*.2),i=Math.max(0,Math.min(1,i)),i=this._hillsMinHeight+i*(this._hillsMaxHeight-this._hillsMinHeight),t.push(i)}return t}getHillsHeightAtAngle(e){this._hillsCache||(this._hillsCache=this.generateHillsProfile());const t=Math.floor(e=(e%360+360)%360)%360,i=(t+1)%360,s=e-Math.floor(e);return this._hillsCache[t]+(this._hillsCache[i]-this._hillsCache[t])*s}renderHills(e,t,i,s){if(!this._hillsEnabled)return;const o=(this.gameObject&&this.gameObject.getWorldRotation?this.gameObject.getWorldRotation():0)+(this._rotation.z||0),n=this.hexToRgb(this._hillsBaseColor),r=this.hexToRgb(this._hillsTopColor),a=this._fogEnabled?this.hexToRgb(this._fogColor):null,l=this._fieldOfView*(Math.PI/180),h=(this._fieldOfView,t/i),c=2*Math.atan(Math.tan(l/2)*h)*(180/Math.PI)/t;for(let l=0;t>l;l++){const h=o+(l-t/2)*c,d=s-i*this.getHillsHeightAtAngle(h),p=s,u=Math.abs((l-t/2)/(t/2)),g=p-d;if(0>=g)continue;const m=Math.max(0,Math.floor(d)),f=Math.min(i,Math.ceil(p));if(i>m&&f>0)for(let i=m;f>i;i++){const s=(i-d)/g;let o=Math.round(r.r+(n.r-r.r)*s),h=Math.round(r.g+(n.g-r.g)*s),c=Math.round(r.b+(n.b-r.b)*s);if(this._hillsUseFogColor&&a){const e=this._hillsFogBlend*u;o=Math.round(o*(1-e)+a.r*e),h=Math.round(h*(1-e)+a.g*e),c=Math.round(c*(1-e)+a.b*e)}e[i*t+l]=255<<24|c<<16|h<<8|o}}}renderWaterReflections(e,t,i,s,o=null){this._waterEnabled&&this._waterReflectionEnabled&&(o&&this._showSun&&this.renderSunReflection(e,t,i,s,o),this._hillsEnabled&&this.renderHillsReflection(e,t,i,s))}renderSunReflection(e,t,i,s,o){const n=s-o.y;if(0>n)return;const r=s+.5*n;if(s>r||r>=i)return;const a=Math.round(o.x),l=Math.round(r),h=this.hexToRgb(this._lightColor),c=.8*this._waterReflectionOpacity,d=.7*this._sunSize,p=.5*this._sunGlowSize,u=1-Math.min(1,(l-s)/(i-s)),g=Math.max(0,a-p),m=Math.min(t-1,a+p),f=Math.max(Math.ceil(s),l-p),y=Math.min(i-1,l+p);for(let s=f;y>=s;s++){const o=Math.sin(s/i*Math.PI*4+this._waterTime)*this._waterReflectionDistortion*i*.5;for(let i=g;m>=i;i++){const n=i+Math.sin(i/t*Math.PI*8+1.3*this._waterTime)*this._waterReflectionDistortion*t*.3-a,r=s+o-l,d=n*n+r*r;if(p*p>=d){const o=1-Math.sqrt(d)/p,n=o*o*.2*c*u;if(n>.01){const o=s*t+i,r=e[o],a=r>>8&255,l=r>>16&255,c=Math.min(255,Math.round((255&r)+h.r*n)),d=Math.min(255,Math.round(a+h.g*n)),p=Math.min(255,Math.round(l+h.b*n));e[o]=255<<24|p<<16|d<<8|c}}}}const w=Math.max(0,a-d),b=Math.min(t-1,a+d),x=Math.max(Math.ceil(s),l-d),v=Math.min(i-1,l+d);for(let s=x;v>=s;s++){const o=Math.sin(s/i*Math.PI*4+this._waterTime)*this._waterReflectionDistortion*i*.5;for(let i=w;b>=i;i++){const n=i+Math.sin(i/t*Math.PI*8+1.3*this._waterTime)*this._waterReflectionDistortion*t*.3-a,r=s+o-l,h=n*n+r*r;if(d*d>=h){const o=1-Math.sqrt(h)/d,n=.5+o*o*(3-2*o)*.3,r=s*t+i,a=e[r],l=a>>8&255,p=a>>16&255,g=n*c*u,m=Math.min(255,Math.round((255&a)*(1-g)+255*g)),f=Math.min(255,Math.round(l*(1-g)+255*g)),y=Math.min(255,Math.round(p*(1-g)+255*g));e[r]=255<<24|y<<16|f<<8|m}}}}renderHillsReflection(e,t,i,s){const o=(this.gameObject&&this.gameObject.getWorldRotation?this.gameObject.getWorldRotation():0)+(this._rotation.z||0),n=this.hexToRgb(this._hillsBaseColor),r=this.hexToRgb(this._hillsTopColor),a=this._fieldOfView*(Math.PI/180),l=t/i,h=2*Math.atan(Math.tan(a/2)*l)*(180/Math.PI)/t;for(let a=0;t>a;a++){const l=o+(a-t/2)*h,c=i*this.getHillsHeightAtAngle(l),d=s-c,p=s;if(0>=c)continue;const u=Math.abs((a-t/2)/(t/2)),g=Math.ceil(s),m=Math.ceil(s+c),f=Math.max(0,g),y=Math.min(i,m);if(y>f)for(let o=f;y>o;o++){const l=s-(o-s)+Math.sin(a/t*Math.PI*4+this._waterTime)*this._waterReflectionDistortion*i,h=p-d;if(0>=h)continue;const c=Math.max(0,Math.min(h,l-d))/h;let f=Math.round(r.r+(n.r-r.r)*c),y=Math.round(r.g+(n.g-r.g)*c),w=Math.round(r.b+(n.b-r.b)*c);const b=o*t+a,x=e[b],v=255&x,M=x>>8&255,C=x>>16&255,_=1-(o-g)/(m-g),P=this._waterReflectionOpacity*_*(1-.5*u);f=Math.round(v*(1-P)+f*P),y=Math.round(M*(1-P)+y*P),w=Math.round(C*(1-P)+w*P),e[b]=255<<24|w<<16|y<<8|f}}}clearBackgroundFast(e,t,i){if("solid"===this._backgroundType){const t=this.hexToRgb(this._backgroundColor),i=255<<24|t.b<<16|t.g<<8|t.r;e.fill(i)}else if("skybox"===this._backgroundType){const s=this._fieldOfView*(Math.PI/180),o=.5*i+i*(-(this._rotation.y||0)*(Math.PI/180)/(s/2))*.6,n=o-2*i,r=o,a=o,l=o+2*i;for(let s=0;i>s;s++){let i;if(o>s){const e=Math.max(0,Math.min(1,(s-n)/(r-n)));i=this.interpolateColor(this._skyColor,this._skyColorHorizon,e)}else{const e=Math.max(0,Math.min(1,(s-a)/(l-a)));if(this._waterEnabled){const t=s-o,n=t/this._waterWaveHeight+this._waterTime,r=t/(2.3*this._waterWaveHeight)+.7*this._waterTime,a=t/(4.1*this._waterWaveHeight)+1.3*this._waterTime,l=Math.max(0,Math.min(1,e+(.035*Math.sin(n)+.02*Math.sin(r)+.015*Math.sin(a))*e*e));i=this.interpolateColor(this._floorColorHorizon,this._floorColor,l)}else i=this.interpolateColor(this._floorColorHorizon,this._floorColor,e)}const h=255<<24|i.b<<16|i.g<<8|i.r,c=s*t;for(let i=0;t>i;i++)e[c+i]=h}this._waterEnabled&&(this._waterTime+=.016*this._waterSpeed);const h=this.calculateSunPosition();h&&h.y<o&&(this.drawSun(e,t,i,h),this._lensFlareEnabled&&this.drawLensFlare(e,t,i,h)),this._hillsEnabled&&this.renderHills(e,t,i,o),this._waterEnabled&&this._waterReflectionEnabled&&this.renderWaterReflections(e,t,i,o,h),this._cloudsEnabled&&this.renderClouds(e,t,i,o)}else"transparent"===this._backgroundType&&e.fill(0)}rasterizeTriangleFast(e,t,i,s){const o={x:Math.round(e.v0.screen.x),y:Math.round(e.v0.screen.y)},n={x:Math.round(e.v1.screen.x),y:Math.round(e.v1.screen.y)},r={x:Math.round(e.v2.screen.x),y:Math.round(e.v2.screen.y)},a=Math.max(0,Math.min(o.x,n.x,r.x)),l=Math.min(i-1,Math.max(o.x,n.x,r.x)),h=Math.max(0,Math.min(o.y,n.y,r.y)),c=Math.min(s-1,Math.max(o.y,n.y,r.y));if(a>l||h>c)return;const d=o.x,p=o.y,u=n.x,g=n.y,m=r.x,f=r.y,y=u-d,w=g-p,b=m-u,x=f-g,v=d-m,M=p-f,C=y*(f-p)-w*(m-d);if(.5>Math.abs(C))return;const _=e.material;if(_&&(_.getDiffuseTexture()||_._useProceduralTexture)){const s=_.getDiffuseTexture();if(!s)return;const o=e.uv0||new Vector2(0,0),n=e.uv1||new Vector2(0,0),r=e.uv2||new Vector2(0,0),P=1/C,S=e.v0.depth,T=e.v1.depth,k=e.v2.depth,O=Math.min(S,T,k);for(let C=h;c>=C;C++){let h=y*(C-p)-w*(a-d),c=b*(C-g)-x*(a-u),A=v*(C-f)-M*(a-m);const D=-w,R=-x,B=-M,j=C*i;for(let i=a;l>=i;i++){if(h>=0&&c>=0&&A>=0){const a=j+i;if(this._zBuffer&&O>this._zBuffer[a]){h+=D,c+=R,A+=B;continue}const l=((g-f)*(i-m)+(m-u)*(C-f))*P,y=((f-p)*(i-m)+(d-m)*(C-f))*P,w=1-l-y,b=S*l+T*y+k*w;if(this._zBuffer&&b>=this._zBuffer[a]){h+=D,c+=R,A+=B;continue}this._zBuffer&&(this._zBuffer[a]=b);const x=o.x*l+n.x*y+r.x*w,v=o.y*l+n.y*y+r.y*w,M=_.sampleTexture(x,v,s).match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);if(M){const s=parseInt(M[1]),o=parseInt(M[2]),n=parseInt(M[3]),r=255&e.packedColor,a=e.packedColor>>8&255,l=e.packedColor>>16&255,h=Math.round(s/255*r),c=Math.round(o/255*a),d=255<<24|Math.round(n/255*l)<<16|c<<8|h;t[j+i]=d}}h+=D,c+=R,A+=B}}}else{const s=e.packedColor;for(let e=h;c>=e;e++){let o=y*(e-p)-w*(a-d),n=b*(e-g)-x*(a-u),r=v*(e-f)-M*(a-m);const h=-w,c=-x,C=-M,_=e*i;for(let e=a;l>=e;e++)0>o||0>n||0>r||(t[_+e]=s),o+=h,n+=c,r+=C}}}calculateSpecularHighlight(e,t){const i=e.material;if(!i)return null;const s=this.hexToRgb(i._specularColor||"#FFFFFF"),o=i._shininess||32;if(0===s.r&&0===s.g&&0===s.b)return null;const n=this.gameObject&&this.gameObject.getWorldPosition?this.gameObject.getWorldPosition():{x:0,y:0};let r=0;this.gameObject&&("function"==typeof this.gameObject.getWorldDepth?r=this.gameObject.getWorldDepth():"number"==typeof this.gameObject.depth&&(r=this.gameObject.depth));const a=(n.x||0)+(this._position.x||0),l=(n.y||0)+(this._position.y||0),h=r+(this._position.z||0),c=e.worldVerts||[e.v0,e.v1,e.v2],d=(c[0].x+c[1].x+c[2].x)/3,p=(c[0].y+c[1].y+c[2].y)/3,u=(c[0].z+c[1].z+c[2].z)/3,g={x:a-d,y:l-p,z:h-u},m=Math.sqrt(g.x**2+g.y**2+g.z**2);if(1e-4>m)return null;g.x/=m,g.y/=m,g.z/=m;const f=e.worldNormal,y=Math.sqrt(f.x**2+f.y**2+f.z**2);if(1e-4>y)return null;const w=f.x/y,b=f.y/y,x=f.z/y,v=this._lightDirection,M=Math.sqrt(v.x**2+v.y**2+v.z**2),C=v.x/M,_=v.y/M,P=v.z/M,S=w*-C+b*-_+x*-P;if(0>=S)return null;const T=2*S*w- -C,k=2*S*b- -_,O=2*S*x- -P,A=Math.max(0,T*g.x+k*g.y+O*g.z),D=Math.pow(A,o)*this._lightIntensity;if(.01>D)return null;const R={x:d+.5*T,y:p+.5*k,z:u+.5*O},B=this.worldToCameraSpace(R);if(B.x<=this._nearPlane)return null;const j=this.projectCameraPoint(B);if(!j)return null;const I=.3*Math.max(Math.abs(t[1].x-t[0].x),Math.abs(t[2].x-t[0].x),Math.abs(t[1].y-t[0].y),Math.abs(t[2].y-t[0].y))*Math.max(.1,1-o/256)*Math.max(.5,Math.min(1,100/B.x));return{centerX:j.x,centerY:j.y,radius:Math.max(3,I),intensity:D,color:s,depth:B.x,cameraPos:B,triangleBounds:{minX:Math.min(t[0].x,t[1].x,t[2].x),maxX:Math.max(t[0].x,t[1].x,t[2].x),minY:Math.min(t[0].y,t[1].y,t[2].y),maxY:Math.max(t[0].y,t[1].y,t[2].y),v0:t[0],v1:t[1],v2:t[2]}}}calculateMeshSpecularHighlights(e,t){e.forEach(e=>{const i=e.mesh.material;if(!i||!i._specularColor)return;const s=this.hexToRgb(i._specularColor||"#FFFFFF"),o=i._shininess||32;if(0===s.r&&0===s.g&&0===s.b)return;const n=this.gameObject&&this.gameObject.getWorldPosition?this.gameObject.getWorldPosition():{x:0,y:0};let r=0;this.gameObject&&("function"==typeof this.gameObject.getWorldDepth?r=this.gameObject.getWorldDepth():"number"==typeof this.gameObject.depth&&(r=this.gameObject.depth));const a=(n.x||0)+(this._position.x||0),l=(n.y||0)+(this._position.y||0),h=r+(this._position.z||0);e.triangles.forEach((i,n)=>{const r=i.worldVerts,c=e.worldNormals[n],d=(r[0].x+r[1].x+r[2].x)/3,p=(r[0].y+r[1].y+r[2].y)/3,u=(r[0].z+r[1].z+r[2].z)/3,g={x:a-d,y:l-p,z:h-u},m=Math.sqrt(g.x**2+g.y**2+g.z**2);if(1e-4>m)return;g.x/=m,g.y/=m,g.z/=m;const f=Math.sqrt(c.x**2+c.y**2+c.z**2);if(1e-4>f)return;const y=c.x/f,w=c.y/f,b=c.z/f,x=this._lightDirection,v=Math.sqrt(x.x**2+x.y**2+x.z**2),M=x.x/v,C=x.y/v,_=x.z/v,P=y*-M+w*-C+b*-_;if(0>=P)return;const S=2*P*y- -M,T=2*P*w- -C,k=2*P*b- -_,O=Math.max(0,S*g.x+T*g.y+k*g.z),A=Math.pow(O,o)*this._lightIntensity;if(.01>A)return;const D={x:d+.5*S,y:p+.5*T,z:u+.5*k},R=this.worldToCameraSpace(D);if(R.x<=this._nearPlane)return;const B=this.projectCameraPoint(R);if(!B)return;const j=[i.v0.screen,i.v1.screen,i.v2.screen],I=.3*Math.max(Math.abs(j[1].x-j[0].x),Math.abs(j[2].x-j[0].x),Math.abs(j[1].y-j[0].y),Math.abs(j[2].y-j[0].y))*Math.max(.1,1-o/256),E={centerX:B.x,centerY:B.y,radius:I,intensity:A,color:s,depth:R.x,cameraPos:R,triangleBounds:{minX:Math.min(j[0].x,j[1].x,j[2].x),maxX:Math.max(j[0].x,j[1].x,j[2].x),minY:Math.min(j[0].y,j[1].y,j[2].y),maxY:Math.max(j[0].y,j[1].y,j[2].y),v0:j[0],v1:j[1],v2:j[2]},isMeshSpecular:!0};t.push(E)})})}renderSpecularHighlights(e,t,i,s){const o=t.data,n=new Uint32Array(t.data.buffer),r=[this.hexToRgb(this._skyColor),this.hexToRgb(this._floorColor),this.hexToRgb(this._backgroundColor)];e.forEach(e=>{const{centerX:t,centerY:a,radius:l,intensity:h,color:c,triangleBounds:d,depth:p,cameraPos:u,fogFactor:g}=e;if(void 0!==g&&g>.9)return;if(u&&this.isPointOccluded(u,this._allTrianglesCache))return;const m=void 0!==g?h*(1-g):h;if(.01>m)return;const f={...e,intensity:m};this._specularFullFace?this.renderFullFaceSpecular(f,n,o,i,s,r):this.renderGradientSpecular(f,n,o,i,s,r),this._specularBloomEnabled&&m>=this._specularBloomThreshold&&this.renderSpecularBloom(f,n,o,i,s)})}renderSpecularBloom(e,t,i,s,o){const{centerX:n,centerY:r,radius:a,intensity:l,color:h}=e,c=a*this._specularBloomRadius,d=l*this._specularBloomIntensity,p=Math.max(0,Math.floor(n-c)),u=Math.min(s-1,Math.ceil(n+c)),g=Math.max(0,Math.floor(r-c)),m=Math.min(o-1,Math.ceil(r+c));if(p>u||g>m)return;const f=c*c,y=1/f,w=c>80?2:1;for(let e=g;m>=e;e+=w){const a=e-r,l=a*a;for(let r=p;u>=r;r+=w){const a=r-n,c=a*a+l;if(f>=c){const n=e*s+r,a=t[n],l=255&a,p=a>>8&255,g=a>>16&255,f=1-Math.sqrt(c*y),b=d*f*f*f;if(b>.005){const t=4*n,a=Math.min(255,Math.round(l+h.r*b)),c=Math.min(255,Math.round(p+h.g*b)),d=Math.min(255,Math.round(g+h.b*b));if(i[t]=a,i[t+1]=c,i[t+2]=d,w>1)for(let t=0;w>t&&m>=e+t;t++)for(let n=0;w>n&&u>=r+n;n++){if(0===n&&0===t)continue;const l=(e+t)*s+(r+n),h=4*l;l>=0&&s*o>l&&(i[h]=a,i[h+1]=c,i[h+2]=d)}}}}}}renderFullFaceSpecular(e,t,i,s,o,n){const{intensity:r,color:a,triangleBounds:l}=e,h=Math.max(0,Math.floor(l.minX)),c=Math.min(s-1,Math.ceil(l.maxX)),d=Math.max(0,Math.floor(l.minY)),p=Math.min(o-1,Math.ceil(l.maxY));if(h>c||d>p)return;const u=l.v0.x,g=l.v0.y,m=l.v1.x,f=l.v1.y,y=l.v2.x,w=l.v2.y,b=m-u,x=f-g,v=y-m,M=w-f,C=u-y,_=g-w,P=Math.min(r,1);for(let e=d;p>=e;e++)for(let o=h;c>=o;o++){if(0>b*(e-g)-x*(o-u)||0>v*(e-f)-M*(o-m)||0>C*(e-w)-_*(o-y))continue;const r=e*s+o,l=t[r],h=255&l,c=l>>8&255,d=l>>16&255;if(!this._specularBleedingEnabled){let e=!1;for(const t of n)if(5>=Math.abs(h-t.r)&&5>=Math.abs(c-t.g)&&5>=Math.abs(d-t.b)){e=!0;break}if(e)continue}const p=4*r,S=Math.min(255,h+a.r*P),T=Math.min(255,c+a.g*P),k=Math.min(255,d+a.b*P);i[p]=S,i[p+1]=T,i[p+2]=k}}renderGradientSpecular(e,t,i,s,o,n){const{centerX:r,centerY:a,radius:l,intensity:h,color:c,triangleBounds:d}=e;let p,u,g,m;if(this._specularBleedingEnabled?(p=Math.max(0,Math.floor(r-l)),u=Math.min(s-1,Math.ceil(r+l)),g=Math.max(0,Math.floor(a-l)),m=Math.min(o-1,Math.ceil(a+l))):(p=Math.max(0,Math.floor(Math.max(d.minX,r-l))),u=Math.min(s-1,Math.ceil(Math.min(d.maxX,r+l))),g=Math.max(0,Math.floor(Math.max(d.minY,a-l))),m=Math.min(o-1,Math.ceil(Math.min(d.maxY,a+l)))),p>u||g>m)return;const f=l*l,y=1/f;let w,b,x,v,M,C,_,P,S;this._specularBleedingEnabled||(w={x:d.v0.x,y:d.v0.y},b={x:d.v1.x,y:d.v1.y},x={x:d.v2.x,y:d.v2.y},v=b.x-w.x,M=b.y-w.y,C=x.x-b.x,_=x.y-b.y,P=w.x-x.x,S=w.y-x.y);const T=Math.min(h,1),k=l>50?2:1;for(let e=g;m>=e;e+=k){const o=e-a,l=o*o;for(let o=p;u>=o;o+=k){if(!this._specularBleedingEnabled){const t=v*(e-w.y)-M*(o-w.x),i=C*(e-b.y)-_*(o-b.x),s=P*(e-x.y)-S*(o-x.x);if(0>t||0>i||0>s)continue}const a=o-r,h=a*a+l;if(f>=h){const r=e*s+o,a=t[r],l=255&a,d=a>>8&255,p=a>>16&255;let g=!1;for(const e of n)if(5>=Math.abs(l-e.r)&&5>=Math.abs(d-e.g)&&5>=Math.abs(p-e.b)){g=!0;break}if(!this._specularBleedingEnabled&&g)continue;const f=1-Math.sqrt(h*y),w=T*f*f*(3-2*f);if(w>.01){const t=4*r,n=Math.min(255,l+c.r*w),a=Math.min(255,d+c.g*w),h=Math.min(255,p+c.b*w);if(i[t]=n,i[t+1]=a,i[t+2]=h,k>1)for(let t=0;k>t&&m>=e+t;t++)for(let r=0;k>r&&u>=o+r;r++){if(0===r&&0===t)continue;const l=4*((e+t)*s+(o+r));i[l]=n,i[l+1]=a,i[l+2]=h}}}}}}interpolateColor(e,t,i){const s=this.hexToRgb(e),o=this.hexToRgb(t);return{r:Math.round(s.r+(o.r-s.r)*i),g:Math.round(s.g+(o.g-s.g)*i),b:Math.round(s.b+(o.b-s.b)*i)}}calculateLighting(e,t){const i=Math.sqrt(this._lightDirection.x**2+this._lightDirection.y**2+this._lightDirection.z**2),s=this._lightDirection.x/i,o=this._lightDirection.y/i,n=this._lightDirection.z/i,r=-(e.x*s+e.y*o+e.z*n),a=Math.max(0,r)*this._lightIntensity,l=this._ambientIntensity+a*(1-this._ambientIntensity),h=this.hexToRgb(this._lightColor),c="string"==typeof t?this.hexToRgb(t):t;return{r:Math.min(255,Math.round(c.r*l*(h.r/255))),g:Math.min(255,Math.round(c.g*l*(h.g/255))),b:Math.min(255,Math.round(c.b*l*(h.b/255)))}}calculateFaceNormal(e,t,i){const s=t.x-e.x,o=t.y-e.y,n=t.z-e.z,r=i.x-e.x,a=i.y-e.y,l=i.z-e.z,h=o*l-n*a,c=n*r-s*l,d=s*a-o*r,p=Math.sqrt(h**2+c**2+d**2);return p>1e-10?{x:h/p,y:c/p,z:d/p}:{x:0,y:0,z:1}}shouldCullFace(e){if(!this._enableBackfaceCulling)return!1;if(3>e.length)return!0;const t=e[0],i=e[1],s=e[2],o=i.x-t.x,n=i.y-t.y,r=i.z-t.z,a=s.x-t.x,l=s.y-t.y,h=s.z-t.z,c=n*h-r*l,d=r*a-o*h,p=o*l-n*a,u=Math.sqrt(c*c+d*d+p*p);if(1e-10>u)return!0;const g=c/u,m=d/u,f=p/u,y={x:-(t.x+i.x+s.x)/3,y:-(t.y+i.y+s.y)/3,z:-(t.z+i.z+s.z)/3},w=Math.sqrt(y.x*y.x+y.y*y.y+y.z*y.z);return w>=1e-10&&(y.x/=w,y.y/=w,y.z/=w,-.05>g*y.x+m*y.y+f*y.z)}render3D(){this._renderTextureCtx&&(this._isActive||0===this.getGameObjects().filter(e=>{const t=e.getModule("Camera3DRasterizer")||e.getModule("Camera3D");return t&&t._isActive&&t!==this}).length&&(this._isActive=!0),this._isActive&&this.renderRasterOptimized())}uploadToWebGLTexture(e,t){return!(!this._renderTexture||!this._isActive||(e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._renderTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,this._renderTextureSmoothing?e.LINEAR:e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,this._renderTextureSmoothing?e.LINEAR:e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_2D,null),0))}getRenderedTexture(e=!1,t=null,i=null){return this._isActive||0===this.getGameObjects().filter(e=>{const t=e.getModule("Camera3DRasterizer")||e.getModule("Camera3D");return t&&t._isActive&&t!==this}).length&&(this._isActive=!0),this._isActive?(this.render3D(),e&&t&&i?(this.uploadToWebGLTexture(t,i),i):this._renderTexture):null}drawRenderedTexture(e,t=0,i=0,s=null,o=null){if(!this._renderTexture||!this._isActive)return;e.imageSmoothingEnabled=this._renderTextureSmoothing;const n=s||this._renderTextureWidth,r=o||this._renderTextureHeight;e.drawImage(this._renderTexture,t,i,n,r)}start(){this.updateViewport(),this.updateRenderTexture();const e=this.getGameObjects().map(e=>e.getModule("Camera3DRasterizer")||e.getModule("Camera3D")).filter(e=>null!=e),t=e.filter(e=>e._isActive);(1===e.length&&e[0]===this||0===t.length)&&(this._isActive=!0)}beginLoop(){this.updateViewport()}draw(e){}drawGizmos(e){e.save(),e.translate(this.gameObject.position.x,this.gameObject.position.y),e.rotate(this.gameObject.angle*Math.PI/180),e.fillStyle="#ffffff",e.fillRect(-3,-3,6,6),e.beginPath(),e.arc(0,0,2,0,2*Math.PI),e.fillStyle="#000000",e.fill();const t=this._fieldOfView/2*(Math.PI/180),i=10*this._nearPlane,s=.1*this._farPlane,o=i*Math.tan(t),n=s*Math.tan(t);e.strokeStyle="#ffff00",e.lineWidth=1,e.beginPath(),e.moveTo(0,0),e.lineTo(i,-o),e.moveTo(0,0),e.lineTo(i,o),e.moveTo(i,-o),e.lineTo(i,o),e.moveTo(i,-o),e.lineTo(s,-n),e.moveTo(i,o),e.lineTo(s,n),e.moveTo(s,-n),e.lineTo(s,n),e.stroke(),e.restore()}toJSON(){return{...super.toJSON(),_type:"Camera3DRasterizer",_position:{x:this._position.x,y:this._position.y,z:this._position.z},_rotation:{x:this._rotation.x,y:this._rotation.y,z:this._rotation.z},_fieldOfView:this._fieldOfView,_nearPlane:this._nearPlane,_farPlane:this._farPlane,_isActive:this._isActive,_backgroundColor:this._backgroundColor,_renderTextureWidth:this._renderTextureWidth,_renderTextureHeight:this._renderTextureHeight,_renderTextureSmoothing:this._renderTextureSmoothing,drawGizmoInRuntime:this.drawGizmoInRuntime,_renderingMethod:this._renderingMethod,_enableBackfaceCulling:this._enableBackfaceCulling,_lightDirection:{x:this._lightDirection.x,y:this._lightDirection.y,z:this._lightDirection.z},_lightColor:this._lightColor,_lightIntensity:this._lightIntensity,_ambientIntensity:this._ambientIntensity,_skyColor:this._skyColor,_skyColorHorizon:this._skyColorHorizon,_floorColor:this._floorColor,_floorColorHorizon:this._floorColorHorizon,_backgroundType:this._backgroundType,_showSun:this._showSun,_sunSize:this._sunSize,_sunGlowSize:this._sunGlowSize,_specularEnabled:this._specularEnabled,_specularBleedingEnabled:this._specularBleedingEnabled,_specularPerMesh:this._specularPerMesh,_specularFullFace:this._specularFullFace,_specularBloomEnabled:this._specularBloomEnabled,_specularBloomIntensity:this._specularBloomIntensity,_specularBloomRadius:this._specularBloomRadius,_specularBloomThreshold:this._specularBloomThreshold,_showDebugInfo:this._showDebugInfo,_maxLights:this._maxLights,_lightFindDistance:this._lightFindDistance,_useDynamicLighting:this._useDynamicLighting,_lensFlareEnabled:this._lensFlareEnabled,_lensFlareIntensity:this._lensFlareIntensity,_lensFlareCount:this._lensFlareCount,_lensFlareSpacing:this._lensFlareSpacing,_lensFlareSize:this._lensFlareSize,_lensFlareColorShift:this._lensFlareColorShift,_fogEnabled:this._fogEnabled,_fogColor:this._fogColor,_fogStart:this._fogStart,_fogEnd:this._fogEnd,_fogDensity:this._fogDensity,_waterEnabled:this._waterEnabled,_waterSpeed:this._waterSpeed,_waterWaveHeight:this._waterWaveHeight,_cloudsEnabled:this._cloudsEnabled,_cloudSpeed:this._cloudSpeed,_cloudDensity:this._cloudDensity,_cloudScale:this._cloudScale,_cloudSoftness:this._cloudSoftness,_cloudHeight:this._cloudHeight,_cloudThickness:this._cloudThickness,_cloudBrightness:this._cloudBrightness,_cloudResolution:this._cloudResolution,_emissiveIntensity:this._emissiveIntensity||1,_hillsEnabled:this._hillsEnabled,_hillsSeed:this._hillsSeed,_hillsMinHeight:this._hillsMinHeight,_hillsMaxHeight:this._hillsMaxHeight,_hillsFrequency:this._hillsFrequency,_hillsRoughness:this._hillsRoughness,_hillsBaseColor:this._hillsBaseColor,_hillsTopColor:this._hillsTopColor,_hillsUseFogColor:this._hillsUseFogColor,_hillsFogBlend:this._hillsFogBlend,_waterReflectionEnabled:this._waterReflectionEnabled,_waterReflectionOpacity:this._waterReflectionOpacity,_waterReflectionDistortion:this._waterReflectionDistortion}}fromJSON(e){super.fromJSON(e),e._position&&(this._position=new Vector3(e._position.x,e._position.y,e._position.z)),e._rotation&&(this._rotation=new Vector3(e._rotation.x,e._rotation.y,e._rotation.z)),void 0!==e._fieldOfView&&(this._fieldOfView=e._fieldOfView),void 0!==e._nearPlane&&(this._nearPlane=e._nearPlane),void 0!==e._farPlane&&(this._farPlane=e._farPlane),void 0!==e._isActive&&(this._isActive=e._isActive),void 0!==e._backgroundColor&&(this._backgroundColor=e._backgroundColor),void 0!==e._renderTextureWidth&&(this._renderTextureWidth=e._renderTextureWidth),void 0!==e._renderTextureHeight&&(this._renderTextureHeight=e._renderTextureHeight),void 0!==e._renderTextureSmoothing&&(this._renderTextureSmoothing=e._renderTextureSmoothing),void 0!==e.drawGizmoInRuntime&&(this.drawGizmoInRuntime=e.drawGizmoInRuntime),void 0!==e._renderingMethod&&(this._renderingMethod=e._renderingMethod),void 0!==e._enableBackfaceCulling&&(this._enableBackfaceCulling=e._enableBackfaceCulling),e._lightDirection&&(this._lightDirection=new Vector3(e._lightDirection.x,e._lightDirection.y,e._lightDirection.z)),void 0!==e._lightColor&&(this._lightColor=e._lightColor),void 0!==e._lightIntensity&&(this._lightIntensity=e._lightIntensity),void 0!==e._ambientIntensity&&(this._ambientIntensity=e._ambientIntensity),void 0!==e._skyColor?this._skyColor=e._skyColor:this._skyColor="#87CEEB",void 0!==e._skyColorHorizon?this._skyColorHorizon=e._skyColorHorizon:this._skyColorHorizon="#87CEEB",void 0!==e._floorColor?this._floorColor=e._floorColor:this._floorColor="#8B4513",void 0!==e._floorColorHorizon?this._floorColorHorizon=e._floorColorHorizon:this._floorColorHorizon="#654321",void 0!==e._backgroundType?this._backgroundType=e._backgroundType:this._backgroundType="skybox",void 0!==e._showSun?this._showSun=e._showSun:this._showSun=!0,void 0!==e._sunSize?this._sunSize=e._sunSize:this._sunSize=30,void 0!==e._sunGlowSize?this._sunGlowSize=e._sunGlowSize:this._sunGlowSize=60,void 0!==e._specularEnabled?this._specularEnabled=e._specularEnabled:this._specularEnabled=!0,void 0!==e._specularBleedingEnabled?this._specularBleedingEnabled=e._specularBleedingEnabled:this._specularBleedingEnabled=!1,void 0!==e._specularPerMesh?this._specularPerMesh=e._specularPerMesh:this._specularPerMesh=!1,void 0!==e._specularFullFace?this._specularFullFace=e._specularFullFace:this._specularFullFace=!1,void 0!==e._specularBloomEnabled?this._specularBloomEnabled=e._specularBloomEnabled:this._specularBloomEnabled=!1,void 0!==e._specularBloomIntensity?this._specularBloomIntensity=e._specularBloomIntensity:this._specularBloomIntensity=.5,void 0!==e._specularBloomRadius?this._specularBloomRadius=e._specularBloomRadius:this._specularBloomRadius=1.5,void 0!==e._specularBloomThreshold?this._specularBloomThreshold=e._specularBloomThreshold:this._specularBloomThreshold=.3,void 0!==e._showDebugInfo&&(this._showDebugInfo=e._showDebugInfo),void 0!==e._maxLights&&(this._maxLights=e._maxLights),void 0!==e._lightFindDistance&&(this._lightFindDistance=e._lightFindDistance),void 0!==e._useDynamicLighting&&(this._useDynamicLighting=e._useDynamicLighting),void 0!==e._lensFlareEnabled?this._lensFlareEnabled=e._lensFlareEnabled:this._lensFlareEnabled=!0,void 0!==e._lensFlareIntensity?this._lensFlareIntensity=e._lensFlareIntensity:this._lensFlareIntensity=.8,void 0!==e._lensFlareCount?this._lensFlareCount=e._lensFlareCount:this._lensFlareCount=5,void 0!==e._lensFlareSpacing?this._lensFlareSpacing=e._lensFlareSpacing:this._lensFlareSpacing=.15,void 0!==e._lensFlareSize?this._lensFlareSize=e._lensFlareSize:this._lensFlareSize=20,void 0!==e._lensFlareColorShift?this._lensFlareColorShift=e._lensFlareColorShift:this._lensFlareColorShift=!0,void 0!==e._fogEnabled?this._fogEnabled=e._fogEnabled:this._fogEnabled=!1,void 0!==e._fogColor?this._fogColor=e._fogColor:this._fogColor="#a0a0a0",void 0!==e._fogStart?this._fogStart=e._fogStart:this._fogStart=100,void 0!==e._fogEnd?this._fogEnd=e._fogEnd:this._fogEnd=500,void 0!==e._fogDensity?this._fogDensity=e._fogDensity:this._fogDensity=1,void 0!==e._waterEnabled?this._waterEnabled=e._waterEnabled:this._waterEnabled=!1,void 0!==e._waterSpeed?this._waterSpeed=e._waterSpeed:this._waterSpeed=1,void 0!==e._waterWaveHeight?this._waterWaveHeight=e._waterWaveHeight:this._waterWaveHeight=10,void 0!==e._cloudsEnabled?this._cloudsEnabled=e._cloudsEnabled:this._cloudsEnabled=!1,void 0!==e._cloudSpeed?this._cloudSpeed=e._cloudSpeed:this._cloudSpeed=.5,void 0!==e._cloudDensity?this._cloudDensity=e._cloudDensity:this._cloudDensity=.4,void 0!==e._cloudScale?this._cloudScale=e._cloudScale:this._cloudScale=150,void 0!==e._cloudSoftness?this._cloudSoftness=e._cloudSoftness:this._cloudSoftness=.6,void 0!==e._cloudHeight?this._cloudHeight=e._cloudHeight:this._cloudHeight=.3,void 0!==e._cloudThickness?this._cloudThickness=e._cloudThickness:this._cloudThickness=.4,void 0!==e._cloudBrightness?this._cloudBrightness=e._cloudBrightness:this._cloudBrightness=1,void 0!==e._cloudResolution?this._cloudResolution=e._cloudResolution:this._cloudResolution=.5,void 0!==e._emissiveIntensity?this._emissiveIntensity=e._emissiveIntensity:this._emissiveIntensity=1,void 0!==e._hillsEnabled?this._hillsEnabled=e._hillsEnabled:this._hillsEnabled=!1,void 0!==e._hillsSeed?this._hillsSeed=e._hillsSeed:this._hillsSeed=12345,void 0!==e._hillsMinHeight?this._hillsMinHeight=e._hillsMinHeight:this._hillsMinHeight=.1,void 0!==e._hillsMaxHeight?this._hillsMaxHeight=e._hillsMaxHeight:this._hillsMaxHeight=.4,void 0!==e._hillsFrequency?this._hillsFrequency=e._hillsFrequency:this._hillsFrequency=.5,void 0!==e._hillsRoughness?this._hillsRoughness=e._hillsRoughness:this._hillsRoughness=.6,void 0!==e._hillsBaseColor?this._hillsBaseColor=e._hillsBaseColor:this._hillsBaseColor="#2d5016",void 0!==e._hillsTopColor?this._hillsTopColor=e._hillsTopColor:this._hillsTopColor="#8b7355",void 0!==e._hillsUseFogColor?this._hillsUseFogColor=e._hillsUseFogColor:this._hillsUseFogColor=!0,void 0!==e._hillsFogBlend?this._hillsFogBlend=e._hillsFogBlend:this._hillsFogBlend=.7,void 0!==e._waterReflectionEnabled?this._waterReflectionEnabled=e._waterReflectionEnabled:this._waterReflectionEnabled=!0,void 0!==e._waterReflectionOpacity?this._waterReflectionOpacity=e._waterReflectionOpacity:this._waterReflectionOpacity=.3,void 0!==e._waterReflectionDistortion?this._waterReflectionDistortion=e._waterReflectionDistortion:this._waterReflectionDistortion=.05,this.updateRenderTexture()}get renderTextureWidth(){return this._renderTextureWidth}set renderTextureWidth(e){this._renderTextureWidth=Math.max(64,Math.min(2048,e)),this.updateRenderTexture()}get renderTextureHeight(){return this._renderTextureHeight}set renderTextureHeight(e){this._renderTextureHeight=Math.max(64,Math.min(2048,e)),this.updateRenderTexture()}get renderTextureSmoothing(){return this._renderTextureSmoothing}set renderTextureSmoothing(e){this._renderTextureSmoothing=e}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){this._backgroundColor=e}get position(){return this._position}set position(e){this._position=e}get rotation(){return this._rotation}set rotation(e){this._rotation=e}get fieldOfView(){return this._fieldOfView}set fieldOfView(e){this._fieldOfView=Math.max(1,Math.min(179,e))}get nearPlane(){return this._nearPlane}set nearPlane(e){this._nearPlane=Math.max(.01,e)}get farPlane(){return this._farPlane}set farPlane(e){this._farPlane=Math.max(1,e)}get isActive(){return this._isActive}set isActive(e){this._isActive=e}}window.Camera3DRasterizer=Camera3DRasterizer;class FlyCamera extends Module{static namespace="3D";constructor(){super("FlyCamera"),this.requires("Camera3DRasterizer"),this._moveSpeed=200,this._sprintMultiplier=2.5,this._verticalSpeed=150,this._smoothing=.2,this._currentVelocity=new Vector3(0,0,0),this._useZAxis=!0,this._lockZAxisPosition=!1,this._keyMapping={forward:"w",backward:"s",left:"a",right:"d",up:"e",down:"q",sprint:"shift"},this.camera=null,this.exposeProperty("moveSpeed","number",200,{min:1,max:1e3,onChange:e=>this._moveSpeed=e}),this.exposeProperty("sprintMultiplier","number",2.5,{min:1,max:10,onChange:e=>this._sprintMultiplier=e}),this.exposeProperty("verticalSpeed","number",150,{min:1,max:500,onChange:e=>this._verticalSpeed=e}),this.exposeProperty("smoothing","number",.2,{min:0,max:.99,step:.01,onChange:e=>this._smoothing=e}),this.exposeProperty("keyMapping","object",this._keyMapping,{onChange:e=>this._keyMapping=e}),this.exposeProperty("useZAxis","boolean",!0,{onChange:e=>this._useZAxis=e}),this.exposeProperty("lockZAxisPosition","boolean",!1,{onChange:e=>this._lockZAxisPosition=e}),this._collisionRadius=50,this._collisionEnabled=!0,this._slideAlongWalls=!0,this.exposeProperty("collisionRadius","number",50,{min:1,max:1e3,onChange:e=>this._collisionRadius=e}),this.exposeProperty("collisionEnabled","boolean",!0,{onChange:e=>this._collisionEnabled=e}),this.exposeProperty("slideAlongWalls","boolean",!0,{onChange:e=>this._slideAlongWalls=e})}start(){this.camera=this.getModule("Camera3DRasterizer"),this.camera||console.error("FlyCamera requires a Camera3D module on the same GameObject"),window.input||console.error("FlyCamera requires InputManager to be initialized")}loop(e){if(!this.camera||!window.input)return;const t=this.calculateTargetVelocity();this._currentVelocity.x+=(t.x-this._currentVelocity.x)*(1-this.smoothing),this._currentVelocity.y+=(t.y-this._currentVelocity.y)*(1-this.smoothing),this._currentVelocity.z+=(t.z-this._currentVelocity.z)*(1-this.smoothing),this._currentVelocity.magnitude()>.01&&this.moveCamera(e)}calculateTargetVelocity(){const e=new Vector3(0,0,0);if(!window.input)return e;const t=window.input.keyDown(this.keyMapping.sprint)?this.sprintMultiplier:1;return window.input.keyDown(this.keyMapping.forward)&&(e.x+=this.moveSpeed*t),window.input.keyDown(this.keyMapping.backward)&&(e.x-=this.moveSpeed*t),window.input.keyDown(this.keyMapping.left)&&(e.y-=this.moveSpeed*t),window.input.keyDown(this.keyMapping.right)&&(e.y+=this.moveSpeed*t),this._useZAxis&&(window.input.keyDown(this.keyMapping.up)&&(e.z+=this.verticalSpeed*t),window.input.keyDown(this.keyMapping.down)&&(e.z-=this.verticalSpeed*t)),e}findCollidableObjects(e){if(!window.engine||!window.engine.gameObjects)return[];const t=[],i=this.getCameraWorldPosition();for(const s of window.engine.gameObjects)if(s.active&&s!==this.gameObject&&s.getModule&&(s.getModule("Collider")||s.getModule("RigidBody")||s.getModule("BoundingBoxCollider"))){const o=s.getWorldPosition();Math.sqrt(Math.pow(i.x-o.x,2)+Math.pow(i.y-o.y,2))>e||t.push(s)}return t}getCameraWorldPosition(){return this.gameObject&&this.gameObject.position?{x:this.gameObject.position.x||0,y:this.gameObject.position.y||0}:{x:0,y:0}}checkMovementCollision(e,t){if(!e||.01>e.magnitude())return null;const i=this.getCameraWorldPosition();for(const s of t){const t=s.getBoundingBox();if(!t)continue;const o={origin:new Vector2(i.x,i.y),direction:new Vector2(e.x,e.y).normalize()},n=window.collisionSystem.raycast(o,t);if(n&&n.distance<=e.magnitude())return{object:s,hit:n,distance:n.distance}}return null}applyCollisionResponse(e,t){if(!this._slideAlongWalls)return new Vector3(0,0,e.z);const i=t.hit.normal,s=new Vector2(e.x,e.y),o=s.dot(i);if(o>=0)return e;const n=s.subtract(i.multiply(o));return new Vector3(n.x,n.y,e.z)}moveCamera(e){const t=this.gameObject&&"function"==typeof this.gameObject.getWorldRotation?this.gameObject.getWorldRotation():"number"==typeof this.gameObject.rotation?this.gameObject.rotation:0,i=this.camera&&this.camera.rotation&&"number"==typeof this.camera.rotation.z&&this.camera.rotation.z||0,s=(this.camera&&this.camera.rotation&&"number"==typeof this.camera.rotation.y&&this.camera.rotation.y,this.camera&&this.camera.rotation&&"number"==typeof this.camera.rotation.x&&this.camera.rotation.x,t+i);this.gameObject.position&&"number"==typeof this.gameObject.position.x&&"number"==typeof this.gameObject.position.y||(this.gameObject.position={x:0,y:0});const o=Vector3.rotateByEulerDeg(Vector3.forward(),s,0,0).normalize(),n=Vector3.rotateByEulerDeg(Vector3.right(),s,0,0).normalize(),r=o.multiply(this._currentVelocity.x).add(n.multiply(this._currentVelocity.y)),a=Number.isFinite(r.x)?r.x*e:0,l=Number.isFinite(r.y)?r.y*e:0,h=Number.isFinite(this._currentVelocity.z)?this._currentVelocity.z*e:0;let c=a,d=l;if(this._collisionEnabled&&(Math.abs(a)>.01||Math.abs(l)>.01)){const e=this.findCollidableObjects(this._collisionRadius);if(e.length>0){const t=new Vector3(a,l,0),i=this.checkMovementCollision(t,e);if(i){const s=this.applyCollisionResponse(t,i);s.magnitude()>.01?this.checkMovementCollision(s,e)?(c=0,d=0):(c=s.x,d=s.y):(c=0,d=0)}}}this.gameObject.position.x+=c,this.gameObject.position.y+=d,this.camera&&!this._lockZAxisPosition?(this.camera.position&&"number"==typeof this.camera.position.z||(this.camera.position=new Vector3(this.camera.position&&this.camera.position.x||0,this.camera.position&&this.camera.position.y||0,this.camera.position&&this.camera.position.z||0)),this.gameObject?"number"==typeof this.gameObject.depth?this.gameObject.depth=(this.gameObject.depth||0)+h:this.gameObject.position&&"number"==typeof this.gameObject.position.z?this.gameObject.position.z+=h:this.camera.position.z=(this.camera.position.z||0)+h:this.camera.position.z=(this.camera.position.z||0)+h):this.gameObject&&!this._lockZAxisPosition&&("number"==typeof this.gameObject.depth?this.gameObject.depth=(this.gameObject.depth||0)+h:"number"==typeof this.gameObject.position.z&&(this.gameObject.position.z+=h))}toJSON(){return{...super.toJSON(),_type:"FlyCamera",_moveSpeed:this._moveSpeed,_sprintMultiplier:this._sprintMultiplier,_verticalSpeed:this._verticalSpeed,_smoothing:this._smoothing,_keyMapping:{...this._keyMapping},_useZAxis:this._useZAxis,_lockZAxisPosition:this._lockZAxisPosition,_collisionRadius:this._collisionRadius,_collisionEnabled:this._collisionEnabled,_slideAlongWalls:this._slideAlongWalls}}fromJSON(e){super.fromJSON(e),void 0!==e._moveSpeed&&(this._moveSpeed=e._moveSpeed),void 0!==e._sprintMultiplier&&(this._sprintMultiplier=e._sprintMultiplier),void 0!==e._verticalSpeed&&(this._verticalSpeed=e._verticalSpeed),void 0!==e._smoothing&&(this._smoothing=e._smoothing),e._keyMapping&&(this._keyMapping={...e._keyMapping}),void 0!==e._useZAxis&&(this._useZAxis=e._useZAxis),void 0!==e._lockZAxisPosition&&(this._lockZAxisPosition=e._lockZAxisPosition),void 0!==e._collisionRadius&&(this._collisionRadius=e._collisionRadius),void 0!==e._collisionEnabled&&(this._collisionEnabled=e._collisionEnabled),void 0!==e._slideAlongWalls&&(this._slideAlongWalls=e._slideAlongWalls)}get moveSpeed(){return this._moveSpeed}set moveSpeed(e){this._moveSpeed=e}get sprintMultiplier(){return this._sprintMultiplier}set sprintMultiplier(e){this._sprintMultiplier=e}get verticalSpeed(){return this._verticalSpeed}set verticalSpeed(e){this._verticalSpeed=e}get smoothing(){return this._smoothing}set smoothing(e){this._smoothing=Math.max(0,Math.min(.99,e))}get keyMapping(){return this._keyMapping}set keyMapping(e){this._keyMapping=e}get useZAxis(){return this._useZAxis}set useZAxis(e){this._useZAxis=e}get lockZAxisPosition(){return this._lockZAxisPosition}set lockZAxisPosition(e){this._lockZAxisPosition=e}get collisionRadius(){return this._collisionRadius}set collisionRadius(e){this._collisionRadius=Math.max(1,e)}get collisionEnabled(){return this._collisionEnabled}set collisionEnabled(e){this._collisionEnabled=e}get slideAlongWalls(){return this._slideAlongWalls}set slideAlongWalls(e){this._slideAlongWalls=e}}window.FlyCamera=FlyCamera;class Light3D extends Module{static namespace="3D";constructor(){super("Light3D"),this._lightType="point",this._color="#FFFFFF",this._intensity=1,this._range=100,this._attenuation=2,this._spotAngle=45,this._spotSoftness=.1,this._spotDirection=new Vector3(0,0,-1),this._showLightSource=!0,this._lightSourceSize=10,this._lightSourceIntensity=1,this._lightSourceGlow=!0,this._castShadows=!0,this._shadowQuality="medium",this._camera=null,this._cameraSearchInterval=0,this.exposeProperty("lightType","dropdown",this._lightType,{options:["point","spot"],onChange:e=>this._lightType=e}),this.exposeProperty("color","color",this._color,{onChange:e=>this._color=e}),this.exposeProperty("intensity","number",this._intensity,{min:0,max:5,step:.1,onChange:e=>this._intensity=e}),this.exposeProperty("range","number",this._range,{min:1,max:1e3,step:1,onChange:e=>this._range=e}),this.exposeProperty("attenuation","number",this._attenuation,{min:.5,max:4,step:.1,onChange:e=>this._attenuation=e}),this.exposeProperty("spotAngle","number",this._spotAngle,{min:1,max:180,step:1,onChange:e=>this._spotAngle=e}),this.exposeProperty("spotSoftness","number",this._spotSoftness,{min:0,max:1,step:.01,onChange:e=>this._spotSoftness=e}),this.exposeProperty("spotDirection","vector3",this._spotDirection,{onChange:e=>this._spotDirection=e}),this.exposeProperty("showLightSource","boolean",this._showLightSource,{onChange:e=>this._showLightSource=e}),this.exposeProperty("lightSourceSize","number",this._lightSourceSize,{min:1,max:50,step:1,onChange:e=>this._lightSourceSize=e}),this.exposeProperty("lightSourceIntensity","number",this._lightSourceIntensity,{min:0,max:2,step:.1,onChange:e=>this._lightSourceIntensity=e}),this.exposeProperty("lightSourceGlow","boolean",this._lightSourceGlow,{onChange:e=>this._lightSourceGlow=e}),this.exposeProperty("castShadows","boolean",this._castShadows,{onChange:e=>this._castShadows=e}),this.exposeProperty("shadowQuality","dropdown",this._shadowQuality,{options:["low","medium","high"],onChange:e=>this._shadowQuality=e})}findAndRegisterCamera(){if(this._camera)return!0;const e=this.getAllGameObjects();for(const t of e){const e=t.getModule("Camera3DRasterizer");if(e&&e._isActive)return this._camera=e,e.registerLight(this),!0}return!1}getWorldPosition(){if(!this.gameObject)return new Vector3(0,0,0);const e=this.gameObject.getWorldPosition?this.gameObject.getWorldPosition():{x:0,y:0};let t=0;return"function"==typeof this.gameObject.getWorldDepth?t=this.gameObject.getWorldDepth():"number"==typeof this.gameObject.depth?t=this.gameObject.depth:this.gameObject.position&&this.gameObject.position.z&&(t=this.gameObject.position.z),new Vector3(e.x||0,e.y||0,t)}getWorldDirection(){if("spot"!==this._lightType)return new Vector3(0,0,-1);const e=(this.gameObject.getWorldRotation?this.gameObject.getWorldRotation():0)*(Math.PI/180),t=this._spotDirection,i=Math.cos(e),s=Math.sin(e);return new Vector3(t.x*i-t.y*s,t.x*s+t.y*i,t.z).normalize()}calculateLightContribution(e,t){const i=this.getWorldPosition(),s=i.x-e.x,o=i.y-e.y,n=i.z-e.z,r=Math.sqrt(s**2+o**2+n**2);if(r>this._range||.001>r)return{r:0,g:0,b:0,intensity:0};const a={x:s/r,y:o/r,z:n/r},l=Math.pow(1-r/this._range,this._attenuation);let h=1;if("spot"===this._lightType){const e=this.getWorldDirection(),t=-(a.x*e.x+a.y*e.y+a.z*e.z),i=this._spotAngle*(Math.PI/180),s=Math.cos(i/2);if(s>t)return{r:0,g:0,b:0,intensity:0};const o=this._spotSoftness*(1-s);s+o>t&&(h=(t-s)/o,h=h*h*(3-2*h))}const c=Math.sqrt(t.x**2+t.y**2+t.z**2),d=t.x/c,p=t.y/c,u=t.z/c,g=Math.max(0,d*a.x+p*a.y+u*a.z),m=this._intensity*l*h*g;if(.001>m)return{r:0,g:0,b:0,intensity:0};const f=this.hexToRgb(this._color);return{r:f.r*m,g:f.g*m,b:f.b*m,intensity:m,lightDir:a,distance:r}}hexToRgb(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:255,g:255,b:255}}drawLightSource(e){if(!this._showLightSource||!e||!e._renderTextureCtx)return;const t=this.getWorldPosition(),i=e.worldToCameraSpace(t);if(i.x<=e._nearPlane||i.x>=e._farPlane)return;const s=e.projectCameraPoint(i);if(!s)return;const o=e._renderTextureCtx,n=new Uint32Array(e._imageData.data.buffer),r=e._renderTextureWidth,a=e._renderTextureHeight,l=Math.round(s.x),h=Math.round(s.y),c=Math.max(.3,Math.min(2,50/i.x)),d=this._lightSourceSize*c,p=this.hexToRgb(this._color);if(this._lightSourceGlow){const e=3*d,t=Math.max(0,l-e),i=Math.min(r-1,l+e),s=Math.max(0,h-e),o=Math.min(a-1,h+e);for(let a=s;o>=a;a++)for(let s=t;i>=s;s++){const t=s-l,i=a-h,o=t*t+i*i;if(e*e>=o){const t=1-Math.sqrt(o)/e,i=t*t*.2*this._lightSourceIntensity;if(i>.01){const e=a*r+s,t=n[e],o=t>>8&255,l=t>>16&255,h=Math.min(255,Math.round((255&t)+p.r*i)),c=Math.min(255,Math.round(o+p.g*i)),d=Math.min(255,Math.round(l+p.b*i));n[e]=255<<24|d<<16|c<<8|h}}}}const u=d,g=Math.max(0,l-u),m=Math.min(r-1,l+u),f=Math.max(0,h-u),y=Math.min(a-1,h+u);for(let e=f;y>=e;e++)for(let t=g;m>=t;t++){const i=t-l,s=e-h,o=i*i+s*s;if(u*u>=o){const i=1-Math.sqrt(o)/u,s=i*i*(3-2*i),a=e*r+t,l=n[a],h=255&l,c=l>>8&255,d=l>>16&255,g=.5+.5*s*this._lightSourceIntensity,m=Math.min(255,Math.round(h*(1-g)+p.r*g)),f=Math.min(255,Math.round(c*(1-g)+p.g*g)),y=Math.min(255,Math.round(d*(1-g)+p.b*g));n[a]=255<<24|y<<16|f<<8|m}}o.putImageData(e._imageData,0,0)}isTriangleLit(e,t,i){if(!this._castShadows||this._lightBleeding)return!0;const s=this.getWorldPosition(),o=s.x-e.x,n=s.y-e.y,r=s.z-e.z,a=Math.sqrt(o**2+n**2+r**2);if(.001>a)return!0;const l={x:o/a,y:n/a,z:r/a},h=Math.sqrt(t.x**2+t.y**2+t.z**2);if(1e-4>h)return!1;const c=t.x/h,d=t.y/h,p=t.z/h;if(.05>=c*l.x+d*l.y+p*l.z)return!1;const u="high"===this._shadowQuality?i.length:"medium"===this._shadowQuality?Math.min(50,i.length):Math.min(20,i.length);for(let t=0;u>t;t++){const o=i[t],n={x:(o.worldVerts[0].x+o.worldVerts[1].x+o.worldVerts[2].x)/3,y:(o.worldVerts[0].y+o.worldVerts[1].y+o.worldVerts[2].y)/3,z:(o.worldVerts[0].z+o.worldVerts[1].z+o.worldVerts[2].z)/3},r=n.x-e.x,h=n.y-e.y,c=n.z-e.z;if(r*r+h*h+c*c>=.01&&this.isTriangleBlockingLight(e,s,a,o,l))return!1}return!0}isTriangleBlockingLight(e,t,i,s,o){const n=s.worldVerts;if(!n||3>n.length)return!1;const r=(n[0].x+n[1].x+n[2].x)/3,a=(n[0].y+n[1].y+n[2].y)/3,l=(n[0].z+n[1].z+n[2].z)/3,h=r-e.x,c=a-e.y,d=l-e.z,p=Math.sqrt(h**2+c**2+d**2);if(.1>p)return!1;if(p>=i-.1)return!1;const u=c/p,g=d/p;if(.94>h/p*o.x+u*o.y+g*o.z)return!1;const m=s.worldNormal;if(!m)return!1;const f=Math.sqrt(m.x**2+m.y**2+m.z**2);if(1e-4>f)return!1;const y=m.x/f,w=m.y/f,b=m.z/f;return y*o.x+w*o.y+b*o.z>.05}beginLoop(){this._camera||this._cameraSearchInterval++%60==0&&this.findAndRegisterCamera()}onDestroy(){this._camera&&(this._camera.unregisterLight(this),this._camera=null)}drawGizmos(e){if(!this.gameObject)return;e.save();const t=this.gameObject.position;if(e.translate(t.x,t.y),e.strokeStyle=this._color,e.fillStyle=this._color+"22",e.lineWidth=2,e.beginPath(),e.arc(0,0,this._range,0,2*Math.PI),e.fill(),e.stroke(),e.fillStyle=this._color+"88",e.beginPath(),e.arc(0,0,10,0,2*Math.PI),e.fill(),"spot"===this._lightType){const t=this.gameObject.angle||0,i=this._spotDirection,s=this._spotAngle/2*(Math.PI/180);e.strokeStyle=this._color,e.fillStyle=this._color+"11",e.lineWidth=1;const o=Math.atan2(i.y,i.x)+t*Math.PI/180;e.beginPath(),e.moveTo(0,0),e.arc(0,0,this._range,o-s,o+s),e.closePath(),e.fill(),e.stroke(),e.beginPath(),e.moveTo(0,0),e.lineTo(Math.cos(o)*this._range,Math.sin(o)*this._range),e.stroke()}e.fillStyle="#FFFFFF",e.font="12px Arial",e.textAlign="center",e.fillText("spot"===this._lightType?"SPOT":"POINT",0,-this._range-10),e.restore()}toJSON(){return{...super.toJSON(),_type:"Light3D",_lightType:this._lightType,_color:this._color,_intensity:this._intensity,_range:this._range,_attenuation:this._attenuation,_spotAngle:this._spotAngle,_spotSoftness:this._spotSoftness,_spotDirection:{x:this._spotDirection.x,y:this._spotDirection.y,z:this._spotDirection.z},_castShadows:this._castShadows,_shadowQuality:this._shadowQuality,_showLightSource:this._showLightSource,_lightSourceSize:this._lightSourceSize,_lightSourceIntensity:this._lightSourceIntensity,_lightSourceGlow:this._lightSourceGlow}}fromJSON(e){super.fromJSON(e),void 0!==e._lightType&&(this._lightType=e._lightType),void 0!==e._color&&(this._color=e._color),void 0!==e._intensity&&(this._intensity=e._intensity),void 0!==e._range&&(this._range=e._range),void 0!==e._attenuation&&(this._attenuation=e._attenuation),void 0!==e._spotAngle&&(this._spotAngle=e._spotAngle),void 0!==e._spotSoftness&&(this._spotSoftness=e._spotSoftness),e._spotDirection&&(this._spotDirection=new Vector3(e._spotDirection.x,e._spotDirection.y,e._spotDirection.z)),void 0!==e._castShadows&&(this._castShadows=e._castShadows),void 0!==e._shadowQuality&&(this._shadowQuality=e._shadowQuality),void 0!==e._showLightSource&&(this._showLightSource=e._showLightSource),void 0!==e._lightSourceSize&&(this._lightSourceSize=e._lightSourceSize),void 0!==e._lightSourceIntensity&&(this._lightSourceIntensity=e._lightSourceIntensity),void 0!==e._lightSourceGlow&&(this._lightSourceGlow=e._lightSourceGlow)}get lightType(){return this._lightType}set lightType(e){this._lightType=e}get color(){return this._color}set color(e){this._color=e}get intensity(){return this._intensity}set intensity(e){this._intensity=Math.max(0,e)}get range(){return this._range}set range(e){this._range=Math.max(1,e)}get attenuation(){return this._attenuation}set attenuation(e){this._attenuation=Math.max(.5,e)}get spotAngle(){return this._spotAngle}set spotAngle(e){this._spotAngle=Math.max(1,Math.min(180,e))}get spotSoftness(){return this._spotSoftness}set spotSoftness(e){this._spotSoftness=Math.max(0,Math.min(1,e))}get showLightSource(){return this._showLightSource}set showLightSource(e){this._showLightSource=e}get lightSourceSize(){return this._lightSourceSize}set lightSourceSize(e){this._lightSourceSize=Math.max(1,e)}get lightSourceIntensity(){return this._lightSourceIntensity}set lightSourceIntensity(e){this._lightSourceIntensity=Math.max(0,e)}get lightSourceGlow(){return this._lightSourceGlow}set lightSourceGlow(e){this._lightSourceGlow=e}get castShadows(){return this._castShadows}set castShadows(e){this._castShadows=e}get shadowQuality(){return this._shadowQuality}set shadowQuality(e){this._shadowQuality=e}}window.Light3D=Light3D;class Material extends Module{static namespace="3D";constructor(){super("Material"),this._diffuseColor="#FFFFFF",this._specularColor="#FFFFFF",this._emissiveColor="#000000",this._shininess=6,this._opacity=1,this._diffuseTexture=null,this._normalTexture=null,this._specularTexture=null,this._emissiveTexture=null,this._useProceduralTexture=!1,this._proceduralType="noise",this._proceduralSeed=12345,this._proceduralScale=1,this._proceduralColor1="#4CAF50",this._proceduralColor2="#2196F3",this._proceduralOctaves=4,this._proceduralPersistence=.5,this._proceduralLacunarity=2,this._uvScale=new Vector2(1,1),this._uvOffset=new Vector2(0,0),this._uvRotation=0,this._transparent=!1,this._doubleSided=!1,this._wireframe=!1,this._generatedTexture=null,this._textureSize=512,this._loadedTextures=new Map,this._texturePromises=new Map,this._textureLoadQueue=[],this.exposeProperty("diffuseColor","color",this._diffuseColor,{onChange:e=>this._diffuseColor=e}),this.exposeProperty("specularColor","color",this._specularColor,{onChange:e=>this._specularColor=e}),this.exposeProperty("shininess","number",this._shininess,{min:1,max:128,onChange:e=>this._shininess=e})}generateProceduralTexture(){const e=this._textureSize,t=document.createElement("canvas");t.width=e,t.height=e;const i=t.getContext("2d"),s=i.createImageData(e,e),o=s.data,n=this._parseColor(this._proceduralColor1),r=this._parseColor(this._proceduralColor2);for(let t=0;e>t;t++)for(let i=0;e>i;i++){const s=i/e,a=t/e;let l=0;switch(this._proceduralType){case"noise":l=this._generateNoise(s*this._proceduralScale,a*this._proceduralScale);break;case"checker":l=this._generateChecker(s*this._proceduralScale,a*this._proceduralScale);break;case"gradient":l=this._generateGradient(s,a);break;case"cellular":l=this._generateCellular(s*this._proceduralScale,a*this._proceduralScale)}l=Math.max(0,Math.min(1,(l+1)/2));const h=this._lerpColor(n,r,l),c=4*(t*e+i);o[c]=h.r,o[c+1]=h.g,o[c+2]=h.b,o[c+3]=255}return i.putImageData(s,0,0),this._generatedTexture=t,t}_generateNoise(e,t){const i=43758.5453*Math.sin(12.9898*e+78.233*t+this._proceduralSeed);return 2*(i-Math.floor(i))-1}_generateChecker(e,t){return(Math.floor(8*e)+Math.floor(8*t))%2==0?1:-1}_generateGradient(e,t){return Math.max(-1,Math.min(1,1-2*Math.sqrt((e-.5)**2+(t-.5)**2)))}_generateCellular(e,t){let i=1/0;for(let s=0;8>s;s++){const o=this._hash(2*s)+.5*Math.sin(s+this._proceduralSeed),n=this._hash(2*s+1)+.5*Math.cos(s+this._proceduralSeed);i=Math.min(i,Math.sqrt((e-o)**2+(t-n)**2))}return Math.max(-1,Math.min(1,1-4*i))}_hash(e){return((73856093*e^19349663*e)>>>0)/4294967295*2-1}_parseColor(e){if(!e)return{r:255,g:255,b:255};if("string"==typeof e&&e.startsWith("#")){const t=e.slice(1);if(3===t.length)return{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16)};if(6===t.length)return{r:parseInt(t.slice(0,2),16),g:parseInt(t.slice(2,4),16),b:parseInt(t.slice(4,6),16)}}if("string"==typeof e&&e.startsWith("rgb")){const t=e.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(t)return{r:parseInt(t[1]),g:parseInt(t[2]),b:parseInt(t[3])}}return{r:255,g:255,b:255}}_lerpColor(e,t,i){return{r:Math.round(e.r+(t.r-e.r)*i),g:Math.round(e.g+(t.g-e.g)*i),b:Math.round(e.b+(t.b-e.b)*i)}}getDiffuseTexture(){return this._useProceduralTexture?this._generatedTexture:this._diffuseTexture&&(this._diffuseTexture instanceof HTMLImageElement||this._diffuseTexture instanceof HTMLCanvasElement||this._diffuseTexture instanceof ImageData)?this._diffuseTexture:"string"==typeof this._diffuseTexture?this.loadTextureFromPath(this._diffuseTexture):this._diffuseTexture}async loadTextureFromPath(e){if(!e)return null;if(this._loadedTextures.has(e))return this._loadedTextures.get(e);if(this._texturePromises.has(e))return this._texturePromises.get(e);const t=this._loadTextureWithFallbacks(e);this._texturePromises.set(e,t);try{const i=await t;return this._loadedTextures.set(e,i),i}catch(t){return console.error("Failed to load texture:",e,t),this._texturePromises.delete(e),null}}async _loadTextureWithFallbacks(e){try{if(window.assetManager){const t=await window.assetManager.getAssetByPath(e);if(t&&(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement))return console.log("Texture loaded from AssetManager:",e),t}if(window.editor&&window.editor.fileBrowser)try{const t=await this._loadTextureFromFileBrowser(e);if(t)return console.log("Texture loaded via FileBrowser:",e),t}catch(e){console.warn("FileBrowser loading failed:",e)}return await this._loadTextureDirect(e)}catch(e){return console.error("Error in texture loading pipeline:",e),null}}async _loadTextureFromFileBrowser(e){const t=window.editor.fileBrowser,i=await t.readFile(e);if(!i)throw Error("Could not read texture file: "+e);if("string"==typeof i&&i.startsWith("data:image"))return this._loadTextureFromDataURL(i);if("string"==typeof i&&!i.startsWith("data:")){const t=e.split(".").pop().toLowerCase(),s=this._getMimeType(t);let o;return o=i.startsWith("data:")?i:`data:${s};base64,${i}`,this._loadTextureFromDataURL(o)}if(i instanceof Blob||i instanceof ArrayBuffer){let t=i;if(i instanceof ArrayBuffer){const s=e.split(".").pop().toLowerCase();t=new Blob([i],{type:"image/"+s})}const s=await this._blobToDataURL(t);return this._loadTextureFromDataURL(s)}throw Error("Unsupported texture content type: "+typeof i)}async _loadTextureDirect(e){return new Promise((t,i)=>{const s=new Image;s.onload=()=>{console.log("Texture loaded successfully:",e),t(s)},s.onerror=()=>{i(Error("Failed to load texture: "+e))},e.startsWith("http")&&!e.includes(window.location.hostname)&&(s.crossOrigin="anonymous"),s.src=e})}async _loadTextureFromDataURL(e){return new Promise((t,i)=>{const s=new Image;s.onload=()=>t(s),s.onerror=()=>i(Error("Failed to load texture from data URL")),s.src=e})}async _blobToDataURL(e){return new Promise((t,i)=>{const s=new FileReader;s.onload=()=>t(s.result),s.onerror=i,s.readAsDataURL(e)})}_getMimeType(e){return{png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",webp:"image/webp",svg:"image/svg+xml",bmp:"image/bmp"}[e]||"image/png"}preloadTexture(e){!e||this._loadedTextures.has(e)||this._texturePromises.has(e)||(this._textureLoadQueue.push(e),1===this._textureLoadQueue.length&&this._processTextureQueue())}async _processTextureQueue(){for(;this._textureLoadQueue.length>0;){const e=this._textureLoadQueue.shift();try{await this.loadTextureFromPath(e)}catch(t){console.warn("Failed to preload texture:",e,t)}}}clearTextureCache(e=null){e?(this._loadedTextures.delete(e),this._texturePromises.delete(e)):(this._loadedTextures.clear(),this._texturePromises.clear())}getTextureLoadingStats(){return{cached:this._loadedTextures.size,loading:this._texturePromises.size,queued:this._textureLoadQueue.length}}calculateLighting(e,t,i,s=[]){const o={diffuse:{r:0,g:0,b:0},specular:{r:0,g:0,b:0},ambient:this._parseColor(this._emissiveColor)},n=t.clone().normalize(),r=i.clone().normalize();for(const t of s){const i=t.position.clone().subtract(e).normalize(),s=this._parseColor(t.color||"#FFFFFF"),a=t.intensity||1,l=Math.max(0,n.dot(i));if(o.diffuse.r+=s.r*l*a,o.diffuse.g+=s.g*l*a,o.diffuse.b+=s.b*l*a,l>0){const e=n.clone().multiply(2*n.dot(i)).subtract(i),t=a*Math.pow(Math.max(0,e.dot(r)),this._shininess),s=this._parseColor(this._specularColor);o.specular.r+=s.r*t,o.specular.g+=s.g*t,o.specular.b+=s.b*t}}const a=e=>({r:Math.max(0,Math.min(255,e.r)),g:Math.max(0,Math.min(255,e.g)),b:Math.max(0,Math.min(255,e.b))});return o.diffuse=a(o.diffuse),o.specular=a(o.specular),o}getLitSurfaceColor(e,t,i,s=[],o=new Vector2(0,0)){let n;if(this._diffuseTexture){const e=this.sampleTexture(o.x,o.y);if(e){const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);n=t?{r:parseInt(t[1]),g:parseInt(t[2]),b:parseInt(t[3]),a:t[4]?parseFloat(t[4]):1}:this._parseColor(this._diffuseColor)}else n=this._parseColor(this._diffuseColor)}else n=this._parseColor(this._diffuseColor);const r=this.calculateLighting(e,t,i,s),a={r:Math.round(n.r*(r.ambient.r/255+r.diffuse.r/255)+r.specular.r),g:Math.round(n.g*(r.ambient.g/255+r.diffuse.g/255)+r.specular.g),b:Math.round(n.b*(r.ambient.b/255+r.diffuse.b/255)+r.specular.b),a:n.a*this._opacity};return a.r=Math.max(0,Math.min(255,a.r)),a.g=Math.max(0,Math.min(255,a.g)),a.b=Math.max(0,Math.min(255,a.b)),a}getSimpleLitColor(e,t,i,s=new Vector2(0,0)){const o=[{position:new Vector3(100,100,100),color:"#FFFFFF",intensity:1},{position:new Vector3(-50,-50,50),color:"#8888FF",intensity:.3}];return this.getLitSurfaceColor(e,t,i,o,s)}sampleTexture(e,t,i=null){const s=i||this.getDiffuseTexture();if(!s){const e=this._parseColor(this._diffuseColor);return`rgba(${e.r}, ${e.g}, ${e.b}, ${this._opacity})`}let o=e*this._uvScale.x+this._uvOffset.x,n=t*this._uvScale.y+this._uvOffset.y;if(0!==this._uvRotation){const e=this._uvRotation*Math.PI/180,t=Math.cos(e),i=Math.sin(e),s=.5,r=.5;o-=s,n-=r;const a=o*i+n*t;o=o*t-n*i+s,n=a+r}o=(o%1+1)%1,n=(n%1+1)%1;const r=Math.floor(o*s.width),a=Math.floor(n*s.height);if(r>=0&&r<s.width&&a>=0&&a<s.height){this._sampleCtx&&this._sampleCtx.canvas===s||(this._sampleCtx=s.getContext("2d",{willReadFrequently:!0}));try{const e=this._sampleCtx.getImageData(r,a,1,1).data;return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]*this._opacity/255})`}catch(e){const t=this._parseColor(this._diffuseColor);return`rgba(${t.r}, ${t.g}, ${t.b}, ${this._opacity})`}}const l=this._parseColor(this._diffuseColor);return`rgba(${l.r}, ${l.g}, ${l.b}, ${this._opacity})`}createTestTexture(){const e=256,t=document.createElement("canvas");t.width=e,t.height=e;const i=t.getContext("2d");for(let t=0;e>t;t++)for(let s=0;e>s;s++){const o=s/e,n=t/e,r=Math.floor(255*o),a=Math.floor(255*n),l=Math.floor((o+n)/2*255);i.fillStyle=`rgb(${r}, ${a}, ${l})`,i.fillRect(s,t,1,1)}return this._diffuseTexture=t,this._useProceduralTexture=!1,this._generatedTexture=null,t}clone(){const e=new Material;return e._diffuseColor=this._diffuseColor,e._specularColor=this._specularColor,e._emissiveColor=this._emissiveColor,e._shininess=this._shininess,e._opacity=this._opacity,e._diffuseTexture=this._diffuseTexture,e._normalTexture=this._normalTexture,e._specularTexture=this._specularTexture,e._emissiveTexture=this._emissiveTexture,e._useProceduralTexture=this._useProceduralTexture,e._proceduralType=this._proceduralType,e._proceduralSeed=this._proceduralSeed,e._proceduralScale=this._proceduralScale,e._proceduralColor1=this._proceduralColor1,e._proceduralColor2=this._proceduralColor2,e._proceduralOctaves=this._proceduralOctaves,e._proceduralPersistence=this._proceduralPersistence,e._proceduralLacunarity=this._proceduralLacunarity,e._uvScale=this._uvScale.clone(),e._uvOffset=this._uvOffset.clone(),e._uvRotation=this._uvRotation,e._transparent=this._transparent,e._doubleSided=this._doubleSided,e._wireframe=this._wireframe,e}toJSON(){return{...super.toJSON(),_type:"Material",_diffuseColor:this._diffuseColor,_specularColor:this._specularColor,_emissiveColor:this._emissiveColor,_shininess:this._shininess,_opacity:this._opacity,_diffuseTexture:this._diffuseTexture,_normalTexture:this._normalTexture,_specularTexture:this._specularTexture,_emissiveTexture:this._emissiveTexture,_useProceduralTexture:!1,_proceduralType:this._proceduralType,_proceduralSeed:this._proceduralSeed,_proceduralScale:this._proceduralScale,_proceduralColor1:this._proceduralColor1,_proceduralColor2:this._proceduralColor2,_proceduralOctaves:this._proceduralOctaves,_proceduralPersistence:this._proceduralPersistence,_proceduralLacunarity:this._proceduralLacunarity,_uvScale:{x:this._uvScale.x,y:this._uvScale.y},_uvOffset:{x:this._uvOffset.x,y:this._uvOffset.y},_uvRotation:this._uvRotation,_transparent:this._transparent,_doubleSided:this._doubleSided,_wireframe:this._wireframe}}fromJSON(e){super.fromJSON(e),void 0!==e._diffuseColor&&(this._diffuseColor=e._diffuseColor),void 0!==e._specularColor&&(this._specularColor=e._specularColor),void 0!==e._emissiveColor&&(this._emissiveColor=e._emissiveColor),void 0!==e._shininess&&(this._shininess=e._shininess),void 0!==e._opacity&&(this._opacity=e._opacity,this._transparent=1>e._opacity),void 0!==e._diffuseTexture&&(this._diffuseTexture=e._diffuseTexture),void 0!==e._normalTexture&&(this._normalTexture=e._normalTexture),void 0!==e._specularTexture&&(this._specularTexture=e._specularTexture),void 0!==e._emissiveTexture&&(this._emissiveTexture=e._emissiveTexture),void 0!==e._useProceduralTexture&&(this._useProceduralTexture=!1),void 0!==e._proceduralType&&(this._proceduralType=e._proceduralType),void 0!==e._proceduralSeed&&(this._proceduralSeed=e._proceduralSeed),void 0!==e._proceduralScale&&(this._proceduralScale=e._proceduralScale),void 0!==e._proceduralColor1&&(this._proceduralColor1=e._proceduralColor1),void 0!==e._proceduralColor2&&(this._proceduralColor2=e._proceduralColor2),void 0!==e._proceduralOctaves&&(this._proceduralOctaves=e._proceduralOctaves),void 0!==e._proceduralPersistence&&(this._proceduralPersistence=e._proceduralPersistence),void 0!==e._proceduralLacunarity&&(this._proceduralLacunarity=e._proceduralLacunarity),e._uvScale&&(this._uvScale=new Vector2(e._uvScale.x,e._uvScale.y)),e._uvOffset&&(this._uvOffset=new Vector2(e._uvOffset.x,e._uvOffset.y)),void 0!==e._uvRotation&&(this._uvRotation=e._uvRotation),void 0!==e._transparent&&(this._transparent=e._transparent),void 0!==e._doubleSided&&(this._doubleSided=e._doubleSided),void 0!==e._wireframe&&(this._wireframe=e._wireframe),this._useProceduralTexture&&this.generateProceduralTexture()}get diffuseColor(){return this._diffuseColor}set diffuseColor(e){this._diffuseColor=e}get specularColor(){return this._specularColor}set specularColor(e){this._specularColor=e}get emissiveColor(){return this._emissiveColor}set emissiveColor(e){this._emissiveColor=e}get shininess(){return this._shininess}set shininess(e){this._shininess=Math.max(1,Math.min(128,e))}get opacity(){return this._opacity}set opacity(e){this._opacity=Math.max(0,Math.min(1,e)),this._transparent=1>this._opacity}get diffuseTexture(){return this._diffuseTexture}set diffuseTexture(e){this._diffuseTexture=e,this._useProceduralTexture=!1,this._generatedTexture=null,"string"==typeof e&&this.preloadTexture(e)}get useProceduralTexture(){return this._useProceduralTexture}set useProceduralTexture(e){this._useProceduralTexture=e,e&&(this._diffuseTexture=null,this.generateProceduralTexture())}get proceduralType(){return this._proceduralType}set proceduralType(e){this._proceduralType=e}get proceduralSeed(){return this._proceduralSeed}set proceduralSeed(e){this._proceduralSeed=e}get proceduralScale(){return this._proceduralScale}set proceduralScale(e){this._proceduralScale=e}get proceduralColor1(){return this._proceduralColor1}set proceduralColor1(e){this._proceduralColor1=e}get proceduralColor2(){return this._proceduralColor2}set proceduralColor2(e){this._proceduralColor2=e}get uvScale(){return this._uvScale}set uvScale(e){this._uvScale=e}get uvOffset(){return this._uvOffset}set uvOffset(e){this._uvOffset=e}get uvRotation(){return this._uvRotation}set uvRotation(e){this._uvRotation=e}get transparent(){return this._transparent}set transparent(e){this._transparent=e}get doubleSided(){return this._doubleSided}set doubleSided(e){this._doubleSided=e}get wireframe(){return this._wireframe}set wireframe(e){this._wireframe=e}}window.Material=Material;class Mesh3D extends Module{static namespace="3D";constructor(){super("Mesh3D"),this.vertices=[],this.edges=[],this.faces=[],this.position=new Vector3(0,0,0),this.rotation=new Vector3(0,0,0),this.scale=new Vector3(1,1,1),this.rotationSpeed=new Vector3(0,0,0),this.enableLOD=!1,this.minLODDistance=100,this.maxLODDistance=500,this.maxSubdivisions=3,this.lodCache=new Map,this.lastCameraPosition=null,this.lodUpdateThreshold=10,this.wireframeColor="#FFFFFF",this.faceColor="#3F51B5",this.renderMode="solid",this.material=null,this._showAxisLines=!1,this._axisLength=150,this._shape="cube",this.exposeProperty("_shape","enum",this._shape,{options:["cube","pyramid","sphere","octahedron","torus","cone","cylinder","icosahedron","quadCube","capsule","prism","tetrahedron","quad","plane","custom"],onChange:e=>{this._shape=e,this.updateShape()}}),this.exposeProperty("position","vector3",this.position,{onChange:e=>{e&&"object"==typeof e?(void 0!==e.x&&(this.position.x=e.x),void 0!==e.y&&(this.position.y=e.y),void 0!==e.z&&(this.position.z=e.z)):this.position=e}}),this.exposeProperty("rotation","vector3",this.rotation,{onChange:e=>{e&&"object"==typeof e?(void 0!==e.x&&(this.rotation.x=e.x),void 0!==e.y&&(this.rotation.y=e.y),void 0!==e.z&&(this.rotation.z=e.z)):this.rotation=e}}),this.exposeProperty("scale","vector3",this.scale,{onChange:e=>{e&&"object"==typeof e?(void 0!==e.x&&(this.scale.x=e.x),void 0!==e.y&&(this.scale.y=e.y),void 0!==e.z&&(this.scale.z=e.z)):this.scale=e}}),this.exposeProperty("rotationSpeed","vector3",this.rotationSpeed,{onChange:e=>{e&&"object"==typeof e?(void 0!==e.x&&(this.rotationSpeed.x=e.x),void 0!==e.y&&(this.rotationSpeed.y=e.y),void 0!==e.z&&(this.rotationSpeed.z=e.z)):this.rotationSpeed=e}}),this.exposeProperty("enableLOD","boolean",!1,{onChange:e=>{this.enableLOD=e,e||this.lodCache.clear()}}),this.exposeProperty("minLODDistance","number",100,{min:10,max:1e3,step:10,onChange:e=>{this.minLODDistance=e,this.lodCache.clear()}}),this.exposeProperty("maxLODDistance","number",500,{min:100,max:2e3,step:50,onChange:e=>{this.maxLODDistance=e,this.lodCache.clear()}}),this.exposeProperty("maxSubdivisions","number",3,{min:0,max:5,step:1,onChange:e=>{this.maxSubdivisions=e,this.lodCache.clear()}}),this.cubeSize=100,this.exposeProperty("cubeSize","number",100,{min:10,max:500,step:10,onChange:e=>{this.cubeSize=e,"cube"===this._shape&&this.createCube(e)}}),this.pyramidBaseSize=100,this.pyramidHeight=150,this.exposeProperty("pyramidBaseSize","number",100,{min:10,max:500,step:10,onChange:e=>{this.pyramidBaseSize=e,"pyramid"===this._shape&&this.createPyramid(e,this.pyramidHeight)}}),this.exposeProperty("pyramidHeight","number",150,{min:10,max:500,step:10,onChange:e=>{this.pyramidHeight=e,"pyramid"===this._shape&&this.createPyramid(this.pyramidBaseSize,e)}}),this.sphereRadius=50,this.sphereDetail=12,this.exposeProperty("sphereRadius","number",100,{min:10,max:500,step:10,onChange:e=>{this.sphereRadius=e,"sphere"===this._shape&&this.createSphere(e,this.sphereDetail)}}),this.exposeProperty("sphereDetail","number",12,{min:6,max:24,step:1,onChange:e=>{this.sphereDetail=e,"sphere"===this._shape&&this.createSphere(this.sphereRadius,e)}}),this.octahedronSize=50,this.exposeProperty("octahedronSize","number",50,{min:10,max:500,step:10,onChange:e=>{this.octahedronSize=e,"octahedron"===this._shape&&this.createOctahedron(e)}}),this.planeSize=100,this.exposeProperty("planeSize","number",100,{min:10,max:500,step:10,onChange:e=>{this.planeSize=e,"plane"===this._shape&&this.createPlane(e)}}),this.quadCubeSize=100,this.quadCubeSubdivisions=2,this.exposeProperty("quadCubeSize","number",100,{min:10,max:500,step:10,onChange:e=>{this.quadCubeSize=e,"quadCube"===this._shape&&this.createQuadCube(e,this.quadCubeSubdivisions)}}),this.exposeProperty("quadCubeSubdivisions","number",2,{min:1,max:10,step:1,onChange:e=>{this.quadCubeSubdivisions=e,"quadCube"===this._shape&&this.createQuadCube(this.quadCubeSize,e)}}),this.capsuleRadius=15,this.capsuleHeight=30,this.capsuleSegments=8,this.exposeProperty("capsuleRadius","number",15,{min:10,max:200,step:5,onChange:e=>{this.capsuleRadius=e,"capsule"===this._shape&&this.createCapsule(e,this.capsuleHeight,this.capsuleSegments)}}),this.exposeProperty("capsuleHeight","number",150,{min:20,max:500,step:10,onChange:e=>{this.capsuleHeight=e,"capsule"===this._shape&&this.createCapsule(this.capsuleRadius,e,this.capsuleSegments)}}),this.exposeProperty("capsuleSegments","number",16,{min:6,max:32,step:1,onChange:e=>{this.capsuleSegments=e,"capsule"===this._shape&&this.createCapsule(this.capsuleRadius,this.capsuleHeight,e)}}),this.prismSides=6,this.prismRadius=50,this.prismHeight=100,this.exposeProperty("prismSides","number",6,{min:3,max:12,step:1,onChange:e=>{this.prismSides=e,"prism"===this._shape&&this.createPrism(e,this.prismRadius,this.prismHeight)}}),this.exposeProperty("prismRadius","number",100,{min:10,max:300,step:10,onChange:e=>{this.prismRadius=e,"prism"===this._shape&&this.createPrism(this.prismSides,e,this.prismHeight)}}),this.exposeProperty("prismHeight","number",150,{min:10,max:500,step:10,onChange:e=>{this.prismHeight=e,"prism"===this._shape&&this.createPrism(this.prismSides,this.prismRadius,e)}}),this.tetrahedronSize=50,this.exposeProperty("tetrahedronSize","number",100,{min:10,max:500,step:10,onChange:e=>{this.tetrahedronSize=e,"tetrahedron"===this._shape&&this.createTetrahedron(e)}}),this.torusMajorRadius=50,this.torusMinorRadius=15,this.torusMajorSegments=16,this.torusMinorSegments=8,this.exposeProperty("torusMajorRadius","number",100,{min:20,max:300,step:10,onChange:e=>{this.torusMajorRadius=e,"torus"===this._shape&&this.createTorus(e,this.torusMinorRadius,this.torusMajorSegments,this.torusMinorSegments)}}),this.exposeProperty("torusMinorRadius","number",40,{min:10,max:100,step:5,onChange:e=>{this.torusMinorRadius=e,"torus"===this._shape&&this.createTorus(this.torusMajorRadius,e,this.torusMajorSegments,this.torusMinorSegments)}}),this.exposeProperty("torusMajorSegments","number",16,{min:8,max:32,step:1,onChange:e=>{this.torusMajorSegments=e,"torus"===this._shape&&this.createTorus(this.torusMajorRadius,this.torusMinorRadius,e,this.torusMinorSegments)}}),this.exposeProperty("torusMinorSegments","number",8,{min:4,max:16,step:1,onChange:e=>{this.torusMinorSegments=e,"torus"===this._shape&&this.createTorus(this.torusMajorRadius,this.torusMinorRadius,this.torusMajorSegments,e)}}),this.coneRadius=50,this.coneHeight=100,this.coneSegments=8,this.exposeProperty("coneRadius","number",50,{min:10,max:500,step:10,onChange:e=>{this.coneRadius=e,"cone"===this._shape&&this.createCone(e,this.coneHeight,this.coneSegments)}}),this.exposeProperty("coneHeight","number",100,{min:10,max:500,step:10,onChange:e=>{this.coneHeight=e,"cone"===this._shape&&this.createCone(this.coneRadius,e,this.coneSegments)}}),this.exposeProperty("coneSegments","number",8,{min:6,max:32,step:1,onChange:e=>{this.coneSegments=e,"cone"===this._shape&&this.createCone(this.coneRadius,this.coneHeight,e)}}),this.cylinderRadius=50,this.cylinderHeight=100,this.cylinderSegments=8,this.exposeProperty("cylinderRadius","number",50,{min:10,max:500,step:10,onChange:e=>{this.cylinderRadius=e,"cylinder"===this._shape&&this.createCylinder(e,this.cylinderHeight,this.cylinderSegments)}}),this.exposeProperty("cylinderHeight","number",100,{min:10,max:500,step:10,onChange:e=>{this.cylinderHeight=e,"cylinder"===this._shape&&this.createCylinder(this.cylinderRadius,e,this.cylinderSegments)}}),this.exposeProperty("cylinderSegments","number",8,{min:6,max:32,step:1,onChange:e=>{this.cylinderSegments=e,"cylinder"===this._shape&&this.createCylinder(this.cylinderRadius,this.cylinderHeight,e)}}),this.icosahedronSize=100,this.exposeProperty("icosahedronSize","number",100,{min:10,max:500,step:10,onChange:e=>{this.icosahedronSize=e,"icosahedron"===this._shape&&this.createIcosahedron(e)}}),this.quadWidth=200,this.quadHeight=200,this.quadSubdivisionsX=4,this.quadSubdivisionsY=4,this.exposeProperty("quadWidth","number",200,{min:10,max:500,step:10,onChange:e=>{this.quadWidth=e,"quad"===this._shape&&this.createQuad(e,this.quadHeight,this.quadSubdivisionsX,this.quadSubdivisionsY)}}),this.exposeProperty("quadHeight","number",200,{min:10,max:500,step:10,onChange:e=>{this.quadHeight=e,"quad"===this._shape&&this.createQuad(this.quadWidth,e,this.quadSubdivisionsX,this.quadSubdivisionsY)}}),this.exposeProperty("quadSubdivisionsX","number",4,{min:1,max:20,step:1,onChange:e=>{this.quadSubdivisionsX=e,"quad"===this._shape&&this.createQuad(this.quadWidth,this.quadHeight,e,this.quadSubdivisionsY)}}),this.exposeProperty("quadSubdivisionsY","number",4,{min:1,max:20,step:1,onChange:e=>{this.quadSubdivisionsY=e,"quad"===this._shape&&this.createQuad(this.quadWidth,this.quadHeight,this.quadSubdivisionsX,e)}}),this.planeSize=200,this.exposeProperty("planeSize","number",200,{min:10,max:500,step:10,onChange:e=>{this.planeSize=e,"plane"===this._shape&&this.createPlane(e)}}),this.generateUVCoordinates(),this.ensureMaterialModule()}style(e){e.startGroup("Shape Selection",!1,{backgroundColor:"rgba(100,150,255,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("shape","enum",this._shape,{label:"Mesh Shape",options:["cube","pyramid","sphere","octahedron","torus","cone","cylinder","icosahedron","quadCube","capsule","prism","tetrahedron","quad","plane","custom"]}),e.endGroup(),e.addDivider(),e.startGroup("Transform",!1,{backgroundColor:"rgba(150,255,150,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("position","vector3",this.position,{label:"Position"}),e.exposeProperty("rotation","vector3",this.rotation,{label:"Rotation"}),e.exposeProperty("scale","vector3",this.scale,{label:"Scale"}),e.exposeProperty("rotationSpeed","vector3",this.rotationSpeed,{label:"Rotation Speed (deg/s)"}),e.endGroup(),e.addDivider(),"cube"===this._shape&&(e.startGroup("Cube Settings",!1,{backgroundColor:"rgba(255,100,100,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("cubeSize","number",this.cubeSize,{label:"Size"}),e.endGroup()),"pyramid"===this._shape&&(e.startGroup("Pyramid Settings",!1,{backgroundColor:"rgba(255,150,100,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("pyramidBaseSize","number",this.pyramidBaseSize,{label:"Base Size"}),e.exposeProperty("pyramidHeight","number",this.pyramidHeight,{label:"Height"}),e.endGroup()),"sphere"===this._shape&&(e.startGroup("Sphere Settings",!1,{backgroundColor:"rgba(100,255,100,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("sphereRadius","number",this.sphereRadius,{label:"Radius"}),e.exposeProperty("sphereDetail","number",this.sphereDetail,{label:"Detail Level"}),e.endGroup()),"octahedron"===this._shape&&(e.startGroup("Octahedron Settings",!1,{backgroundColor:"rgba(255,100,255,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("octahedronSize","number",this.octahedronSize,{label:"Size"}),e.endGroup()),"torus"===this._shape&&(e.startGroup("Torus Settings",!1,{backgroundColor:"rgba(100,255,255,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("torusMajorRadius","number",this.torusMajorRadius,{label:"Major Radius"}),e.exposeProperty("torusMinorRadius","number",this.torusMinorRadius,{label:"Minor Radius"}),e.exposeProperty("torusMajorSegments","number",this.torusMajorSegments,{label:"Major Segments"}),e.exposeProperty("torusMinorSegments","number",this.torusMinorSegments,{label:"Minor Segments"}),e.endGroup()),"cone"===this._shape&&(e.startGroup("Cone Settings",!1,{backgroundColor:"rgba(255,200,100,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("coneRadius","number",this.coneRadius,{label:"Base Radius"}),e.exposeProperty("coneHeight","number",this.coneHeight,{label:"Height"}),e.exposeProperty("coneSegments","number",this.coneSegments,{label:"Segments"}),e.endGroup()),"cylinder"===this._shape&&(e.startGroup("Cylinder Settings",!1,{backgroundColor:"rgba(150,150,255,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("cylinderRadius","number",this.cylinderRadius,{label:"Radius"}),e.exposeProperty("cylinderHeight","number",this.cylinderHeight,{label:"Height"}),e.exposeProperty("cylinderSegments","number",this.cylinderSegments,{label:"Segments"}),e.endGroup()),"icosahedron"===this._shape&&(e.startGroup("Icosahedron Settings",!1,{backgroundColor:"rgba(255,150,200,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("icosahedronSize","number",this.icosahedronSize,{label:"Size"}),e.endGroup()),"quadCube"===this._shape&&(e.startGroup("Quad Cube Settings",!1,{backgroundColor:"rgba(200,150,100,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("quadCubeSize","number",this.quadCubeSize,{label:"Size"}),e.exposeProperty("quadCubeSubdivisions","number",this.quadCubeSubdivisions,{label:"Subdivisions"}),e.endGroup()),"capsule"===this._shape&&(e.startGroup("Capsule Settings",!1,{backgroundColor:"rgba(150,255,200,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("capsuleRadius","number",this.capsuleRadius,{label:"Radius"}),e.exposeProperty("capsuleHeight","number",this.capsuleHeight,{label:"Height"}),e.exposeProperty("capsuleSegments","number",this.capsuleSegments,{label:"Segments"}),e.endGroup()),"prism"===this._shape&&(e.startGroup("Prism Settings",!1,{backgroundColor:"rgba(200,150,255,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("prismSides","number",this.prismSides,{label:"Sides"}),e.exposeProperty("prismRadius","number",this.prismRadius,{label:"Radius"}),e.exposeProperty("prismHeight","number",this.prismHeight,{label:"Height"}),e.endGroup()),"tetrahedron"===this._shape&&(e.startGroup("Tetrahedron Settings",!1,{backgroundColor:"rgba(255,200,150,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("tetrahedronSize","number",this.tetrahedronSize,{label:"Size"}),e.endGroup()),"quad"===this._shape&&(e.startGroup("Quad Settings",!1,{backgroundColor:"rgba(200,100,255,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("quadWidth","number",this.quadWidth,{label:"Width"}),e.exposeProperty("quadHeight","number",this.quadHeight,{label:"Height"}),e.exposeProperty("quadSubdivisionsX","number",this.quadSubdivisionsX,{label:"X Subdivisions"}),e.exposeProperty("quadSubdivisionsY","number",this.quadSubdivisionsY,{label:"Y Subdivisions"}),e.endGroup()),"plane"===this._shape&&(e.startGroup("Plane Settings",!1,{backgroundColor:"rgba(150,200,255,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("planeSize","number",this.planeSize,{label:"Size"}),e.endGroup()),"custom"===this._shape&&(e.startGroup("Custom Model Settings",!1,{backgroundColor:"rgba(255,255,100,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("sphereRadius","number",this.sphereRadius,{label:"Base Radius"}),e.exposeProperty("sphereDetail","number",this.sphereDetail,{label:"Detail Level"}),e.endGroup()),e.addDivider(),e.startGroup("Performance",!1,{backgroundColor:"rgba(200,200,200,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("enableLOD","boolean",this.enableLOD,{label:"Enable LOD"}),e.exposeProperty("minLODDistance","number",this.minLODDistance,{label:"Min LOD Distance"}),e.exposeProperty("maxLODDistance","number",this.maxLODDistance,{label:"Max LOD Distance"}),e.exposeProperty("maxSubdivisions","number",this.maxSubdivisions,{label:"Max Subdivisions"}),e.endGroup(),e.addDivider(),e.startGroup("Material & Lighting",!1,{backgroundColor:"rgba(255,150,255,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("material","module",this.material,{label:"Material"}),e.endGroup(),e.addDivider(),e.startGroup("Debug",!1,{backgroundColor:"rgba(255,255,150,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("_showAxisLines","boolean",this._showAxisLines,{label:"Show Axis Lines"}),e.exposeProperty("_axisLength","number",this._axisLength,{label:"Axis Length"}),e.endGroup()}start(){this.ensureMaterialModule(),this.updateShape()}loop(e){this.rotation.x+=this.rotationSpeed.x*e,this.rotation.y+=this.rotationSpeed.y*e,this.rotation.z+=this.rotationSpeed.z*e,this.rotation.x=(this.rotation.x%360+360)%360,this.rotation.y=(this.rotation.y%360+360)%360,this.rotation.z=(this.rotation.z%360+360)%360,this.isCustomModel&&"custom"===this._shape&&this.handleCustomModelInput(),this.updateShape()}ensureMaterialModule(){if(!this.gameObject)return;let e=this.gameObject.getModule?this.gameObject.getModule("Material"):null;e||(e=new Material,this.gameObject.addModule&&this.gameObject.addModule(e)),this.material=e}generateUVCoordinates(){this.uvCoordinates=[];for(let e=0;e<this.vertices.length;e++){const t=this.vertices[e];let i,s;Math.abs(t.x)>Math.abs(t.y)&&Math.abs(t.x)>Math.abs(t.z)?(i=(t.y+1)/2,s=(t.z+1)/2):Math.abs(t.y)>Math.abs(t.x)&&Math.abs(t.y)>Math.abs(t.z)?(i=(t.x+1)/2,s=(t.z+1)/2):(i=(t.x+1)/2,s=(t.y+1)/2),this.uvCoordinates.push(new Vector2(i,s))}}getMaterialColor(e,t,i,s=null){if(!this.material)return this.faceColor;const o=this.getFaceCenter(e,t),n=s?s[0]:this.calculateFaceNormal(e,t);if(i&&i.position){const t=i.position.clone().subtract(o).normalize(),s=e.map(e=>this.uvCoordinates[e]||new Vector2(0,0)),r=s.reduce((e,t)=>e+t.x,0)/s.length,a=s.reduce((e,t)=>e+t.y,0)/s.length,l=this.material.getSimpleLitColor(o,n,t,new Vector2(r,a));return`rgba(${Math.round(l.r)}, ${Math.round(l.g)}, ${Math.round(l.b)}, ${l.a})`}return this.material.diffuseColor}getFaceCenter(e,t){const i=new Vector3(0,0,0);for(const s of e)s<t.length&&i.add(t[s]);return i.multiply(1/e.length),i}calculateFaceNormal(e,t){if(3>e.length)return new Vector3(0,0,1);const i=t[e[0]],s=t[e[1]],o=t[e[2]];if(!i||!s||!o)return new Vector3(0,0,1);const n=s.clone().subtract(i),r=o.clone().subtract(i);return n.clone().cross(r).normalize()}createCube(e=100){const t=e/2;this.vertices=[new Vector3(-t,-t,-t),new Vector3(-t,t,-t),new Vector3(-t,t,t),new Vector3(-t,-t,t),new Vector3(t,-t,-t),new Vector3(t,t,-t),new Vector3(t,t,t),new Vector3(t,-t,t)],this.edges=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]],this.faces=[[0,3,2],[0,2,1],[4,5,6],[4,6,7],[0,1,5],[0,5,4],[3,7,6],[3,6,2],[0,4,7],[0,7,3],[1,2,6],[1,6,5]],this.generateUVCoordinates()}createPyramid(e=100,t=150){const i=e/2,s=t/2;this.vertices=[new Vector3(-i,-i,-s),new Vector3(-i,i,-s),new Vector3(i,i,-s),new Vector3(i,-i,-s),new Vector3(0,0,s)],this.edges=[[0,1],[1,2],[2,3],[3,0],[0,4],[1,4],[2,4],[3,4]],this.faces=[[0,1,2,3],[0,4,1],[1,4,2],[2,4,3],[3,4,0]],this.generateUVCoordinates()}createSphere(e=100,t=12){this.vertices=[],this.edges=[],this.faces=[];for(let i=0;t>=i;i++){const s=i*Math.PI/t,o=Math.sin(s),n=Math.cos(s);for(let i=0;t>=i;i++){const s=2*i*Math.PI/t,r=Math.sin(s),a=e*o*Math.cos(s),l=e*n,h=e*o*r;this.vertices.push(new Vector3(a,l,h))}}for(let e=0;t>e;e++)for(let i=0;t>i;i++){const s=e*(t+1)+i,o=s+t+1;this.faces.push([s,s+1,o]),this.faces.push([o,s+1,o+1]),this.edges.push([s,s+1]),this.edges.push([s,o]),e===t-1&&this.edges.push([o,o+1]),i===t-1&&this.edges.push([s+1,o+1])}this.generateUVCoordinates()}createOctahedron(e=100){const t=e/2;this.vertices=[new Vector3(0,t,0),new Vector3(t,0,0),new Vector3(0,0,t),new Vector3(-t,0,0),new Vector3(0,0,-t),new Vector3(0,-t,0)],this.edges=[[0,1],[0,2],[0,3],[0,4],[1,2],[2,3],[3,4],[4,1],[5,1],[5,2],[5,3],[5,4]],this.faces=[[0,2,1],[0,3,2],[0,4,3],[0,1,4],[5,1,2],[5,2,3],[5,3,4],[5,4,1]],this.generateUVCoordinates()}createTorus(e=100,t=40,i=16,s=8){this.vertices=[],this.edges=[],this.faces=[];for(let o=0;i>o;o++){const n=o/i*Math.PI*2,r=Math.cos(n)*e,a=Math.sin(n)*e;for(let e=0;s>e;e++){const i=e/s*Math.PI*2,o=r+Math.cos(i)*Math.cos(n)*t,l=Math.sin(i)*t,h=a+Math.cos(i)*Math.sin(n)*t;this.vertices.push(new Vector3(o,l,h))}}for(let e=0;i>e;e++)for(let t=0;s>t;t++){const o=e*s+t,n=(e+1)%i*s+t,r=e*s+(t+1)%s,a=(e+1)%i*s+(t+1)%s;this.faces.push([o,r,a]),this.faces.push([o,a,n]),this.edges.push([o,r]),this.edges.push([o,n])}this.generateUVCoordinates()}createCone(e=100,t=150,i=16){this.vertices=[],this.edges=[],this.faces=[];const s=t/2;this.vertices.push(new Vector3(0,0,s)),this.vertices.push(new Vector3(0,0,-s));for(let t=0;i>t;t++){const o=t/i*Math.PI*2,n=Math.cos(o)*e,r=Math.sin(o)*e;this.vertices.push(new Vector3(n,r,-s))}for(let e=0;i>e;e++){const t=2+e,s=2+(e+1)%i;this.faces.push([0,t,s]),this.edges.push([0,t]),this.edges.push([t,s])}const o=[];for(let e=i-1;e>=0;e--)o.push(2+e);this.faces.push(o);for(let e=0;i>e;e++)this.edges.push([1,2+e]);this.generateUVCoordinates()}createCylinder(e=100,t=150,i=16){this.vertices=[],this.edges=[],this.faces=[];const s=t/2;for(let t=0;i>t;t++){const o=t/i*Math.PI*2,n=Math.cos(o)*e,r=Math.sin(o)*e;this.vertices.push(new Vector3(n,r,-s))}for(let t=0;i>t;t++){const o=t/i*Math.PI*2,n=Math.cos(o)*e,r=Math.sin(o)*e;this.vertices.push(new Vector3(n,r,s))}const o=[];for(let e=0;i>e;e++)o.push(e);o.reverse(),this.faces.push(o);const n=[];for(let e=0;i>e;e++)n.push(i+e);this.faces.push(n);for(let e=0;i>e;e++){const t=(e+1)%i,s=e,o=t,n=i+e,r=i+t;this.faces.push([s,o,r,n]),this.edges.push([s,o]),this.edges.push([n,r]),this.edges.push([s,n])}this.generateUVCoordinates()}createIcosahedron(e=100){this.vertices=[],this.edges=[],this.faces=[];const t=1.618033988749895,i=e/1.902113032590307,s=[[-1,t,0],[1,t,0],[-1,-t,0],[1,-t,0],[0,-1,t],[0,1,t],[0,-1,-t],[0,1,-t],[t,0,-1],[t,0,1],[-t,0,-1],[-t,0,1]];for(const e of s)this.vertices.push(new Vector3(e[0]*i,e[1]*i,e[2]*i));this.faces=[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]];const o=new Set;for(const e of this.faces)for(let t=0;t<e.length;t++){const i=Math.min(e[t],e[(t+1)%e.length]),s=Math.max(e[t],e[(t+1)%e.length]);o.add(`${i},${s}`)}for(const e of o){const[t,i]=e.split(",").map(Number);this.edges.push([t,i])}this.generateUVCoordinates()}createQuadCube(e=100,t=2){this.vertices=[],this.edges=[],this.faces=[];const i=e/2,s=(e,i=!1)=>{const s=this.vertices.length,[o,n,r,a]=e;for(let e=0;t>=e;e++)for(let i=0;t>=i;i++){const s=e/t,l=i/t,h=new Vector3(o.x*(1-s)*(1-l)+n.x*s*(1-l)+r.x*s*l+a.x*(1-s)*l,o.y*(1-s)*(1-l)+n.y*s*(1-l)+r.y*s*l+a.y*(1-s)*l,o.z*(1-s)*(1-l)+n.z*s*(1-l)+r.z*s*l+a.z*(1-s)*l);this.vertices.push(h)}for(let e=0;t>e;e++)for(let o=0;t>o;o++){const n=s+e*(t+1)+o,r=n+1,a=n+(t+1),l=a+1;i?(this.faces.push([n,r,l]),this.faces.push([n,l,a])):(this.faces.push([n,a,l]),this.faces.push([n,l,r]))}};s([new Vector3(i,-i,-i),new Vector3(i,i,-i),new Vector3(i,i,i),new Vector3(i,-i,i)],!1),s([new Vector3(-i,i,-i),new Vector3(-i,-i,-i),new Vector3(-i,-i,i),new Vector3(-i,i,i)],!1),s([new Vector3(i,i,-i),new Vector3(-i,i,-i),new Vector3(-i,i,i),new Vector3(i,i,i)],!1),s([new Vector3(-i,-i,-i),new Vector3(i,-i,-i),new Vector3(i,-i,i),new Vector3(-i,-i,i)],!1),s([new Vector3(-i,-i,i),new Vector3(i,-i,i),new Vector3(i,i,i),new Vector3(-i,i,i)],!1),s([new Vector3(i,-i,-i),new Vector3(-i,-i,-i),new Vector3(-i,i,-i),new Vector3(i,i,-i)],!1);const o=new Set;for(const e of this.faces)for(let t=0;t<e.length;t++){const i=Math.min(e[t],e[(t+1)%e.length]),s=Math.max(e[t],e[(t+1)%e.length]);o.add(`${i},${s}`)}for(const e of o){const[t,i]=e.split(",").map(Number);this.edges.push([t,i])}this.generateUVCoordinates()}createCapsule(e=50,t=150,i=16){this.vertices=[],this.edges=[],this.faces=[];const s=t/2,o=Math.floor(i/2);for(let t=0;o>=t;t++){const n=t/o*(Math.PI/2),r=Math.sin(n),a=Math.cos(n);for(let t=0;i>=t;t++){const o=t/i*Math.PI*2,n=Math.sin(o),l=e*r*Math.cos(o),h=e*r*n,c=s+e*a;this.vertices.push(new Vector3(l,h,c))}}for(let t=0;i>=t;t++){const o=t/i*Math.PI*2,n=Math.sin(o),r=e*Math.cos(o),a=e*n,l=s;this.vertices.push(new Vector3(r,a,l))}for(let t=0;i>=t;t++){const o=t/i*Math.PI*2,n=Math.sin(o),r=e*Math.cos(o),a=e*n,l=-s;this.vertices.push(new Vector3(r,a,l))}for(let t=0;o>=t;t++){const n=t/o*(Math.PI/2),r=Math.sin(n),a=Math.cos(n);for(let t=0;i>=t;t++){const o=t/i*Math.PI*2,n=Math.sin(o),l=e*r*Math.cos(o),h=e*r*n,c=-s-e*a;this.vertices.push(new Vector3(l,h,c))}}const n=(o+1)*(i+1),r=n+(i+1),a=r+(i+1);for(let e=0;o>e;e++)for(let t=0;i>t;t++){const s=0+e*(i+1)+t,o=s+i+1;this.faces.push([s,o,s+1]),this.faces.push([s+1,o,o+1])}for(let e=0;i>e;e++){const t=n+e,i=n+e+1,s=r+e,o=r+e+1;this.faces.push([t,s,o]),this.faces.push([t,o,i])}for(let e=0;o>e;e++)for(let t=0;i>t;t++){const s=a+e*(i+1)+t,o=s+i+1;this.faces.push([s,s+1,o]),this.faces.push([o,s+1,o+1])}const l=new Set;for(const e of this.faces)for(let t=0;t<e.length;t++){const i=Math.min(e[t],e[(t+1)%e.length]),s=Math.max(e[t],e[(t+1)%e.length]);l.add(`${i},${s}`)}for(const e of l){const[t,i]=e.split(",").map(Number);this.edges.push([t,i])}this.generateUVCoordinates()}createPrism(e=6,t=100,i=150){this.vertices=[],this.edges=[],this.faces=[];const s=i/2;for(let i=0;e>i;i++){const o=i/e*Math.PI*2,n=Math.cos(o)*t,r=Math.sin(o)*t;this.vertices.push(new Vector3(n,r,s))}for(let i=0;e>i;i++){const o=i/e*Math.PI*2,n=Math.cos(o)*t,r=Math.sin(o)*t;this.vertices.push(new Vector3(n,r,-s))}const o=[];for(let t=0;e>t;t++)o.push(t);this.faces.push(o);const n=[];for(let t=0;e>t;t++)n.push(e+t);n.reverse(),this.faces.push(n);for(let t=0;e>t;t++){const i=(t+1)%e,s=t,o=i,n=e+t,r=e+i;this.faces.push([s,n,r,o]),this.edges.push([s,o]),this.edges.push([n,r]),this.edges.push([s,n])}this.generateUVCoordinates()}createTetrahedron(e=100){const t=e/Math.sqrt(2);this.vertices=[new Vector3(t,t,t),new Vector3(t,-t,-t),new Vector3(-t,t,-t),new Vector3(-t,-t,t)],this.edges=[[0,1],[0,2],[0,3],[1,2],[1,3],[2,3]],this.faces=[[0,1,2],[0,3,1],[0,2,3],[3,2,1]],this.generateUVCoordinates()}createQuad(e=200,t=200,i=4,s=4){this.vertices=[],this.edges=[],this.faces=[];const o=e/2,n=t/2;for(let r=0;s>=r;r++)for(let a=0;i>=a;a++){const l=a/i*e-o,h=r/s*t-n;this.vertices.push(new Vector3(l,h,0))}for(let e=0;s>e;e++)for(let t=0;i>t;t++){const o=e*(i+1)+t,n=o+1,r=(e+1)*(i+1)+t,a=r+1;this.faces.push([o,n,a,r]),this.edges.push([o,n]),this.edges.push([o,r]),t===i-1&&this.edges.push([n,a]),e===s-1&&this.edges.push([r,a])}this.generateUVCoordinates()}createPlane(e=200){const t=e/2;this.vertices=[new Vector3(-t,-t,0),new Vector3(-t,t,0),new Vector3(t,t,0),new Vector3(t,-t,0)],this.edges=[[0,1],[1,2],[2,3],[3,0]],this.faces=[[3,2,1,0]],this.generateUVCoordinates()}createCustomModel(e=100,t=6){this.createSphere(e,t),this.isCustomModel=!0,this.selectedVertexIndex=-1,this.vertexHandleSize=8,this.isDraggingVertex=!1,this.originalVertices=this.vertices.map(e=>e.clone())}updateShape(){switch(this.vertices=[],this.edges=[],this.faces=[],this.uvCoordinates=[],this._shape||(this._shape="cube"),this._shape){case"cube":default:this.createCube(this.cubeSize);break;case"pyramid":this.createPyramid(this.pyramidBaseSize,this.pyramidHeight);break;case"sphere":this.createSphere(this.sphereRadius,this.sphereDetail);break;case"octahedron":this.createOctahedron(this.octahedronSize);break;case"torus":this.createTorus(this.torusMajorRadius,this.torusMinorRadius,this.torusMajorSegments,this.torusMinorSegments);break;case"cone":this.createCone(this.coneRadius,this.coneHeight,this.coneSegments);break;case"cylinder":this.createCylinder(this.cylinderRadius,this.cylinderHeight,this.cylinderSegments);break;case"icosahedron":this.createIcosahedron(this.icosahedronSize);break;case"quad":this.createQuad(this.quadWidth,this.quadHeight,this.quadSubdivisionsX,this.quadSubdivisionsY);break;case"plane":this.createPlane(this.planeSize);break;case"quadCube":this.createQuadCube(this.quadCubeSize,this.quadCubeSubdivisions);break;case"capsule":this.createCapsule(this.capsuleRadius,this.capsuleHeight,this.capsuleSegments);break;case"prism":this.createPrism(this.prismSides,this.prismRadius,this.prismHeight);break;case"tetrahedron":this.createTetrahedron(this.tetrahedronSize);break;case"custom":this.createCustomModel(this.sphereRadius,this.sphereDetail)}this.vertices.length>0&&this.generateUVCoordinates()}setMeshData(e,t,i){this.vertices=e,this.edges=t||[],this.faces=i||[],this.generateUVCoordinates()}drawGizmos(e){e.save(),e.translate(this.gameObject.position.x,this.gameObject.position.y),e.rotate(this.gameObject.angle*Math.PI/180),e.scale(this.gameObject.scale.x,this.gameObject.scale.y),this.draw2DVisualization(e),e.restore()}draw(e){const t=this.findActiveCamera();t&&(t.getRenderTextureContext&&t.render3D?this.drawToRenderTexture(t.getRenderTextureContext(),t):this.drawDirect(e,t),this.isCustomModel&&"custom"===this._shape&&this.drawVertexHandles(e,t))}draw2DVisualization(e){switch(e.strokeStyle=this.wireframeColor,e.fillStyle=this.faceColor,e.lineWidth=2,this._shape){case"cube":this.draw2DCube(e);break;case"pyramid":this.draw2DPyramid(e);break;case"sphere":this.draw2DSphere(e);break;case"octahedron":this.draw2DOctahedron(e);break;case"torus":this.draw2DTorus(e);break;case"cone":this.draw2DCone(e);break;case"cylinder":this.draw2DCylinder(e);break;case"icosahedron":this.draw2DIcosahedron(e);break;case"quad":case"plane":this.draw2DPlane(e);break;case"custom":this.draw2DCustom(e);break;default:this.drawPlaceholder(e)}"quadCube"===this._shape&&this.draw2DCube(e),"capsule"===this._shape&&this.draw2DCapsule(e),"prism"===this._shape&&this.draw2DPrism(e),"tetrahedron"===this._shape&&this.draw2DTetrahedron(e)}draw2DCube(e){const t=this.cubeSize/2*this.scale.x,i=this.cubeSize*this.scale.z*.3;e.fillStyle=this.faceColor,e.globalAlpha=.7,e.fillRect(-t,-t,2*t,2*t),e.globalAlpha=1,e.strokeRect(-t,-t,2*t,2*t),e.strokeStyle=this.wireframeColor,e.lineWidth=2,e.globalAlpha=.8,e.beginPath(),e.moveTo(-t,-t),e.lineTo(-t,-t-i),e.stroke(),e.beginPath(),e.moveTo(t,-t),e.lineTo(t,-t-i),e.stroke(),e.beginPath(),e.moveTo(-t,t),e.lineTo(-t,t-i),e.stroke(),e.beginPath(),e.moveTo(t,t),e.lineTo(t,t-i),e.stroke(),e.fillStyle=this.faceColor,e.globalAlpha=.9,e.fillRect(-t,-t-i,2*t,2*t),e.globalAlpha=1,e.strokeRect(-t,-t-i,2*t,2*t),e.globalAlpha=1}draw2DPyramid(e){const t=this.pyramidBaseSize/2*this.scale.x,i=this.pyramidHeight*this.scale.z*.3;e.fillStyle=this.faceColor,e.globalAlpha=.6,e.fillRect(-t,-t,2*t,2*t),e.globalAlpha=1,e.strokeRect(-t,-t,2*t,2*t),e.fillStyle=this.faceColor,e.globalAlpha=.9,e.beginPath(),e.moveTo(0,-i),e.lineTo(t,t),e.lineTo(-t,t),e.closePath(),e.fill(),e.stroke(),e.globalAlpha=.7,e.beginPath(),e.moveTo(0,-i),e.lineTo(-t,t),e.lineTo(-t,-t),e.closePath(),e.fill(),e.stroke(),e.beginPath(),e.moveTo(0,-i),e.lineTo(t,t),e.lineTo(t,-t),e.closePath(),e.fill(),e.stroke(),e.globalAlpha=1}draw2DSphere(e){const t=this.sphereRadius*this.scale.x;e.fillStyle=this.faceColor,e.globalAlpha=.7,e.beginPath(),e.arc(0,0,t,0,2*Math.PI),e.fill(),e.globalAlpha=1,e.stroke(),e.strokeStyle=this.wireframeColor,e.globalAlpha=.3;const i=Math.min(this.sphereDetail,8);for(let s=1;i>s;s++){const o=s/i*t;e.beginPath(),e.arc(0,0,o,0,2*Math.PI),e.stroke()}e.beginPath(),e.moveTo(-t,0),e.lineTo(t,0),e.moveTo(0,-t),e.lineTo(0,t),e.stroke(),e.globalAlpha=1}draw2DOctahedron(e){const t=this.octahedronSize*this.scale.x,i=this.octahedronSize*this.scale.z*.3;e.fillStyle=this.faceColor,e.globalAlpha=.7,e.beginPath(),e.moveTo(0,-t),e.lineTo(t,0),e.lineTo(0,t),e.lineTo(-t,0),e.closePath(),e.fill(),e.stroke(),e.globalAlpha=.9,e.beginPath(),e.moveTo(0,-i),e.lineTo(.5*t,.5*-t),e.lineTo(.5*-t,.5*-t),e.closePath(),e.fill(),e.stroke(),e.globalAlpha=1}draw2DTorus(e){const t=this.torusMajorRadius*this.scale.x,i=this.torusMinorRadius*this.scale.x;e.fillStyle=this.faceColor,e.globalAlpha=.7,e.beginPath(),e.arc(0,0,t+i,0,2*Math.PI),e.arc(0,0,t-i,0,2*Math.PI,!0),e.fill(),e.globalAlpha=1,e.strokeStyle=this.wireframeColor,e.beginPath(),e.arc(0,0,t+i,0,2*Math.PI),e.stroke(),e.beginPath(),e.arc(0,0,t-i,0,2*Math.PI),e.stroke(),e.globalAlpha=.3;const s=Math.min(this.torusMinorSegments,8);for(let o=0;s>o;o++){const n=o/s*Math.PI*2,r=Math.cos(n)*(t-i),a=Math.sin(n)*(t-i),l=Math.cos(n)*(t+i),h=Math.sin(n)*(t+i);e.beginPath(),e.moveTo(r,a),e.lineTo(l,h),e.stroke()}e.globalAlpha=1}draw2DCone(e){const t=this.coneRadius*this.scale.x,i=this.coneHeight*this.scale.z*.3;e.fillStyle=this.faceColor,e.globalAlpha=.6,e.beginPath(),e.arc(0,0,t,0,2*Math.PI),e.fill(),e.globalAlpha=1,e.stroke(),e.strokeStyle=this.wireframeColor,e.globalAlpha=.5;for(let s=0;8>s;s++){const o=s/8*Math.PI*2,n=Math.cos(o)*t,r=Math.sin(o)*t;e.beginPath(),e.moveTo(0,-i),e.lineTo(n,r),e.stroke()}e.globalAlpha=1,e.fillStyle=this.wireframeColor,e.beginPath(),e.arc(0,-i,4,0,2*Math.PI),e.fill()}draw2DCylinder(e){const t=this.cylinderRadius*this.scale.x,i=this.cylinderHeight*this.scale.z*.3;e.fillStyle=this.faceColor,e.globalAlpha=.6,e.beginPath(),e.arc(0,0,t,0,2*Math.PI),e.fill(),e.globalAlpha=1,e.stroke(),e.strokeStyle=this.wireframeColor,e.globalAlpha=.8,e.lineWidth=2;for(let s=0;8>s;s++){const o=s/8*Math.PI*2,n=Math.cos(o)*t,r=Math.sin(o)*t;e.beginPath(),e.moveTo(n,r),e.lineTo(n,r-i),e.stroke()}e.fillStyle=this.faceColor,e.globalAlpha=.8,e.beginPath(),e.arc(0,-i,t,0,2*Math.PI),e.fill(),e.globalAlpha=1,e.stroke(),e.strokeStyle=this.wireframeColor,e.globalAlpha=.3;for(let s=0;8>s;s++){const o=s/8*Math.PI*2,n=Math.cos(o)*t,r=Math.sin(o)*t;e.beginPath(),e.moveTo(0,-i),e.lineTo(n,r-i),e.stroke()}e.globalAlpha=1}draw2DIcosahedron(e){const t=this.icosahedronSize*this.scale.x;e.fillStyle=this.faceColor,e.globalAlpha=.7,e.beginPath();for(let i=0;5>i;i++){const s=i/5*Math.PI*2-Math.PI/2,o=Math.cos(s)*t,n=Math.sin(s)*t;0===i?e.moveTo(o,n):e.lineTo(o,n)}e.closePath(),e.fill(),e.globalAlpha=1,e.stroke(),e.strokeStyle=this.wireframeColor,e.globalAlpha=.4;for(let i=0;5>i;i++){const s=i/5*Math.PI*2-Math.PI/2,o=(i+2)%5/5*Math.PI*2-Math.PI/2,n=Math.cos(s)*t,r=Math.sin(s)*t,a=Math.cos(o)*t,l=Math.sin(o)*t;e.beginPath(),e.moveTo(n,r),e.lineTo(a,l),e.stroke()}e.globalAlpha=1}draw2DCapsule(e){const t=this.capsuleRadius*this.scale.x,i=this.capsuleHeight*this.scale.z;e.fillStyle=this.faceColor,e.globalAlpha=.7,e.fillRect(-t,-i,2*t,i),e.globalAlpha=1,e.strokeRect(-t,-i,2*t,i),e.globalAlpha=.8,e.beginPath(),e.arc(0,-i,t,0,Math.PI,!0),e.fill(),e.stroke(),e.globalAlpha=.6,e.beginPath(),e.arc(0,0,t,0,Math.PI),e.fill(),e.stroke(),e.globalAlpha=1}draw2DPrism(e){const t=this.prismRadius*this.scale.x,i=this.prismSides;e.fillStyle=this.faceColor,e.globalAlpha=.7,e.beginPath();for(let s=0;i>s;s++){const o=s/i*Math.PI*2-Math.PI/2,n=Math.cos(o)*t,r=Math.sin(o)*t;0===s?e.moveTo(n,r):e.lineTo(n,r)}e.closePath(),e.fill(),e.globalAlpha=1,e.stroke(),e.strokeStyle=this.wireframeColor,e.globalAlpha=.3;for(let s=0;i>s;s++){const o=s/i*Math.PI*2-Math.PI/2,n=Math.cos(o)*t,r=Math.sin(o)*t;e.beginPath(),e.moveTo(0,0),e.lineTo(n,r),e.stroke()}e.globalAlpha=1}draw2DTetrahedron(e){const t=this.tetrahedronSize*this.scale.x,i=this.tetrahedronSize*this.scale.z*.3;e.fillStyle=this.faceColor,e.globalAlpha=.7,e.beginPath(),e.moveTo(0,-t),e.lineTo(.866*t,.5*t),e.lineTo(.866*-t,.5*t),e.closePath(),e.fill(),e.globalAlpha=1,e.stroke(),e.fillStyle=this.wireframeColor,e.beginPath(),e.arc(0,-i,4,0,2*Math.PI),e.fill(),e.strokeStyle=this.wireframeColor,e.globalAlpha=.4,e.beginPath(),e.moveTo(0,-i),e.lineTo(0,-t),e.moveTo(0,-i),e.lineTo(.866*t,.5*t),e.moveTo(0,-i),e.lineTo(.866*-t,.5*t),e.stroke(),e.globalAlpha=1}draw2DPlane(e){const t=("quad"===this._shape?this.quadWidth/2:this.planeSize/2)*this.scale.x,i=("quad"===this._shape?this.quadHeight/2:this.planeSize/2)*this.scale.y;if(e.fillStyle=this.faceColor,e.globalAlpha=.7,e.fillRect(-t,-i,2*t,2*i),e.globalAlpha=1,e.strokeRect(-t,-i,2*t,2*i),"quad"===this._shape){e.strokeStyle=this.wireframeColor,e.globalAlpha=.3;for(let s=1;s<this.quadSubdivisionsX;s++){const o=-t+s/this.quadSubdivisionsX*t*2;e.beginPath(),e.moveTo(o,-i),e.lineTo(o,i),e.stroke()}for(let s=1;s<this.quadSubdivisionsY;s++){const o=-i+s/this.quadSubdivisionsY*i*2;e.beginPath(),e.moveTo(-t,o),e.lineTo(t,o),e.stroke()}e.globalAlpha=1}else e.strokeStyle=this.wireframeColor,e.globalAlpha=.3,e.beginPath(),e.moveTo(-t,0),e.lineTo(t,0),e.moveTo(0,-i),e.lineTo(0,i),e.stroke(),e.globalAlpha=1}draw2DCustom(e){let t=50*Math.max(this.scale.x,this.scale.y);if(this.vertices&&this.vertices.length>0){t=0;for(const e of this.vertices){const i=Math.sqrt(e.x*e.x+e.y*e.y)*this.scale.x;t=Math.max(t,i)}}e.strokeStyle=this.wireframeColor,e.fillStyle=this.faceColor,e.globalAlpha=.3,e.beginPath(),e.arc(0,0,t,0,2*Math.PI),e.fill(),e.globalAlpha=1,e.stroke(),e.fillStyle="#ffff00",e.font="bold 12px Arial",e.textAlign="center",e.textBaseline="middle";const i=this.vertices?this.vertices.length:0;e.fillText(`CUSTOM (${i}v)`,0,0)}subdivideTriangle(e){if(3!==e.length)return[e];const[t,i,s]=e,o=new Vector3((t.x+i.x)/2,(t.y+i.y)/2,(t.z+i.z)/2),n=new Vector3((i.x+s.x)/2,(i.y+s.y)/2,(i.z+s.z)/2),r=new Vector3((s.x+t.x)/2,(s.y+t.y)/2,(s.z+t.z)/2);return[[t,o,r],[o,i,n],[r,n,s],[o,n,r]]}subdivideTriangleRecursive(e,t,i){if(t>=i)return[e];const s=this.subdivideTriangle(e),o=[];for(const e of s){const s=this.subdivideTriangleRecursive(e,t+1,i);o.push(...s)}return o}calculateLODLevel(e,t){const i=e.distanceTo(t);if(i<=this.minLODDistance)return this.maxSubdivisions;if(i>=this.maxLODDistance)return 0;const s=(i-this.minLODDistance)/(this.maxLODDistance-this.minLODDistance),o=Math.floor((1-s)*this.maxSubdivisions);return Math.max(0,Math.min(this.maxSubdivisions,o))}getTriangleCenter(e){if(0===e.length)return new Vector3(0,0,0);const t=new Vector3(0,0,0);for(const i of e)t.add(i);return t.multiply(1/e.length),t}hasCameraMovedSignificantly(e){return!this.lastCameraPosition||this.lastCameraPosition.distanceTo(e)>this.lodUpdateThreshold}applyLODSubdivision(e,t,i){if(!this.enableLOD||!i||!i.position)return e.map(e=>({face:e.map(e=>t[e]),level:0}));const s=i.position;if(!this.hasCameraMovedSignificantly(s)&&this.lodCache.size>0)return Array.from(this.lodCache.values());this.lodCache.clear(),this.lastCameraPosition=s.clone();const o=[];for(let i=0;i<e.length;i++){const n=e[i],r=this.faceToTriangles(n,t);for(const e of r){const t=this.getTriangleCenter(e),n=this.calculateLODLevel(t,s),r=this.subdivideTriangleRecursive(e,0,n);for(const e of r){const t={face:e,level:n};o.push(t),this.lodCache.set(`${i}_${o.length}`,t)}}}return o}faceToTriangles(e,t){if(3===e.length)return[[t[e[0]],t[e[1]],t[e[2]]]];if(4===e.length)return[[t[e[0]],t[e[1]],t[e[2]]],[t[e[0]],t[e[2]],t[e[3]]]];{const i=[];for(let s=1;s<e.length-1;s++)i.push([t[e[0]],t[e[s]],t[e[s+1]]]);return i}}drawDirect(e,t){const i=this.transformVertices(),s=this.applyLODSubdivision(this.faces,i,t),o=new Map;for(const{face:e}of s)for(const i of e){const e=`${i.x}_${i.y}_${i.z}`;o.has(e)||o.set(e,t.projectPoint(i))}const n=s.map(({face:e,level:t})=>{const i=e.reduce((e,t)=>e+t.x,0)/e.length;return{face:e,level:t,avgDepth:i}}).sort((e,t)=>e.avgDepth-t.avgDepth);if("solid"===this.renderMode||"both"===this.renderMode)for(const{face:i,level:s}of n){const n=i.map(e=>{const t=`${e.x}_${e.y}_${e.z}`;return o.get(t)});if(!n.every(e=>null!==e))continue;const r=this.calculateFaceNormal([0,1,2],i),a=this.getTriangleCenter(i),l=t.position?t.position.clone().subtract(a).normalize():new Vector3(-1,0,0);if(0>r.dot(l))continue;const h=this.getMaterialColor([0,1,2],i,t);e.fillStyle=h,e.beginPath(),e.moveTo(n[0].x,n[0].y);for(let t=1;t<n.length;t++)e.lineTo(n[t].x,n[t].y);e.closePath(),e.fill(),this.enableLOD?(e.strokeStyle=this.getLODDebugColor(s),e.lineWidth=2,e.stroke()):"both"===this.renderMode&&(e.strokeStyle=this.wireframeColor,e.lineWidth=1,e.stroke())}if("wireframe"===this.renderMode||"both"===this.renderMode&&!this.enableLOD){const s=i.map(e=>t.projectPoint(e));e.strokeStyle=this.wireframeColor,e.lineWidth=1;for(const[t,i]of this.edges)t<s.length&&i<s.length&&null!==s[t]&&null!==s[i]&&(e.beginPath(),e.moveTo(s[t].x,s[t].y),e.lineTo(s[i].x,s[i].y),e.stroke())}if(this._showAxisLines){const s=i.map(e=>t.projectPoint(e));this.drawAxisLines(e,s)}}getLODDebugColor(e){const t=["#ff0000","#ff7f00","#ffff00","#00ff00","#0000ff","#4b0082"];return t[Math.min(e,t.length-1)]}drawToRenderTexture(e,t){this.drawDirect(e,t)}drawAxisLines(e,t){if(0===t.length)return;let i=0,s=0,o=0;for(const e of t)null!==e&&(i+=e.x,s+=e.y,o++);if(0===o)return;i/=o,s/=o;const n=this.axisLength,r=new Vector2(i,s),a={x:new Vector3(n,0,0),y:new Vector3(0,n,0),z:new Vector3(0,0,n)},l={};for(const[e,t]of Object.entries(a)){const i=new Vector3(t.x+this.position.x,t.y+this.position.y,t.z+this.position.z);l[e]=this.projectPointRelative(i,r)}const h={x:"#ff0000",y:"#0000ff",z:"#00ff00"},c={x:"X",y:"Y",z:"Z"};e.font="12px Arial",e.textAlign="center",e.textBaseline="middle";for(const[t,o]of Object.entries(h)){const n=l[t];n&&(e.strokeStyle=o,e.lineWidth=3,e.beginPath(),e.moveTo(i,s),e.lineTo(n.x,n.y),e.stroke(),e.fillStyle=o,e.fillText(c[t],n.x,n.y),this.drawArrowhead(e,i,s,n.x,n.y,o))}e.fillStyle="#ffffff",e.font="10px Arial",e.textAlign="left",e.fillText("X: Forward/Back (Red)",i+10,s-30),e.fillText("Y: Left/Right (Blue)",i+10,s-18),e.fillText("Z: Up/Down (Green)",i+10,s-6)}projectPointRelative(e,t){const i=this.findActiveCamera();return i?i.projectPoint(e):null}drawArrowhead(e,t,i,s,o,n){const r=s-t,a=o-i,l=Math.sqrt(r*r+a*a);if(0===l)return;const h=r/l,c=a/l,d=-c,p=s-8*(.8660254037844387*h-.49999999999999994*d),u=o-8*(.8660254037844387*c-.49999999999999994*h),g=s-8*(.8660254037844387*h+.49999999999999994*d),m=o-8*(.8660254037844387*c+.49999999999999994*h);e.strokeStyle=n,e.lineWidth=2,e.beginPath(),e.moveTo(s,o),e.lineTo(p,u),e.moveTo(s,o),e.lineTo(g,m),e.stroke()}drawPlaceholder(e){e.strokeStyle=this.wireframeColor,e.lineWidth=1,e.beginPath(),e.rect(-25,-25,50,50),e.stroke(),e.beginPath(),e.rect(-17.5,-17.5,35,35),e.stroke(),e.beginPath(),e.moveTo(-25,-25),e.lineTo(-17.5,-17.5),e.moveTo(25,-25),e.lineTo(17.5,-17.5),e.moveTo(25,25),e.lineTo(17.5,17.5),e.moveTo(-25,25),e.lineTo(-17.5,17.5),e.stroke(),e.fillStyle=this.wireframeColor,e.font="12px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText("Mesh3D",0,0)}findActiveCamera(){const e=this.getAllGameObjects();for(const t of e){const e=t.getModule("Camera3DRasterizer")||t.getModule("Camera3D");if(e&&e.isActive)return e}return null}getAllGameObjects(){if(!this.gameObject)return[];if(window.editor&&window.editor.getAllGameObjects)return window.editor.getAllGameObjects();const e=[],t=window.editor?window.editor.activeScene:window.engine?window.engine.scene:null;if(t&&t.gameObjects){const i=t=>{t.forEach(t=>{e.push(t),t.children&&t.children.length>0&&i(t.children)})};i(t.gameObjects)}return e}rotateVectorX(e,t){const i=Math.cos(t),s=Math.sin(t);return new Vector3(e.x,e.y*i-e.z*s,e.y*s+e.z*i)}rotateVectorY(e,t){const i=Math.cos(t),s=Math.sin(t);return new Vector3(e.x*i+e.z*s,e.y,-e.x*s+e.z*i)}rotateVectorZ(e,t){const i=Math.cos(t),s=Math.sin(t);return new Vector3(e.x*i-e.y*s,e.x*s+e.y*i,e.z)}rotateVectorZ(e,t){const i=Math.cos(t),s=Math.sin(t);return new Vector3(e.x*i-e.y*s,e.x*s+e.y*i,e.z)}transformVertices(){let e={x:0,y:0},t=0,i={x:1,y:1};this.gameObject&&(e=this.gameObject.getWorldPosition?this.gameObject.getWorldPosition():{x:0,y:0},t=this.gameObject.getWorldRotation?this.gameObject.getWorldRotation():0,i=this.gameObject.getWorldScale?this.gameObject.getWorldScale():{x:1,y:1});let s=0;this.gameObject&&("function"==typeof this.gameObject.getWorldDepth?s=this.gameObject.getWorldDepth():"number"==typeof this.gameObject.depth?s=this.gameObject.depth:this.gameObject.position&&"number"==typeof this.gameObject.position.z&&(s=this.gameObject.position.z));const o=new Vector3(e.x,e.y,s),n=new Vector3(i.x,i.y,1);return this.vertices.map(e=>{let i=e.clone?e.clone():new Vector3(e.x,e.y,e.z);if(i.x*=this.scale.x,i.y*=this.scale.y,i.z*=this.scale.z,0!==this.rotation.x&&(i=this.rotateVectorX(i,this.rotation.x*(Math.PI/180))),0!==this.rotation.y&&(i=this.rotateVectorY(i,this.rotation.y*(Math.PI/180))),0!==this.rotation.z&&(i=this.rotateVectorZ(i,this.rotation.z*(Math.PI/180))),i.x+=this.position.x,i.y+=this.position.y,i.z+=this.position.z,i.x*=n.x,i.y*=n.y,i.z*=n.z,0!==t){const e=t*(Math.PI/180);i=this.rotateVectorZ(i,e)}return i.x+=o.x,i.y+=o.y,i.z+=o.z,i})}rotate(e=0,t=0,i=0){this.rotation.x+=e,this.rotation.y+=t,this.rotation.z+=i,this.rotation.x=(this.rotation.x%360+360)%360,this.rotation.y=(this.rotation.y%360+360)%360,this.rotation.z=(this.rotation.z%360+360)%360}setRotation(e=0,t=0,i=0){this.rotation.x=e,this.rotation.y=t,this.rotation.z=i,this.rotation.x=(this.rotation.x%360+360)%360,this.rotation.y=(this.rotation.y%360+360)%360,this.rotation.z=(this.rotation.z%360+360)%360}rotateX(e){this.rotate(e,0,0)}rotateY(e){this.rotate(0,e,0)}rotateZ(e){this.rotate(0,0,e)}setRotationSpeed(e=0,t=0,i=0){this.rotationSpeed.x=e,this.rotationSpeed.y=t,this.rotationSpeed.z=i}getRotation(){return this.rotation.clone()}getRotationSpeed(){return this.rotationSpeed.clone()}resetRotation(){this.rotation.x=0,this.rotation.y=0,this.rotation.z=0}stopRotation(){this.rotationSpeed.x=0,this.rotationSpeed.y=0,this.rotationSpeed.z=0}lookAt(e){const t=new Vector3(this.position.x,this.position.y,this.position.z),i=e.clone().subtract(t),s=Math.atan2(i.y,i.x)*(180/Math.PI),o=Math.sqrt(i.x*i.x+i.y*i.y),n=Math.atan2(i.z,o)*(180/Math.PI);this.setRotation(0,n,s)}rotateTowards(e,t=90){const i=new Vector3(this.position.x,this.position.y,this.position.z),s=e.clone().subtract(i),o=Math.atan2(s.y,s.x)*(180/Math.PI),n=Math.sqrt(s.x*s.x+s.y*s.y),r=Math.atan2(s.z,n)*(180/Math.PI),a=t*(this.gameObject?.scene?.engine?.deltaTime||0);let l=o-this.rotation.z;for(;l>180;)l-=360;for(;-180>l;)l+=360;const h=Math.min(Math.abs(l),a)*Math.sign(l);this.rotation.z+=h;let c=r-this.rotation.y;for(;c>180;)c-=360;for(;-180>c;)c+=360;const d=Math.min(Math.abs(c),a)*Math.sign(c);return this.rotation.y+=d,this.rotation.y=(this.rotation.y%360+360)%360,this.rotation.z=(this.rotation.z%360+360)%360,1>Math.abs(l)&&1>Math.abs(c)}getForward(){const e=this.rotation.z*(Math.PI/180),t=this.rotation.y*(Math.PI/180);return new Vector3(Math.cos(t)*Math.cos(e),Math.cos(t)*Math.sin(e),Math.sin(t)).normalize()}getRight(){const e=this.rotation.z*(Math.PI/180);return new Vector3(-Math.sin(e),Math.cos(e),0).normalize()}getUp(){const e=this.rotation.x*(Math.PI/180),t=this.rotation.z*(Math.PI/180);return new Vector3(-Math.sin(e)*Math.sin(t),Math.sin(e)*Math.cos(t),Math.cos(e)).normalize()}drawInEditor(e){this.draw(e)}update(){}handleCustomModelInput(){const e=this.gameObject?.scene?.engine?.inputManager;if(!e)return;const t=e.mouseX,i=e.mouseY;if(e.isMousePressed(0)&&!this.isDraggingVertex&&this.onMouseDown(t,i),this.isDraggingVertex&&e.isMouseDown(0)){const s=e.mouseDeltaX||0,o=e.mouseDeltaY||0;this.onMouseMove(t,i,s,o)}!e.isMouseDown(0)&&this.isDraggingVertex&&this.onMouseUp()}drawVertexHandles(e,t){if(!this.isCustomModel)return;const i=this.transformVertices().map(e=>t.projectPoint(e));e.fillStyle="#00ff00",e.strokeStyle="#ffffff",e.lineWidth=2;for(let t=0;t<i.length;t++){const s=i[t];if(!s)continue;const o=this.vertexHandleSize/2;t===this.selectedVertexIndex?(e.fillStyle="#ffff00",e.strokeStyle="#ff0000",e.lineWidth=3):(e.fillStyle="#00ff00",e.strokeStyle="#ffffff",e.lineWidth=2),e.fillRect(s.x-o,s.y-o,this.vertexHandleSize,this.vertexHandleSize),e.strokeRect(s.x-o,s.y-o,this.vertexHandleSize,this.vertexHandleSize)}}onMouseDown(e,t){if(!this.isCustomModel||"custom"!==this._shape)return!1;const i=this.findActiveCamera();if(!i)return!1;const s=this.transformVertices().map(e=>i.projectPoint(e));for(let i=0;i<s.length;i++){const o=s[i];if(!o)continue;const n=e-o.x,r=t-o.y;if(Math.sqrt(n*n+r*r)<this.vertexHandleSize)return this.selectedVertexIndex=i,this.isDraggingVertex=!0,!0}return this.selectedVertexIndex=-1,!1}onMouseMove(e,t,i,s){if(!this.isCustomModel||!this.isDraggingVertex||-1===this.selectedVertexIndex)return!1;if(!this.findActiveCamera())return!1;const o=this.vertices[this.selectedVertexIndex];return o.x+=1*i,o.y+=1*s,!0}onMouseUp(){if(!this.isCustomModel)return!1;const e=this.isDraggingVertex;return this.isDraggingVertex=!1,e}resetCustomModel(){this.isCustomModel&&this.originalVertices&&(this.vertices=this.originalVertices.map(e=>e.clone()),this.selectedVertexIndex=-1,this.isDraggingVertex=!1)}toJSON(){return{...super.toJSON(),_type:"Mesh3D",vertices:this.vertices.map(e=>({x:e.x,y:e.y,z:e.z})),edges:this.edges.map(e=>[...e]),faces:this.faces.map(e=>[...e]),uvCoordinates:this.uvCoordinates.map(e=>({x:e.x,y:e.y})),position:this.position,rotation:this.rotation,scale:this.scale,wireframeColor:this.wireframeColor,faceColor:this.faceColor,renderMode:this.renderMode,_showAxisLines:this._showAxisLines,_axisLength:this._axisLength,_shape:this._shape,cubeSize:this.cubeSize,pyramidBaseSize:this.pyramidBaseSize,pyramidHeight:this.pyramidHeight,sphereRadius:this.sphereRadius,sphereDetail:this.sphereDetail,octahedronSize:this.octahedronSize,torusMajorRadius:this.torusMajorRadius,torusMinorRadius:this.torusMinorRadius,torusMajorSegments:this.torusMajorSegments,torusMinorSegments:this.torusMinorSegments,coneRadius:this.coneRadius,coneHeight:this.coneHeight,coneSegments:this.coneSegments,cylinderRadius:this.cylinderRadius,cylinderHeight:this.cylinderHeight,cylinderSegments:this.cylinderSegments,icosahedronSize:this.icosahedronSize,quadCubeSize:this.quadCubeSize,quadCubeSubdivisions:this.quadCubeSubdivisions,capsuleRadius:this.capsuleRadius,capsuleHeight:this.capsuleHeight,capsuleSegments:this.capsuleSegments,prismSides:this.prismSides,prismRadius:this.prismRadius,prismHeight:this.prismHeight,tetrahedronSize:this.tetrahedronSize,quadWidth:this.quadWidth,quadHeight:this.quadHeight,quadSubdivisionsX:this.quadSubdivisionsX,quadSubdivisionsY:this.quadSubdivisionsY,planeSize:this.planeSize,isCustomModel:this.isCustomModel,originalVertices:this.originalVertices?this.originalVertices.map(e=>({x:e.x,y:e.y,z:e.z})):null,material:this.material?this.material.toJSON():null,enableLOD:this.enableLOD,minLODDistance:this.minLODDistance,maxLODDistance:this.maxLODDistance,maxSubdivisions:this.maxSubdivisions,lodUpdateThreshold:this.lodUpdateThreshold}}fromJSON(e){super.fromJSON(e),e.vertices&&(this.vertices=e.vertices.map(e=>new Vector3(e.x,e.y,e.z))),e.edges&&(this.edges=e.edges),e.faces&&(this.faces=e.faces),e.uvCoordinates?this.uvCoordinates=e.uvCoordinates.map(e=>new Vector2(e.x,e.y)):this.generateUVCoordinates(),e.position&&(this.position=e.position),e.rotation&&(this.rotation=e.rotation),e.scale&&(this.scale=e.scale),void 0!==e.wireframeColor&&(this.wireframeColor=e.wireframeColor),void 0!==e.faceColor&&(this.faceColor=e.faceColor),void 0!==e.renderMode&&(this.renderMode=e.renderMode),void 0!==e._showAxisLines&&(this._showAxisLines=e._showAxisLines),void 0!==e._axisLength&&(this._axisLength=e._axisLength),void 0!==e._shape&&(this._shape=e._shape),void 0!==e.cubeSize&&(this.cubeSize=e.cubeSize),void 0!==e.pyramidBaseSize&&(this.pyramidBaseSize=e.pyramidBaseSize),void 0!==e.pyramidHeight&&(this.pyramidHeight=e.pyramidHeight),void 0!==e.sphereRadius&&(this.sphereRadius=e.sphereRadius),void 0!==e.sphereDetail&&(this.sphereDetail=e.sphereDetail),void 0!==e.octahedronSize&&(this.octahedronSize=e.octahedronSize),void 0!==e.torusMajorRadius&&(this.torusMajorRadius=e.torusMajorRadius),void 0!==e.torusMinorRadius&&(this.torusMinorRadius=e.torusMinorRadius),void 0!==e.torusMajorSegments&&(this.torusMajorSegments=e.torusMajorSegments),void 0!==e.torusMinorSegments&&(this.torusMinorSegments=e.torusMinorSegments),void 0!==e.coneRadius&&(this.coneRadius=e.coneRadius),void 0!==e.coneHeight&&(this.coneHeight=e.coneHeight),void 0!==e.coneSegments&&(this.coneSegments=e.coneSegments),void 0!==e.cylinderRadius&&(this.cylinderRadius=e.cylinderRadius),void 0!==e.cylinderHeight&&(this.cylinderHeight=e.cylinderHeight),void 0!==e.cylinderSegments&&(this.cylinderSegments=e.cylinderSegments),void 0!==e.icosahedronSize&&(this.icosahedronSize=e.icosahedronSize),void 0!==e.quadCubeSize&&(this.quadCubeSize=e.quadCubeSize),void 0!==e.quadCubeSubdivisions&&(this.quadCubeSubdivisions=e.quadCubeSubdivisions),void 0!==e.capsuleRadius&&(this.capsuleRadius=e.capsuleRadius),void 0!==e.capsuleHeight&&(this.capsuleHeight=e.capsuleHeight),void 0!==e.capsuleSegments&&(this.capsuleSegments=e.capsuleSegments),void 0!==e.prismSides&&(this.prismSides=e.prismSides),void 0!==e.prismRadius&&(this.prismRadius=e.prismRadius),void 0!==e.prismHeight&&(this.prismHeight=e.prismHeight),void 0!==e.tetrahedronSize&&(this.tetrahedronSize=e.tetrahedronSize),void 0!==e.quadWidth&&(this.quadWidth=e.quadWidth),void 0!==e.quadHeight&&(this.quadHeight=e.quadHeight),void 0!==e.quadSubdivisionsX&&(this.quadSubdivisionsX=e.quadSubdivisionsX),void 0!==e.quadSubdivisionsY&&(this.quadSubdivisionsY=e.quadSubdivisionsY),void 0!==e.planeSize&&(this.planeSize=e.planeSize),void 0!==e.isCustomModel&&(this.isCustomModel=e.isCustomModel),e.originalVertices&&(this.originalVertices=e.originalVertices.map(e=>new Vector3(e.x,e.y,e.z))),void 0!==e.enableLOD&&(this.enableLOD=e.enableLOD),void 0!==e.minLODDistance&&(this.minLODDistance=e.minLODDistance),void 0!==e.maxLODDistance&&(this.maxLODDistance=e.maxLODDistance),void 0!==e.maxSubdivisions&&(this.maxSubdivisions=e.maxSubdivisions),void 0!==e.lodUpdateThreshold&&(this.lodUpdateThreshold=e.lodUpdateThreshold),this.lodCache.clear(),this.lastCameraPosition=null,e._shape&&this.updateShape(),e.material&&(this.material||this.ensureMaterialModule(),this.material&&this.material.fromJSON&&this.material.fromJSON(e.material))}get showAxisLines(){return this._showAxisLines}set showAxisLines(e){this._showAxisLines=e}get axisLength(){return this._axisLength}set axisLength(e){this._axisLength=Math.max(50,Math.min(500,e))}get shape(){return this._shape}set shape(e){this._shape=e}}window.Mesh3D=Mesh3D;class MouseLook extends Module{static namespace="3D";static description="Controls camera rotation with mouse movement";static allowMultiple=!1;static icon="fa-mouse";constructor(){super("MouseLook"),this.requires("Camera3DRasterizer"),this._sensitivity=.2,this._invertX=!1,this._invertY=!1,this._smoothing=.1,this._lockX=!1,this._lockY=!1,this._minPitch=-89.9,this._maxPitch=89.9,this._isLooking=!1,this._lastMouseX=0,this._lastMouseY=0,this._targetRotation=new Vector3(0,0,0),this.camera=null,this._activateMode="leftButton",this._lockCursor=!1,this._isPointerLocked=!1,this._screenWrap=!0,this._wrapSensitivity=1,this.exposeProperty("sensitivity","number",.2,{min:.01,max:2,step:.01,onChange:e=>this._sensitivity=e}),this.exposeProperty("invertX","boolean",!1,{onChange:e=>this._invertX=e}),this.exposeProperty("invertY","boolean",!1,{onChange:e=>this._invertY=e}),this.exposeProperty("lockX","boolean",!1,{onChange:e=>this._lockX=e}),this.exposeProperty("lockY","boolean",!1,{onChange:e=>this._lockY=e}),this.exposeProperty("smoothing","number",.1,{min:0,max:.99,step:.01,onChange:e=>this._smoothing=e}),this.exposeProperty("minPitch","number",-89.9,{min:-89.9,max:89.9,onChange:e=>this._minPitch=e}),this.exposeProperty("maxPitch","number",89.9,{min:-89.9,max:89.9,onChange:e=>this._maxPitch=e}),this.exposeProperty("activateMode","enum","rightButton",{options:["always","rightButton","middleButton","leftButton","freeLook"],onChange:e=>this._activateMode=e}),this.exposeProperty("lockCursor","boolean",!1,{onChange:e=>this._lockCursor=e}),this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.handleMouseLeave=this.handleMouseLeave.bind(this),this.handleMouseEnter=this.handleMouseEnter.bind(this),this.handlePointerLockChange=this.handlePointerLockChange.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCanvasFocus=this.handleCanvasFocus.bind(this),this.handleCanvasBlur=this.handleCanvasBlur.bind(this)}start(){this.camera=this.gameObject.getModule("Camera3DRasterizer")||this.gameObject.getModule("Camera3D"),this.camera?(this._targetRotation=new Vector3(this.camera.rotation.x,this.camera.rotation.y,this.camera.rotation.z),setTimeout(()=>{this.setupEventListeners()},100)):console.error("MouseLook requires a Camera3D module on the same GameObject")}setupEventListeners(){if(window.engine&&window.engine.canvas){const e=window.engine.canvas;e.addEventListener("mousedown",this.handleMouseDown),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),e.addEventListener("mouseleave",this.handleMouseLeave),e.addEventListener("mouseenter",this.handleMouseEnter),document.addEventListener("pointerlockchange",this.handlePointerLockChange),document.addEventListener("keydown",this.handleKeyDown),e.addEventListener("focus",this.handleCanvasFocus),e.addEventListener("blur",this.handleCanvasBlur),e.hasAttribute("tabindex")||e.setAttribute("tabindex","0")}else if(document.querySelector("canvas")){const e=document.querySelector("canvas");e.addEventListener("mousedown",this.handleMouseDown),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),e.addEventListener("mouseleave",this.handleMouseLeave),e.addEventListener("mouseenter",this.handleMouseEnter),document.addEventListener("pointerlockchange",this.handlePointerLockChange),document.addEventListener("keydown",this.handleKeyDown),e.addEventListener("focus",this.handleCanvasFocus),e.addEventListener("blur",this.handleCanvasBlur),e.hasAttribute("tabindex")||e.setAttribute("tabindex","0"),console.log("MouseLook: Using fallback canvas")}else console.warn("MouseLook: No canvas found for mouse events")}onDestroy(){const e=window.engine?.canvas||document.querySelector("canvas");e&&(e.removeEventListener("mousedown",this.handleMouseDown),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),e.removeEventListener("mouseleave",this.handleMouseLeave),e.removeEventListener("mouseenter",this.handleMouseEnter),document.removeEventListener("pointerlockchange",this.handlePointerLockChange),document.removeEventListener("keydown",this.handleKeyDown),e.removeEventListener("focus",this.handleCanvasFocus),e.removeEventListener("blur",this.handleCanvasBlur)),this._isPointerLocked&&document.exitPointerLock()}handleCanvasFocus(){this._lockCursor&&"freeLook"===this._activateMode&&this.requestPointerLock()}handleCanvasBlur(){this._isPointerLocked&&document.exitPointerLock()}handleMouseLeave(e){this._screenWrap&&!this._isPointerLocked&&(this._isWrapping=!0,this._wrapStartTime=Date.now())}handleMouseEnter(e){this._screenWrap&&!this._isPointerLocked&&(this._isWrapping&&void 0!==this._lastMouseX&&void 0!==this._lastMouseY&&100>Date.now()-this._wrapStartTime&&this.simulateWrapMovement(e),this._isWrapping=!1)}simulateWrapMovement(e){if(!this._isLooking)return;const t=window.engine?.canvas||document.querySelector("canvas");if(!t)return;const i=t.getBoundingClientRect();let s=0,o=0;if(e.clientX>i.left+10?e.clientX<i.right-10?e.clientY>i.top+10?e.clientY<i.bottom-10||(o=-50*this._wrapSensitivity):o=50*this._wrapSensitivity:s=-50*this._wrapSensitivity:s=50*this._wrapSensitivity,0!==s||0!==o){const e=this._lockX?0:s*this.sensitivity*(this.invertX?-1:1),t=this._lockY?0:o*this.sensitivity*(this.invertY?-1:1);this._targetRotation.z=(this._targetRotation.z+e)%360,this._targetRotation.y=this._targetRotation.y-t,this._targetRotation.y=Math.max(this.minPitch,Math.min(this.maxPitch,this._targetRotation.y))}}handleKeyDown(e){"Escape"===e.key&&this._isPointerLocked&&document.exitPointerLock()}handlePointerLockChange(){const e=window.engine?.canvas||document.querySelector("canvas");this._isPointerLocked=document.pointerLockElement===e,this._isPointerLocked?this._isLooking=!0:"freeLook"===this._activateMode&&(this._isLooking=!1)}requestPointerLock(){const e=window.engine?.canvas||document.querySelector("canvas");e&&!this._isPointerLocked&&(e.focus(),e.requestPointerLock().catch(e=>{console.warn("Pointer lock request failed:",e)}))}handleMouseDown(e){if(!this.camera)return;const t=window.engine?.canvas||document.querySelector("canvas");if(t&&document.activeElement!==t&&t.focus(),this._lockCursor&&!this._isPointerLocked&&this.requestPointerLock(),"freeLook"!==this._activateMode){if(("rightButton"===this._activateMode&&2===e.button||"middleButton"===this._activateMode&&1===e.button||"leftButton"===this._activateMode&&0===e.button)&&(this._isLooking=!0,this._lastMouseX=e.clientX,this._lastMouseY=e.clientY,2===e.button)){e.preventDefault();const t=e=>{e.preventDefault(),document.removeEventListener("contextmenu",t)};document.addEventListener("contextmenu",t)}}else this._lockCursor||(this._isLooking=!0,this._lastMouseX=e.clientX,this._lastMouseY=e.clientY)}handleMouseMove(e){if(!this.camera||!this._isLooking)return;let t,i;this._isPointerLocked?(t=e.movementX||0,i=e.movementY||0):(t=e.clientX-this._lastMouseX,i=e.clientY-this._lastMouseY,this._lastMouseX=e.clientX,this._lastMouseY=e.clientY);const s=this._lockX?0:t*this.sensitivity*(this.invertX?-1:1),o=this._lockY?0:i*this.sensitivity*(this.invertY?-1:1);this._targetRotation.z=(this._targetRotation.z+s)%360,this._targetRotation.y=this._targetRotation.y+o,this._targetRotation.y=Math.max(this.minPitch,Math.min(this.maxPitch,this._targetRotation.y))}handleMouseUp(e){this.camera&&("freeLook"!==this._activateMode||!this._isPointerLocked&&this._lockCursor?("rightButton"===this._activateMode&&2===e.button||"middleButton"===this._activateMode&&1===e.button||"leftButton"===this._activateMode&&0===e.button)&&(this._isLooking=!1):this._lockCursor||(this._isLooking=!1))}loop(e){if(this.camera)if("always"===this._activateMode&&(this._isLooking=!0),"freeLook"!==this._activateMode||this._lockCursor||(this._isLooking=!0),this.smoothing>0){this.camera.rotation.y+=(this._targetRotation.y-this.camera.rotation.y)*(1-this.smoothing),this.camera.rotation.x+=(this._targetRotation.x-this.camera.rotation.x)*(1-this.smoothing);let e=this._targetRotation.z-this.camera.rotation.z;e>180?e-=360:-180>e&&(e+=360),this.camera.rotation.z+=e*(1-this.smoothing),this.camera.rotation.z=(this.camera.rotation.z%360+360)%360}else this.camera.rotation.y=this._targetRotation.y,this.camera.rotation.x=this._targetRotation.x,this.camera.rotation.z=this._targetRotation.z}toJSON(){return{...super.toJSON(),_type:"MouseLook",_sensitivity:this._sensitivity,_invertX:this._invertX,_invertY:this._invertY,_smoothing:this._smoothing,_lockX:this._lockX,_lockY:this._lockY,_minPitch:this._minPitch,_maxPitch:this._maxPitch,_activateMode:this._activateMode,_lockCursor:this._lockCursor,_screenWrap:this._screenWrap,_wrapSensitivity:this._wrapSensitivity}}fromJSON(e){super.fromJSON(e),void 0!==e._sensitivity&&(this._sensitivity=e._sensitivity),void 0!==e._invertX&&(this._invertX=e._invertX),void 0!==e._invertY&&(this._invertY=e._invertY),void 0!==e._smoothing&&(this._smoothing=e._smoothing),void 0!==e._lockX&&(this._lockX=e._lockX),void 0!==e._lockY&&(this._lockY=e._lockY),void 0!==e._minPitch&&(this._minPitch=e._minPitch),void 0!==e._maxPitch&&(this._maxPitch=e._maxPitch),void 0!==e._activateMode&&(this._activateMode=e._activateMode),void 0!==e._lockCursor&&(this._lockCursor=e._lockCursor),void 0!==e._screenWrap&&(this._screenWrap=e._screenWrap),void 0!==e._wrapSensitivity&&(this._wrapSensitivity=e._wrapSensitivity)}get sensitivity(){return this._sensitivity}set sensitivity(e){this._sensitivity=e}get invertX(){return this._invertX}set invertX(e){this._invertX=e}get invertY(){return this._invertY}set invertY(e){this._invertY=e}get lockX(){return this._lockX}set lockX(e){this._lockX=e}get lockY(){return this._lockY}set lockY(e){this._lockY=e}get smoothing(){return this._smoothing}set smoothing(e){this._smoothing=Math.max(0,Math.min(.99,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch=Math.max(-89.9,Math.min(this.maxPitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch=Math.min(89.9,Math.max(this.minPitch,e))}get activateMode(){return this._activateMode}set activateMode(e){this._activateMode=e}get lockCursor(){return this._lockCursor}set lockCursor(e){this._lockCursor=e}get screenWrap(){return this._screenWrap}set screenWrap(e){this._screenWrap=e}get wrapSensitivity(){return this._wrapSensitivity}set wrapSensitivity(e){this._wrapSensitivity=Math.max(.1,Math.min(5,e))}}window.MouseLook=MouseLook;class BloomEffect extends Module{static namespace="Effects";constructor(){super("BloomEffect"),this._threshold=.7,this._intensity=.5,this._radius=10,this._softness=.8,this._downsample=2,this.camera=null,this._originalPostRender=null,this.exposeProperty("threshold","number",.7,{min:0,max:1,step:.05,onChange:e=>this._threshold=e}),this.exposeProperty("intensity","number",.5,{min:0,max:2,step:.1,onChange:e=>this._intensity=e}),this.exposeProperty("radius","number",10,{min:1,max:30,step:1,onChange:e=>this._radius=e}),this.exposeProperty("softness","number",.8,{min:0,max:1,step:.05,onChange:e=>this._softness=e}),this.exposeProperty("downsample","number",2,{min:1,max:4,step:1,onChange:e=>this._downsample=e})}start(){this.camera=this.gameObject.getModule("Camera3DRasterizer"),this.camera?this.setupPostRender():console.warn("BloomEffect: Camera3DRasterizer not found on start")}setupPostRender(){this.camera&&(this._originalPostRender=this.camera.postRender.bind(this.camera),this.camera.postRender=(e,t,i)=>{if(this._originalPostRender&&this._originalPostRender(e,t,i),0===this._intensity)return;const s=Math.floor(t/this._downsample),o=Math.floor(i/this._downsample),n=this.extractBrightPixelsDownsampled(e,t,i,s,o),r=this.fastBoxBlur(n,s,o,Math.ceil(this._radius/this._downsample));this.blendBloom(e,r,t,i,s,o)})}extractBrightPixelsDownsampled(e,t,i,s,o){const n=new Uint32Array(s*o);for(let i=0;o>i;i++){const o=Math.floor(i*this._downsample);for(let r=0;s>r;r++){const a=e[o*t+Math.floor(r*this._downsample)],l=255&a,h=a>>8&255,c=a>>16&255,d=(.299*l+.587*h+.114*c)/255;if(d>=this._threshold){const e=(d-this._threshold)/(1-this._threshold);n[i*s+r]=255<<24|Math.round(c*e)<<16|Math.round(h*e)<<8|Math.round(l*e)}}}return n}fastBoxBlur(e,t,i,s){if(1>s)return e;const o=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let n=0;i>n;n++){const i=n*t;let r=0,a=0,l=0,h=0;for(let o=-s;s>=o;o++){const s=e[i+Math.max(0,Math.min(t-1,o))];r+=255&s,a+=s>>8&255,l+=s>>16&255,h++}o[i]=255<<24|Math.round(l/h)<<16|Math.round(a/h)<<8|Math.round(r/h);for(let n=1;t>n;n++){const c=Math.max(0,n-s-1),d=Math.min(t-1,n+s),p=e[i+c],u=e[i+d];r+=(255&u)-(255&p),a+=(u>>8&255)-(p>>8&255),l+=(u>>16&255)-(p>>16&255),o[i+n]=255<<24|Math.round(l/h)<<16|Math.round(a/h)<<8|Math.round(r/h)}}for(let e=0;t>e;e++){let r=0,a=0,l=0,h=0;for(let n=-s;s>=n;n++){const s=o[Math.max(0,Math.min(i-1,n))*t+e];r+=255&s,a+=s>>8&255,l+=s>>16&255,h++}n[e]=255<<24|Math.round(l/h)<<16|Math.round(a/h)<<8|Math.round(r/h);for(let c=1;i>c;c++){const d=Math.max(0,c-s-1),p=Math.min(i-1,c+s),u=o[d*t+e],g=o[p*t+e];r+=(255&g)-(255&u),a+=(g>>8&255)-(u>>8&255),l+=(g>>16&255)-(u>>16&255),n[c*t+e]=255<<24|Math.round(l/h)<<16|Math.round(a/h)<<8|Math.round(r/h)}}return n}blendBloom(e,t,i,s,o,n){const r=this._intensity;for(let a=0;s>a;a++){const s=Math.floor(a/this._downsample),l=a/this._downsample-s;for(let h=0;i>h;h++){const c=Math.floor(h/this._downsample),d=h/this._downsample-c,p=Math.min(c,o-1),u=Math.min(c+1,o-1),g=Math.min(s,n-1),m=Math.min(s+1,n-1),f=t[g*o+p],y=t[g*o+u],w=t[m*o+p],b=t[m*o+u],x=this.bilerp(255&f,255&y,255&w,255&b,d,l),v=this.bilerp(f>>8&255,y>>8&255,w>>8&255,b>>8&255,d,l),M=this.bilerp(f>>16&255,y>>16&255,w>>16&255,b>>16&255,d,l),C=a*i+h,_=e[C],P=_>>8&255,S=_>>16&255,T=Math.min(255,(255&_)+Math.round(x*r)),k=Math.min(255,P+Math.round(v*r)),O=Math.min(255,S+Math.round(M*r));e[C]=255<<24|O<<16|k<<8|T}}}bilerp(e,t,i,s,o,n){return(e*(1-o)+t*o)*(1-n)+(i*(1-o)+s*o)*n}loop(e){this.camera||(this.camera=this.gameObject.getModule("Camera3DRasterizer"),this.camera&&this.setupPostRender())}onDestroy(){this.camera&&this._originalPostRender&&(this.camera.postRender=this._originalPostRender)}toJSON(){return{...super.toJSON(),_type:"BloomEffect",_threshold:this._threshold,_intensity:this._intensity,_radius:this._radius,_softness:this._softness,_downsample:this._downsample}}fromJSON(e){super.fromJSON(e),void 0!==e._threshold&&(this._threshold=e._threshold),void 0!==e._intensity&&(this._intensity=e._intensity),void 0!==e._radius&&(this._radius=e._radius),void 0!==e._softness&&(this._softness=e._softness),void 0!==e._downsample&&(this._downsample=e._downsample)}}window.BloomEffect=BloomEffect;class ChromaticAberrationEffect extends Module{static namespace="Effects";constructor(){super("ChromaticAberrationEffect"),this._intensity=5,this._radialDistortion=!1,this._center={x:.5,y:.5},this.camera=null,this._originalPostRender=null,this.exposeProperty("intensity","number",5,{min:0,max:20,step:1,onChange:e=>this._intensity=e}),this.exposeProperty("radialDistortion","boolean",!1,{onChange:e=>this._radialDistortion=e}),this.exposeProperty("centerX","number",.5,{min:0,max:1,step:.05,onChange:e=>this._center.x=e}),this.exposeProperty("centerY","number",.5,{min:0,max:1,step:.05,onChange:e=>this._center.y=e})}start(){this.camera=this.gameObject.getModule("Camera3DRasterizer"),this.camera?this.setupPostRender():console.warn("ChromaticAberrationEffect: Camera3DRasterizer not found on start")}setupPostRender(){this.camera&&(this._originalPostRender=this.camera.postRender.bind(this.camera),this.camera.postRender=(e,t,i)=>{if(this._originalPostRender&&this._originalPostRender(e,t,i),0===this._intensity)return;const s=new Uint32Array(e.length);s.set(e);const o=t*this._center.x,n=i*this._center.y,r=Math.sqrt(o*o+n*n);for(let a=0;i>a;a++)for(let i=0;t>i;i++){const l=a*t+i;let h=this._intensity;if(this._radialDistortion){const e=i-o,t=a-n,s=Math.sqrt(e*e+t*t)/r;h=Math.round(this._intensity*s)}const c=255&s[a*t+Math.max(0,i-h)],d=s[l]>>8&255,p=s[a*t+Math.min(t-1,i+h)]>>16&255;e[l]=255<<24|p<<16|d<<8|c}})}loop(e){this.camera||(this.camera=this.gameObject.getModule("Camera3DRasterizer"),this.camera&&this.setupPostRender())}onDestroy(){this.camera&&this._originalPostRender&&(this.camera.postRender=this._originalPostRender)}toJSON(){return{...super.toJSON(),_type:"ChromaticAberrationEffect",_intensity:this._intensity,_radialDistortion:this._radialDistortion,_center:{...this._center}}}fromJSON(e){super.fromJSON(e),void 0!==e._intensity&&(this._intensity=e._intensity),void 0!==e._radialDistortion&&(this._radialDistortion=e._radialDistortion),e._center&&(this._center={...e._center})}}window.ChromaticAberrationEffect=ChromaticAberrationEffect;class DepthOfFieldEffect extends Module{static namespace="Effects";constructor(){super("DepthOfFieldEffect"),this._focalDistance=100,this._focalRange=50,this._maxBlurRadius=10,this._bokehQuality=2,this._downsample=2,this.camera=null,this._originalPostRender=null,this._depthBuffer=null,this.exposeProperty("focalDistance","number",100,{min:10,max:500,step:10,onChange:e=>this._focalDistance=e}),this.exposeProperty("focalRange","number",50,{min:10,max:200,step:10,onChange:e=>this._focalRange=e}),this.exposeProperty("maxBlurRadius","number",10,{min:2,max:30,step:2,onChange:e=>this._maxBlurRadius=e}),this.exposeProperty("bokehQuality","number",2,{min:1,max:4,step:1,onChange:e=>this._bokehQuality=e}),this.exposeProperty("downsample","number",2,{min:1,max:4,step:1,onChange:e=>this._downsample=e})}start(){this.camera=this.gameObject.getModule("Camera3DRasterizer"),this.camera?this.setupPostRender():console.warn("DepthOfFieldEffect: Camera3DRasterizer not found on start")}setupPostRender(){this.camera&&(this._originalPostRender=this.camera.postRender.bind(this.camera),this.camera.postRender=(e,t,i)=>{this._originalPostRender&&this._originalPostRender(e,t,i),this._depthBuffer=this.camera._zBuffer,this._depthBuffer&&this.applyDepthOfField(e,t,i)})}applyDepthOfField(e,t,i){const s=Math.floor(t/this._downsample),o=Math.floor(i/this._downsample),n=this.createBlurMap(t,i,s,o),r=this.applyVariableBlur(e,t,i,n,s,o);e.set(r)}createBlurMap(e,t,i,s){const o=new Float32Array(i*s);for(let t=0;s>t;t++){const s=Math.floor(t*this._downsample);for(let n=0;i>n;n++){const r=s*e+Math.floor(n*this._downsample),a=this._depthBuffer[r];if(a===1/0){o[t*i+n]=this._maxBlurRadius;continue}const l=Math.abs(a-this._focalDistance),h=Math.max(0,(l-this._focalRange)/this._focalRange);o[t*i+n]=Math.min(h,1)*this._maxBlurRadius}}return o}applyVariableBlur(e,t,i,s,o,n){const r=new Uint32Array(e.length);for(let n=0;i>n;n++){const a=Math.floor(n/this._downsample);for(let l=0;t>l;l++){const h=s[a*o+Math.floor(l/this._downsample)];if(.5>h){r[n*t+l]=e[n*t+l];continue}const c=Math.ceil(this._bokehQuality*h);let d=0,p=0,u=0,g=0;for(let s=0;c>s;s++){const o=s/c*Math.PI*2,r=h*Math.sqrt(Math.random()),a=Math.round(l+Math.cos(o)*r),m=Math.round(n+Math.sin(o)*r);if(a>=0&&t>a&&m>=0&&i>m){const i=e[m*t+a];d+=255&i,p+=i>>8&255,u+=i>>16&255,g++}}r[n*t+l]=g>0?255<<24|Math.round(u/g)<<16|Math.round(p/g)<<8|Math.round(d/g):e[n*t+l]}}return r}loop(e){this.camera||(this.camera=this.gameObject.getModule("Camera3DRasterizer"),this.camera&&this.setupPostRender())}onDestroy(){this.camera&&this._originalPostRender&&(this.camera.postRender=this._originalPostRender)}toJSON(){return{...super.toJSON(),_type:"DepthOfFieldEffect",_focalDistance:this._focalDistance,_focalRange:this._focalRange,_maxBlurRadius:this._maxBlurRadius,_bokehQuality:this._bokehQuality,_downsample:this._downsample}}fromJSON(e){super.fromJSON(e),void 0!==e._focalDistance&&(this._focalDistance=e._focalDistance),void 0!==e._focalRange&&(this._focalRange=e._focalRange),void 0!==e._maxBlurRadius&&(this._maxBlurRadius=e._maxBlurRadius),void 0!==e._bokehQuality&&(this._bokehQuality=e._bokehQuality),void 0!==e._downsample&&(this._downsample=e._downsample)}}window.DepthOfFieldEffect=DepthOfFieldEffect;class EdgeBlurEffect extends Module{static namespace="Effects";constructor(){super("EdgeBlurEffect"),this._strength=.5,this._threshold=30,this._blurRadius=2,this._preserveSharpEdges=!0,this.camera=null,this._originalPostRender=null,this._edgeMapCache=null,this.exposeProperty("strength","number",.5,{min:0,max:1,step:.05,onChange:e=>this._strength=e}),this.exposeProperty("threshold","number",30,{min:5,max:100,step:5,onChange:e=>this._threshold=e}),this.exposeProperty("blurRadius","number",2,{min:1,max:5,step:1,onChange:e=>this._blurRadius=e}),this.exposeProperty("preserveSharpEdges","boolean",!0,{onChange:e=>this._preserveSharpEdges=e})}start(){this.camera=this.gameObject.getModule("Camera3DRasterizer"),this.camera?this.setupPostRender():console.warn("EdgeBlurEffect: Camera3DRasterizer not found on start")}setupPostRender(){this.camera&&(this._originalPostRender=this.camera.postRender.bind(this.camera),this.camera.postRender=(e,t,i)=>{if(this._originalPostRender&&this._originalPostRender(e,t,i),0===this._strength)return;const s=this.detectEdgesFast(e,t,i);this.blurEdgesFast(e,s,t,i)})}detectEdgesFast(e,t,i){this._edgeMapCache&&this._edgeMapCache.length===t*i||(this._edgeMapCache=new Uint8Array(t*i));const s=this._edgeMapCache;s.fill(0);const o=this._threshold,n=3*o;for(let r=1;i-1>r;r++){const i=r*t,a=(r-1)*t,l=(r+1)*t;for(let r=1;t-1>r;r++){const t=e[a+r-1],h=e[a+r],c=e[a+r+1],d=e[i+r-1],p=e[i+r+1],u=e[l+r-1],g=e[l+r],m=e[l+r+1],f=77*(255&t)+150*(t>>8&255)+29*(t>>16&255)>>8,y=77*(255&c)+150*(c>>8&255)+29*(c>>16&255)>>8,w=77*(255&u)+150*(u>>8&255)+29*(u>>16&255)>>8,b=77*(255&m)+150*(m>>8&255)+29*(m>>16&255)>>8,x=w+2*(77*(255&g)+150*(g>>8&255)+29*(g>>16&255)>>8)+b-(f+2*(77*(255&h)+150*(h>>8&255)+29*(h>>16&255)>>8)+y),v=Math.abs(y+2*(77*(255&p)+150*(p>>8&255)+29*(p>>16&255)>>8)+b-(f+2*(77*(255&d)+150*(d>>8&255)+29*(d>>16&255)>>8)+w))+Math.abs(x);this._preserveSharpEdges?v>o&&n>v&&(s[i+r]=255):v>o&&(s[i+r]=255)}}return s}blurEdgesFast(e,t,i,s){const o=this._blurRadius,n=this._strength,r=new Uint8Array(i*s);for(let e=0;s>e;e++)for(let n=0;i>n;n++){const a=e*i+n;let l=!1;const h=o+1;for(let o=-h;h>=o&&!l;o++){const r=e+o;if(r>=0&&s>r)for(let e=-h;h>=e;e++){const s=n+e;if(s>=0&&i>s&&t[r*i+s]>0){l=!0;break}}}l&&(r[a]=255)}const a=new Uint32Array(i*s);for(let t=0;s>t;t++){const s=t*i;for(let t=0;i>t;t++){const n=s+t;if(0===r[n]){a[n]=e[n];continue}let l=0,h=0,c=0,d=0;for(let n=-o;o>=n;n++){const r=t+n;if(0>r||r>=i)continue;const a=e[s+r],p=255&a,u=a>>8&255,g=a>>16&255,m=1-Math.abs(n)/(o+1);l+=p*m,h+=u*m,c+=g*m,d+=m}if(d>0){const e=Math.round(l/d),t=Math.round(h/d),i=Math.round(c/d);a[n]=255<<24|i<<16|t<<8|e}else a[n]=e[n]}}for(let t=0;s>t;t++){const l=t*i;for(let h=0;i>h;h++){const c=l+h;if(0===r[c])continue;let d=0,p=0,u=0,g=0;for(let e=-o;o>=e;e++){const n=t+e;if(0>n||n>=s)continue;const r=a[n*i+h],l=255&r,c=r>>8&255,m=r>>16&255,f=1-Math.abs(e)/(o+1);d+=l*f,p+=c*f,u+=m*f,g+=f}if(g>0){const t=Math.round(d/g),i=Math.round(p/g),s=Math.round(u/g),o=e[c],r=o>>8&255,a=o>>16&255,l=Math.round((255&o)*(1-n)+t*n),h=Math.round(r*(1-n)+i*n),m=Math.round(a*(1-n)+s*n);e[c]=255<<24|m<<16|h<<8|l}}}}loop(e){this.camera||(this.camera=this.gameObject.getModule("Camera3DRasterizer"),this.camera&&this.setupPostRender())}onDestroy(){this.camera&&this._originalPostRender&&(this.camera.postRender=this._originalPostRender),this._edgeMapCache=null}toJSON(){return{...super.toJSON(),_type:"EdgeBlurEffect",_strength:this._strength,_threshold:this._threshold,_blurRadius:this._blurRadius,_preserveSharpEdges:this._preserveSharpEdges}}fromJSON(e){super.fromJSON(e),void 0!==e._strength&&(this._strength=e._strength),void 0!==e._threshold&&(this._threshold=e._threshold),void 0!==e._blurRadius&&(this._blurRadius=e._blurRadius),void 0!==e._preserveSharpEdges&&(this._preserveSharpEdges=e._preserveSharpEdges)}}window.EdgeBlurEffect=EdgeBlurEffect;class MotionBlurEffect extends Module{static namespace="Effects";constructor(){super("MotionBlurEffect"),this._strength=.5,this._samples=8,this._maxBlurDistance=20,this.camera=null,this._originalPostRender=null,this._lastCameraPos=null,this._lastCameraRot=null,this._motionVector={x:0,y:0,z:0},this.exposeProperty("strength","number",.5,{min:0,max:1,step:.05,onChange:e=>this._strength=e}),this.exposeProperty("samples","number",8,{min:2,max:16,step:1,onChange:e=>this._samples=e}),this.exposeProperty("maxBlurDistance","number",20,{min:5,max:50,step:5,onChange:e=>this._maxBlurDistance=e})}start(){this.camera=this.gameObject.getModule("Camera3DRasterizer"),this.camera?(this._lastCameraPos={...this.camera._position},this._lastCameraRot={...this.camera._rotation},this.setupPostRender()):console.warn("MotionBlurEffect: Camera3DRasterizer not found on start")}setupPostRender(){this.camera&&(this._originalPostRender=this.camera.postRender.bind(this.camera),this.camera.postRender=(e,t,i)=>{this._originalPostRender&&this._originalPostRender(e,t,i),0!==this._strength&&(this.calculateMotionVector(),this.applyMotionBlur(e,t,i),this._lastCameraPos={...this.camera._position},this._lastCameraRot={...this.camera._rotation})})}calculateMotionVector(){if(!this._lastCameraPos||!this._lastCameraRot)return;const e=this.camera._position.x-this._lastCameraPos.x,t=this.camera._position.y-this._lastCameraPos.y,i=this.camera._position.z-this._lastCameraPos.z,s=this.camera._rotation.x-this._lastCameraRot.x,o=this.camera._rotation.y-this._lastCameraRot.y,n=this.camera._rotation.z-this._lastCameraRot.z;this._motionVector={x:2*t+.5*n,y:2*i+.5*o,z:Math.sqrt(e*e+s*s)}}applyMotionBlur(e,t,i){const s=Math.sqrt(this._motionVector.x*this._motionVector.x+this._motionVector.y*this._motionVector.y);if(.1>s)return;const o=new Uint32Array(e.length),n=this._samples,r=this._strength,a=Math.min(10*s,this._maxBlurDistance),l=this._motionVector.x/s*a,h=this._motionVector.y/s*a;for(let s=0;i>s;s++)for(let a=0;t>a;a++){const c=s*t+a;let d=0,p=0,u=0,g=0;for(let o=0;n>o;o++){const c=o/(n-1)-.5,m=Math.round(a+l*c*r),f=Math.round(s+h*c*r);if(m>=0&&t>m&&f>=0&&i>f){const i=e[f*t+m];d+=255&i,p+=i>>8&255,u+=i>>16&255,g++}}o[c]=g>0?255<<24|Math.round(u/g)<<16|Math.round(p/g)<<8|Math.round(d/g):e[c]}e.set(o)}loop(e){this.camera||(this.camera=this.gameObject.getModule("Camera3DRasterizer"),this.camera&&(this._lastCameraPos={...this.camera._position},this._lastCameraRot={...this.camera._rotation},this.setupPostRender()))}onDestroy(){this.camera&&this._originalPostRender&&(this.camera.postRender=this._originalPostRender)}toJSON(){return{...super.toJSON(),_type:"MotionBlurEffect",_strength:this._strength,_samples:this._samples,_maxBlurDistance:this._maxBlurDistance}}fromJSON(e){super.fromJSON(e),void 0!==e._strength&&(this._strength=e._strength),void 0!==e._samples&&(this._samples=e._samples),void 0!==e._maxBlurDistance&&(this._maxBlurDistance=e._maxBlurDistance)}}window.MotionBlurEffect=MotionBlurEffect;class OutlineEffect extends Module{static namespace="Effects";constructor(){super("OutlineEffect"),this._thickness=1,this._threshold=50,this._color="#000000",this._blendMode="multiply",this.camera=null,this._originalPostRender=null,this.exposeProperty("thickness","number",1,{min:1,max:5,step:1,onChange:e=>this._thickness=e}),this.exposeProperty("threshold","number",50,{min:10,max:200,step:10,onChange:e=>this._threshold=e}),this.exposeProperty("color","color","#000000",{onChange:e=>this._color=e}),this.exposeProperty("blendMode","dropdown","multiply",{options:["multiply","overlay","solid"],onChange:e=>this._blendMode=e})}start(){this.camera=this.gameObject.getModule("Camera3DRasterizer"),this.camera?this.setupPostRender():console.warn("OutlineEffect: Camera3DRasterizer not found on start")}setupPostRender(){this.camera&&(this._originalPostRender=this.camera.postRender.bind(this.camera),this.camera.postRender=(e,t,i)=>{this._originalPostRender&&this._originalPostRender(e,t,i);const s=this.camera.detectEdges(e,t,i,this._threshold),o=this.hexToRgb(this._color);for(let n=0;i>n;n++)for(let r=0;t>r;r++){const a=n*t+r;let l=s[a]>0;if(!l&&this._thickness>1)for(let e=1-this._thickness;e<this._thickness&&!l;e++)for(let o=1-this._thickness;o<this._thickness&&!l;o++){const a=n+e,h=r+o;h>=0&&t>h&&a>=0&&i>a&&s[a*t+h]>0&&(l=!0)}if(l){const t=e[a],i=255&t,s=t>>8&255,n=t>>16&255;let r,l,h;switch(this._blendMode){case"solid":r=o.r,l=o.g,h=o.b;break;case"multiply":r=Math.round(i/255*o.r),l=Math.round(s/255*o.g),h=Math.round(n/255*o.b);break;case"overlay":r=Math.round((i+o.r)/2),l=Math.round((s+o.g)/2),h=Math.round((n+o.b)/2);break;default:r=i,l=s,h=n}e[a]=255<<24|h<<16|l<<8|r}}})}hexToRgb(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:0,g:0,b:0}}loop(e){this.camera||(this.camera=this.gameObject.getModule("Camera3DRasterizer"),this.camera&&this.setupPostRender())}onDestroy(){this.camera&&this._originalPostRender&&(this.camera.postRender=this._originalPostRender)}toJSON(){return{...super.toJSON(),_type:"OutlineEffect",_thickness:this._thickness,_threshold:this._threshold,_color:this._color,_blendMode:this._blendMode}}fromJSON(e){super.fromJSON(e),void 0!==e._thickness&&(this._thickness=e._thickness),void 0!==e._threshold&&(this._threshold=e._threshold),void 0!==e._color&&(this._color=e._color),void 0!==e._blendMode&&(this._blendMode=e._blendMode)}}window.OutlineEffect=OutlineEffect;class VignetteEffect extends Module{static namespace="Effects";constructor(){super("VignetteEffect"),this._intensity=.5,this._softness=.5,this._color="#000000",this.camera=null,this._originalPostRender=null,this.exposeProperty("intensity","number",.5,{min:0,max:1,step:.05,onChange:e=>this._intensity=e}),this.exposeProperty("softness","number",.5,{min:0,max:1,step:.05,onChange:e=>this._softness=e}),this.exposeProperty("color","color","#000000",{onChange:e=>this._color=e})}start(){this.camera=this.gameObject.getModule("Camera3DRasterizer"),this.camera?this.setupPostRender():console.warn("VignetteEffect: Camera3DRasterizer not found on start")}setupPostRender(){this.camera&&(this._originalPostRender=this.camera.postRender.bind(this.camera),this.camera.postRender=(e,t,i)=>{if(this._originalPostRender&&this._originalPostRender(e,t,i),0===this._intensity)return;const s=this.hexToRgb(this._color),o=t/2,n=i/2,r=Math.sqrt(o*o+n*n);for(let a=0;i>a;a++)for(let i=0;t>i;i++){const l=i-o,h=a-n,c=Math.pow(Math.sqrt(l*l+h*h)/r,1+2*(1-this._softness))*this._intensity,d=a*t+i,p=e[d],u=p>>8&255,g=p>>16&255,m=Math.round((255&p)*(1-c)+s.r*c),f=Math.round(u*(1-c)+s.g*c),y=Math.round(g*(1-c)+s.b*c);e[d]=255<<24|y<<16|f<<8|m}})}hexToRgb(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:0,g:0,b:0}}loop(e){this.camera||(this.camera=this.gameObject.getModule("Camera3DRasterizer"),this.camera&&this.setupPostRender())}onDestroy(){this.camera&&this._originalPostRender&&(this.camera.postRender=this._originalPostRender)}toJSON(){return{...super.toJSON(),_type:"VignetteEffect",_intensity:this._intensity,_softness:this._softness,_color:this._color}}fromJSON(e){super.fromJSON(e),void 0!==e._intensity&&(this._intensity=e._intensity),void 0!==e._softness&&(this._softness=e._softness),void 0!==e._color&&(this._color=e._color)}}window.VignetteEffect=VignetteEffect;class TopDownCamera extends Module{static namespace="3D";static description="Top-down camera controller with Z-up coordinate system (Z=up/down, Y=left/right, X=forward/back)";static iconClass="fas fa-camera";constructor(){super("TopDownCamera"),this.requires("Camera3DRasterizer"),this._cameraDistance=500,this._moveSpeed=200,this._sprintMultiplier=2.5,this._smoothing=.2,this._currentVelocity=new Vector3(0,0,0),this._topDownAngleX=90,this._topDownAngleY=0,this._topDownAngleZ=0,this._keyMapping={forward:"w",backward:"s",left:"a",right:"d",up:"e",down:"q",sprint:"shift"},this.camera=null,this.exposeProperty("cameraDistance","number",500,{min:10,max:2e3,step:10,description:"Distance from camera to target",onChange:e=>this._cameraDistance=e}),this.exposeProperty("moveSpeed","number",200,{min:1,max:1e3,description:"Movement speed in units per second",onChange:e=>this._moveSpeed=e}),this.exposeProperty("sprintMultiplier","number",2.5,{min:1,max:10,description:"Speed multiplier when sprinting",onChange:e=>this._sprintMultiplier=e}),this.exposeProperty("smoothing","number",.2,{min:0,max:.99,step:.01,description:"Movement smoothing (0 = instant, 1 = very smooth)",onChange:e=>this._smoothing=e}),this.exposeProperty("topDownAngleX","number",90,{min:45,max:90,step:1,description:"Camera pitch angle around Y axis (90 = straight down)",onChange:e=>this._topDownAngleX=e}),this.exposeProperty("topDownAngleY","number",0,{min:-180,max:180,step:1,description:"Camera yaw angle around Z axis (rotation around vertical axis)",onChange:e=>this._topDownAngleY=e}),this.exposeProperty("topDownAngleZ","number",0,{min:-180,max:180,step:1,description:"Camera roll angle around X axis (tilt)",onChange:e=>this._topDownAngleZ=e}),this.exposeProperty("keyMapping","object",this._keyMapping,{description:"Key mapping for camera controls",onChange:e=>this._keyMapping=e})}start(){this.camera=this.gameObject.getModule("Camera3D"),this.camera||console.error("TopDownCamera requires a Camera3D module on the same GameObject"),window.input||console.error("TopDownCamera requires InputManager to be initialized"),this.lockCameraAngle()}lockCameraAngle(){this.camera&&(this.camera.rotation&&(this.camera.rotation.x=this._topDownAngleZ,this.camera.rotation.y=this._topDownAngleX,this.camera.rotation.z=this._topDownAngleY),this.gameObject&&(this.gameObject.angle=this._topDownAngleY))}loop(e){if(!this.camera||!window.input)return;this.lockCameraAngle();const t=this.calculateTargetVelocity();this._currentVelocity.x+=(t.x-this._currentVelocity.x)*(1-this._smoothing),this._currentVelocity.y+=(t.y-this._currentVelocity.y)*(1-this._smoothing),this._currentVelocity.z+=(t.z-this._currentVelocity.z)*(1-this._smoothing),this._currentVelocity.magnitude()>.01&&this.moveCamera(e)}calculateTargetVelocity(){const e=new Vector3(0,0,0);if(!window.input)return e;const t=window.input.keyDown(this.keyMapping.sprint)?this.sprintMultiplier:1;return window.input.keyDown(this.keyMapping.forward)&&(e.x+=this.moveSpeed*t),window.input.keyDown(this.keyMapping.backward)&&(e.x-=this.moveSpeed*t),window.input.keyDown(this.keyMapping.left)&&(e.y-=this.moveSpeed*t),window.input.keyDown(this.keyMapping.right)&&(e.y+=this.moveSpeed*t),window.input.keyDown(this.keyMapping.up)&&(e.z+=this.moveSpeed*t),window.input.keyDown(this.keyMapping.down)&&(e.z-=this.moveSpeed*t),e}moveCamera(e){this.gameObject.position&&"number"==typeof this.gameObject.position.x&&"number"==typeof this.gameObject.position.y||(this.gameObject.position={x:0,y:0});const t=Number.isFinite(this._currentVelocity.x)?this._currentVelocity.x*e:0,i=Number.isFinite(this._currentVelocity.y)?this._currentVelocity.y*e:0;this.gameObject.position.x+=t,this.gameObject.position.y+=i;const s=Number.isFinite(this._currentVelocity.z)?this._currentVelocity.z*e:0;this.camera&&this.camera.position&&(this.camera.position.z&&"number"==typeof this.camera.position.z?(this.camera.position.z+=s,this.camera.position.z=Math.max(50,Math.min(2e3,this.camera.position.z)),this._cameraDistance=this.camera.position.z):this.camera.position.z=this._cameraDistance)}setCameraDistance(e){this._cameraDistance=Math.max(50,Math.min(2e3,e)),this.camera&&this.camera.position&&(this.camera.position.z=this._cameraDistance)}getCameraDistance(){return this.camera&&this.camera.position&&"number"==typeof this.camera.position.z?this.camera.position.z:this._cameraDistance}setTopDownAngles(e=90,t=0,i=0){this._topDownAngleX=Math.max(45,Math.min(90,e)),this._topDownAngleY=t,this._topDownAngleZ=i,this.lockCameraAngle()}toJSON(){return{...super.toJSON(),_type:"TopDownCamera",_cameraDistance:this._cameraDistance,_moveSpeed:this._moveSpeed,_sprintMultiplier:this._sprintMultiplier,_smoothing:this._smoothing,_topDownAngleX:this._topDownAngleX,_topDownAngleY:this._topDownAngleY,_topDownAngleZ:this._topDownAngleZ,_keyMapping:{...this._keyMapping}}}fromJSON(e){super.fromJSON(e),void 0!==e._cameraDistance&&(this._cameraDistance=e._cameraDistance),void 0!==e._moveSpeed&&(this._moveSpeed=e._moveSpeed),void 0!==e._sprintMultiplier&&(this._sprintMultiplier=e._sprintMultiplier),void 0!==e._smoothing&&(this._smoothing=e._smoothing),void 0!==e._topDownAngleX&&(this._topDownAngleX=e._topDownAngleX),void 0!==e._topDownAngleY&&(this._topDownAngleY=e._topDownAngleY),void 0!==e._topDownAngleZ&&(this._topDownAngleZ=e._topDownAngleZ),e._keyMapping&&(this._keyMapping={...e._keyMapping}),this.lockCameraAngle()}get cameraDistance(){return this._cameraDistance}set cameraDistance(e){this._cameraDistance=e,this.setCameraDistance(e)}get moveSpeed(){return this._moveSpeed}set moveSpeed(e){this._moveSpeed=e}get sprintMultiplier(){return this._sprintMultiplier}set sprintMultiplier(e){this._sprintMultiplier=e}get smoothing(){return this._smoothing}set smoothing(e){this._smoothing=Math.max(0,Math.min(.99,e))}get topDownAngleX(){return this._topDownAngleX}set topDownAngleX(e){this._topDownAngleX=e,this.lockCameraAngle()}get topDownAngleY(){return this._topDownAngleY}set topDownAngleY(e){this._topDownAngleY=e,this.lockCameraAngle()}get topDownAngleZ(){return this._topDownAngleZ}set topDownAngleZ(e){this._topDownAngleZ=e,this.lockCameraAngle()}get keyMapping(){return this._keyMapping}set keyMapping(e){this._keyMapping=e}}window.TopDownCamera=TopDownCamera;class DrawArrow extends Module{static namespace="Drawing";static description="Directional arrow for UI and gameplay";static allowMultiple=!1;static iconClass="fas fa-arrow-right";static iconColor="#a200ffff";constructor(){super("DrawArrow"),this.fillColor="#44ff44",this.outlineColor="#228822",this.outlineWidth=2,this.filled=!0,this.outlined=!0,this.arrowType="standard",this.exposeProperty("fillColor","color",this.fillColor,{description:"Arrow fill color",onChange:e=>{this.fillColor=e}}),this.exposeProperty("outlineColor","color",this.outlineColor,{description:"Arrow outline color",onChange:e=>{this.outlineColor=e}}),this.exposeProperty("outlineWidth","number",this.outlineWidth,{description:"Outline thickness",onChange:e=>{this.outlineWidth=e}}),this.exposeProperty("filled","boolean",this.filled,{description:"Fill the arrow",onChange:e=>{this.filled=e}}),this.exposeProperty("outlined","boolean",this.outlined,{description:"Draw outline",onChange:e=>{this.outlined=e}}),this.exposeProperty("arrowType","enum",this.arrowType,{description:"Arrow style",options:["standard","thick","pointed"],onChange:e=>{this.arrowType=e}})}style(e){e.startGroup("Arrow Style",!1,{backgroundColor:"rgba(68,255,68,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("arrowType","enum",this.arrowType,{description:"Style of the arrow",options:["standard","thick","pointed"],style:{label:"Arrow Type"}}),e.endGroup(),e.startGroup("Arrow Appearance",!1,{backgroundColor:"rgba(68,255,68,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("fillColor","color",this.fillColor,{style:{label:"Fill Color"}}),e.exposeProperty("outlineColor","color",this.outlineColor,{style:{label:"Outline Color"}}),e.exposeProperty("outlineWidth","number",this.outlineWidth,{min:0,max:20,step:1,style:{label:"Outline Width",slider:!0}}),e.exposeProperty("filled","boolean",this.filled,{style:{label:"Filled"}}),e.exposeProperty("outlined","boolean",this.outlined,{style:{label:"Outlined"}}),e.endGroup(),e.addHelpText("Great for directions, UI navigation, and gameplay indicators")}draw(e){this.gameObject.getWorldPosition(),this.gameObject.scale,e.save(),e.beginPath(),"standard"===this.arrowType?(e.moveTo(-25,-8),e.lineTo(15,-8),e.lineTo(15,-15),e.lineTo(30,0),e.lineTo(15,15),e.lineTo(15,8),e.lineTo(-25,8)):"thick"===this.arrowType?(e.moveTo(-25,-12),e.lineTo(10,-12),e.lineTo(10,-18),e.lineTo(30,0),e.lineTo(10,18),e.lineTo(10,12),e.lineTo(-25,12)):"pointed"===this.arrowType&&(e.moveTo(-30,-5),e.lineTo(15,-5),e.lineTo(15,-15),e.lineTo(35,0),e.lineTo(15,15),e.lineTo(15,5),e.lineTo(-30,5)),e.closePath(),this.filled&&(e.fillStyle=this.fillColor,e.fill()),this.outlined&&this.outlineWidth>0&&(e.strokeStyle=this.outlineColor,e.lineWidth=this.outlineWidth,e.stroke()),e.restore()}toJSON(){return{...super.toJSON(),fillColor:this.fillColor,outlineColor:this.outlineColor,outlineWidth:this.outlineWidth,filled:this.filled,outlined:this.outlined,arrowType:this.arrowType}}fromJSON(e){super.fromJSON(e),e&&(this.fillColor=e.fillColor||"#44ff44",this.outlineColor=e.outlineColor||"#228822",this.outlineWidth=e.outlineWidth||2,this.filled=void 0===e.filled||e.filled,this.outlined=void 0===e.outlined||e.outlined,this.arrowType=e.arrowType||"standard")}}window.DrawArrow=DrawArrow;class DrawCapsule extends Module{static namespace="Drawing";static description="Draws a filled capsule at the GameObject's position";static iconColor="#a200ffff";constructor(){super("DrawCapsule"),this.width=30,this.height=60,this.offset=new Vector2(0,0),this.color="#ffffff",this.fill=!0,this.outline=!1,this.outlineColor="#000000",this.outlineWidth=2,this.orientation="vertical",this.exposeProperty("width","number",this.width,{min:1,description:"Capsule width",onChange:e=>this.width=e}),this.exposeProperty("height","number",this.height,{min:1,description:"Capsule height",onChange:e=>this.height=e}),this.exposeProperty("offset","vector2",this.offset,{description:"Offset from center",onChange:e=>this.offset=e}),this.exposeProperty("color","color",this.color,{description:"Fill color",onChange:e=>this.color=e}),this.exposeProperty("fill","boolean",this.fill,{description:"Fill capsule",onChange:e=>this.fill=e}),this.exposeProperty("outline","boolean",this.outline,{description:"Show outline",onChange:e=>this.outline=e}),this.exposeProperty("outlineColor","color",this.outlineColor,{description:"Outline color",onChange:e=>this.outlineColor=e}),this.exposeProperty("outlineWidth","number",this.outlineWidth,{description:"Outline thickness",min:0,max:20,step:.5,onChange:e=>this.outlineWidth=e}),this.exposeProperty("orientation","enum",this.orientation,{options:["vertical","horizontal"],description:"Capsule orientation",onChange:e=>this.orientation=e})}getBoundingBox(){return{x:this.offset.x-this.width/2,y:this.offset.y-this.height/2,width:this.width,height:this.height}}draw(e,t){if(!this.enabled)return;const i=Math.min(this.width,this.height)/2,s="vertical"===this.orientation;let o,n,r;if(s?(o=this.width,n=Math.max(0,this.height-this.width),r=n):(o=Math.max(0,this.width-this.height),n=this.height,r=o),window.engine&&window.engine.usePixi&&e instanceof window.PixiRenderer){const a=t||e.graphics;function l(e){return window.PIXI&&window.PIXI.utils&&window.PIXI.utils.string2hex?window.PIXI.utils.string2hex(e):"string"==typeof e&&e.startsWith("#")?parseInt(e.slice(1),16):16777215}return a.clear(),this.fill&&a.beginFill(l(this.color)),this.outline&&a.lineStyle(this.outlineWidth,l(this.outlineColor)),s?(r>0&&a.drawRect(this.offset.x-o/2,this.offset.y-r/2,o,r),a.drawCircle(this.offset.x,this.offset.y-r/2,i),a.drawCircle(this.offset.x,this.offset.y+r/2,i)):(r>0&&a.drawRect(this.offset.x-r/2,this.offset.y-n/2,r,n),a.drawCircle(this.offset.x-r/2,this.offset.y,i),a.drawCircle(this.offset.x+r/2,this.offset.y,i)),a.endFill(),void e.render()}if(e.save(),e.translate(this.offset.x,this.offset.y),e.beginPath(),s){const h=r/2;r>0?(e.moveTo(-i,-h),e.lineTo(i,-h),e.arc(0,-h,i,0,Math.PI,!0),e.lineTo(-i,h),e.arc(0,h,i,Math.PI,0,!0)):e.arc(0,0,i,0,2*Math.PI)}else{const c=r/2;r>0?(e.moveTo(-c,-i),e.arc(-c,0,i,-Math.PI/2,Math.PI/2,!0),e.lineTo(c,i),e.arc(c,0,i,Math.PI/2,-Math.PI/2,!0)):e.arc(0,0,i,0,2*Math.PI)}e.closePath(),this.fill&&(e.fillStyle=this.color,e.fill()),this.outline&&(e.strokeStyle=this.outlineColor,e.lineWidth=this.outlineWidth,e.stroke()),e.restore()}drawSeparate(e){if(!this.enabled)return;let t,i,s;e.save(),e.translate(this.offset.x,this.offset.y),"vertical"===this.orientation?(t=Math.min(this.width,this.height),i=Math.max(this.width,this.height),s=!0):(t=Math.max(this.width,this.height),i=Math.min(this.width,this.height),s=!1);const o=Math.min(t,i)/2,n=Math.max(t,i)-2*o;if(s){const i=n/2;e.beginPath(),e.rect(-t/2,-i,t,n),this.fill&&(e.fillStyle=this.color,e.fill()),this.outline&&(e.strokeStyle=this.outlineColor,e.lineWidth=this.outlineWidth,e.stroke()),e.beginPath(),e.arc(0,-i,o,Math.PI,0,!1),this.fill&&(e.fillStyle=this.color,e.fill()),this.outline&&(e.strokeStyle=this.outlineColor,e.lineWidth=this.outlineWidth,e.stroke()),e.beginPath(),e.arc(0,i,o,0,Math.PI,!1),this.fill&&(e.fillStyle=this.color,e.fill()),this.outline&&(e.strokeStyle=this.outlineColor,e.lineWidth=this.outlineWidth,e.stroke())}else{const t=n/2;e.beginPath(),e.rect(-t,-i/2,n,i),this.fill&&(e.fillStyle=this.color,e.fill()),this.outline&&(e.strokeStyle=this.outlineColor,e.lineWidth=this.outlineWidth,e.stroke()),e.beginPath(),e.arc(-t,0,o,Math.PI/2,-Math.PI/2,!1),this.fill&&(e.fillStyle=this.color,e.fill()),this.outline&&(e.strokeStyle=this.outlineColor,e.lineWidth=this.outlineWidth,e.stroke()),e.beginPath(),e.arc(t,0,o,-Math.PI/2,Math.PI/2,!1),this.fill&&(e.fillStyle=this.color,e.fill()),this.outline&&(e.strokeStyle=this.outlineColor,e.lineWidth=this.outlineWidth,e.stroke())}e.restore()}toJSON(){return{...super.toJSON(),width:this.width,height:this.height,offset:this.offset.toJSON(),color:this.color,fill:this.fill,outline:this.outline,outlineColor:this.outlineColor,outlineWidth:this.outlineWidth,orientation:this.orientation}}fromJSON(e){super.fromJSON(e),this.width=e.width||this.width,this.height=e.height||this.height,this.offset=Vector2.fromJSON(e.offset)||this.offset,this.color=e.color||this.color,this.fill=void 0!==e.fill?e.fill:this.fill,this.outline=void 0!==e.outline?e.outline:this.outline,this.outlineColor=e.outlineColor||this.outlineColor,this.outlineWidth=e.outlineWidth||this.outlineWidth,this.orientation=e.orientation||this.orientation}}window.DrawCapsule=DrawCapsule;class DrawCircle extends Module{static namespace="Drawing";static description="Draws a filled circle at the GameObject's position";static iconColor="#a200ffff";constructor(){super("DrawCircle"),this.radius=25,this.offset=new Vector2(0,0),this.color="#ffffff",this.fill=!0,this.outline=!1,this.outlineColor="#000000",this.outlineWidth=2,this.exposeProperty("radius","number",this.radius,{min:0,description:"Circle radius",onChange:e=>this.radius=e}),this.exposeProperty("offset","vector2",this.offset,{description:"Offset from center",onChange:e=>this.offset=e}),this.exposeProperty("color","color",this.color,{description:"Fill color",onChange:e=>this.color=e}),this.exposeProperty("fill","boolean",this.fill,{description:"Fill circle",onChange:e=>this.fill=e}),this.exposeProperty("outline","boolean",this.outline,{description:"Show outline",onChange:e=>this.outline=e}),this.exposeProperty("outlineColor","color",this.outlineColor,{description:"Outline color",onChange:e=>this.outlineColor=e}),this.exposeProperty("outlineWidth","number",this.outlineWidth,{description:"Outline thickness",min:0,max:20,step:.5,onChange:e=>this.outlineWidth=e})}getBoundingBox(){return{x:this.offset.x-this.radius,y:this.offset.y-this.radius,width:2*this.radius,height:2*this.radius}}draw(e,t){if(this.enabled){if(window.engine&&window.engine.usePixi&&e instanceof window.PixiRenderer){const i=t||e.graphics;function s(e){return window.PIXI&&window.PIXI.utils&&window.PIXI.utils.string2hex?window.PIXI.utils.string2hex(e):"string"==typeof e&&e.startsWith("#")?parseInt(e.slice(1),16):16777215}return i.clear(),this.fill&&i.beginFill(s(this.color)),this.outline&&i.lineStyle(this.outlineWidth,s(this.outlineColor)),i.drawCircle(this.offset.x,this.offset.y,this.radius),i.endFill(),void e.render()}e.save(),e.translate(this.offset.x,this.offset.y),e.beginPath(),e.arc(0,0,this.radius,0,2*Math.PI),this.fill&&(e.fillStyle=this.color,e.fill()),this.outline&&(e.strokeStyle=this.outlineColor,e.lineWidth=this.outlineWidth,e.stroke()),e.restore()}}toJSON(){return{...super.toJSON(),radius:this.radius,offset:this.offset.toJSON(),color:this.color,fill:this.fill,outline:this.outline,outlineColor:this.outlineColor,outlineWidth:this.outlineWidth}}fromJSON(e){super.fromJSON(e),this.radius=e.radius||this.radius,this.offset=Vector2.fromJSON(e.offset)||this.offset,this.color=e.color||this.color,this.fill=void 0!==e.fill?e.fill:this.fill,this.outline=void 0!==e.outline?e.outline:this.outline,this.outlineColor=e.outlineColor||this.outlineColor,this.outlineWidth=e.outlineWidth||this.outlineWidth}}window.DrawCircle=DrawCircle;class DrawDiamond extends Module{static namespace="Drawing";static description="Sparkling diamond for gems and valuables";static allowMultiple=!1;static iconClass="fas fa-gem";static iconColor="#a200ffff";constructor(){super("DrawDiamond"),this.fillColor="#88ddff",this.outlineColor="#2288cc",this.outlineWidth=2,this.filled=!0,this.outlined=!0,this.sparkle=!0,this.facets=!0,this.exposeProperty("fillColor","color",this.fillColor,{description:"Diamond fill color",onChange:e=>{this.fillColor=e}}),this.exposeProperty("outlineColor","color",this.outlineColor,{description:"Diamond outline color",onChange:e=>{this.outlineColor=e}}),this.exposeProperty("outlineWidth","number",this.outlineWidth,{description:"Outline thickness",onChange:e=>{this.outlineWidth=e}}),this.exposeProperty("filled","boolean",this.filled,{description:"Fill the diamond",onChange:e=>{this.filled=e}}),this.exposeProperty("outlined","boolean",this.outlined,{description:"Draw outline",onChange:e=>{this.outlined=e}}),this.exposeProperty("sparkle","boolean",this.sparkle,{description:"Add sparkle effect",onChange:e=>{this.sparkle=e}}),this.exposeProperty("facets","boolean",this.facets,{description:"Show facet lines",onChange:e=>{this.facets=e}})}style(e){e.startGroup("Diamond Appearance",!1,{backgroundColor:"rgba(136,221,255,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("fillColor","color",this.fillColor,{style:{label:"Fill Color"}}),e.exposeProperty("outlineColor","color",this.outlineColor,{style:{label:"Outline Color"}}),e.exposeProperty("outlineWidth","number",this.outlineWidth,{min:0,max:20,step:1,style:{label:"Outline Width",slider:!0}}),e.exposeProperty("filled","boolean",this.filled,{style:{label:"Filled"}}),e.exposeProperty("outlined","boolean",this.outlined,{style:{label:"Outlined"}}),e.exposeProperty("sparkle","boolean",this.sparkle,{style:{label:"Sparkle Effect"}}),e.exposeProperty("facets","boolean",this.facets,{style:{label:"Show Facets"}}),e.endGroup(),e.addHelpText("Ideal for gems, currency, and precious items")}draw(e){if(this.gameObject.getWorldPosition(),this.gameObject.scale,e.save(),e.beginPath(),e.moveTo(0,-25),e.lineTo(-15,-10),e.lineTo(-20,10),e.lineTo(0,25),e.lineTo(20,10),e.lineTo(15,-10),e.closePath(),this.filled){const t=e.createLinearGradient(-20,-25,20,25);t.addColorStop(0,this.fillColor),t.addColorStop(.5,"rgba(255,255,255,0.3)"),t.addColorStop(1,this.fillColor),e.fillStyle=t,e.fill()}this.outlined&&this.outlineWidth>0&&(e.strokeStyle=this.outlineColor,e.lineWidth=this.outlineWidth,e.stroke()),this.facets&&(e.strokeStyle="rgba(255,255,255,0.3)",e.lineWidth=1,e.beginPath(),e.moveTo(0,-25),e.lineTo(0,25),e.moveTo(-15,-10),e.lineTo(15,-10),e.stroke()),this.sparkle&&(e.fillStyle="white",e.fillRect(-2,-15,4,2),e.fillRect(-1,-17,2,6),e.fillRect(8,-5,3,1),e.fillRect(9,-7,1,4)),e.restore()}toJSON(){return{...super.toJSON(),fillColor:this.fillColor,outlineColor:this.outlineColor,outlineWidth:this.outlineWidth,filled:this.filled,outlined:this.outlined,sparkle:this.sparkle,facets:this.facets}}fromJSON(e){super.fromJSON(e),e&&(this.fillColor=e.fillColor||"#88ddff",this.outlineColor=e.outlineColor||"#2288cc",this.outlineWidth=e.outlineWidth||2,this.filled=void 0===e.filled||e.filled,this.outlined=void 0===e.outlined||e.outlined,this.sparkle=void 0===e.sparkle||e.sparkle,this.facets=void 0===e.facets||e.facets)}}window.DrawDiamond=DrawDiamond;class DrawGrid extends Module{static namespace="Drawing";static description="Draws an infinite, scalable grid optimized for viewport rendering";static allowMultiple=!0;static iconClass="fas fa-th";static iconColor="#a200ffff";constructor(){super("DrawGrid"),this.x=0,this.y=0,this.cellWidth=50,this.cellHeight=50,this.lineColor="#cccccc",this.lineThickness=1,this.showVertical=!0,this.showHorizontal=!0,this.glow=!1,this.glowColor="#00ffff",this.glowBlur=8,this.infinite=!0,this.width=800,this.height=600,this.exposeProperty("x","number",this.x,{description:"Grid X offset position",onChange:e=>{this.x=e}}),this.exposeProperty("y","number",this.y,{description:"Grid Y offset position",onChange:e=>{this.y=e}}),this.exposeProperty("cellWidth","number",this.cellWidth,{description:"Cell width",onChange:e=>{this.cellWidth=Math.max(1,e)}}),this.exposeProperty("cellHeight","number",this.cellHeight,{description:"Cell height",onChange:e=>{this.cellHeight=Math.max(1,e)}}),this.exposeProperty("lineColor","color",this.lineColor,{description:"Grid line color",onChange:e=>{this.lineColor=e}}),this.exposeProperty("lineThickness","number",this.lineThickness,{description:"Line thickness",onChange:e=>{this.lineThickness=Math.max(.1,e)}}),this.exposeProperty("showVertical","boolean",this.showVertical,{description:"Show vertical lines",onChange:e=>{this.showVertical=e}}),this.exposeProperty("showHorizontal","boolean",this.showHorizontal,{description:"Show horizontal lines",onChange:e=>{this.showHorizontal=e}}),this.exposeProperty("glow","boolean",this.glow,{description:"Enable glow effect",onChange:e=>{this.glow=e}}),this.exposeProperty("glowColor","color",this.glowColor,{description:"Glow color",onChange:e=>{this.glowColor=e}}),this.exposeProperty("glowBlur","number",this.glowBlur,{description:"Glow blur amount",onChange:e=>{this.glowBlur=e}}),this.exposeProperty("infinite","boolean",this.infinite,{description:"Enable infinite grid generation",onChange:e=>{this.infinite=e}}),this.exposeProperty("width","number",this.width,{description:"Grid width (when not infinite)",onChange:e=>{this.width=e}}),this.exposeProperty("height","number",this.height,{description:"Grid height (when not infinite)",onChange:e=>{this.height=e}})}style(e){e.startGroup("Grid Position",!1,{backgroundColor:"rgba(200,200,255,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("x","number",this.x,{min:-1e4,max:1e4}),e.exposeProperty("y","number",this.y,{min:-1e4,max:1e4}),e.exposeProperty("infinite","boolean",this.infinite),this.infinite||(e.exposeProperty("width","number",this.width,{min:1,max:1e4}),e.exposeProperty("height","number",this.height,{min:1,max:1e4})),e.endGroup(),e.startGroup("Cells",!1,{backgroundColor:"rgba(150,255,200,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("cellWidth","number",this.cellWidth,{min:1,max:1e3}),e.exposeProperty("cellHeight","number",this.cellHeight,{min:1,max:1e3}),e.endGroup(),e.startGroup("Lines",!1,{backgroundColor:"rgba(200,255,200,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("lineColor","color",this.lineColor),e.exposeProperty("lineThickness","number",this.lineThickness,{min:.1,max:20}),e.exposeProperty("showVertical","boolean",this.showVertical),e.exposeProperty("showHorizontal","boolean",this.showHorizontal),e.endGroup(),e.startGroup("Glow",!1,{backgroundColor:"rgba(0,255,255,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("glow","boolean",this.glow),e.exposeProperty("glowColor","color",this.glowColor),e.exposeProperty("glowBlur","number",this.glowBlur,{min:0,max:50}),e.endGroup()}draw(e){const t=window.engine?.viewport||{x:0,y:0,width:e.canvas.width,height:e.canvas.height};if(this.gameObject.position.x=0,this.gameObject.position.y=0,!this.showVertical&&!this.showHorizontal)return;let i,s,o,n;if(e.save(),e.strokeStyle=this.lineColor,e.lineWidth=this.lineThickness,this.glow&&(e.shadowColor=this.glowColor,e.shadowBlur=this.glowBlur),this.infinite){const e=Math.max(this.cellWidth,this.cellHeight);i=t.x-e,s=t.x+t.width+e,o=t.y-e,n=t.y+t.height+e}else if(i=Math.max(this.x,t.x),s=Math.min(this.x+this.width,t.x+t.width),o=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height),i>=s||o>=n)return void e.restore();if(this.showVertical&&this.cellWidth>0){const t=this.infinite?Math.floor((i-this.x)/this.cellWidth)*this.cellWidth+this.x:this.x,r=this.infinite?s:Math.min(this.x+this.width,s),a=this.infinite?o:Math.max(this.y,o),l=this.infinite?n:Math.min(this.y+this.height,n);for(let s=t;r>=s;s+=this.cellWidth)i>s||(this.infinite||s>=this.x&&s<=this.x+this.width)&&(e.beginPath(),e.moveTo(s,a),e.lineTo(s,l),e.stroke())}if(this.showHorizontal&&this.cellHeight>0){const t=this.infinite?Math.floor((o-this.y)/this.cellHeight)*this.cellHeight+this.y:this.y,r=this.infinite?n:Math.min(this.y+this.height,n),a=this.infinite?i:Math.max(this.x,i),l=this.infinite?s:Math.min(this.x+this.width,s);for(let i=t;r>=i;i+=this.cellHeight)o>i||(this.infinite||i>=this.y&&i<=this.y+this.height)&&(e.beginPath(),e.moveTo(a,i),e.lineTo(l,i),e.stroke())}e.restore()}toJSON(){return{...super.toJSON(),x:this.x,y:this.y,width:this.width,height:this.height,cellWidth:this.cellWidth,cellHeight:this.cellHeight,lineColor:this.lineColor,lineThickness:this.lineThickness,showVertical:this.showVertical,showHorizontal:this.showHorizontal,glow:this.glow,glowColor:this.glowColor,glowBlur:this.glowBlur,infinite:this.infinite}}fromJSON(e){super.fromJSON(e),e&&(this.x=e.x||0,this.y=e.y||0,this.width=e.width||800,this.height=e.height||600,this.cellWidth=e.cellWidth||50,this.cellHeight=e.cellHeight||50,this.lineColor=e.lineColor||"#cccccc",this.lineThickness=e.lineThickness||1,this.showVertical=void 0===e.showVertical||e.showVertical,this.showHorizontal=void 0===e.showHorizontal||e.showHorizontal,this.glow=e.glow||!1,this.glowColor=e.glowColor||"#00ffff",this.glowBlur=e.glowBlur||8,this.infinite=void 0===e.infinite||e.infinite)}}window.DrawGrid=DrawGrid;class DrawHeart extends Module{static namespace="Drawing";static description="Scalable heart shape for health/love indicators";static allowMultiple=!1;static iconClass="fas fa-heart";static iconColor="#a200ffff";constructor(){super("DrawHeart"),this.fillColor="#ff4444",this.outlineColor="#aa0000",this.outlineWidth=2,this.filled=!0,this.outlined=!0,this.useGradient=!1,this.gradientColor1="#ff6b6b",this.gradientColor2="#c44569",this.gradientType="radial",this.gradientAngle=0,this.horizontalScale=1,this.verticalScale=1,this.exposeProperty("fillColor","color",this.fillColor,{description:"Heart fill color (used when gradient is off)",onChange:e=>{this.fillColor=e}}),this.exposeProperty("outlineColor","color",this.outlineColor,{description:"Heart outline color",onChange:e=>{this.outlineColor=e}}),this.exposeProperty("outlineWidth","number",this.outlineWidth,{description:"Outline thickness",onChange:e=>{this.outlineWidth=e}}),this.exposeProperty("filled","boolean",this.filled,{description:"Fill the heart",onChange:e=>{this.filled=e}}),this.exposeProperty("outlined","boolean",this.outlined,{description:"Draw outline",onChange:e=>{this.outlined=e}}),this.exposeProperty("useGradient","boolean",this.useGradient,{description:"Use gradient fill instead of solid color",onChange:e=>{this.useGradient=e}}),this.exposeProperty("gradientColor1","color",this.gradientColor1,{description:"First gradient color",onChange:e=>{this.gradientColor1=e}}),this.exposeProperty("gradientColor2","color",this.gradientColor2,{description:"Second gradient color",onChange:e=>{this.gradientColor2=e}}),this.exposeProperty("gradientType","string",this.gradientType,{description:"Gradient type (linear or radial)",onChange:e=>{this.gradientType=e}}),this.exposeProperty("gradientAngle","number",this.gradientAngle,{description:"Gradient angle in degrees (for linear gradients)",onChange:e=>{this.gradientAngle=e}}),this.exposeProperty("horizontalScale","number",this.horizontalScale,{description:"Independent horizontal scaling",onChange:e=>{this.horizontalScale=e}}),this.exposeProperty("verticalScale","number",this.verticalScale,{description:"Independent vertical scaling",onChange:e=>{this.verticalScale=e}})}style(e){e.startGroup("Heart Appearance",!1,{backgroundColor:"rgba(255,68,68,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("fillColor","color",this.fillColor,{description:"Color of the heart fill (when gradient is off)",style:{label:"Fill Color"}}),e.exposeProperty("outlineColor","color",this.outlineColor,{description:"Color of the heart outline",style:{label:"Outline Color"}}),e.exposeProperty("outlineWidth","number",this.outlineWidth,{description:"Thickness of the outline",min:0,max:20,step:1,style:{label:"Outline Width",slider:!0}}),e.exposeProperty("filled","boolean",this.filled,{description:"Whether to fill the heart with color",style:{label:"Filled"}}),e.exposeProperty("outlined","boolean",this.outlined,{description:"Whether to draw an outline",style:{label:"Outlined"}}),e.endGroup(),e.startGroup("Gradient Options",!1,{backgroundColor:"rgba(196,69,105,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("useGradient","boolean",this.useGradient,{description:"Use gradient fill instead of solid color",style:{label:"Use Gradient"}}),e.exposeProperty("gradientColor1","color",this.gradientColor1,{description:"First gradient color",style:{label:"Gradient Color 1"}}),e.exposeProperty("gradientColor2","color",this.gradientColor2,{description:"Second gradient color",style:{label:"Gradient Color 2"}}),e.exposeProperty("gradientType","select",this.gradientType,{description:"Type of gradient to apply",options:["linear","radial"],style:{label:"Gradient Type"}}),e.exposeProperty("gradientAngle","number",this.gradientAngle,{description:"Angle in degrees for linear gradients",min:0,max:360,step:15,style:{label:"Gradient Angle",slider:!0}}),e.endGroup(),e.startGroup("Scaling",!1,{backgroundColor:"rgba(107,107,255,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("horizontalScale","number",this.horizontalScale,{description:"Independent horizontal scaling factor",min:.1,max:3,step:.1,style:{label:"Horizontal Scale",slider:!0}}),e.exposeProperty("verticalScale","number",this.verticalScale,{description:"Independent vertical scaling factor",min:.1,max:3,step:.1,style:{label:"Vertical Scale",slider:!0}}),e.endGroup(),e.addHelpText("Perfect for health indicators and UI elements. Use gradient for more visual appeal!")}createGradient(e,t){let i;if("radial"===this.gradientType){const s=t.centerX,o=t.centerY,n=Math.max(t.width,t.height)/2;i=e.createRadialGradient(s,o,0,s,o,n)}else{const s=this.gradientAngle*Math.PI/180,o=Math.cos(s),n=Math.sin(s),r=t.centerX-o*t.width/2,a=t.centerY-n*t.height/2,l=t.centerX+o*t.width/2,h=t.centerY+n*t.height/2;i=e.createLinearGradient(r,a,l,h)}return i.addColorStop(0,this.gradientColor1),i.addColorStop(1,this.gradientColor2),i}draw(e){e.save(),e.scale(this.horizontalScale,this.verticalScale),e.beginPath();let t=!0;for(let i=0;100>=i;i++){const s=i/100*2*Math.PI,o=20*Math.pow(Math.sin(s),3),n=-20*(13*Math.cos(s)-5*Math.cos(2*s)-2*Math.cos(3*s)-Math.cos(4*s))/16;t?(e.moveTo(o,n),t=!1):e.lineTo(o,n)}if(e.closePath(),this.filled){if(this.useGradient){const t={centerX:0,centerY:-10,width:50,height:40};e.fillStyle=this.createGradient(e,t)}else e.fillStyle=this.fillColor;e.fill()}this.outlined&&this.outlineWidth>0&&(e.strokeStyle=this.outlineColor,e.lineWidth=this.outlineWidth,e.stroke()),e.restore()}toJSON(){return{...super.toJSON(),fillColor:this.fillColor,outlineColor:this.outlineColor,outlineWidth:this.outlineWidth,filled:this.filled,outlined:this.outlined,useGradient:this.useGradient,gradientColor1:this.gradientColor1,gradientColor2:this.gradientColor2,gradientType:this.gradientType,gradientAngle:this.gradientAngle,horizontalScale:this.horizontalScale,verticalScale:this.verticalScale}}fromJSON(e){super.fromJSON(e),e&&(this.fillColor=e.fillColor||"#ff4444",this.outlineColor=e.outlineColor||"#aa0000",this.outlineWidth=e.outlineWidth||2,this.filled=void 0===e.filled||e.filled,this.outlined=void 0===e.outlined||e.outlined,this.useGradient=void 0!==e.useGradient&&e.useGradient,this.gradientColor1=e.gradientColor1||"#ff6b6b",this.gradientColor2=e.gradientColor2||"#c44569",this.gradientType=e.gradientType||"radial",this.gradientAngle=void 0!==e.gradientAngle?e.gradientAngle:0,this.horizontalScale=void 0!==e.horizontalScale?e.horizontalScale:1,this.verticalScale=void 0!==e.verticalScale?e.verticalScale:1)}}window.DrawHeart=DrawHeart;class DrawIcon extends Module{static namespace="Drawing";static description="Draws a Font Awesome icon at the GameObject's position";static allowMultiple=!1;static iconClass="fas fa-icons";static iconColor="#a200ffff";constructor(){super("IconDrawModule"),this.icon="fas fa-star",this.size=48,this.color="#FFD700",this.opacity=1,this.exposeProperty("icon","string",this.icon,{description:"Font Awesome icon class (e.g. 'fas fa-star')",onChange:e=>{this.icon=e}}),this.exposeProperty("size","number",this.size,{description:"Icon size in pixels",min:8,max:256,step:1,onChange:e=>{this.size=e}}),this.exposeProperty("color","color",this.color,{description:"Icon color",onChange:e=>{this.color=e}}),this.exposeProperty("opacity","number",this.opacity,{description:"Icon opacity",min:0,max:1,step:.01,onChange:e=>{this.opacity=e}}),this._iconElem=document.createElement("i"),this._iconElem.style.position="absolute",this._iconElem.style.visibility="hidden",document.body.appendChild(this._iconElem)}style(e){e.startGroup("Icon Settings",!1,{backgroundColor:"rgba(255,215,0,0.08)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("icon","string",this.icon,{label:"Icon Class",description:"Font Awesome icon class"}),e.exposeProperty("size","number",this.size,{label:"Size (px)",min:8,max:256,step:1}),e.exposeProperty("color","color",this.color,{label:"Color"}),e.exposeProperty("opacity","number",this.opacity,{label:"Opacity",min:0,max:1,step:.01}),e.endGroup(),e.addDivider(),e.addHelpText("Use any Font Awesome icon class, e.g. 'fas fa-star'. See <a href='https://fontawesome.com/icons' target='_blank'>Font Awesome Icons</a>.")}draw(e){this._iconElem.className=this.icon,this._iconElem.style.fontSize=this.size+"px",this._iconElem.style.color=this.color,this._iconElem.style.opacity=this.opacity;const t="http://www.w3.org/2000/svg",i=document.createElementNS(t,"svg");i.setAttribute("width",this.size),i.setAttribute("height",this.size);const s=document.createElementNS(t,"foreignObject");s.setAttribute("width","100%"),s.setAttribute("height","100%"),s.appendChild(this._iconElem.cloneNode(!0)),i.appendChild(s);const o=new window.Image,n=(new XMLSerializer).serializeToString(i);o.src="data:image/svg+xml;base64,"+btoa(n),this.gameObject.position,o.onload=()=>{e.save(),e.globalAlpha=this.opacity,e.drawImage(o,-this.size/2,-this.size/2,this.size,this.size),e.restore()}}toJSON(){return{...super.toJSON(),icon:this.icon,size:this.size,color:this.color,opacity:this.opacity}}fromJSON(e){super.fromJSON(e),e&&(this.icon=e.icon||"fas fa-star",this.size=e.size||48,this.color=e.color||"#FFD700",this.opacity=e.opacity??1)}}window.DrawIcon=DrawIcon;class DrawLine extends Module{static namespace="Drawing";static description="Draws a customizable line with color, thickness, and glow";static allowMultiple=!0;static iconClass="fas fa-minus";static iconColor="#a200ffff";constructor(){super("DrawLine"),this.x1=0,this.y1=0,this.x2=100,this.y2=0,this.color="#ffffff",this.thickness=2,this.glow=!1,this.glowColor="#00ffff",this.glowBlur=10,this.exposeProperty("x1","number",this.x1,{description:"Start X position",onChange:e=>{this.x1=e}}),this.exposeProperty("y1","number",this.y1,{description:"Start Y position",onChange:e=>{this.y1=e}}),this.exposeProperty("x2","number",this.x2,{description:"End X position",onChange:e=>{this.x2=e}}),this.exposeProperty("y2","number",this.y2,{description:"End Y position",onChange:e=>{this.y2=e}}),this.exposeProperty("color","color",this.color,{description:"Line color",onChange:e=>{this.color=e}}),this.exposeProperty("thickness","number",this.thickness,{description:"Line thickness",onChange:e=>{this.thickness=e}}),this.exposeProperty("glow","boolean",this.glow,{description:"Enable glow effect",onChange:e=>{this.glow=e}}),this.exposeProperty("glowColor","color",this.glowColor,{description:"Glow color",onChange:e=>{this.glowColor=e}}),this.exposeProperty("glowBlur","number",this.glowBlur,{description:"Glow blur amount",onChange:e=>{this.glowBlur=e}})}style(e){e.startGroup("Line",!1,{backgroundColor:"rgba(100,255,255,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("x1","number",this.x1,{min:-1e3,max:1e3}),e.exposeProperty("y1","number",this.y1,{min:-1e3,max:1e3}),e.exposeProperty("x2","number",this.x2,{min:-1e3,max:1e3}),e.exposeProperty("y2","number",this.y2,{min:-1e3,max:1e3}),e.exposeProperty("color","color",this.color),e.exposeProperty("thickness","number",this.thickness,{min:1,max:50}),e.endGroup(),e.startGroup("Glow",!1,{backgroundColor:"rgba(0,255,255,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("glow","boolean",this.glow),e.exposeProperty("glowColor","color",this.glowColor),e.exposeProperty("glowBlur","number",this.glowBlur,{min:0,max:50}),e.endGroup()}draw(e){e.save(),e.strokeStyle=this.color,e.lineWidth=this.thickness,this.glow&&(e.shadowColor=this.glowColor,e.shadowBlur=this.glowBlur),e.beginPath(),e.moveTo(this.x1,this.y1),e.lineTo(this.x2,this.y2),e.stroke(),e.restore()}toJSON(){return{...super.toJSON(),x1:this.x1,y1:this.y1,x2:this.x2,y2:this.y2,color:this.color,thickness:this.thickness,glow:this.glow,glowColor:this.glowColor,glowBlur:this.glowBlur}}fromJSON(e){super.fromJSON(e),e&&(this.x1=e.x1||0,this.y1=e.y1||0,this.x2=e.x2||100,this.y2=e.y2||0,this.color=e.color||"#ffffff",this.thickness=e.thickness||2,this.glow=e.glow||!1,this.glowColor=e.glowColor||"#00ffff",this.glowBlur=e.glowBlur||10)}}window.DrawLine=DrawLine;class DrawPolygon extends Module{static namespace="Drawing";static description="Draws a filled polygon at the GameObject's position";static iconColor="#a200ffff";constructor(){super("DrawPolygon"),this.vertices=[new Vector2(0,-50),new Vector2(50,50),new Vector2(-50,50)],this.offset=new Vector2(0,0),this.color="#ffffff",this.fill=!0,this.outline=!1,this.outlineColor="#000000",this.outlineWidth=2,this.exposeProperty("vertices","polygon",this.vertices,{description:"Array of Vector2 points (min 3)",minItems:3,onChange:e=>{this.vertices=e,this.gameObject&&this._onVerticesChanged()}}),this.exposeProperty("offset","vector2",this.offset,{description:"Offset from center",onChange:e=>this.offset=e}),this.exposeProperty("color","color",this.color,{description:"Fill color",onChange:e=>this.color=e}),this.exposeProperty("fill","boolean",this.fill,{description:"Fill polygon",onChange:e=>this.fill=e}),this.exposeProperty("outline","boolean",this.outline,{description:"Show outline",onChange:e=>this.outline=e}),this.exposeProperty("outlineColor","color",this.outlineColor,{description:"Stroke color",onChange:e=>this.outlineColor=e}),this.exposeProperty("outlineWidth","number",this.outlineWidth,{description:"Outline thickness",min:0,max:20,step:.5,onChange:e=>this.outlineWidth=e})}getBoundingBox(){if(!this.vertices||3>this.vertices.length)return null;let e=1/0,t=1/0,i=-1/0,s=-1/0;for(const o of this.vertices)e=Math.min(e,o.x),t=Math.min(t,o.y),i=Math.max(i,o.x),s=Math.max(s,o.y);return{x:e,y:t,width:i-e,height:s-t}}_onVerticesChanged(){if(this.gameObject)try{const e=this.gameObject.getModule("RigidBody")||(void 0!==RigidBody?this.gameObject.getModule(RigidBody):null);e&&(e.vertices=this.vertices.slice(),e.rebuildBody())}catch(e){console.warn("Error syncing polygon vertices with RigidBody:",e)}}draw(e){if(this.enabled&&this.vertices.length>=3){if(e.save(),e.translate(this.offset.x,this.offset.y),this.fill){e.fillStyle=this.color,e.beginPath(),e.moveTo(this.vertices[0].x,this.vertices[0].y);for(let t=1;t<this.vertices.length;t++)e.lineTo(this.vertices[t].x,this.vertices[t].y);e.closePath(),e.fill()}if(this.outline){e.strokeStyle=this.outlineColor,e.lineWidth=this.outlineWidth,e.beginPath(),e.moveTo(this.vertices[0].x,this.vertices[0].y);for(let t=1;t<this.vertices.length;t++)e.lineTo(this.vertices[t].x,this.vertices[t].y);e.closePath(),e.stroke()}e.restore()}}onAttach(){this.vertices&&this.vertices.length>=3&&this._onVerticesChanged()}toJSON(){const e=super.toJSON();return this.vertices&&Array.isArray(this.vertices)&&(e.vertices=this.vertices.map(e=>({x:e.x||0,y:e.y||0}))),this.offset&&(e.offset={x:this.offset.x||0,y:this.offset.y||0}),e}fromJSON(e){if(super.fromJSON(e),e.vertices&&Array.isArray(e.vertices))try{this.vertices=e.vertices.map(e=>new Vector2(e.x||0,e.y||0))}catch(e){console.warn("Error reconstructing polygon vertices:",e),this.vertices=[new Vector2(0,-50),new Vector2(50,50),new Vector2(-50,50)]}if(e.offset&&"object"==typeof e.offset)try{this.offset=new Vector2(e.offset.x||0,e.offset.y||0)}catch(e){console.warn("Error reconstructing polygon offset:",e),this.offset=new Vector2(0,0)}return this}setVertex(e,t){if(!this.vertices||0>e||e>=this.vertices.length)return void console.warn("Vertex index out of bounds: "+e);const i=t instanceof Vector2?t:new Vector2(t.x||0,t.y||0);this.vertices[e]=i,this.gameObject&&this._onVerticesChanged()}addVertex(e,t){this.vertices||(this.vertices=[]);const i=e instanceof Vector2?e:new Vector2(e.x||0,e.y||0);void 0!==t?this.vertices.splice(t,0,i):this.vertices.push(i),this.gameObject&&this._onVerticesChanged()}removeVertex(e){this.vertices&&e>=0&&e<this.vertices.length?this.vertices.length>3?(this.vertices.splice(e,1),this.gameObject&&this._onVerticesChanged()):console.warn("Cannot remove vertex: polygon must have at least 3 vertices"):console.warn("Vertex index out of bounds: "+e)}toJSON(){const e=super.toJSON();return e.vertices=this.vertices.map(e=>e.toJSON()),e.offset=this.offset.toJSON(),e.color=this.color,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e}fromJSON(e){return super.fromJSON(e),this.vertices=e.vertices.map(e=>Vector2.fromJSON(e)),this.offset=Vector2.fromJSON(e.offset)||new Vector2(0,0),this.color=e.color||"#ffffff",this.fill=void 0===e.fill||e.fill,this.outline=void 0!==e.outline&&e.outline,this.outlineColor=e.outlineColor||"#000000",this.outlineWidth=e.outlineWidth||2,this.gameObject&&this._onVerticesChanged(),this}}window.DrawPolygon=DrawPolygon;class DrawRectangle extends Module{static namespace="Drawing";static description="Draws a filled rectangle at the GameObject's position";static iconColor="#a200ffff";constructor(){super("DrawRectangle"),this.width=50,this.height=50,this.offset=new Vector2(0,0),this.color="#ffffff",this.fill=!0,this.outline=!1,this.outlineColor="#000000",this.outlineWidth=2,this.exposeProperty("width","number",this.width,{min:0,description:"Rectangle width",onChange:e=>this.width=e}),this.exposeProperty("height","number",this.height,{min:0,description:"Rectangle height",onChange:e=>this.height=e}),this.exposeProperty("offset","vector2",this.offset,{description:"Offset from center",onChange:e=>this.offset=e}),this.exposeProperty("color","color",this.color,{description:"Fill color",onChange:e=>this.color=e}),this.exposeProperty("fill","boolean",this.fill,{description:"Fill rectangle",onChange:e=>this.fill=e}),this.exposeProperty("outline","boolean",this.outline,{description:"Show outline",onChange:e=>this.outline=e}),this.exposeProperty("outlineColor","color",this.outlineColor,{description:"Outline color",onChange:e=>this.outlineColor=e}),this.exposeProperty("outlineWidth","number",this.outlineWidth,{description:"Outline thickness",min:0,max:20,step:.5,onChange:e=>this.outlineWidth=e})}getBoundingBox(){return this.gameObject?{x:this.gameObject.position.x+this.offset.x-this.width/2,y:this.gameObject.position.y+this.offset.y-this.height/2,width:this.width,height:this.height}:null}draw(e){this.enabled&&(e.save(),e.translate(this.offset.x,this.offset.y),e.beginPath(),e.rect(-this.width/2,-this.height/2,this.width,this.height),this.fill&&(e.fillStyle=this.color,e.fill()),this.outline&&(e.strokeStyle=this.outlineColor,e.lineWidth=this.outlineWidth,e.stroke()),e.restore())}toJSON(){return{...super.toJSON(),width:this.width,height:this.height,offset:{x:this.offset.x,y:this.offset.y},color:this.color,fill:this.fill,outline:this.outline,outlineColor:this.outlineColor,outlineWidth:this.outlineWidth}}fromJSON(e){super.fromJSON(e),void 0!==e.width&&(this.width=e.width),void 0!==e.height&&(this.height=e.height),e.offset&&(this.offset=e.offset),void 0!==e.color&&(this.color=e.color),void 0!==e.fill&&(this.fill=e.fill),void 0!==e.outline&&(this.outline=e.outline),void 0!==e.outlineColor&&(this.outlineColor=e.outlineColor),void 0!==e.outlineWidth&&(this.outlineWidth=e.outlineWidth)}}window.DrawRectangle=DrawRectangle;class DrawShield extends Module{static namespace="Drawing";static description="Classic shield shape for defense/protection icons";static allowMultiple=!1;static iconClass="fas fa-shield-alt";static iconColor="#a200ffff";constructor(){super("DrawShield"),this.fillColor="#4488ff",this.outlineColor="#2266cc",this.outlineWidth=3,this.filled=!0,this.outlined=!0,this.gloss=!0,this.topPoints=3,this.exposeProperty("fillColor","color",this.fillColor,{description:"Shield fill color",onChange:e=>{this.fillColor=e}}),this.exposeProperty("outlineColor","color",this.outlineColor,{description:"Shield outline color",onChange:e=>{this.outlineColor=e}}),this.exposeProperty("outlineWidth","number",this.outlineWidth,{description:"Outline thickness",onChange:e=>{this.outlineWidth=e}}),this.exposeProperty("filled","boolean",this.filled,{description:"Fill the shield",onChange:e=>{this.filled=e}}),this.exposeProperty("outlined","boolean",this.outlined,{description:"Draw outline",onChange:e=>{this.outlined=e}}),this.exposeProperty("gloss","boolean",this.gloss,{description:"Add glossy effect",onChange:e=>{this.gloss=e}}),this.exposeProperty("topPoints","number",this.topPoints,{description:"Number of curved points at the top",onChange:e=>{this.topPoints=Math.max(1,Math.min(7,Math.round(e)))}})}style(e){e.startGroup("Shield Appearance",!1,{backgroundColor:"rgba(68,136,255,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("fillColor","color",this.fillColor,{style:{label:"Fill Color"}}),e.exposeProperty("outlineColor","color",this.outlineColor,{style:{label:"Outline Color"}}),e.exposeProperty("outlineWidth","number",this.outlineWidth,{min:0,max:20,step:1,style:{label:"Outline Width",slider:!0}}),e.exposeProperty("filled","boolean",this.filled,{style:{label:"Filled"}}),e.exposeProperty("outlined","boolean",this.outlined,{style:{label:"Outlined"}}),e.exposeProperty("gloss","boolean",this.gloss,{style:{label:"Glossy Effect"}}),e.exposeProperty("topPoints","number",this.topPoints,{min:1,max:7,step:1,style:{label:"Top Points",slider:!0}}),e.endGroup(),e.addHelpText("Perfect for armor, defense, and protection indicators. Adjust top points for different shield styles.")}draw(e){e.save();const t=-35;e.beginPath();const i=50/this.topPoints;e.moveTo(-25,t);for(let s=0;s<this.topPoints;s++){const o=(s+1)*i-25,n=(s*i-25+o)/2;e.quadraticCurveTo(n,-27,o,t)}if(e.bezierCurveTo(25,t,25,-10,25,10),e.bezierCurveTo(25,25,15,30,0,35),e.bezierCurveTo(-15,30,-25,25,-25,10),e.bezierCurveTo(-25,-10,-25,t,-25,t),e.closePath(),this.filled&&(e.fillStyle=this.fillColor,e.fill(),this.gloss)){const t=e.createLinearGradient(-20,-30,20,10);t.addColorStop(0,"rgba(255,255,255,0.4)"),t.addColorStop(.5,"rgba(255,255,255,0.1)"),t.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=t,e.fill()}this.outlined&&this.outlineWidth>0&&(e.strokeStyle=this.outlineColor,e.lineWidth=this.outlineWidth,e.stroke()),e.restore()}toJSON(){return{...super.toJSON(),fillColor:this.fillColor,outlineColor:this.outlineColor,outlineWidth:this.outlineWidth,filled:this.filled,outlined:this.outlined,gloss:this.gloss,topPoints:this.topPoints}}fromJSON(e){super.fromJSON(e),e&&(this.fillColor=e.fillColor||"#4488ff",this.outlineColor=e.outlineColor||"#2266cc",this.outlineWidth=e.outlineWidth||3,this.filled=void 0===e.filled||e.filled,this.outlined=void 0===e.outlined||e.outlined,this.gloss=void 0===e.gloss||e.gloss,this.topPoints=e.topPoints||3)}}window.DrawShield=DrawShield;class DrawStar extends Module{static namespace="Drawing";static description="Scalable star shape for ratings and pickups";static allowMultiple=!1;static iconClass="fas fa-star";static iconColor="#a200ffff";constructor(){super("DrawStar"),this.fillColor="#ffdd00",this.outlineColor="#cc8800",this.outlineWidth=2,this.filled=!0,this.outlined=!0,this.points=5,this.innerRadius=.4,this.exposeProperty("fillColor","color",this.fillColor,{description:"Star fill color",onChange:e=>{this.fillColor=e}}),this.exposeProperty("outlineColor","color",this.outlineColor,{description:"Star outline color",onChange:e=>{this.outlineColor=e}}),this.exposeProperty("outlineWidth","number",this.outlineWidth,{description:"Outline thickness",onChange:e=>{this.outlineWidth=e}}),this.exposeProperty("filled","boolean",this.filled,{description:"Fill the star",onChange:e=>{this.filled=e}}),this.exposeProperty("outlined","boolean",this.outlined,{description:"Draw outline",onChange:e=>{this.outlined=e}}),this.exposeProperty("points","number",this.points,{description:"Number of points",onChange:e=>{this.points=Math.max(3,Math.floor(e))}}),this.exposeProperty("innerRadius","number",this.innerRadius,{description:"Inner radius ratio",onChange:e=>{this.innerRadius=Math.max(.1,Math.min(.9,e))}})}style(e){e.startGroup("Star Shape",!1,{backgroundColor:"rgba(255,221,0,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("points","number",this.points,{description:"Number of star points",min:3,max:12,step:1,style:{label:"Points",slider:!0}}),e.exposeProperty("innerRadius","number",this.innerRadius,{description:"Inner radius as ratio of outer radius",min:.1,max:.9,step:.05,style:{label:"Inner Radius",slider:!0}}),e.endGroup(),e.startGroup("Star Appearance",!1,{backgroundColor:"rgba(255,221,0,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("fillColor","color",this.fillColor,{style:{label:"Fill Color"}}),e.exposeProperty("outlineColor","color",this.outlineColor,{style:{label:"Outline Color"}}),e.exposeProperty("outlineWidth","number",this.outlineWidth,{min:0,max:20,step:1,style:{label:"Outline Width",slider:!0}}),e.exposeProperty("filled","boolean",this.filled,{style:{label:"Filled"}}),e.exposeProperty("outlined","boolean",this.outlined,{style:{label:"Outlined"}}),e.endGroup(),e.addHelpText("Great for collectibles, ratings, and decorative elements")}draw(e){this.gameObject.getWorldPosition(),this.gameObject.scale,e.save();const t=30*this.innerRadius,i=2*Math.PI/this.points;e.beginPath();for(let s=0;s<2*this.points;s++){const o=s*(i/2)-Math.PI/2,n=s%2==0?30:t,r=Math.cos(o)*n,a=Math.sin(o)*n;0===s?e.moveTo(r,a):e.lineTo(r,a)}e.closePath(),this.filled&&(e.fillStyle=this.fillColor,e.fill()),this.outlined&&this.outlineWidth>0&&(e.strokeStyle=this.outlineColor,e.lineWidth=this.outlineWidth,e.stroke()),e.restore()}toJSON(){return{...super.toJSON(),fillColor:this.fillColor,outlineColor:this.outlineColor,outlineWidth:this.outlineWidth,filled:this.filled,outlined:this.outlined,points:this.points,innerRadius:this.innerRadius}}fromJSON(e){super.fromJSON(e),e&&(this.fillColor=e.fillColor||"#ffdd00",this.outlineColor=e.outlineColor||"#cc8800",this.outlineWidth=e.outlineWidth||2,this.filled=void 0===e.filled||e.filled,this.outlined=void 0===e.outlined||e.outlined,this.points=e.points||5,this.innerRadius=e.innerRadius||.4)}}window.DrawStar=DrawStar;class DrawText extends Module{static namespace="Drawing";static description="Draws customizable text with shadows, outlines, gradients and effects";static allowMultiple=!0;static iconClass="fas fa-font";static iconColor="#a200ffff";constructor(){super("DrawText"),this.text="Hello World",this.fontSize=32,this.fontFamily="Arial",this.fontWeight="normal",this.fontStyle="normal",this.fillColor="#ffffff",this.useGradient=!1,this.gradientStartColor="#ff0000",this.gradientEndColor="#0000ff",this.gradientAngle=0,this.hasOutline=!1,this.outlineColor="#000000",this.outlineWidth=2,this.hasShadow=!1,this.shadowColor="#000000",this.shadowOffsetX=2,this.shadowOffsetY=2,this.shadowBlur=4,this.textAlign="center",this.textBaseline="middle",this.lineHeight=1.2,this.letterSpacing=0,this.wordSpacing=0,this.opacity=1,this.rotation=0,this.skewX=0,this.skewY=0,this.scaleX=1,this.scaleY=1,this.wave=!1,this.waveAmplitude=5,this.waveFrequency=2,this.waveSpeed=2,this.rainbow=!1,this.rainbowSpeed=1,this.maxWidth=0,this.wordWrap=!0,this.hasBackground=!1,this.backgroundColor="#000000",this.backgroundPadding=10,this.backgroundRadius=0,this.time=0,this.exposeAllProperties()}exposeAllProperties(){this.exposeProperty("text","string",this.text,{description:"Text content to display",onChange:e=>{this.text=e}}),this.exposeProperty("fontSize","number",this.fontSize,{description:"Font size in pixels",onChange:e=>{this.fontSize=e}}),this.exposeProperty("fontFamily","select",this.fontFamily,{description:"Font family",options:["Arial","Helvetica","Times New Roman","Courier New","Georgia","Verdana","Comic Sans MS","Impact","Trebuchet MS"],onChange:e=>{this.fontFamily=e}}),this.exposeProperty("fontWeight","enum",this.fontWeight,{description:"Font weight",options:["normal","bold","lighter","bolder","100","200","300","400","500","600","700","800","900"],onChange:e=>{this.fontWeight=e}}),this.exposeProperty("fontStyle","enum",this.fontStyle,{description:"Font style",options:["normal","italic","oblique"],onChange:e=>{this.fontStyle=e}}),this.exposeProperty("fillColor","color",this.fillColor,{description:"Text fill color",onChange:e=>{this.fillColor=e}}),this.exposeProperty("useGradient","boolean",this.useGradient,{description:"Use gradient fill instead of solid color",onChange:e=>{this.useGradient=e}}),this.exposeProperty("gradientStartColor","color",this.gradientStartColor,{description:"Gradient start color",onChange:e=>{this.gradientStartColor=e}}),this.exposeProperty("gradientEndColor","color",this.gradientEndColor,{description:"Gradient end color",onChange:e=>{this.gradientEndColor=e}}),this.exposeProperty("gradientAngle","number",this.gradientAngle,{description:"Gradient angle in degrees",onChange:e=>{this.gradientAngle=e}}),this.exposeProperty("hasOutline","boolean",this.hasOutline,{description:"Enable text outline",onChange:e=>{this.hasOutline=e}}),this.exposeProperty("outlineColor","color",this.outlineColor,{description:"Outline color",onChange:e=>{this.outlineColor=e}}),this.exposeProperty("outlineWidth","number",this.outlineWidth,{description:"Outline width in pixels",onChange:e=>{this.outlineWidth=e}}),this.exposeProperty("hasShadow","boolean",this.hasShadow,{description:"Enable text shadow",onChange:e=>{this.hasShadow=e}}),this.exposeProperty("shadowColor","color",this.shadowColor,{description:"Shadow color",onChange:e=>{this.shadowColor=e}}),this.exposeProperty("shadowOffsetX","number",this.shadowOffsetX,{description:"Shadow horizontal offset",onChange:e=>{this.shadowOffsetX=e}}),this.exposeProperty("shadowOffsetY","number",this.shadowOffsetY,{description:"Shadow vertical offset",onChange:e=>{this.shadowOffsetY=e}}),this.exposeProperty("shadowBlur","number",this.shadowBlur,{description:"Shadow blur radius",onChange:e=>{this.shadowBlur=e}}),this.exposeProperty("textAlign","enum",this.textAlign,{description:"Text horizontal alignment",options:["left","center","right","start","end"],onChange:e=>{this.textAlign=e}}),this.exposeProperty("textBaseline","enum",this.textBaseline,{description:"Text vertical alignment",options:["top","hanging","middle","alphabetic","ideographic","bottom"],onChange:e=>{this.textBaseline=e}}),this.exposeProperty("lineHeight","number",this.lineHeight,{description:"Line height multiplier for multi-line text",onChange:e=>{this.lineHeight=e}}),this.exposeProperty("letterSpacing","number",this.letterSpacing,{description:"Letter spacing in pixels",onChange:e=>{this.letterSpacing=e}}),this.exposeProperty("opacity","number",this.opacity,{description:"Text opacity (0-1)",onChange:e=>{this.opacity=e}}),this.exposeProperty("rotation","number",this.rotation,{description:"Text rotation in degrees",onChange:e=>{this.rotation=e}}),this.exposeProperty("skewX","number",this.skewX,{description:"Horizontal skew in degrees",onChange:e=>{this.skewX=e}}),this.exposeProperty("skewY","number",this.skewY,{description:"Vertical skew in degrees",onChange:e=>{this.skewY=e}}),this.exposeProperty("scaleX","number",this.scaleX,{description:"Horizontal scale multiplier",onChange:e=>{this.scaleX=e}}),this.exposeProperty("scaleY","number",this.scaleY,{description:"Vertical scale multiplier",onChange:e=>{this.scaleY=e}}),this.exposeProperty("wave","boolean",this.wave,{description:"Enable wave animation effect",onChange:e=>{this.wave=e}}),this.exposeProperty("waveAmplitude","number",this.waveAmplitude,{description:"Wave effect amplitude",onChange:e=>{this.waveAmplitude=e}}),this.exposeProperty("waveFrequency","number",this.waveFrequency,{description:"Wave effect frequency",onChange:e=>{this.waveFrequency=e}}),this.exposeProperty("waveSpeed","number",this.waveSpeed,{description:"Wave animation speed",onChange:e=>{this.waveSpeed=e}}),this.exposeProperty("rainbow","boolean",this.rainbow,{description:"Enable rainbow color animation",onChange:e=>{this.rainbow=e}}),this.exposeProperty("rainbowSpeed","number",this.rainbowSpeed,{description:"Rainbow animation speed",onChange:e=>{this.rainbowSpeed=e}}),this.exposeProperty("maxWidth","number",this.maxWidth,{description:"Maximum width for text wrapping (0 = no wrapping)",onChange:e=>{this.maxWidth=e}}),this.exposeProperty("wordWrap","boolean",this.wordWrap,{description:"Enable word wrapping",onChange:e=>{this.wordWrap=e}}),this.exposeProperty("hasBackground","boolean",this.hasBackground,{description:"Enable text background",onChange:e=>{this.hasBackground=e}}),this.exposeProperty("backgroundColor","color",this.backgroundColor,{description:"Background color",onChange:e=>{this.backgroundColor=e}}),this.exposeProperty("backgroundPadding","number",this.backgroundPadding,{description:"Background padding in pixels",onChange:e=>{this.backgroundPadding=e}}),this.exposeProperty("backgroundRadius","number",this.backgroundRadius,{description:"Background border radius",onChange:e=>{this.backgroundRadius=e}})}style(e){e.startGroup("Text Content",!1,{backgroundColor:"rgba(100,150,255,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("text","string",this.text),e.endGroup(),e.startGroup("Font Properties",!1,{backgroundColor:"rgba(150,100,255,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("fontSize","number",this.fontSize,{min:1,max:200}),e.exposeProperty("fontFamily","enum",this.fontFamily,{options:["Arial","Helvetica","Times New Roman","Courier New","Georgia","Verdana","Comic Sans MS","Impact","Trebuchet MS"]}),e.exposeProperty("fontWeight","enum",this.fontWeight,{options:["normal","bold","lighter","bolder","100","200","300","400","500","600","700","800","900"]}),e.exposeProperty("fontStyle","enum",this.fontStyle,{options:["normal","italic","oblique"]}),e.endGroup(),e.startGroup("Colors & Fill",!1,{backgroundColor:"rgba(255,150,100,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("fillColor","color",this.fillColor),e.exposeProperty("useGradient","boolean",this.useGradient),e.exposeProperty("gradientStartColor","color",this.gradientStartColor),e.exposeProperty("gradientEndColor","color",this.gradientEndColor),e.exposeProperty("gradientAngle","number",this.gradientAngle,{min:0,max:360}),e.exposeProperty("rainbow","boolean",this.rainbow),e.exposeProperty("rainbowSpeed","number",this.rainbowSpeed,{min:.1,max:5}),e.endGroup(),e.startGroup("Outline",!1,{backgroundColor:"rgba(255,100,150,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("hasOutline","boolean",this.hasOutline),e.exposeProperty("outlineColor","color",this.outlineColor),e.exposeProperty("outlineWidth","number",this.outlineWidth,{min:0,max:20}),e.endGroup(),e.startGroup("Shadow",!1,{backgroundColor:"rgba(100,255,150,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("hasShadow","boolean",this.hasShadow),e.exposeProperty("shadowColor","color",this.shadowColor),e.exposeProperty("shadowOffsetX","number",this.shadowOffsetX,{min:-50,max:50}),e.exposeProperty("shadowOffsetY","number",this.shadowOffsetY,{min:-50,max:50}),e.exposeProperty("shadowBlur","number",this.shadowBlur,{min:0,max:50}),e.endGroup(),e.startGroup("Alignment & Spacing",!1,{backgroundColor:"rgba(150,255,100,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("textAlign","enum",this.textAlign,{options:["left","center","right","start","end"]}),e.exposeProperty("textBaseline","enum",this.textBaseline,{options:["top","hanging","middle","alphabetic","ideographic","bottom"]}),e.exposeProperty("lineHeight","number",this.lineHeight,{min:.5,max:3,step:.1}),e.exposeProperty("letterSpacing","number",this.letterSpacing,{min:-10,max:20}),e.endGroup(),e.startGroup("Transform Effects",!1,{backgroundColor:"rgba(255,255,100,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("opacity","number",this.opacity,{min:0,max:1,step:.01}),e.exposeProperty("rotation","number",this.rotation,{min:-180,max:180}),e.exposeProperty("skewX","number",this.skewX,{min:-45,max:45}),e.exposeProperty("skewY","number",this.skewY,{min:-45,max:45}),e.exposeProperty("scaleX","number",this.scaleX,{min:.1,max:3,step:.1}),e.exposeProperty("scaleY","number",this.scaleY,{min:.1,max:3,step:.1}),e.endGroup(),e.startGroup("Animation Effects",!1,{backgroundColor:"rgba(100,255,255,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("wave","boolean",this.wave),e.exposeProperty("waveAmplitude","number",this.waveAmplitude,{min:0,max:50}),e.exposeProperty("waveFrequency","number",this.waveFrequency,{min:.1,max:10}),e.exposeProperty("waveSpeed","number",this.waveSpeed,{min:.1,max:10}),e.endGroup(),e.startGroup("Text Wrapping",!1,{backgroundColor:"rgba(255,100,255,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("maxWidth","number",this.maxWidth,{min:0,max:2e3}),e.exposeProperty("wordWrap","boolean",this.wordWrap),e.endGroup(),e.startGroup("Background",!1,{backgroundColor:"rgba(200,200,200,0.1)",borderRadius:"6px",padding:"8px"}),e.exposeProperty("hasBackground","boolean",this.hasBackground),e.exposeProperty("backgroundColor","color",this.backgroundColor),e.exposeProperty("backgroundPadding","number",this.backgroundPadding,{min:0,max:50}),e.exposeProperty("backgroundRadius","number",this.backgroundRadius,{min:0,max:50}),e.endGroup()}loop(e){this.time+=e}draw(e){if(e.save(),e.globalAlpha=this.opacity,0!==this.rotation||0!==this.skewX||0!==this.skewY||1!==this.scaleX||1!==this.scaleY){const t=this.rotation*Math.PI/180,i=this.skewX*Math.PI/180,s=this.skewY*Math.PI/180;e.transform(this.scaleX*Math.cos(t),this.scaleX*Math.sin(t)+Math.tan(s),-this.scaleY*Math.sin(t)+Math.tan(i),this.scaleY*Math.cos(t),0,0)}e.font=`${this.fontStyle} ${this.fontWeight} ${this.fontSize}px ${this.fontFamily}`,e.textAlign=this.textAlign,e.textBaseline=this.textBaseline;const t=this.getWrappedText(e,this.text);let i=0,s=t.length*this.fontSize*this.lineHeight;if(this.maxWidth>0)i=this.maxWidth;else for(let s of t){const t=e.measureText(s).width;t>i&&(i=t)}if(this.hasBackground){e.save(),e.fillStyle=this.backgroundColor;let t=-i/2-this.backgroundPadding,o=-s/2-this.backgroundPadding,n=i+2*this.backgroundPadding,r=s+2*this.backgroundPadding;"left"===this.textAlign&&(t=-this.backgroundPadding),"right"===this.textAlign&&(t=-i-this.backgroundPadding),this.backgroundRadius>0?(this.roundRect(e,t,o,n,r,this.backgroundRadius),e.fill()):e.fillRect(t,o,n,r),e.restore()}this.hasShadow&&(e.shadowColor=this.shadowColor,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY,e.shadowBlur=this.shadowBlur);for(let i=0;i<t.length;i++){const s=t[i],o=(i-(t.length-1)/2)*this.fontSize*this.lineHeight;this.wave?this.drawWaveText(e,s,0,o):this.drawStyledText(e,s,0,o)}e.restore()}getWrappedText(e,t){if(0>=this.maxWidth||!this.wordWrap)return t.split("\n");const i=t.split(" "),s=[];let o="";for(let t of i){const i=o+(o?" ":"")+t;e.measureText(i).width>this.maxWidth&&""!==o?(s.push(o),o=t):o=i}return o&&s.push(o),s}drawWaveText(e,t,i,s){for(let o=0;o<t.length;o++){const n=t[o],r=Math.sin(this.time*this.waveSpeed+o*this.waveFrequency)*this.waveAmplitude,a=e.measureText(n).width;e.save(),e.translate(i,s+r),this.drawStyledText(e,n,0,0),e.restore(),i+=a+this.letterSpacing}}drawStyledText(e,t,i,s){if(this.rainbow){const t=this.time*this.rainbowSpeed*360%360;e.fillStyle=`hsl(${t}, 100%, 50%)`}else if(this.useGradient){const o=this.createTextGradient(e,t,i,s);e.fillStyle=o}else e.fillStyle=this.fillColor;this.hasOutline&&(e.strokeStyle=this.outlineColor,e.lineWidth=this.outlineWidth,e.strokeText(t,i,s)),e.fillText(t,i,s)}createTextGradient(e,t,i,s){const o=e.measureText(t).width,n=this.fontSize,r=this.gradientAngle*Math.PI/180,a=Math.cos(r),l=Math.sin(r),h=Math.abs(o*a)+Math.abs(n*l),c=i-h*a/2,d=s-h*l/2,p=i+h*a/2,u=s+h*l/2,g=e.createLinearGradient(c,d,p,u);return g.addColorStop(0,this.gradientStartColor),g.addColorStop(1,this.gradientEndColor),g}roundRect(e,t,i,s,o,n){e.beginPath(),e.moveTo(t+n,i),e.lineTo(t+s-n,i),e.quadraticCurveTo(t+s,i,t+s,i+n),e.lineTo(t+s,i+o-n),e.quadraticCurveTo(t+s,i+o,t+s-n,i+o),e.lineTo(t+n,i+o),e.quadraticCurveTo(t,i+o,t,i+o-n),e.lineTo(t,i+n),e.quadraticCurveTo(t,i,t+n,i),e.closePath()}toJSON(){return{...super.toJSON(),text:this.text,fontSize:this.fontSize,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontStyle:this.fontStyle,fillColor:this.fillColor,useGradient:this.useGradient,gradientStartColor:this.gradientStartColor,gradientEndColor:this.gradientEndColor,gradientAngle:this.gradientAngle,hasOutline:this.hasOutline,outlineColor:this.outlineColor,outlineWidth:this.outlineWidth,hasShadow:this.hasShadow,shadowColor:this.shadowColor,shadowOffsetX:this.shadowOffsetX,shadowOffsetY:this.shadowOffsetY,shadowBlur:this.shadowBlur,textAlign:this.textAlign,textBaseline:this.textBaseline,lineHeight:this.lineHeight,letterSpacing:this.letterSpacing,wordSpacing:this.wordSpacing,opacity:this.opacity,rotation:this.rotation,skewX:this.skewX,skewY:this.skewY,scaleX:this.scaleX,scaleY:this.scaleY,wave:this.wave,waveAmplitude:this.waveAmplitude,waveFrequency:this.waveFrequency,waveSpeed:this.waveSpeed,rainbow:this.rainbow,rainbowSpeed:this.rainbowSpeed,maxWidth:this.maxWidth,wordWrap:this.wordWrap,hasBackground:this.hasBackground,backgroundColor:this.backgroundColor,backgroundPadding:this.backgroundPadding,backgroundRadius:this.backgroundRadius}}fromJSON(e){super.fromJSON(e),e&&(this.text=e.text||"Hello World",this.fontSize=e.fontSize||32,this.fontFamily=e.fontFamily||"Arial",this.fontWeight=e.fontWeight||"normal",this.fontStyle=e.fontStyle||"normal",this.fillColor=e.fillColor||"#ffffff",this.useGradient=e.useGradient||!1,this.gradientStartColor=e.gradientStartColor||"#ff0000",this.gradientEndColor=e.gradientEndColor||"#0000ff",this.gradientAngle=e.gradientAngle||0,this.hasOutline=e.hasOutline||!1,this.outlineColor=e.outlineColor||"#000000",this.outlineWidth=e.outlineWidth||2,this.hasShadow=e.hasShadow||!1,this.shadowColor=e.shadowColor||"#000000",this.shadowOffsetX=e.shadowOffsetX||2,this.shadowOffsetY=e.shadowOffsetY||2,this.shadowBlur=e.shadowBlur||4,this.textAlign=e.textAlign||"center",this.textBaseline=e.textBaseline||"middle",this.lineHeight=e.lineHeight||1.2,this.letterSpacing=e.letterSpacing||0,this.wordSpacing=e.wordSpacing||0,this.opacity=e.opacity||1,this.rotation=e.rotation||0,this.skewX=e.skewX||0,this.skewY=e.skewY||0,this.scaleX=e.scaleX||1,this.scaleY=e.scaleY||1,this.wave=e.wave||!1,this.waveAmplitude=e.waveAmplitude||5,this.waveFrequency=e.waveFrequency||2,this.waveSpeed=e.waveSpeed||2,this.rainbow=e.rainbow||!1,this.rainbowSpeed=e.rainbowSpeed||1,this.maxWidth=e.maxWidth||0,this.wordWrap=void 0===e.wordWrap||e.wordWrap,this.hasBackground=e.hasBackground||!1,this.backgroundColor=e.backgroundColor||"#000000",this.backgroundPadding=e.backgroundPadding||10,this.backgroundRadius=e.backgroundRadius||0)}}window.DrawText=DrawText;let gameInitialized=!1;function setLoadingProgress(e){var t=document.querySelector(".loading-progress");t&&(t.style.width=Math.max(0,Math.min(100,e))+"%")}async function initializeGame(){if(gameInitialized)return;gameInitialized=!0,console.log("Initializing exported game..."),window.assetManager||(window.assetManager=new AssetManager(null)),window.prefabManager||(window.prefabManager={prefabs:new Map,loadPrefabs:function(e){if(e){console.log("Loading prefabs into global manager:",Object.keys(e));for(const[t,i]of Object.entries(e))this.prefabs.set(t,i);console.log("Total prefabs loaded:",this.prefabs.size)}},findPrefabByName:function(e){if(!e)return null;if(this.prefabs.has(e))return this.prefabs.get(e);const t=e.toLowerCase();for(const[e,i]of this.prefabs)if(e.toLowerCase()===t)return i;return null},hasPrefab:function(e){return null!==this.findPrefabByName(e)},getAllPrefabNames:function(){return Array.from(this.prefabs.keys())},instantiatePrefabByName:function(e,t=null,i=null){const s=this.findPrefabByName(e);return s?this.instantiatePrefab(s,t,i):(console.error("Prefab not found:",e),null)},instantiatePrefab:function(e,t=null,i=null){try{const s=GameObject.fromJSON(e);return t&&(s.position.x=t.x,s.position.y=t.y),i?i.addChild(s):window.engine&&window.engine.gameObjects&&window.engine.gameObjects.push(s),s}catch(e){return console.error("Error instantiating prefab:",e),null}}});const e={"/Assets/3D/package-info.json":{content:'{"name":"3D","description":"3D engine with mesh, screen effects etc","version":"1.7.0","author":"SynKrown","importedAt":1759710608998,"originalFilename":"2d_context_3d.dmjs","totalFiles":14,"totalDirectories":1}',type:"application/json"},"Assets/3D/package-info.json":{content:'{\n  "name": "3D",\n  "description": "3D engine with mesh, screen effects etc",\n  "version": "1.7.0",\n  "author": "SynKrown",\n  "importedAt": 1759710608998,\n  "originalFilename": "2d_context_3d.dmjs",\n  "totalFiles": 14,\n  "totalDirectories": 1\n}',type:"application/json",source:"fileBrowser"},"Assets/Basic Drawing Module/Assets/Basic Drawing Module/package-info.json":{content:'{\n  "name": "Basic Drawing Module",\n  "description": "A bunch of modules for drawing different shapes",\n  "version": "1.0.0",\n  "author": "SynKrown",\n  "importedAt": 1758695717079,\n  "originalFilename": "basic_drawing_module.dmjs",\n  "totalFiles": 13,\n  "totalDirectories": 0\n}',type:"application/json",source:"fileBrowser"},"Assets/Basic Drawing Module/package-info.json":{content:'{\n  "name": "Basic Drawing Module",\n  "description": "A bunch of drawing modules for drawing basic shapes, like circle, rectangle, star, shield etc",\n  "version": "1.2.0",\n  "author": "SynKrown",\n  "importedAt": 1759711203543,\n  "originalFilename": "basic_drawing_module.dmjs",\n  "totalFiles": 14,\n  "totalDirectories": 0\n}',type:"application/json",source:"fileBrowser"}};e&&(console.log("Loading embedded assets into AssetManager..."),window.assetManager.addEmbeddedAssets(e),await new Promise(e=>setTimeout(e,100)),console.log("AssetManager cache populated with:",Object.keys(window.assetManager.cache))),document.addEventListener("keydown",e=>{[32,33,34,35,36,37,38,39,40].includes(e.keyCode)&&e.preventDefault()},{passive:!1}),document.addEventListener("contextmenu",e=>e.preventDefault()),document.addEventListener("dragover",e=>e.preventDefault()),document.addEventListener("drop",e=>e.preventDefault());const t=document.getElementById("loading-screen");if("undefined"==typeof Matter)return void console.log("Waiting for Matter.js to load...");let i;console.log("Matter.js is available, proceeding with initialization..."),window.physicsManager=new PhysicsManager,window.moduleRegistry||(window.moduleRegistry=new ModuleRegistry),console.log("Registering modules..."),void 0!==SpriteRenderer?(window.moduleRegistry.register(SpriteRenderer),console.log("Registered module: SpriteRenderer")):console.error("Module class not found: SpriteRenderer"),void 0!==RigidBody?(window.moduleRegistry.register(RigidBody),console.log("Registered module: RigidBody")):console.error("Module class not found: RigidBody"),void 0!==BloomEffect?(window.moduleRegistry.register(BloomEffect),console.log("Registered module: BloomEffect")):console.error("Module class not found: BloomEffect"),void 0!==ChromaticAberrationEffect?(window.moduleRegistry.register(ChromaticAberrationEffect),console.log("Registered module: ChromaticAberrationEffect")):console.error("Module class not found: ChromaticAberrationEffect"),void 0!==DepthOfFieldEffect?(window.moduleRegistry.register(DepthOfFieldEffect),console.log("Registered module: DepthOfFieldEffect")):console.error("Module class not found: DepthOfFieldEffect"),void 0!==EdgeBlurEffect?(window.moduleRegistry.register(EdgeBlurEffect),console.log("Registered module: EdgeBlurEffect")):console.error("Module class not found: EdgeBlurEffect"),void 0!==MotionBlurEffect?(window.moduleRegistry.register(MotionBlurEffect),console.log("Registered module: MotionBlurEffect")):console.error("Module class not found: MotionBlurEffect"),void 0!==OutlineEffect?(window.moduleRegistry.register(OutlineEffect),console.log("Registered module: OutlineEffect")):console.error("Module class not found: OutlineEffect"),void 0!==VignetteEffect?(window.moduleRegistry.register(VignetteEffect),console.log("Registered module: VignetteEffect")):console.error("Module class not found: VignetteEffect"),void 0!==Camera3DRasterizer?(window.moduleRegistry.register(Camera3DRasterizer),console.log("Registered module: Camera3DRasterizer")):console.error("Module class not found: Camera3DRasterizer"),void 0!==FlyCamera?(window.moduleRegistry.register(FlyCamera),console.log("Registered module: FlyCamera")):console.error("Module class not found: FlyCamera"),void 0!==Light3D?(window.moduleRegistry.register(Light3D),console.log("Registered module: Light3D")):console.error("Module class not found: Light3D"),void 0!==Material?(window.moduleRegistry.register(Material),console.log("Registered module: Material")):console.error("Module class not found: Material"),void 0!==Mesh3D?(window.moduleRegistry.register(Mesh3D),console.log("Registered module: Mesh3D")):console.error("Module class not found: Mesh3D"),void 0!==MouseLook?(window.moduleRegistry.register(MouseLook),console.log("Registered module: MouseLook")):console.error("Module class not found: MouseLook"),void 0!==TopDownCamera?(window.moduleRegistry.register(TopDownCamera),console.log("Registered module: TopDownCamera")):console.error("Module class not found: TopDownCamera"),void 0!==DrawArrow?(window.moduleRegistry.register(DrawArrow),console.log("Registered module: DrawArrow")):console.error("Module class not found: DrawArrow"),void 0!==DrawCapsule?(window.moduleRegistry.register(DrawCapsule),console.log("Registered module: DrawCapsule")):console.error("Module class not found: DrawCapsule"),void 0!==DrawCircle?(window.moduleRegistry.register(DrawCircle),console.log("Registered module: DrawCircle")):console.error("Module class not found: DrawCircle"),void 0!==DrawDiamond?(window.moduleRegistry.register(DrawDiamond),console.log("Registered module: DrawDiamond")):console.error("Module class not found: DrawDiamond"),void 0!==DrawGrid?(window.moduleRegistry.register(DrawGrid),console.log("Registered module: DrawGrid")):console.error("Module class not found: DrawGrid"),void 0!==DrawHeart?(window.moduleRegistry.register(DrawHeart),console.log("Registered module: DrawHeart")):console.error("Module class not found: DrawHeart"),void 0!==DrawIcon?(window.moduleRegistry.register(DrawIcon),console.log("Registered module: DrawIcon")):console.error("Module class not found: DrawIcon"),void 0!==DrawLine?(window.moduleRegistry.register(DrawLine),console.log("Registered module: DrawLine")):console.error("Module class not found: DrawLine"),void 0!==DrawPolygon?(window.moduleRegistry.register(DrawPolygon),console.log("Registered module: DrawPolygon")):console.error("Module class not found: DrawPolygon"),void 0!==DrawRectangle?(window.moduleRegistry.register(DrawRectangle),console.log("Registered module: DrawRectangle")):console.error("Module class not found: DrawRectangle"),void 0!==DrawShield?(window.moduleRegistry.register(DrawShield),console.log("Registered module: DrawShield")):console.error("Module class not found: DrawShield"),void 0!==DrawStar?(window.moduleRegistry.register(DrawStar),console.log("Registered module: DrawStar")):console.error("Module class not found: DrawStar"),void 0!==DrawText?(window.moduleRegistry.register(DrawText),console.log("Registered module: DrawText")):console.error("Module class not found: DrawText"),void 0!==SpriteRendererBackground?(window.moduleRegistry.register(SpriteRendererBackground),console.log("Registered module: SpriteRendererBackground")):console.error("Module class not found: SpriteRendererBackground"),void 0!==ObjectTiling?(window.moduleRegistry.register(ObjectTiling),console.log("Registered module: ObjectTiling")):console.error("Module class not found: ObjectTiling"),void 0!==FollowTarget?(window.moduleRegistry.register(FollowTarget),console.log("Registered module: FollowTarget")):console.error("Module class not found: FollowTarget"),void 0!==Spawner?(window.moduleRegistry.register(Spawner),console.log("Registered module: Spawner")):console.error("Module class not found: Spawner"),void 0!==SimpleMovementController?(window.moduleRegistry.register(SimpleMovementController),console.log("Registered module: SimpleMovementController")):console.error("Module class not found: SimpleMovementController"),void 0!==CameraController?(window.moduleRegistry.register(CameraController),console.log("Registered module: CameraController")):console.error("Module class not found: CameraController"),void 0!==Tween?(window.moduleRegistry.register(Tween),console.log("Registered module: Tween")):console.error("Module class not found: Tween"),void 0!==Timer?(window.moduleRegistry.register(Timer),console.log("Registered module: Timer")):console.error("Module class not found: Timer"),void 0!==ParticleSystem?(window.moduleRegistry.register(ParticleSystem),console.log("Registered module: ParticleSystem")):console.error("Module class not found: ParticleSystem"),void 0!==RigidBodyDragger?(window.moduleRegistry.register(RigidBodyDragger),console.log("Registered module: RigidBodyDragger")):console.error("Module class not found: RigidBodyDragger"),void 0!==Joint?(window.moduleRegistry.register(Joint),console.log("Registered module: Joint")):console.error("Module class not found: Joint"),void 0!==GravityFieldMatter?(window.moduleRegistry.register(GravityFieldMatter),console.log("Registered module: GravityFieldMatter")):console.error("Module class not found: GravityFieldMatter"),void 0!==WindZoneMatter?(window.moduleRegistry.register(WindZoneMatter),console.log("Registered module: WindZoneMatter")):console.error("Module class not found: WindZoneMatter"),void 0!==VehiclePhysics?(window.moduleRegistry.register(VehiclePhysics),console.log("Registered module: VehiclePhysics")):console.error("Module class not found: VehiclePhysics"),void 0!==PlatformControllerMatter?(window.moduleRegistry.register(PlatformControllerMatter),console.log("Registered module: PlatformControllerMatter")):console.error("Module class not found: PlatformControllerMatter"),void 0!==BasicPhysics?(window.moduleRegistry.register(BasicPhysics),console.log("Registered module: BasicPhysics")):console.error("Module class not found: BasicPhysics"),void 0!==PhysicsKeyboardController?(window.moduleRegistry.register(PhysicsKeyboardController),console.log("Registered module: PhysicsKeyboardController")):console.error("Module class not found: PhysicsKeyboardController"),void 0!==SimpleHealth?(window.moduleRegistry.register(SimpleHealth),console.log("Registered module: SimpleHealth")):console.error("Module class not found: SimpleHealth"),void 0!==AudioPlayer?(window.moduleRegistry.register(AudioPlayer),console.log("Registered module: AudioPlayer")):console.error("Module class not found: AudioPlayer"),void 0!==BehaviorTrigger?(window.moduleRegistry.register(BehaviorTrigger),console.log("Registered module: BehaviorTrigger")):console.error("Module class not found: BehaviorTrigger"),console.log("Total registered modules:",window.moduleRegistry.modules.size),window.input||(window.input=new InputManager),window.assetManager.normalizePath=function(e){if(!e)return"";let t=e.replace(/^[/\\]+/,"").replace(/\\/g,"/");try{t=decodeURIComponent(t)}catch(e){}return t},window.prefabManager={prefabs:new Map,loadPrefabs:function(e){if(e){for(const[t,i]of Object.entries(e))this.prefabs.set(t,i),console.log("Loaded prefab:",t);console.log("Total prefabs loaded:",this.prefabs.size)}},findPrefabByName:function(e){if(!e)return null;if(this.prefabs.has(e))return this.prefabs.get(e);const t=e.toLowerCase();for(const[e,i]of this.prefabs)if(e.toLowerCase()===t)return i;return null},hasPrefab:function(e){return null!==this.findPrefabByName(e)},getAllPrefabNames:function(){return Array.from(this.prefabs.keys())},instantiatePrefabByName:function(e,t=null,i=null){const s=this.findPrefabByName(e);return s?this.instantiatePrefab(s,t,i):(console.error("Prefab not found:",e),null)},instantiatePrefab:function(e,t=null,i=null){try{const s=new GameObject(e.name);return t?(s.position.x=t.x,s.position.y=t.y):(s.position.x=e.position.x,s.position.y=e.position.y),s.angle=e.angle||0,s.scale.x=e.scale?.x||1,s.scale.y=e.scale?.y||1,s.active=!1!==e.active,e.modules&&e.modules.length>0&&e.modules.forEach(e=>{try{const t=window.moduleRegistry.getModuleClass(e.className);if(!t)return void console.warn("Module class not found:",e.className);const i=new t;e.properties&&Object.keys(e.properties).forEach(t=>{i.hasOwnProperty(t)&&(i[t]=e.properties[t])}),s.addModule(i)}catch(t){console.error("Error adding module "+e.className+":",t)}}),e.children&&e.children.length>0&&e.children.forEach(e=>{const t=this.instantiatePrefab(e,null,s);s.addChild(t)}),i?i.addChild(s):window.engine&&window.engine.gameObjects&&window.engine.gameObjects.push(s),s}catch(e){throw console.error("Error instantiating prefab:",e),e}}};try{i={scenes:[{name:"Main Scene",settings:{viewportWidth:640,viewportHeight:480,viewportX:0,viewportY:0,backgroundColor:"#1e1e1e",gridEnabled:!0,gridSize:32,snapToGrid:!1},gameObjects:[{id:"47adece7-88a4-41b6-bd79-c1d9943a4bc6",name:"Camera",position:{x:320,y:320},angle:0,scale:{x:1,y:1},size:{width:50,height:50},active:!0,visible:!0,depth:0,modules:[{type:"Camera3DRasterizer",id:"061941b8-c5ae-491d-957b-5a03dc0cf81c",enabled:!0,data:{name:"Camera3DRasterizer",type:"Camera3DRasterizer",enabled:!0,requirements:[],properties:{},exposedValues:{position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},fieldOfView:60,nearPlane:.1,farPlane:5e3,backgroundColor:"#000000",drawGizmoInRuntime:!1,renderTextureWidth:160,renderTextureHeight:120,renderTextureSmoothing:!1,renderingMethod:"raster",lightDirection:{x:1,y:-1,z:-1},lightColor:"#ffffff",lightIntensity:1,ambientIntensity:.3,maxLights:4,lightFindDistance:500,useDynamicLighting:!0,backgroundType:"skybox",skyColor:"#87CEEB",skyColorHorizon:"#da846aff",floorColor:"#95d5f3",floorColorHorizon:"#1a2c46",cloudsEnabled:!0,cloudSpeed:2.5,cloudDensity:1,cloudScale:250,cloudSoftness:.8,cloudHeight:.1,cloudThickness:.8,cloudBrightness:.9,cloudResolution:.3,waterEnabled:!0,waterSpeed:1,waterWaveHeight:2,hillsEnabled:!0,hillsSeed:12345,hillsMinHeight:.2,hillsMaxHeight:.3,hillsFrequency:.5,hillsRoughness:.6,hillsBaseColor:"#0e2f12",hillsTopColor:"#3e9844",hillsUseFogColor:!1,hillsFogBlend:.7,waterReflectionEnabled:!0,waterReflectionOpacity:.9,waterReflectionDistortion:.1,showSun:!0,sunSize:30,sunGlowSize:60,lensFlareEnabled:!0,lensFlareIntensity:.8,lensFlareCount:5,lensFlareSpacing:.25,lensFlareSize:32,lensFlareColorShift:!0,specularEnabled:!0,specularFullFace:!0,specularBloomEnabled:!0,specularBloomIntensity:.9,specularBloomRadius:2.5,specularBloomThreshold:.3,fogEnabled:!1,fogColor:"#a0a0a0",fogStart:100,fogEnd:500,fogDensity:1,showDebugInfo:!1},_type:"Camera3DRasterizer",_position:{x:0,y:0,z:0},_rotation:{x:0,y:0,z:0},_fieldOfView:60,_nearPlane:.1,_farPlane:5e3,_isActive:!0,_backgroundColor:"#000000",_renderTextureWidth:160,_renderTextureHeight:120,_renderTextureSmoothing:!1,drawGizmoInRuntime:!1,_renderingMethod:"raster",_enableBackfaceCulling:!0,_lightDirection:{x:1,y:-1,z:-1},_lightColor:"#ffffff",_lightIntensity:1,_ambientIntensity:.3,_skyColor:"#87CEEB",_skyColorHorizon:"#da846aff",_floorColor:"#95d5f3",_floorColorHorizon:"#1a2c46",_backgroundType:"skybox",_showSun:!0,_sunSize:30,_sunGlowSize:60,_specularEnabled:!0,_specularBleedingEnabled:!1,_specularPerMesh:!1,_specularFullFace:!0,_specularBloomEnabled:!0,_specularBloomIntensity:.9,_specularBloomRadius:2.5,_specularBloomThreshold:.3,_showDebugInfo:!1,_maxLights:4,_lightFindDistance:500,_useDynamicLighting:!0,_lensFlareEnabled:!0,_lensFlareIntensity:.8,_lensFlareCount:5,_lensFlareSpacing:.25,_lensFlareSize:32,_lensFlareColorShift:!0,_fogEnabled:!1,_fogColor:"#a0a0a0",_fogStart:100,_fogEnd:500,_fogDensity:1,_waterEnabled:!0,_waterSpeed:1,_waterWaveHeight:2,_cloudsEnabled:!0,_cloudSpeed:2.5,_cloudDensity:1,_cloudScale:250,_cloudSoftness:.8,_cloudHeight:.1,_cloudThickness:.8,_cloudBrightness:.9,_cloudResolution:.3,_emissiveIntensity:1,_hillsEnabled:!0,_hillsSeed:12345,_hillsMinHeight:.2,_hillsMaxHeight:.3,_hillsFrequency:.5,_hillsRoughness:.6,_hillsBaseColor:"#0e2f12",_hillsTopColor:"#3e9844",_hillsUseFogColor:!1,_hillsFogBlend:.7,_waterReflectionEnabled:!0,_waterReflectionOpacity:.9,_waterReflectionDistortion:.1}},{type:"FlyCamera",id:"8c594f5a-8d5c-451d-b721-08cb1580bf81",enabled:!0,data:{name:"FlyCamera",type:"FlyCamera",enabled:!0,requirements:["Camera3DRasterizer"],properties:{},exposedValues:{moveSpeed:200,sprintMultiplier:2.5,verticalSpeed:150,smoothing:.2,keyMapping:{forward:"w",backward:"s",left:"a",right:"d",up:"e",down:"q",sprint:"shift"},useZAxis:!0,lockZAxisPosition:!1,collisionRadius:50,collisionEnabled:!0,slideAlongWalls:!0},_type:"FlyCamera",_moveSpeed:200,_sprintMultiplier:2.5,_verticalSpeed:150,_smoothing:.2,_keyMapping:{forward:"w",backward:"s",left:"a",right:"d",up:"e",down:"q",sprint:"shift"},_useZAxis:!0,_lockZAxisPosition:!1,_collisionRadius:50,_collisionEnabled:!0,_slideAlongWalls:!0}},{type:"MouseLook",id:"2f8f7932-5b42-4094-84ed-389478748556",enabled:!0,data:{name:"MouseLook",type:"MouseLook",enabled:!0,requirements:["Camera3DRasterizer"],properties:{},exposedValues:{sensitivity:.2,invertX:!1,invertY:!1,lockX:!1,lockY:!1,smoothing:.1,minPitch:-89.9,maxPitch:89.9,activateMode:"leftButton",lockCursor:!1},_type:"MouseLook",_sensitivity:.2,_invertX:!1,_invertY:!1,_smoothing:.1,_lockX:!1,_lockY:!1,_minPitch:-89.9,_maxPitch:89.9,_activateMode:"leftButton",_lockCursor:!1,_screenWrap:!0,_wrapSensitivity:1}},{type:"BloomEffect",id:"add3f7b0-65dc-482d-9587-36375500d861",enabled:!0,data:{name:"BloomEffect",type:"BloomEffect",enabled:!0,requirements:[],properties:{},exposedValues:{threshold:.2,intensity:.9,radius:64,softness:.1,downsample:7},_type:"BloomEffect",_threshold:.2,_intensity:.9,_radius:64,_softness:.1,_downsample:7}},{type:"ChromaticAberrationEffect",id:"f2e1b6ca-7978-401f-ac90-1aa10708f844",enabled:!0,data:{name:"ChromaticAberrationEffect",type:"ChromaticAberrationEffect",enabled:!0,requirements:[],properties:{},exposedValues:{intensity:5,radialDistortion:!0,centerX:.5,centerY:.5},_type:"ChromaticAberrationEffect",_intensity:5,_radialDistortion:!0,_center:{x:.5,y:.5}}},{type:"MotionBlurEffect",id:"78ddf90b-6c24-41e1-87fd-14b8d2ebd2c9",enabled:!1,data:{name:"MotionBlurEffect",type:"MotionBlurEffect",enabled:!1,requirements:[],properties:{},exposedValues:{strength:.9,samples:4,maxBlurDistance:64},_type:"MotionBlurEffect",_strength:.9,_samples:4,_maxBlurDistance:64}},{type:"VignetteEffect",id:"eb524c6c-c3e2-4eeb-8934-4ce3fc564cb9",enabled:!0,data:{name:"VignetteEffect",type:"VignetteEffect",enabled:!0,requirements:[],properties:{},exposedValues:{intensity:.9,softness:.5,color:"#000000"},_type:"VignetteEffect",_intensity:.9,_softness:.5,_color:"#000000"}}]},{id:"ce3e8222-6fc5-4450-b3df-12990a623941",name:"Cube",position:{x:544,y:320},angle:0,scale:{x:1,y:1},size:{width:50,height:50},active:!0,visible:!0,depth:0,modules:[{type:"Mesh3D",id:"0145e5a5-bd27-44f9-9f56-9219aab27e7c",enabled:!0,data:{name:"Mesh3D",type:"Mesh3D",enabled:!0,requirements:[],properties:{},exposedValues:{_shape:"cube",position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:76.5840000015861},scale:{x:1,y:1,z:1},rotationSpeed:{x:0,y:0,z:30},enableLOD:!1,minLODDistance:100,maxLODDistance:500,maxSubdivisions:3,cubeSize:100,pyramidBaseSize:100,pyramidHeight:150,sphereRadius:50,sphereDetail:12,octahedronSize:50,planeSize:100,quadCubeSize:100,quadCubeSubdivisions:2,capsuleRadius:15,capsuleHeight:30,capsuleSegments:8,prismSides:6,prismRadius:50,prismHeight:100,tetrahedronSize:50,torusMajorRadius:50,torusMinorRadius:15,torusMajorSegments:16,torusMinorSegments:8,coneRadius:50,coneHeight:100,coneSegments:8,cylinderRadius:50,cylinderHeight:100,cylinderSegments:8,icosahedronSize:100,quadWidth:200,quadHeight:200,quadSubdivisionsX:4,quadSubdivisionsY:4},_type:"Mesh3D",vertices:[],edges:[],faces:[],uvCoordinates:[],position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:76.5840000015861},scale:{x:1,y:1,z:1},wireframeColor:"#FFFFFF",faceColor:"#3F51B5",renderMode:"solid",_showAxisLines:!1,_axisLength:150,_shape:"cube",cubeSize:100,pyramidBaseSize:100,pyramidHeight:150,sphereRadius:50,sphereDetail:12,octahedronSize:50,torusMajorRadius:50,torusMinorRadius:15,torusMajorSegments:16,torusMinorSegments:8,coneRadius:50,coneHeight:100,coneSegments:8,cylinderRadius:50,cylinderHeight:100,cylinderSegments:8,icosahedronSize:100,quadCubeSize:100,quadCubeSubdivisions:2,capsuleRadius:15,capsuleHeight:30,capsuleSegments:8,prismSides:6,prismRadius:50,prismHeight:100,tetrahedronSize:50,quadWidth:200,quadHeight:200,quadSubdivisionsX:4,quadSubdivisionsY:4,planeSize:100,originalVertices:null,material:null,enableLOD:!1,minLODDistance:100,maxLODDistance:500,maxSubdivisions:3,lodUpdateThreshold:10}},{type:"Material",id:"7d0b4344-b4f9-4414-824c-ae0b62a27cc9",enabled:!0,data:{name:"Material",type:"Material",enabled:!0,requirements:[],properties:{},exposedValues:{diffuseColor:"#6b8eb3",specularColor:"#ffffff",shininess:6},_type:"Material",_diffuseColor:"#6b8eb3",_specularColor:"#ffffff",_emissiveColor:"#000000",_shininess:6,_opacity:1,_diffuseTexture:null,_normalTexture:null,_specularTexture:null,_emissiveTexture:null,_useProceduralTexture:!1,_proceduralType:"noise",_proceduralSeed:12345,_proceduralScale:1,_proceduralColor1:"#4CAF50",_proceduralColor2:"#2196F3",_proceduralOctaves:4,_proceduralPersistence:.5,_proceduralLacunarity:2,_uvScale:{x:1,y:1},_uvOffset:{x:0,y:0},_uvRotation:0,_transparent:!1,_doubleSided:!1,_wireframe:!1}}]},{id:"23b5d54b-700e-4a44-a37c-59be51387fe6",name:"Text",position:{x:32,y:32},angle:0,scale:{x:1,y:1},size:{width:50,height:50},active:!0,visible:!0,depth:-9999,modules:[{type:"DrawText",id:"00dc7084-f6ed-4448-897c-0bf09ebff9d6",enabled:!0,data:{name:"DrawText",type:"DrawText",enabled:!0,requirements:[],properties:{},exposedValues:{text:"Hello World",fontSize:32,fontFamily:"Arial",fontWeight:"bold",fontStyle:"normal",fillColor:"#ffffff",useGradient:!1,gradientStartColor:"#ff0000",gradientEndColor:"#0000ff",gradientAngle:0,hasOutline:!1,outlineColor:"#000000",outlineWidth:2,hasShadow:!0,shadowColor:"#000000",shadowOffsetX:2,shadowOffsetY:2,shadowBlur:4,textAlign:"left",textBaseline:"middle",lineHeight:1.2,letterSpacing:0,opacity:1,rotation:0,skewX:0,skewY:0,scaleX:1,scaleY:1,wave:!1,waveAmplitude:5,waveFrequency:2,waveSpeed:2,rainbow:!1,rainbowSpeed:1,maxWidth:0,wordWrap:!0,hasBackground:!1,backgroundColor:"#000000",backgroundPadding:10,backgroundRadius:0},text:"Hello World",fontSize:32,fontFamily:"Arial",fontWeight:"bold",fontStyle:"normal",fillColor:"#ffffff",useGradient:!1,gradientStartColor:"#ff0000",gradientEndColor:"#0000ff",gradientAngle:0,hasOutline:!1,outlineColor:"#000000",outlineWidth:2,hasShadow:!0,shadowColor:"#000000",shadowOffsetX:2,shadowOffsetY:2,shadowBlur:4,textAlign:"left",textBaseline:"middle",lineHeight:1.2,letterSpacing:0,wordSpacing:0,opacity:1,rotation:0,skewX:0,skewY:0,scaleX:1,scaleY:1,wave:!1,waveAmplitude:5,waveFrequency:2,waveSpeed:2,rainbow:!1,rainbowSpeed:1,maxWidth:0,wordWrap:!0,hasBackground:!1,backgroundColor:"#000000",backgroundPadding:10,backgroundRadius:0}}]}]}],assets:{"/Assets/3D/package-info.json":{content:'{"name":"3D","description":"3D engine with mesh, screen effects etc","version":"1.7.0","author":"SynKrown","importedAt":1759710608998,"originalFilename":"2d_context_3d.dmjs","totalFiles":14,"totalDirectories":1}',type:"application/json"},"Assets/3D/package-info.json":{content:'{\n  "name": "3D",\n  "description": "3D engine with mesh, screen effects etc",\n  "version": "1.7.0",\n  "author": "SynKrown",\n  "importedAt": 1759710608998,\n  "originalFilename": "2d_context_3d.dmjs",\n  "totalFiles": 14,\n  "totalDirectories": 1\n}',type:"application/json",source:"fileBrowser"},"Assets/Basic Drawing Module/Assets/Basic Drawing Module/package-info.json":{content:'{\n  "name": "Basic Drawing Module",\n  "description": "A bunch of modules for drawing different shapes",\n  "version": "1.0.0",\n  "author": "SynKrown",\n  "importedAt": 1758695717079,\n  "originalFilename": "basic_drawing_module.dmjs",\n  "totalFiles": 13,\n  "totalDirectories": 0\n}',type:"application/json",source:"fileBrowser"},"Assets/Basic Drawing Module/package-info.json":{content:'{\n  "name": "Basic Drawing Module",\n  "description": "A bunch of drawing modules for drawing basic shapes, like circle, rectangle, star, shield etc",\n  "version": "1.2.0",\n  "author": "SynKrown",\n  "importedAt": 1759711203543,\n  "originalFilename": "basic_drawing_module.dmjs",\n  "totalFiles": 14,\n  "totalDirectories": 0\n}',type:"application/json",source:"fileBrowser"}},prefabs:{}}}catch(e){return console.error("Error parsing game data:",e),void(t.innerHTML="<div>Error loading game data: "+e.message+"</div>")}i.assets&&(console.log("Pre-caching embedded assets..."),console.log("Assets to cache:",Object.keys(i.assets)),window.assetManager.addEmbeddedAssets(i.assets),console.log("Asset caching completed."),console.log("Final asset cache keys:",Object.keys(window.assetManager.cache)));const s=document.getElementById("gameCanvas"),o=window.innerWidth,n=window.innerHeight;s.width=o,s.height=n;const r=new Engine(s,{useWebGL:!1,enableFullscreen:!0,pixelWidth:o,pixelHeight:n,pixelScale:1});if(i.prefabs&&Object.keys(i.prefabs).length>0?(console.log("Loading",Object.keys(i.prefabs).length,"prefabs..."),window.prefabManager.loadPrefabs(i.prefabs),"function"==typeof r.loadPrefabs&&r.loadPrefabs(i.prefabs),console.log("Prefabs loaded. Available in global manager:",window.prefabManager.getAllPrefabNames()),console.log("Available in engine:",r.getAvailablePrefabs())):console.warn("No prefabs found in game data"),r.updateFPSLimit(60),this.ctx=s.ctx,window.engine=r,i.prefabs&&(console.log("Loading prefabs into engine..."),r.loadPrefabs(i.prefabs),window.prefabManager&&"function"==typeof window.prefabManager.loadPrefabs&&window.prefabManager.loadPrefabs(i.prefabs),console.log("Prefabs loaded. Available prefabs:",r.getAvailablePrefabs())),r.handleResize=function(e,t){this.canvas.width=e,this.canvas.height=t,this.width=e,this.height=t,this.ctx&&this.ctx.gl&&this.ctx.gl.viewport(0,0,e,t),this.camera&&this.camera.updateBounds(e,t),console.log("Engine resized to:",e,"x",t)},window.physicsManager){console.log("Connecting physics to engine...");const e=r.update.bind(r),t=r.draw.bind(r);r.update=function(t){window.physicsManager&&window.physicsManager.update&&window.physicsManager.update(t),e(t)},r.draw=function(){t(),window.physicsManager&&window.physicsManager.drawDebug&&this.ctx&&window.physicsManager.drawDebug(this.ctx)},console.log("Matter Physics connected to engine successfully")}else console.error("Physics manager not found during engine setup");function a(){const e=document.getElementById("game-container"),t=document.getElementById("gameCanvas");if(!t||!e)return;const i=e.clientWidth,s=e.clientHeight,o=Math.min(i/800,s/600),n=800*o,r=600*o;t.style.width=n+"px",t.style.height=r+"px",t.style.position="absolute",t.style.left="50%",t.style.top="50%",t.style.transform="translate(-50%, -50%)"}a(),window.addEventListener("resize",a);const l=i.scenes||[],h=[];function createGameObjectFromData(e){console.log("Creating game object:",e.name,"with",e.modules?.length||0,"modules");const t=new GameObject(e.name);return e.id&&(t.id=e.id),t.position=new Vector2(e.position.x,e.position.y),t.angle="number"==typeof e.angle?e.angle:0,t.depth=e.depth,t.useCollisions=e.useCollisions||!1,t.size=e.size?new Vector2(e.size.width,e.size.height):new Vector2(50,50),e.scale&&(t.scale=new Vector2(e.scale.x,e.scale.y)),t.editorColor=e.editorColor||t.generateRandomColor(),void 0!==e.polygonPointCount&&(t.polygonPointCount=e.polygonPointCount),e.polygonPoints&&Array.isArray(e.polygonPoints)&&(t.polygonPoints=e.polygonPoints.map(e=>new Vector2(e.x,e.y)),t.polygon=new Polygon(t,t.position.clone(),...t.polygonPoints.map(e=>e.clone()))),void 0!==e.usePolygonCollision&&(t.usePolygonCollision=e.usePolygonCollision),t.active=e.active,void 0!==e.visible&&(t.visible=e.visible),t.tags=Array.isArray(e.tags)?[...e.tags]:[],void 0!==e.collisionEnabled&&(t.collisionEnabled=e.collisionEnabled),void 0!==e.collisionLayer&&(t.collisionLayer=e.collisionLayer),void 0!==e.collisionMask&&(t.collisionMask=e.collisionMask),e.modules&&e.modules.length>0&&e.modules.forEach(i=>{console.log("Adding module:",i.type,"to",e.name);const s=window.moduleRegistry.getModuleClass(i.type);if(s){const e=new s;if(e.enabled=i.enabled,e.id=i.id,i.data)if("function"==typeof e.fromJSON)try{e.fromJSON(i.data),console.log("Module data restored via fromJSON for:",i.type)}catch(t){console.error("Error restoring module data via fromJSON:",t),i.data.properties&&Object.keys(i.data.properties).forEach(t=>{t in e&&(e[t]=i.data.properties[t])})}else{const t=i.data.properties||i.data;Object.keys(t).forEach(i=>{i in e&&(e[i]=t[i])})}t.addModule(e),console.log("Successfully added module:",i.type)}}),e.children&&e.children.forEach(e=>{const i=createGameObjectFromData(e);t.addChild(i)}),t}if(l.forEach(e=>{const t=new Scene(e.name);t.settings=e.settings,e.gameObjects.forEach(e=>{const i=createGameObjectFromData(e);t.gameObjects.push(i)}),h.push(t)}),h.length>0)try{const e=0,i=h[e]||h[0];console.log("Loading starting scene:",i.name,"at index:",e),r.loadScene(i),await r.start(),t.style.display="none",console.log("Game started successfully with scene:",i.name)}catch(e){console.error("Failed to start game:",e),t.innerHTML="<div>Error loading game: "+e.message+"</div>"}else t.innerHTML="<div>No scenes found</div>"}document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("start-game-btn");e&&e.addEventListener("click",function(){e.style.display="none";const t=document.getElementById("loading-screen");t&&(t.style.display="none"),window.melodicode&&window.melodicode.audioEngine&&window.melodicode.audioEngine.context&&window.melodicode.audioEngine.context.resume(),"function"==typeof initializeGame&&initializeGame()})}),document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("start-game-btn");e&&e.addEventListener("click",function(){e.style.display="none";const t=document.getElementById("loading-screen");t&&(t.style.display="none"),window.melodicode&&window.melodicode.audioEngine&&window.melodicode.audioEngine.context&&window.melodicode.audioEngine.context.resume(),"function"==typeof initializeGame&&initializeGame()})});</script>
</head><body><div id=game-container><canvas id=gameCanvas></canvas><div id=loading-screen style="background:#000000;"><div class=loading-content><img class=loading-logo src="data:image/png;base64,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" alt=Logo><div class=game-title style="
font-size:2em;
font-weight:700;
color:#4f8ef7;
margin-bottom:16px;
text-align:center;
letter-spacing:1px;
">Dark Matter Game</div><div style="display:flex;align-items:center;justify-content:center;gap:12px;"><button id=start-game-btn style="
margin-top:8px;
padding: 16px 48px;
font-size: 1.4em;
font-weight: bold;
color: #fff;
background: #4f8ef7;
border: none;
border-radius: 32px;
box-shadow: 0 2px 16px 0 #4f8ef744;
cursor: pointer;
transition: background 0.2s, box-shadow 0.2s;
outline: none;
letter-spacing: 1px;
">Start Game</button><button id=desc-btn aria-label="Show Description" style="
margin-top:8px;
padding: 0 16px;
font-size: 1.4em;
font-weight: bold;
color: #4f8ef7;
background: #222;
border: 2px solid #4f8ef7;
border-radius: 50%;
cursor: pointer;
transition: background 0.2s, box-shadow 0.2s;
outline: none;
height:48px;
width:48px;
display:flex;
align-items:center;
justify-content:center;
">?</button></div><button id=load-game-btn style="
margin-top:12px;
padding: 12px 32px;
font-size: 1.1em;
font-weight: bold;
color: #fff;
background: #4f8ef7;
border: none;
border-radius: 24px;
box-shadow: 0 2px 8px 0 #4f8ef744;
cursor: pointer;
transition: background 0.2s, box-shadow 0.2s;
outline: none;
letter-spacing: 1px;
">Load Game</button></div></div><div id=desc-modal style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:3000;align-items:center;justify-content:center;background:rgba(0,0,0,0.85);"><div style="background:#222;padding:32px 24px;border-radius:16px;max-width:90vw;max-height:80vh;overflow:auto;box-shadow:0 8px 32px #000a;color:#fff;position:relative;"><button id=desc-close-btn style="position:absolute;top:12px;right:16px;background:none;border:none;color:#4f8ef7;font-size:1.6em;cursor:pointer;">&times;</button><h2 style="color:#4f8ef7;margin-top:0;margin-bottom:12px;font-size:1.3em;">About This Game</h2><div style="font-size:1.1em;line-height:1.5;color:#eee;">Use WASDD to move the camera around, hold left mouse button and drag to rotate the camera</div></div></div></div></body></html>