<!DOCTYPE html>
<html>
<head>
    <title>Dark Matter JS - Game Engine</title>
    <link rel="stylesheet" href="src/styles/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="src/styles/file-browser.css">
    <link rel="stylesheet" href="src/styles/script-editor.css">
    <link rel="stylesheet" href="src/styles/hierarchy.css">
    <link rel="stylesheet" href="src/styles/inspector.css">
    <link rel="stylesheet" href="src/styles/scene-manager.css">
    <link rel="stylesheet" href="src/styles/scene.css">
    <link rel="stylesheet" href="src/styles/scrollbars.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.7/beautify.min.js"></script>
</head>
<body>
    <div class="toolbar">
        <div class="toolbar-group">
            <button class="toolbar-button" title="New Project" style="color: #ffffff"><i class="fas fa-file"></i></button>
            <button class="toolbar-button" title="Load Project" style="color: #d8be75"><i class="fas fa-folder-open"></i></button>
            <button class="toolbar-button" title="Save Project" style="color: #789ace"><i class="fas fa-save"></i></button>
            <button class="toolbar-button" title="Export Project" style="color: #68bb81"><i class="fas fa-file-export"></i></button>
        </div>
        <div class="toolbar-group">
            <button class="toolbar-button" title="Play" style="color: #4CAF50"><i class="fas fa-play"></i></button>
            <button class="toolbar-button" title="Stop" style="color: #f44336"><i class="fas fa-stop"></i></button>
            <div class="toolbar-spacer"></div>
            <button class="toolbar-button" title="Settings" style="color: #607D8B"><i class="fas fa-cog"></i></button>
        </div>
    </div>
    
    <div class="main-content">
        <div class="hierarchy-panel">
            <div class="hierarchy-header">Hierarchy</div>
            <div id="gameObjectHierarchy"></div>
            <div class="resizer-v"></div>
        </div>
        
        <div class="center-panel">
            <div class="canvas-tabs">
                <button class="canvas-tab active" data-canvas="editor">Scene</button>
                <button class="canvas-tab" data-canvas="game">Game</button>
            </div>
            <div class="canvas-container">
                <div class="canvas-view active" id="editorView">
                    <div class="editor-toolbar">
                        <label><input type="checkbox" id="showGrid" checked> Show Grid</label>
                        <label>Grid Size: <input type="number" id="gridSize" value="32" min="8" max="128"></label>
                        <label><input type="checkbox" id="snapToGrid"> Snap to Grid</label>
                    </div>
                    <div class="editor-canvas-container">
                        <canvas id="editorCanvas" width="800" height="600"></canvas>
                        <svg class="axis-indicator" width="50" height="50" viewBox="0 0 50 50">
                            <line x1="10" y1="40" x2="40" y2="40" stroke="#ff0000" stroke-width="2"/>
                            <line x1="10" y1="40" x2="10" y2="10" stroke="#00ff00" stroke-width="2"/>
                            <text x="42" y="44" fill="#ff0000" font-size="12">X</text>
                            <text x="6" y="8" fill="#00ff00" font-size="12">Y</text>
                        </svg>
                    </div>
                </div>
                <div class="canvas-view" id="gameView">
                    <canvas id="gameCanvas" width="800" height="600"></canvas>
                </div>
            </div>
        </div>
        
        <div class="module-panel">
            <div class="hierarchy-header">Inspector</div>
            <div id="moduleSettings"></div>
            <div class="resizer-v"></div>
        </div>
    </div>
    
    <div class="bottom-panel">
        <div class="resizer-h"></div>
        <div class="tab-buttons">
            <button class="tab-button active" data-tab="fileManager">Project</button>
            <button class="tab-button" data-tab="console">Console</button>
        </div>
        <div class="tab-content active" id="fileManager">
            <div id="fileBrowserContainer" style="height: 100%; display: flex; flex-direction: column;"></div>
        </div>
        <div class="tab-content" id="console">
            <div class="console-container">
                <div class="console-toolbar">
                    <button class="console-button" id="clearConsole" title="Clear Console">
                        <i class="fas fa-trash"></i> Clear
                    </button>
                </div>
                <div class="console-output"></div>
                <div class="console-input">
                    <span class="console-prompt">></span>
                    <input type="text" class="console-input-field">
                </div>
            </div>
        </div>
    </div>

    <script>
        // Simple panel resizing
        document.addEventListener('DOMContentLoaded', function() {
            // Vertical resizers for left and right panels
            const leftResizer = document.querySelector('.hierarchy-panel .resizer-v');
            const rightResizer = document.querySelector('.module-panel .resizer-v');
            const bottomResizer = document.querySelector('.bottom-panel .resizer-h');
            
            // Set up left panel resizer
            if (leftResizer) {
                setupResizer(leftResizer, 'width', '.hierarchy-panel', true);
            }
            
            // Set up right panel resizer
            if (rightResizer) {
                setupResizer(rightResizer, 'width', '.module-panel', false);
            }
            
            // Set up bottom panel resizer
            if (bottomResizer) {
                setupResizer(bottomResizer, 'height', '.bottom-panel', false);
                
                // Update main content height when bottom panel resizes
                bottomResizer.addEventListener('mouseup', updateMainContentHeight);
            }
            
            // Initial update
            updateMainContentHeight();
            
            function setupResizer(resizer, dimension, targetSelector, isGrowing) {
                let startPos, startSize;
                
                resizer.addEventListener('mousedown', function(e) {
                    e.preventDefault();
                    startPos = dimension === 'width' ? e.clientX : e.clientY;
                    const target = document.querySelector(targetSelector);
                    startSize = dimension === 'width' ? target.offsetWidth : target.offsetHeight;
                    
                    document.addEventListener('mousemove', resize);
                    document.addEventListener('mouseup', stopResize);
                    document.body.style.cursor = dimension === 'width' ? 'col-resize' : 'row-resize';
                });
                
                function resize(e) {
                    const currentPos = dimension === 'width' ? e.clientX : e.clientY;
                    const diff = isGrowing ? (currentPos - startPos) : (startPos - currentPos);
                    const target = document.querySelector(targetSelector);
                    let newSize = Math.max(100, startSize + diff);
                    
                    // Add max size constraints
                    if (dimension === 'width') {
                        newSize = Math.min(window.innerWidth / 3, newSize);
                    } else {
                        newSize = Math.min(window.innerHeight * 0.6, newSize);
                    }
                    
                    target.style[dimension] = newSize + 'px';
                    
                    // If this is the bottom panel, update main content
                    if (targetSelector === '.bottom-panel') {
                        updateMainContentHeight();
                    }
                }
                
                function stopResize() {
                    document.removeEventListener('mousemove', resize);
                    document.removeEventListener('mouseup', stopResize);
                    document.body.style.cursor = '';
                }
            }
            
            function updateMainContentHeight() {
                const bottomPanel = document.querySelector('.bottom-panel');
                const mainContent = document.querySelector('.main-content');
                const toolbar = document.querySelector('.toolbar');
                const footer = document.querySelector('.footer');
                
                if (bottomPanel && mainContent) {
                    const bottomHeight = bottomPanel.offsetHeight;
                    const toolbarHeight = toolbar ? toolbar.offsetHeight : 0;
                    const footerHeight = footer ? footer.offsetHeight : 0;
                    const totalHeight = window.innerHeight;
                    
                    // Calculate remaining height for main content
                    const mainHeight = totalHeight - bottomHeight - toolbarHeight - footerHeight;
                    mainContent.style.height = mainHeight + 'px';
                    
                    // Update scroll containers
                    updateScrollContainers();
                }
            }
            
            function updateScrollContainers() {
                // Update hierarchy container height
                const hierarchyHeader = document.querySelector('.hierarchy-panel .hierarchy-header');
                const hierarchyList = document.getElementById('gameObjectHierarchy');
                
                if (hierarchyHeader && hierarchyList) {
                    const headerHeight = hierarchyHeader.offsetHeight;
                    const panelHeight = document.querySelector('.hierarchy-panel').offsetHeight;
                    hierarchyList.style.maxHeight = (panelHeight - headerHeight) + 'px';
                }
                
                // Update inspector container height
                const inspectorHeader = document.querySelector('.module-panel .hierarchy-header');
                const inspectorList = document.getElementById('moduleSettings');
                
                if (inspectorHeader && inspectorList) {
                    const headerHeight = inspectorHeader.offsetHeight;
                    const panelHeight = document.querySelector('.module-panel').offsetHeight;
                    inspectorList.style.maxHeight = (panelHeight - headerHeight) + 'px';
                }
            }
            
            // Handle window resize
            window.addEventListener('resize', function() {
                updateMainContentHeight();
            });
        });
    </script>
    
    <div class="footer">
        SynKrown
    </div>

    <script src="src/core/Vector2.js"></script>
    <script src="src/core/Module.js"></script>
    <script src="src/core/ModuleRegistry.js"></script>
    <script src="src/core/GameObject.js"></script>
    <script src="src/core/Scene.js"></script>
    <script src="src/core/SceneBuffer.js"></script>
    <script src="src/core/SceneStorage.js"></script>
    <script src="src/core/SceneManager.js"></script>
    <script src="src/core/Engine.js"></script>
    <script src="src/core/EditorGrid.js"></script>
    <script src="src/core/HierarchyManager.js"></script>
    <script src="src/core/Inspector.js"></script>
    <script src="src/core/Editor.js"></script>
    <script src="src/core/FileBrowser.js"></script>
    <script src="src/core/ScriptEditor.js"></script>
    <script src="src/core/Modules/SpriteRenderer.js"></script>
    <script src="src/app.js"></script>
</body>
</html>
